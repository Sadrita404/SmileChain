var tJ=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var FXe=tJ((yQe,nn)=>{function _z(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Df=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function nJ(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var EE={exports:{}},Xp={},CE={exports:{}},Ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NF;function rJ(){if(NF)return Ot;NF=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(H){return H===null||typeof H!="object"?null:(H=d&&H[d]||H["@@iterator"],typeof H=="function"?H:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(H,Y,ce){this.props=H,this.context=Y,this.refs=v,this.updater=ce||m}y.prototype.isReactComponent={},y.prototype.setState=function(H,Y){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,Y,"setState")},y.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function w(){}w.prototype=y.prototype;function x(H,Y,ce){this.props=H,this.context=Y,this.refs=v,this.updater=ce||m}var S=x.prototype=new w;S.constructor=x,g(S,y.prototype),S.isPureReactComponent=!0;var k=Array.isArray,E=Object.prototype.hasOwnProperty,A={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function N(H,Y,ce){var de,ge={},be=null,we=null;if(Y!=null)for(de in Y.ref!==void 0&&(we=Y.ref),Y.key!==void 0&&(be=""+Y.key),Y)E.call(Y,de)&&!R.hasOwnProperty(de)&&(ge[de]=Y[de]);var Ae=arguments.length-2;if(Ae===1)ge.children=ce;else if(1<Ae){for(var _e=Array(Ae),je=0;je<Ae;je++)_e[je]=arguments[je+2];ge.children=_e}if(H&&H.defaultProps)for(de in Ae=H.defaultProps,Ae)ge[de]===void 0&&(ge[de]=Ae[de]);return{$$typeof:t,type:H,key:be,ref:we,props:ge,_owner:A.current}}function P(H,Y){return{$$typeof:t,type:H.type,key:Y,ref:H.ref,props:H.props,_owner:H._owner}}function O(H){return typeof H=="object"&&H!==null&&H.$$typeof===t}function _(H){var Y={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ce){return Y[ce]})}var M=/\/+/g;function G(H,Y){return typeof H=="object"&&H!==null&&H.key!=null?_(""+H.key):Y.toString(36)}function q(H,Y,ce,de,ge){var be=typeof H;(be==="undefined"||be==="boolean")&&(H=null);var we=!1;if(H===null)we=!0;else switch(be){case"string":case"number":we=!0;break;case"object":switch(H.$$typeof){case t:case e:we=!0}}if(we)return we=H,ge=ge(we),H=de===""?"."+G(we,0):de,k(ge)?(ce="",H!=null&&(ce=H.replace(M,"$&/")+"/"),q(ge,Y,ce,"",function(je){return je})):ge!=null&&(O(ge)&&(ge=P(ge,ce+(!ge.key||we&&we.key===ge.key?"":(""+ge.key).replace(M,"$&/")+"/")+H)),Y.push(ge)),1;if(we=0,de=de===""?".":de+":",k(H))for(var Ae=0;Ae<H.length;Ae++){be=H[Ae];var _e=de+G(be,Ae);we+=q(be,Y,ce,_e,ge)}else if(_e=h(H),typeof _e=="function")for(H=_e.call(H),Ae=0;!(be=H.next()).done;)be=be.value,_e=de+G(be,Ae++),we+=q(be,Y,ce,_e,ge);else if(be==="object")throw Y=String(H),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return we}function D(H,Y,ce){if(H==null)return H;var de=[],ge=0;return q(H,de,"","",function(be){return Y.call(ce,be,ge++)}),de}function L(H){if(H._status===-1){var Y=H._result;Y=Y(),Y.then(function(ce){(H._status===0||H._status===-1)&&(H._status=1,H._result=ce)},function(ce){(H._status===0||H._status===-1)&&(H._status=2,H._result=ce)}),H._status===-1&&(H._status=0,H._result=Y)}if(H._status===1)return H._result.default;throw H._result}var K={current:null},j={transition:null},W={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:j,ReactCurrentOwner:A};function X(){throw Error("act(...) is not supported in production builds of React.")}return Ot.Children={map:D,forEach:function(H,Y,ce){D(H,function(){Y.apply(this,arguments)},ce)},count:function(H){var Y=0;return D(H,function(){Y++}),Y},toArray:function(H){return D(H,function(Y){return Y})||[]},only:function(H){if(!O(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Ot.Component=y,Ot.Fragment=n,Ot.Profiler=s,Ot.PureComponent=x,Ot.StrictMode=r,Ot.Suspense=c,Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,Ot.act=X,Ot.cloneElement=function(H,Y,ce){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var de=g({},H.props),ge=H.key,be=H.ref,we=H._owner;if(Y!=null){if(Y.ref!==void 0&&(be=Y.ref,we=A.current),Y.key!==void 0&&(ge=""+Y.key),H.type&&H.type.defaultProps)var Ae=H.type.defaultProps;for(_e in Y)E.call(Y,_e)&&!R.hasOwnProperty(_e)&&(de[_e]=Y[_e]===void 0&&Ae!==void 0?Ae[_e]:Y[_e])}var _e=arguments.length-2;if(_e===1)de.children=ce;else if(1<_e){Ae=Array(_e);for(var je=0;je<_e;je++)Ae[je]=arguments[je+2];de.children=Ae}return{$$typeof:t,type:H.type,key:ge,ref:be,props:de,_owner:we}},Ot.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:i,_context:H},H.Consumer=H},Ot.createElement=N,Ot.createFactory=function(H){var Y=N.bind(null,H);return Y.type=H,Y},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(H){return{$$typeof:a,render:H}},Ot.isValidElement=O,Ot.lazy=function(H){return{$$typeof:u,_payload:{_status:-1,_result:H},_init:L}},Ot.memo=function(H,Y){return{$$typeof:l,type:H,compare:Y===void 0?null:Y}},Ot.startTransition=function(H){var Y=j.transition;j.transition={};try{H()}finally{j.transition=Y}},Ot.unstable_act=X,Ot.useCallback=function(H,Y){return K.current.useCallback(H,Y)},Ot.useContext=function(H){return K.current.useContext(H)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(H){return K.current.useDeferredValue(H)},Ot.useEffect=function(H,Y){return K.current.useEffect(H,Y)},Ot.useId=function(){return K.current.useId()},Ot.useImperativeHandle=function(H,Y,ce){return K.current.useImperativeHandle(H,Y,ce)},Ot.useInsertionEffect=function(H,Y){return K.current.useInsertionEffect(H,Y)},Ot.useLayoutEffect=function(H,Y){return K.current.useLayoutEffect(H,Y)},Ot.useMemo=function(H,Y){return K.current.useMemo(H,Y)},Ot.useReducer=function(H,Y,ce){return K.current.useReducer(H,Y,ce)},Ot.useRef=function(H){return K.current.useRef(H)},Ot.useState=function(H){return K.current.useState(H)},Ot.useSyncExternalStore=function(H,Y,ce){return K.current.useSyncExternalStore(H,Y,ce)},Ot.useTransition=function(){return K.current.useTransition()},Ot.version="18.3.1",Ot}var _F;function Xg(){return _F||(_F=1,CE.exports=rJ()),CE.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $F;function sJ(){if($F)return Xp;$F=1;var t=Xg(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,l){var u,d={},h=null,m=null;l!==void 0&&(h=""+l),c.key!==void 0&&(h=""+c.key),c.ref!==void 0&&(m=c.ref);for(u in c)r.call(c,u)&&!i.hasOwnProperty(u)&&(d[u]=c[u]);if(a&&a.defaultProps)for(u in c=a.defaultProps,c)d[u]===void 0&&(d[u]=c[u]);return{$$typeof:e,type:a,key:h,ref:m,props:d,_owner:s.current}}return Xp.Fragment=n,Xp.jsx=o,Xp.jsxs=o,Xp}var RF;function iJ(){return RF||(RF=1,EE.exports=sJ()),EE.exports}var F=iJ(),Hv={},TE={exports:{}},Ls={},AE={exports:{}},NE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OF;function oJ(){return OF||(OF=1,(function(t){function e(j,W){var X=j.length;j.push(W);e:for(;0<X;){var H=X-1>>>1,Y=j[H];if(0<s(Y,W))j[H]=W,j[X]=Y,X=H;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var W=j[0],X=j.pop();if(X!==W){j[0]=X;e:for(var H=0,Y=j.length,ce=Y>>>1;H<ce;){var de=2*(H+1)-1,ge=j[de],be=de+1,we=j[be];if(0>s(ge,X))be<Y&&0>s(we,ge)?(j[H]=we,j[be]=X,H=be):(j[H]=ge,j[de]=X,H=de);else if(be<Y&&0>s(we,X))j[H]=we,j[be]=X,H=be;else break e}}return W}function s(j,W){var X=j.sortIndex-W.sortIndex;return X!==0?X:j.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,h=3,m=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(j){for(var W=n(l);W!==null;){if(W.callback===null)r(l);else if(W.startTime<=j)r(l),W.sortIndex=W.expirationTime,e(c,W);else break;W=n(l)}}function k(j){if(v=!1,S(j),!g)if(n(c)!==null)g=!0,L(E);else{var W=n(l);W!==null&&K(k,W.startTime-j)}}function E(j,W){g=!1,v&&(v=!1,w(N),N=-1),m=!0;var X=h;try{for(S(W),d=n(c);d!==null&&(!(d.expirationTime>W)||j&&!_());){var H=d.callback;if(typeof H=="function"){d.callback=null,h=d.priorityLevel;var Y=H(d.expirationTime<=W);W=t.unstable_now(),typeof Y=="function"?d.callback=Y:d===n(c)&&r(c),S(W)}else r(c);d=n(c)}if(d!==null)var ce=!0;else{var de=n(l);de!==null&&K(k,de.startTime-W),ce=!1}return ce}finally{d=null,h=X,m=!1}}var A=!1,R=null,N=-1,P=5,O=-1;function _(){return!(t.unstable_now()-O<P)}function M(){if(R!==null){var j=t.unstable_now();O=j;var W=!0;try{W=R(!0,j)}finally{W?G():(A=!1,R=null)}}else A=!1}var G;if(typeof x=="function")G=function(){x(M)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,D=q.port2;q.port1.onmessage=M,G=function(){D.postMessage(null)}}else G=function(){y(M,0)};function L(j){R=j,A||(A=!0,G())}function K(j,W){N=y(function(){j(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,L(E))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(j){switch(h){case 1:case 2:case 3:var W=3;break;default:W=h}var X=h;h=W;try{return j()}finally{h=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,W){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var X=h;h=j;try{return W()}finally{h=X}},t.unstable_scheduleCallback=function(j,W,X){var H=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?H+X:H):X=H,j){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=X+Y,j={id:u++,callback:W,priorityLevel:j,startTime:X,expirationTime:Y,sortIndex:-1},X>H?(j.sortIndex=X,e(l,j),n(c)===null&&j===n(l)&&(v?(w(N),N=-1):v=!0,K(k,X-H))):(j.sortIndex=Y,e(c,j),g||m||(g=!0,L(E))),j},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(j){var W=h;return function(){var X=h;h=W;try{return j.apply(this,arguments)}finally{h=X}}}})(NE)),NE}var PF;function aJ(){return PF||(PF=1,AE.exports=oJ()),AE.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DF;function cJ(){if(DF)return Ls;DF=1;var t=Xg(),e=aJ();function n(f){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+f,b=1;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(f,p){o(f,p),o(f+"Capture",p)}function o(f,p){for(s[f]=p,f=0;f<p.length;f++)r.add(p[f])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},d={};function h(f){return c.call(d,f)?!0:c.call(u,f)?!1:l.test(f)?d[f]=!0:(u[f]=!0,!1)}function m(f,p,b,I){if(b!==null&&b.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return I?!1:b!==null?!b.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function g(f,p,b,I){if(p===null||typeof p>"u"||m(f,p,b,I))return!0;if(I)return!1;if(b!==null)switch(b.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function v(f,p,b,I,C,T,B){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=I,this.attributeNamespace=C,this.mustUseProperty=b,this.propertyName=f,this.type=p,this.sanitizeURL=T,this.removeEmptyString=B}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){y[f]=new v(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var p=f[0];y[p]=new v(p,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){y[f]=new v(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){y[f]=new v(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){y[f]=new v(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){y[f]=new v(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){y[f]=new v(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){y[f]=new v(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){y[f]=new v(f,5,!1,f.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function x(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var p=f.replace(w,x);y[p]=new v(p,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var p=f.replace(w,x);y[p]=new v(p,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var p=f.replace(w,x);y[p]=new v(p,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){y[f]=new v(f,1,!1,f.toLowerCase(),null,!1,!1)}),y.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){y[f]=new v(f,1,!1,f.toLowerCase(),null,!0,!0)});function S(f,p,b,I){var C=y.hasOwnProperty(p)?y[p]:null;(C!==null?C.type!==0:I||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(g(p,b,C,I)&&(b=null),I||C===null?h(p)&&(b===null?f.removeAttribute(p):f.setAttribute(p,""+b)):C.mustUseProperty?f[C.propertyName]=b===null?C.type===3?!1:"":b:(p=C.attributeName,I=C.attributeNamespace,b===null?f.removeAttribute(p):(C=C.type,b=C===3||C===4&&b===!0?"":""+b,I?f.setAttributeNS(I,p,b):f.setAttribute(p,b))))}var k=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),A=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),_=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),K=Symbol.for("react.offscreen"),j=Symbol.iterator;function W(f){return f===null||typeof f!="object"?null:(f=j&&f[j]||f["@@iterator"],typeof f=="function"?f:null)}var X=Object.assign,H;function Y(f){if(H===void 0)try{throw Error()}catch(b){var p=b.stack.trim().match(/\n( *(at )?)/);H=p&&p[1]||""}return`
`+H+f}var ce=!1;function de(f,p){if(!f||ce)return"";ce=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(pe){var I=pe}Reflect.construct(f,[],p)}else{try{p.call()}catch(pe){I=pe}f.call(p.prototype)}else{try{throw Error()}catch(pe){I=pe}f()}}catch(pe){if(pe&&I&&typeof pe.stack=="string"){for(var C=pe.stack.split(`
`),T=I.stack.split(`
`),B=C.length-1,Q=T.length-1;1<=B&&0<=Q&&C[B]!==T[Q];)Q--;for(;1<=B&&0<=Q;B--,Q--)if(C[B]!==T[Q]){if(B!==1||Q!==1)do if(B--,Q--,0>Q||C[B]!==T[Q]){var ne=`
`+C[B].replace(" at new "," at ");return f.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",f.displayName)),ne}while(1<=B&&0<=Q);break}}}finally{ce=!1,Error.prepareStackTrace=b}return(f=f?f.displayName||f.name:"")?Y(f):""}function ge(f){switch(f.tag){case 5:return Y(f.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return f=de(f.type,!1),f;case 11:return f=de(f.type.render,!1),f;case 1:return f=de(f.type,!0),f;default:return""}}function be(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case R:return"Fragment";case A:return"Portal";case P:return"Profiler";case N:return"StrictMode";case G:return"Suspense";case q:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case _:return(f.displayName||"Context")+".Consumer";case O:return(f._context.displayName||"Context")+".Provider";case M:var p=f.render;return f=f.displayName,f||(f=p.displayName||p.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case D:return p=f.displayName||null,p!==null?p:be(f.type)||"Memo";case L:p=f._payload,f=f._init;try{return be(f(p))}catch{}}return null}function we(f){var p=f.type;switch(f.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=p.render,f=f.displayName||f.name||"",p.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(p);case 8:return p===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Ae(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function _e(f){var p=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function je(f){var p=_e(f)?"checked":"value",b=Object.getOwnPropertyDescriptor(f.constructor.prototype,p),I=""+f[p];if(!f.hasOwnProperty(p)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var C=b.get,T=b.set;return Object.defineProperty(f,p,{configurable:!0,get:function(){return C.call(this)},set:function(B){I=""+B,T.call(this,B)}}),Object.defineProperty(f,p,{enumerable:b.enumerable}),{getValue:function(){return I},setValue:function(B){I=""+B},stopTracking:function(){f._valueTracker=null,delete f[p]}}}}function st(f){f._valueTracker||(f._valueTracker=je(f))}function dt(f){if(!f)return!1;var p=f._valueTracker;if(!p)return!0;var b=p.getValue(),I="";return f&&(I=_e(f)?f.checked?"true":"false":f.value),f=I,f!==b?(p.setValue(f),!0):!1}function yt(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Mt(f,p){var b=p.checked;return X({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??f._wrapperState.initialChecked})}function Ft(f,p){var b=p.defaultValue==null?"":p.defaultValue,I=p.checked!=null?p.checked:p.defaultChecked;b=Ae(p.value!=null?p.value:b),f._wrapperState={initialChecked:I,initialValue:b,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Pt(f,p){p=p.checked,p!=null&&S(f,"checked",p,!1)}function Xt(f,p){Pt(f,p);var b=Ae(p.value),I=p.type;if(b!=null)I==="number"?(b===0&&f.value===""||f.value!=b)&&(f.value=""+b):f.value!==""+b&&(f.value=""+b);else if(I==="submit"||I==="reset"){f.removeAttribute("value");return}p.hasOwnProperty("value")?ns(f,p.type,b):p.hasOwnProperty("defaultValue")&&ns(f,p.type,Ae(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(f.defaultChecked=!!p.defaultChecked)}function en(f,p,b){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var I=p.type;if(!(I!=="submit"&&I!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+f._wrapperState.initialValue,b||p===f.value||(f.value=p),f.defaultValue=p}b=f.name,b!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,b!==""&&(f.name=b)}function ns(f,p,b){(p!=="number"||yt(f.ownerDocument)!==f)&&(b==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+b&&(f.defaultValue=""+b))}var Z=Array.isArray;function le(f,p,b,I){if(f=f.options,p){p={};for(var C=0;C<b.length;C++)p["$"+b[C]]=!0;for(b=0;b<f.length;b++)C=p.hasOwnProperty("$"+f[b].value),f[b].selected!==C&&(f[b].selected=C),C&&I&&(f[b].defaultSelected=!0)}else{for(b=""+Ae(b),p=null,C=0;C<f.length;C++){if(f[C].value===b){f[C].selected=!0,I&&(f[C].defaultSelected=!0);return}p!==null||f[C].disabled||(p=f[C])}p!==null&&(p.selected=!0)}}function ye(f,p){if(p.dangerouslySetInnerHTML!=null)throw Error(n(91));return X({},p,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function De(f,p){var b=p.value;if(b==null){if(b=p.children,p=p.defaultValue,b!=null){if(p!=null)throw Error(n(92));if(Z(b)){if(1<b.length)throw Error(n(93));b=b[0]}p=b}p==null&&(p=""),b=p}f._wrapperState={initialValue:Ae(b)}}function Ne(f,p){var b=Ae(p.value),I=Ae(p.defaultValue);b!=null&&(b=""+b,b!==f.value&&(f.value=b),p.defaultValue==null&&f.defaultValue!==b&&(f.defaultValue=b)),I!=null&&(f.defaultValue=""+I)}function Ee(f){var p=f.textContent;p===f._wrapperState.initialValue&&p!==""&&p!==null&&(f.value=p)}function Ge(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xt(f,p){return f==null||f==="http://www.w3.org/1999/xhtml"?Ge(p):f==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Ct,Zn=(function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,b,I,C){MSApp.execUnsafeLocalFunction(function(){return f(p,b,I,C)})}:f})(function(f,p){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=p;else{for(Ct=Ct||document.createElement("div"),Ct.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=Ct.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;p.firstChild;)f.appendChild(p.firstChild)}});function $s(f,p){if(p){var b=f.firstChild;if(b&&b===f.lastChild&&b.nodeType===3){b.nodeValue=p;return}}f.textContent=p}var Tr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},up=["Webkit","ms","Moz","O"];Object.keys(Tr).forEach(function(f){up.forEach(function(p){p=p+f.charAt(0).toUpperCase()+f.substring(1),Tr[p]=Tr[f]})});function fo(f,p,b){return p==null||typeof p=="boolean"||p===""?"":b||typeof p!="number"||p===0||Tr.hasOwnProperty(f)&&Tr[f]?(""+p).trim():p+"px"}function _c(f,p){f=f.style;for(var b in p)if(p.hasOwnProperty(b)){var I=b.indexOf("--")===0,C=fo(b,p[b],I);b==="float"&&(b="cssFloat"),I?f.setProperty(b,C):f[b]=C}}var dp=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dd(f,p){if(p){if(dp[f]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(n(137,f));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(n(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(n(61))}if(p.style!=null&&typeof p.style!="object")throw Error(n(62))}}function fp(f,p){if(f.indexOf("-")===-1)return typeof p.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fd=null;function zS(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var US=null,Ld=null,Bd=null;function GO(f){if(f=Pp(f)){if(typeof US!="function")throw Error(n(280));var p=f.stateNode;p&&(p=iv(p),US(f.stateNode,f.type,p))}}function qO(f){Ld?Bd?Bd.push(f):Bd=[f]:Ld=f}function KO(){if(Ld){var f=Ld,p=Bd;if(Bd=Ld=null,GO(f),p)for(f=0;f<p.length;f++)GO(p[f])}}function XO(f,p){return f(p)}function QO(){}var VS=!1;function YO(f,p,b){if(VS)return f(p,b);VS=!0;try{return XO(f,p,b)}finally{VS=!1,(Ld!==null||Bd!==null)&&(QO(),KO())}}function hp(f,p){var b=f.stateNode;if(b===null)return null;var I=iv(b);if(I===null)return null;b=I[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(I=!I.disabled)||(f=f.type,I=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!I;break e;default:f=!1}if(f)return null;if(b&&typeof b!="function")throw Error(n(231,p,typeof b));return b}var jS=!1;if(a)try{var pp={};Object.defineProperty(pp,"passive",{get:function(){jS=!0}}),window.addEventListener("test",pp,pp),window.removeEventListener("test",pp,pp)}catch{jS=!1}function aY(f,p,b,I,C,T,B,Q,ne){var pe=Array.prototype.slice.call(arguments,3);try{p.apply(b,pe)}catch(ke){this.onError(ke)}}var mp=!1,Ly=null,By=!1,HS=null,cY={onError:function(f){mp=!0,Ly=f}};function lY(f,p,b,I,C,T,B,Q,ne){mp=!1,Ly=null,aY.apply(cY,arguments)}function uY(f,p,b,I,C,T,B,Q,ne){if(lY.apply(this,arguments),mp){if(mp){var pe=Ly;mp=!1,Ly=null}else throw Error(n(198));By||(By=!0,HS=pe)}}function Xl(f){var p=f,b=f;if(f.alternate)for(;p.return;)p=p.return;else{f=p;do p=f,(p.flags&4098)!==0&&(b=p.return),f=p.return;while(f)}return p.tag===3?b:null}function ZO(f){if(f.tag===13){var p=f.memoizedState;if(p===null&&(f=f.alternate,f!==null&&(p=f.memoizedState)),p!==null)return p.dehydrated}return null}function JO(f){if(Xl(f)!==f)throw Error(n(188))}function dY(f){var p=f.alternate;if(!p){if(p=Xl(f),p===null)throw Error(n(188));return p!==f?null:f}for(var b=f,I=p;;){var C=b.return;if(C===null)break;var T=C.alternate;if(T===null){if(I=C.return,I!==null){b=I;continue}break}if(C.child===T.child){for(T=C.child;T;){if(T===b)return JO(C),f;if(T===I)return JO(C),p;T=T.sibling}throw Error(n(188))}if(b.return!==I.return)b=C,I=T;else{for(var B=!1,Q=C.child;Q;){if(Q===b){B=!0,b=C,I=T;break}if(Q===I){B=!0,I=C,b=T;break}Q=Q.sibling}if(!B){for(Q=T.child;Q;){if(Q===b){B=!0,b=T,I=C;break}if(Q===I){B=!0,I=T,b=C;break}Q=Q.sibling}if(!B)throw Error(n(189))}}if(b.alternate!==I)throw Error(n(190))}if(b.tag!==3)throw Error(n(188));return b.stateNode.current===b?f:p}function eP(f){return f=dY(f),f!==null?tP(f):null}function tP(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var p=tP(f);if(p!==null)return p;f=f.sibling}return null}var nP=e.unstable_scheduleCallback,rP=e.unstable_cancelCallback,fY=e.unstable_shouldYield,hY=e.unstable_requestPaint,Jn=e.unstable_now,pY=e.unstable_getCurrentPriorityLevel,WS=e.unstable_ImmediatePriority,sP=e.unstable_UserBlockingPriority,My=e.unstable_NormalPriority,mY=e.unstable_LowPriority,iP=e.unstable_IdlePriority,zy=null,Xo=null;function gY(f){if(Xo&&typeof Xo.onCommitFiberRoot=="function")try{Xo.onCommitFiberRoot(zy,f,void 0,(f.current.flags&128)===128)}catch{}}var ho=Math.clz32?Math.clz32:bY,yY=Math.log,vY=Math.LN2;function bY(f){return f>>>=0,f===0?32:31-(yY(f)/vY|0)|0}var Uy=64,Vy=4194304;function gp(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function jy(f,p){var b=f.pendingLanes;if(b===0)return 0;var I=0,C=f.suspendedLanes,T=f.pingedLanes,B=b&268435455;if(B!==0){var Q=B&~C;Q!==0?I=gp(Q):(T&=B,T!==0&&(I=gp(T)))}else B=b&~C,B!==0?I=gp(B):T!==0&&(I=gp(T));if(I===0)return 0;if(p!==0&&p!==I&&(p&C)===0&&(C=I&-I,T=p&-p,C>=T||C===16&&(T&4194240)!==0))return p;if((I&4)!==0&&(I|=b&16),p=f.entangledLanes,p!==0)for(f=f.entanglements,p&=I;0<p;)b=31-ho(p),C=1<<b,I|=f[b],p&=~C;return I}function wY(f,p){switch(f){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xY(f,p){for(var b=f.suspendedLanes,I=f.pingedLanes,C=f.expirationTimes,T=f.pendingLanes;0<T;){var B=31-ho(T),Q=1<<B,ne=C[B];ne===-1?((Q&b)===0||(Q&I)!==0)&&(C[B]=wY(Q,p)):ne<=p&&(f.expiredLanes|=Q),T&=~Q}}function GS(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function oP(){var f=Uy;return Uy<<=1,(Uy&4194240)===0&&(Uy=64),f}function qS(f){for(var p=[],b=0;31>b;b++)p.push(f);return p}function yp(f,p,b){f.pendingLanes|=p,p!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,p=31-ho(p),f[p]=b}function IY(f,p){var b=f.pendingLanes&~p;f.pendingLanes=p,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=p,f.mutableReadLanes&=p,f.entangledLanes&=p,p=f.entanglements;var I=f.eventTimes;for(f=f.expirationTimes;0<b;){var C=31-ho(b),T=1<<C;p[C]=0,I[C]=-1,f[C]=-1,b&=~T}}function KS(f,p){var b=f.entangledLanes|=p;for(f=f.entanglements;b;){var I=31-ho(b),C=1<<I;C&p|f[I]&p&&(f[I]|=p),b&=~C}}var tn=0;function aP(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var cP,XS,lP,uP,dP,QS=!1,Hy=[],$c=null,Rc=null,Oc=null,vp=new Map,bp=new Map,Pc=[],SY="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fP(f,p){switch(f){case"focusin":case"focusout":$c=null;break;case"dragenter":case"dragleave":Rc=null;break;case"mouseover":case"mouseout":Oc=null;break;case"pointerover":case"pointerout":vp.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":bp.delete(p.pointerId)}}function wp(f,p,b,I,C,T){return f===null||f.nativeEvent!==T?(f={blockedOn:p,domEventName:b,eventSystemFlags:I,nativeEvent:T,targetContainers:[C]},p!==null&&(p=Pp(p),p!==null&&XS(p)),f):(f.eventSystemFlags|=I,p=f.targetContainers,C!==null&&p.indexOf(C)===-1&&p.push(C),f)}function kY(f,p,b,I,C){switch(p){case"focusin":return $c=wp($c,f,p,b,I,C),!0;case"dragenter":return Rc=wp(Rc,f,p,b,I,C),!0;case"mouseover":return Oc=wp(Oc,f,p,b,I,C),!0;case"pointerover":var T=C.pointerId;return vp.set(T,wp(vp.get(T)||null,f,p,b,I,C)),!0;case"gotpointercapture":return T=C.pointerId,bp.set(T,wp(bp.get(T)||null,f,p,b,I,C)),!0}return!1}function hP(f){var p=Ql(f.target);if(p!==null){var b=Xl(p);if(b!==null){if(p=b.tag,p===13){if(p=ZO(b),p!==null){f.blockedOn=p,dP(f.priority,function(){lP(b)});return}}else if(p===3&&b.stateNode.current.memoizedState.isDehydrated){f.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Wy(f){if(f.blockedOn!==null)return!1;for(var p=f.targetContainers;0<p.length;){var b=ZS(f.domEventName,f.eventSystemFlags,p[0],f.nativeEvent);if(b===null){b=f.nativeEvent;var I=new b.constructor(b.type,b);Fd=I,b.target.dispatchEvent(I),Fd=null}else return p=Pp(b),p!==null&&XS(p),f.blockedOn=b,!1;p.shift()}return!0}function pP(f,p,b){Wy(f)&&b.delete(p)}function EY(){QS=!1,$c!==null&&Wy($c)&&($c=null),Rc!==null&&Wy(Rc)&&(Rc=null),Oc!==null&&Wy(Oc)&&(Oc=null),vp.forEach(pP),bp.forEach(pP)}function xp(f,p){f.blockedOn===p&&(f.blockedOn=null,QS||(QS=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,EY)))}function Ip(f){function p(C){return xp(C,f)}if(0<Hy.length){xp(Hy[0],f);for(var b=1;b<Hy.length;b++){var I=Hy[b];I.blockedOn===f&&(I.blockedOn=null)}}for($c!==null&&xp($c,f),Rc!==null&&xp(Rc,f),Oc!==null&&xp(Oc,f),vp.forEach(p),bp.forEach(p),b=0;b<Pc.length;b++)I=Pc[b],I.blockedOn===f&&(I.blockedOn=null);for(;0<Pc.length&&(b=Pc[0],b.blockedOn===null);)hP(b),b.blockedOn===null&&Pc.shift()}var Md=k.ReactCurrentBatchConfig,Gy=!0;function CY(f,p,b,I){var C=tn,T=Md.transition;Md.transition=null;try{tn=1,YS(f,p,b,I)}finally{tn=C,Md.transition=T}}function TY(f,p,b,I){var C=tn,T=Md.transition;Md.transition=null;try{tn=4,YS(f,p,b,I)}finally{tn=C,Md.transition=T}}function YS(f,p,b,I){if(Gy){var C=ZS(f,p,b,I);if(C===null)mk(f,p,I,qy,b),fP(f,I);else if(kY(C,f,p,b,I))I.stopPropagation();else if(fP(f,I),p&4&&-1<SY.indexOf(f)){for(;C!==null;){var T=Pp(C);if(T!==null&&cP(T),T=ZS(f,p,b,I),T===null&&mk(f,p,I,qy,b),T===C)break;C=T}C!==null&&I.stopPropagation()}else mk(f,p,I,null,b)}}var qy=null;function ZS(f,p,b,I){if(qy=null,f=zS(I),f=Ql(f),f!==null)if(p=Xl(f),p===null)f=null;else if(b=p.tag,b===13){if(f=ZO(p),f!==null)return f;f=null}else if(b===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;f=null}else p!==f&&(f=null);return qy=f,null}function mP(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pY()){case WS:return 1;case sP:return 4;case My:case mY:return 16;case iP:return 536870912;default:return 16}default:return 16}}var Dc=null,JS=null,Ky=null;function gP(){if(Ky)return Ky;var f,p=JS,b=p.length,I,C="value"in Dc?Dc.value:Dc.textContent,T=C.length;for(f=0;f<b&&p[f]===C[f];f++);var B=b-f;for(I=1;I<=B&&p[b-I]===C[T-I];I++);return Ky=C.slice(f,1<I?1-I:void 0)}function Xy(f){var p=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&p===13&&(f=13)):f=p,f===10&&(f=13),32<=f||f===13?f:0}function Qy(){return!0}function yP(){return!1}function ui(f){function p(b,I,C,T,B){this._reactName=b,this._targetInst=C,this.type=I,this.nativeEvent=T,this.target=B,this.currentTarget=null;for(var Q in f)f.hasOwnProperty(Q)&&(b=f[Q],this[Q]=b?b(T):T[Q]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Qy:yP,this.isPropagationStopped=yP,this}return X(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Qy)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Qy)},persist:function(){},isPersistent:Qy}),p}var zd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ek=ui(zd),Sp=X({},zd,{view:0,detail:0}),AY=ui(Sp),tk,nk,kp,Yy=X({},Sp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sk,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==kp&&(kp&&f.type==="mousemove"?(tk=f.screenX-kp.screenX,nk=f.screenY-kp.screenY):nk=tk=0,kp=f),tk)},movementY:function(f){return"movementY"in f?f.movementY:nk}}),vP=ui(Yy),NY=X({},Yy,{dataTransfer:0}),_Y=ui(NY),$Y=X({},Sp,{relatedTarget:0}),rk=ui($Y),RY=X({},zd,{animationName:0,elapsedTime:0,pseudoElement:0}),OY=ui(RY),PY=X({},zd,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),DY=ui(PY),FY=X({},zd,{data:0}),bP=ui(FY),LY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zY(f){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(f):(f=MY[f])?!!p[f]:!1}function sk(){return zY}var UY=X({},Sp,{key:function(f){if(f.key){var p=LY[f.key]||f.key;if(p!=="Unidentified")return p}return f.type==="keypress"?(f=Xy(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?BY[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sk,charCode:function(f){return f.type==="keypress"?Xy(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?Xy(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),VY=ui(UY),jY=X({},Yy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wP=ui(jY),HY=X({},Sp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sk}),WY=ui(HY),GY=X({},zd,{propertyName:0,elapsedTime:0,pseudoElement:0}),qY=ui(GY),KY=X({},Yy,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),XY=ui(KY),QY=[9,13,27,32],ik=a&&"CompositionEvent"in window,Ep=null;a&&"documentMode"in document&&(Ep=document.documentMode);var YY=a&&"TextEvent"in window&&!Ep,xP=a&&(!ik||Ep&&8<Ep&&11>=Ep),IP=" ",SP=!1;function kP(f,p){switch(f){case"keyup":return QY.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EP(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Ud=!1;function ZY(f,p){switch(f){case"compositionend":return EP(p);case"keypress":return p.which!==32?null:(SP=!0,IP);case"textInput":return f=p.data,f===IP&&SP?null:f;default:return null}}function JY(f,p){if(Ud)return f==="compositionend"||!ik&&kP(f,p)?(f=gP(),Ky=JS=Dc=null,Ud=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return xP&&p.locale!=="ko"?null:p.data;default:return null}}var eZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CP(f){var p=f&&f.nodeName&&f.nodeName.toLowerCase();return p==="input"?!!eZ[f.type]:p==="textarea"}function TP(f,p,b,I){qO(I),p=nv(p,"onChange"),0<p.length&&(b=new ek("onChange","change",null,b,I),f.push({event:b,listeners:p}))}var Cp=null,Tp=null;function tZ(f){WP(f,0)}function Zy(f){var p=Gd(f);if(dt(p))return f}function nZ(f,p){if(f==="change")return p}var AP=!1;if(a){var ok;if(a){var ak="oninput"in document;if(!ak){var NP=document.createElement("div");NP.setAttribute("oninput","return;"),ak=typeof NP.oninput=="function"}ok=ak}else ok=!1;AP=ok&&(!document.documentMode||9<document.documentMode)}function _P(){Cp&&(Cp.detachEvent("onpropertychange",$P),Tp=Cp=null)}function $P(f){if(f.propertyName==="value"&&Zy(Tp)){var p=[];TP(p,Tp,f,zS(f)),YO(tZ,p)}}function rZ(f,p,b){f==="focusin"?(_P(),Cp=p,Tp=b,Cp.attachEvent("onpropertychange",$P)):f==="focusout"&&_P()}function sZ(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Zy(Tp)}function iZ(f,p){if(f==="click")return Zy(p)}function oZ(f,p){if(f==="input"||f==="change")return Zy(p)}function aZ(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var po=typeof Object.is=="function"?Object.is:aZ;function Ap(f,p){if(po(f,p))return!0;if(typeof f!="object"||f===null||typeof p!="object"||p===null)return!1;var b=Object.keys(f),I=Object.keys(p);if(b.length!==I.length)return!1;for(I=0;I<b.length;I++){var C=b[I];if(!c.call(p,C)||!po(f[C],p[C]))return!1}return!0}function RP(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function OP(f,p){var b=RP(f);f=0;for(var I;b;){if(b.nodeType===3){if(I=f+b.textContent.length,f<=p&&I>=p)return{node:b,offset:p-f};f=I}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=RP(b)}}function PP(f,p){return f&&p?f===p?!0:f&&f.nodeType===3?!1:p&&p.nodeType===3?PP(f,p.parentNode):"contains"in f?f.contains(p):f.compareDocumentPosition?!!(f.compareDocumentPosition(p)&16):!1:!1}function DP(){for(var f=window,p=yt();p instanceof f.HTMLIFrameElement;){try{var b=typeof p.contentWindow.location.href=="string"}catch{b=!1}if(b)f=p.contentWindow;else break;p=yt(f.document)}return p}function ck(f){var p=f&&f.nodeName&&f.nodeName.toLowerCase();return p&&(p==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||p==="textarea"||f.contentEditable==="true")}function cZ(f){var p=DP(),b=f.focusedElem,I=f.selectionRange;if(p!==b&&b&&b.ownerDocument&&PP(b.ownerDocument.documentElement,b)){if(I!==null&&ck(b)){if(p=I.start,f=I.end,f===void 0&&(f=p),"selectionStart"in b)b.selectionStart=p,b.selectionEnd=Math.min(f,b.value.length);else if(f=(p=b.ownerDocument||document)&&p.defaultView||window,f.getSelection){f=f.getSelection();var C=b.textContent.length,T=Math.min(I.start,C);I=I.end===void 0?T:Math.min(I.end,C),!f.extend&&T>I&&(C=I,I=T,T=C),C=OP(b,T);var B=OP(b,I);C&&B&&(f.rangeCount!==1||f.anchorNode!==C.node||f.anchorOffset!==C.offset||f.focusNode!==B.node||f.focusOffset!==B.offset)&&(p=p.createRange(),p.setStart(C.node,C.offset),f.removeAllRanges(),T>I?(f.addRange(p),f.extend(B.node,B.offset)):(p.setEnd(B.node,B.offset),f.addRange(p)))}}for(p=[],f=b;f=f.parentNode;)f.nodeType===1&&p.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<p.length;b++)f=p[b],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var lZ=a&&"documentMode"in document&&11>=document.documentMode,Vd=null,lk=null,Np=null,uk=!1;function FP(f,p,b){var I=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;uk||Vd==null||Vd!==yt(I)||(I=Vd,"selectionStart"in I&&ck(I)?I={start:I.selectionStart,end:I.selectionEnd}:(I=(I.ownerDocument&&I.ownerDocument.defaultView||window).getSelection(),I={anchorNode:I.anchorNode,anchorOffset:I.anchorOffset,focusNode:I.focusNode,focusOffset:I.focusOffset}),Np&&Ap(Np,I)||(Np=I,I=nv(lk,"onSelect"),0<I.length&&(p=new ek("onSelect","select",null,p,b),f.push({event:p,listeners:I}),p.target=Vd)))}function Jy(f,p){var b={};return b[f.toLowerCase()]=p.toLowerCase(),b["Webkit"+f]="webkit"+p,b["Moz"+f]="moz"+p,b}var jd={animationend:Jy("Animation","AnimationEnd"),animationiteration:Jy("Animation","AnimationIteration"),animationstart:Jy("Animation","AnimationStart"),transitionend:Jy("Transition","TransitionEnd")},dk={},LP={};a&&(LP=document.createElement("div").style,"AnimationEvent"in window||(delete jd.animationend.animation,delete jd.animationiteration.animation,delete jd.animationstart.animation),"TransitionEvent"in window||delete jd.transitionend.transition);function ev(f){if(dk[f])return dk[f];if(!jd[f])return f;var p=jd[f],b;for(b in p)if(p.hasOwnProperty(b)&&b in LP)return dk[f]=p[b];return f}var BP=ev("animationend"),MP=ev("animationiteration"),zP=ev("animationstart"),UP=ev("transitionend"),VP=new Map,jP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fc(f,p){VP.set(f,p),i(p,[f])}for(var fk=0;fk<jP.length;fk++){var hk=jP[fk],uZ=hk.toLowerCase(),dZ=hk[0].toUpperCase()+hk.slice(1);Fc(uZ,"on"+dZ)}Fc(BP,"onAnimationEnd"),Fc(MP,"onAnimationIteration"),Fc(zP,"onAnimationStart"),Fc("dblclick","onDoubleClick"),Fc("focusin","onFocus"),Fc("focusout","onBlur"),Fc(UP,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _p="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(_p));function HP(f,p,b){var I=f.type||"unknown-event";f.currentTarget=b,uY(I,p,void 0,f),f.currentTarget=null}function WP(f,p){p=(p&4)!==0;for(var b=0;b<f.length;b++){var I=f[b],C=I.event;I=I.listeners;e:{var T=void 0;if(p)for(var B=I.length-1;0<=B;B--){var Q=I[B],ne=Q.instance,pe=Q.currentTarget;if(Q=Q.listener,ne!==T&&C.isPropagationStopped())break e;HP(C,Q,pe),T=ne}else for(B=0;B<I.length;B++){if(Q=I[B],ne=Q.instance,pe=Q.currentTarget,Q=Q.listener,ne!==T&&C.isPropagationStopped())break e;HP(C,Q,pe),T=ne}}}if(By)throw f=HS,By=!1,HS=null,f}function vn(f,p){var b=p[xk];b===void 0&&(b=p[xk]=new Set);var I=f+"__bubble";b.has(I)||(GP(p,f,2,!1),b.add(I))}function pk(f,p,b){var I=0;p&&(I|=4),GP(b,f,I,p)}var tv="_reactListening"+Math.random().toString(36).slice(2);function $p(f){if(!f[tv]){f[tv]=!0,r.forEach(function(b){b!=="selectionchange"&&(fZ.has(b)||pk(b,!1,f),pk(b,!0,f))});var p=f.nodeType===9?f:f.ownerDocument;p===null||p[tv]||(p[tv]=!0,pk("selectionchange",!1,p))}}function GP(f,p,b,I){switch(mP(p)){case 1:var C=CY;break;case 4:C=TY;break;default:C=YS}b=C.bind(null,p,b,f),C=void 0,!jS||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(C=!0),I?C!==void 0?f.addEventListener(p,b,{capture:!0,passive:C}):f.addEventListener(p,b,!0):C!==void 0?f.addEventListener(p,b,{passive:C}):f.addEventListener(p,b,!1)}function mk(f,p,b,I,C){var T=I;if((p&1)===0&&(p&2)===0&&I!==null)e:for(;;){if(I===null)return;var B=I.tag;if(B===3||B===4){var Q=I.stateNode.containerInfo;if(Q===C||Q.nodeType===8&&Q.parentNode===C)break;if(B===4)for(B=I.return;B!==null;){var ne=B.tag;if((ne===3||ne===4)&&(ne=B.stateNode.containerInfo,ne===C||ne.nodeType===8&&ne.parentNode===C))return;B=B.return}for(;Q!==null;){if(B=Ql(Q),B===null)return;if(ne=B.tag,ne===5||ne===6){I=T=B;continue e}Q=Q.parentNode}}I=I.return}YO(function(){var pe=T,ke=zS(b),Te=[];e:{var Se=VP.get(f);if(Se!==void 0){var Ue=ek,Qe=f;switch(f){case"keypress":if(Xy(b)===0)break e;case"keydown":case"keyup":Ue=VY;break;case"focusin":Qe="focus",Ue=rk;break;case"focusout":Qe="blur",Ue=rk;break;case"beforeblur":case"afterblur":Ue=rk;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=vP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=_Y;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=WY;break;case BP:case MP:case zP:Ue=OY;break;case UP:Ue=qY;break;case"scroll":Ue=AY;break;case"wheel":Ue=XY;break;case"copy":case"cut":case"paste":Ue=DY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=wP}var Je=(p&4)!==0,er=!Je&&f==="scroll",ue=Je?Se!==null?Se+"Capture":null:Se;Je=[];for(var ie=pe,he;ie!==null;){he=ie;var $e=he.stateNode;if(he.tag===5&&$e!==null&&(he=$e,ue!==null&&($e=hp(ie,ue),$e!=null&&Je.push(Rp(ie,$e,he)))),er)break;ie=ie.return}0<Je.length&&(Se=new Ue(Se,Qe,null,b,ke),Te.push({event:Se,listeners:Je}))}}if((p&7)===0){e:{if(Se=f==="mouseover"||f==="pointerover",Ue=f==="mouseout"||f==="pointerout",Se&&b!==Fd&&(Qe=b.relatedTarget||b.fromElement)&&(Ql(Qe)||Qe[Pa]))break e;if((Ue||Se)&&(Se=ke.window===ke?ke:(Se=ke.ownerDocument)?Se.defaultView||Se.parentWindow:window,Ue?(Qe=b.relatedTarget||b.toElement,Ue=pe,Qe=Qe?Ql(Qe):null,Qe!==null&&(er=Xl(Qe),Qe!==er||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):(Ue=null,Qe=pe),Ue!==Qe)){if(Je=vP,$e="onMouseLeave",ue="onMouseEnter",ie="mouse",(f==="pointerout"||f==="pointerover")&&(Je=wP,$e="onPointerLeave",ue="onPointerEnter",ie="pointer"),er=Ue==null?Se:Gd(Ue),he=Qe==null?Se:Gd(Qe),Se=new Je($e,ie+"leave",Ue,b,ke),Se.target=er,Se.relatedTarget=he,$e=null,Ql(ke)===pe&&(Je=new Je(ue,ie+"enter",Qe,b,ke),Je.target=he,Je.relatedTarget=er,$e=Je),er=$e,Ue&&Qe)t:{for(Je=Ue,ue=Qe,ie=0,he=Je;he;he=Hd(he))ie++;for(he=0,$e=ue;$e;$e=Hd($e))he++;for(;0<ie-he;)Je=Hd(Je),ie--;for(;0<he-ie;)ue=Hd(ue),he--;for(;ie--;){if(Je===ue||ue!==null&&Je===ue.alternate)break t;Je=Hd(Je),ue=Hd(ue)}Je=null}else Je=null;Ue!==null&&qP(Te,Se,Ue,Je,!1),Qe!==null&&er!==null&&qP(Te,er,Qe,Je,!0)}}e:{if(Se=pe?Gd(pe):window,Ue=Se.nodeName&&Se.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Se.type==="file")var et=nZ;else if(CP(Se))if(AP)et=oZ;else{et=sZ;var it=rZ}else(Ue=Se.nodeName)&&Ue.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(et=iZ);if(et&&(et=et(f,pe))){TP(Te,et,b,ke);break e}it&&it(f,Se,pe),f==="focusout"&&(it=Se._wrapperState)&&it.controlled&&Se.type==="number"&&ns(Se,"number",Se.value)}switch(it=pe?Gd(pe):window,f){case"focusin":(CP(it)||it.contentEditable==="true")&&(Vd=it,lk=pe,Np=null);break;case"focusout":Np=lk=Vd=null;break;case"mousedown":uk=!0;break;case"contextmenu":case"mouseup":case"dragend":uk=!1,FP(Te,b,ke);break;case"selectionchange":if(lZ)break;case"keydown":case"keyup":FP(Te,b,ke)}var ot;if(ik)e:{switch(f){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else Ud?kP(f,b)&&(gt="onCompositionEnd"):f==="keydown"&&b.keyCode===229&&(gt="onCompositionStart");gt&&(xP&&b.locale!=="ko"&&(Ud||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&Ud&&(ot=gP()):(Dc=ke,JS="value"in Dc?Dc.value:Dc.textContent,Ud=!0)),it=nv(pe,gt),0<it.length&&(gt=new bP(gt,f,null,b,ke),Te.push({event:gt,listeners:it}),ot?gt.data=ot:(ot=EP(b),ot!==null&&(gt.data=ot)))),(ot=YY?ZY(f,b):JY(f,b))&&(pe=nv(pe,"onBeforeInput"),0<pe.length&&(ke=new bP("onBeforeInput","beforeinput",null,b,ke),Te.push({event:ke,listeners:pe}),ke.data=ot))}WP(Te,p)})}function Rp(f,p,b){return{instance:f,listener:p,currentTarget:b}}function nv(f,p){for(var b=p+"Capture",I=[];f!==null;){var C=f,T=C.stateNode;C.tag===5&&T!==null&&(C=T,T=hp(f,b),T!=null&&I.unshift(Rp(f,T,C)),T=hp(f,p),T!=null&&I.push(Rp(f,T,C))),f=f.return}return I}function Hd(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function qP(f,p,b,I,C){for(var T=p._reactName,B=[];b!==null&&b!==I;){var Q=b,ne=Q.alternate,pe=Q.stateNode;if(ne!==null&&ne===I)break;Q.tag===5&&pe!==null&&(Q=pe,C?(ne=hp(b,T),ne!=null&&B.unshift(Rp(b,ne,Q))):C||(ne=hp(b,T),ne!=null&&B.push(Rp(b,ne,Q)))),b=b.return}B.length!==0&&f.push({event:p,listeners:B})}var hZ=/\r\n?/g,pZ=/\u0000|\uFFFD/g;function KP(f){return(typeof f=="string"?f:""+f).replace(hZ,`
`).replace(pZ,"")}function rv(f,p,b){if(p=KP(p),KP(f)!==p&&b)throw Error(n(425))}function sv(){}var gk=null,yk=null;function vk(f,p){return f==="textarea"||f==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var bk=typeof setTimeout=="function"?setTimeout:void 0,mZ=typeof clearTimeout=="function"?clearTimeout:void 0,XP=typeof Promise=="function"?Promise:void 0,gZ=typeof queueMicrotask=="function"?queueMicrotask:typeof XP<"u"?function(f){return XP.resolve(null).then(f).catch(yZ)}:bk;function yZ(f){setTimeout(function(){throw f})}function wk(f,p){var b=p,I=0;do{var C=b.nextSibling;if(f.removeChild(b),C&&C.nodeType===8)if(b=C.data,b==="/$"){if(I===0){f.removeChild(C),Ip(p);return}I--}else b!=="$"&&b!=="$?"&&b!=="$!"||I++;b=C}while(b);Ip(p)}function Lc(f){for(;f!=null;f=f.nextSibling){var p=f.nodeType;if(p===1||p===3)break;if(p===8){if(p=f.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return f}function QP(f){f=f.previousSibling;for(var p=0;f;){if(f.nodeType===8){var b=f.data;if(b==="$"||b==="$!"||b==="$?"){if(p===0)return f;p--}else b==="/$"&&p++}f=f.previousSibling}return null}var Wd=Math.random().toString(36).slice(2),Qo="__reactFiber$"+Wd,Op="__reactProps$"+Wd,Pa="__reactContainer$"+Wd,xk="__reactEvents$"+Wd,vZ="__reactListeners$"+Wd,bZ="__reactHandles$"+Wd;function Ql(f){var p=f[Qo];if(p)return p;for(var b=f.parentNode;b;){if(p=b[Pa]||b[Qo]){if(b=p.alternate,p.child!==null||b!==null&&b.child!==null)for(f=QP(f);f!==null;){if(b=f[Qo])return b;f=QP(f)}return p}f=b,b=f.parentNode}return null}function Pp(f){return f=f[Qo]||f[Pa],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Gd(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(n(33))}function iv(f){return f[Op]||null}var Ik=[],qd=-1;function Bc(f){return{current:f}}function bn(f){0>qd||(f.current=Ik[qd],Ik[qd]=null,qd--)}function hn(f,p){qd++,Ik[qd]=f.current,f.current=p}var Mc={},rs=Bc(Mc),Rs=Bc(!1),Yl=Mc;function Kd(f,p){var b=f.type.contextTypes;if(!b)return Mc;var I=f.stateNode;if(I&&I.__reactInternalMemoizedUnmaskedChildContext===p)return I.__reactInternalMemoizedMaskedChildContext;var C={},T;for(T in b)C[T]=p[T];return I&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=p,f.__reactInternalMemoizedMaskedChildContext=C),C}function Os(f){return f=f.childContextTypes,f!=null}function ov(){bn(Rs),bn(rs)}function YP(f,p,b){if(rs.current!==Mc)throw Error(n(168));hn(rs,p),hn(Rs,b)}function ZP(f,p,b){var I=f.stateNode;if(p=p.childContextTypes,typeof I.getChildContext!="function")return b;I=I.getChildContext();for(var C in I)if(!(C in p))throw Error(n(108,we(f)||"Unknown",C));return X({},b,I)}function av(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Mc,Yl=rs.current,hn(rs,f),hn(Rs,Rs.current),!0}function JP(f,p,b){var I=f.stateNode;if(!I)throw Error(n(169));b?(f=ZP(f,p,Yl),I.__reactInternalMemoizedMergedChildContext=f,bn(Rs),bn(rs),hn(rs,f)):bn(Rs),hn(Rs,b)}var Da=null,cv=!1,Sk=!1;function eD(f){Da===null?Da=[f]:Da.push(f)}function wZ(f){cv=!0,eD(f)}function zc(){if(!Sk&&Da!==null){Sk=!0;var f=0,p=tn;try{var b=Da;for(tn=1;f<b.length;f++){var I=b[f];do I=I(!0);while(I!==null)}Da=null,cv=!1}catch(C){throw Da!==null&&(Da=Da.slice(f+1)),nP(WS,zc),C}finally{tn=p,Sk=!1}}return null}var Xd=[],Qd=0,lv=null,uv=0,$i=[],Ri=0,Zl=null,Fa=1,La="";function Jl(f,p){Xd[Qd++]=uv,Xd[Qd++]=lv,lv=f,uv=p}function tD(f,p,b){$i[Ri++]=Fa,$i[Ri++]=La,$i[Ri++]=Zl,Zl=f;var I=Fa;f=La;var C=32-ho(I)-1;I&=~(1<<C),b+=1;var T=32-ho(p)+C;if(30<T){var B=C-C%5;T=(I&(1<<B)-1).toString(32),I>>=B,C-=B,Fa=1<<32-ho(p)+C|b<<C|I,La=T+f}else Fa=1<<T|b<<C|I,La=f}function kk(f){f.return!==null&&(Jl(f,1),tD(f,1,0))}function Ek(f){for(;f===lv;)lv=Xd[--Qd],Xd[Qd]=null,uv=Xd[--Qd],Xd[Qd]=null;for(;f===Zl;)Zl=$i[--Ri],$i[Ri]=null,La=$i[--Ri],$i[Ri]=null,Fa=$i[--Ri],$i[Ri]=null}var di=null,fi=null,Sn=!1,mo=null;function nD(f,p){var b=Fi(5,null,null,0);b.elementType="DELETED",b.stateNode=p,b.return=f,p=f.deletions,p===null?(f.deletions=[b],f.flags|=16):p.push(b)}function rD(f,p){switch(f.tag){case 5:var b=f.type;return p=p.nodeType!==1||b.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(f.stateNode=p,di=f,fi=Lc(p.firstChild),!0):!1;case 6:return p=f.pendingProps===""||p.nodeType!==3?null:p,p!==null?(f.stateNode=p,di=f,fi=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(b=Zl!==null?{id:Fa,overflow:La}:null,f.memoizedState={dehydrated:p,treeContext:b,retryLane:1073741824},b=Fi(18,null,null,0),b.stateNode=p,b.return=f,f.child=b,di=f,fi=null,!0):!1;default:return!1}}function Ck(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Tk(f){if(Sn){var p=fi;if(p){var b=p;if(!rD(f,p)){if(Ck(f))throw Error(n(418));p=Lc(b.nextSibling);var I=di;p&&rD(f,p)?nD(I,b):(f.flags=f.flags&-4097|2,Sn=!1,di=f)}}else{if(Ck(f))throw Error(n(418));f.flags=f.flags&-4097|2,Sn=!1,di=f}}}function sD(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;di=f}function dv(f){if(f!==di)return!1;if(!Sn)return sD(f),Sn=!0,!1;var p;if((p=f.tag!==3)&&!(p=f.tag!==5)&&(p=f.type,p=p!=="head"&&p!=="body"&&!vk(f.type,f.memoizedProps)),p&&(p=fi)){if(Ck(f))throw iD(),Error(n(418));for(;p;)nD(f,p),p=Lc(p.nextSibling)}if(sD(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(n(317));e:{for(f=f.nextSibling,p=0;f;){if(f.nodeType===8){var b=f.data;if(b==="/$"){if(p===0){fi=Lc(f.nextSibling);break e}p--}else b!=="$"&&b!=="$!"&&b!=="$?"||p++}f=f.nextSibling}fi=null}}else fi=di?Lc(f.stateNode.nextSibling):null;return!0}function iD(){for(var f=fi;f;)f=Lc(f.nextSibling)}function Yd(){fi=di=null,Sn=!1}function Ak(f){mo===null?mo=[f]:mo.push(f)}var xZ=k.ReactCurrentBatchConfig;function Dp(f,p,b){if(f=b.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(n(309));var I=b.stateNode}if(!I)throw Error(n(147,f));var C=I,T=""+f;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===T?p.ref:(p=function(B){var Q=C.refs;B===null?delete Q[T]:Q[T]=B},p._stringRef=T,p)}if(typeof f!="string")throw Error(n(284));if(!b._owner)throw Error(n(290,f))}return f}function fv(f,p){throw f=Object.prototype.toString.call(p),Error(n(31,f==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":f))}function oD(f){var p=f._init;return p(f._payload)}function aD(f){function p(ue,ie){if(f){var he=ue.deletions;he===null?(ue.deletions=[ie],ue.flags|=16):he.push(ie)}}function b(ue,ie){if(!f)return null;for(;ie!==null;)p(ue,ie),ie=ie.sibling;return null}function I(ue,ie){for(ue=new Map;ie!==null;)ie.key!==null?ue.set(ie.key,ie):ue.set(ie.index,ie),ie=ie.sibling;return ue}function C(ue,ie){return ue=Kc(ue,ie),ue.index=0,ue.sibling=null,ue}function T(ue,ie,he){return ue.index=he,f?(he=ue.alternate,he!==null?(he=he.index,he<ie?(ue.flags|=2,ie):he):(ue.flags|=2,ie)):(ue.flags|=1048576,ie)}function B(ue){return f&&ue.alternate===null&&(ue.flags|=2),ue}function Q(ue,ie,he,$e){return ie===null||ie.tag!==6?(ie=bE(he,ue.mode,$e),ie.return=ue,ie):(ie=C(ie,he),ie.return=ue,ie)}function ne(ue,ie,he,$e){var et=he.type;return et===R?ke(ue,ie,he.props.children,$e,he.key):ie!==null&&(ie.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===L&&oD(et)===ie.type)?($e=C(ie,he.props),$e.ref=Dp(ue,ie,he),$e.return=ue,$e):($e=Fv(he.type,he.key,he.props,null,ue.mode,$e),$e.ref=Dp(ue,ie,he),$e.return=ue,$e)}function pe(ue,ie,he,$e){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=wE(he,ue.mode,$e),ie.return=ue,ie):(ie=C(ie,he.children||[]),ie.return=ue,ie)}function ke(ue,ie,he,$e,et){return ie===null||ie.tag!==7?(ie=au(he,ue.mode,$e,et),ie.return=ue,ie):(ie=C(ie,he),ie.return=ue,ie)}function Te(ue,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=bE(""+ie,ue.mode,he),ie.return=ue,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case E:return he=Fv(ie.type,ie.key,ie.props,null,ue.mode,he),he.ref=Dp(ue,null,ie),he.return=ue,he;case A:return ie=wE(ie,ue.mode,he),ie.return=ue,ie;case L:var $e=ie._init;return Te(ue,$e(ie._payload),he)}if(Z(ie)||W(ie))return ie=au(ie,ue.mode,he,null),ie.return=ue,ie;fv(ue,ie)}return null}function Se(ue,ie,he,$e){var et=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return et!==null?null:Q(ue,ie,""+he,$e);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case E:return he.key===et?ne(ue,ie,he,$e):null;case A:return he.key===et?pe(ue,ie,he,$e):null;case L:return et=he._init,Se(ue,ie,et(he._payload),$e)}if(Z(he)||W(he))return et!==null?null:ke(ue,ie,he,$e,null);fv(ue,he)}return null}function Ue(ue,ie,he,$e,et){if(typeof $e=="string"&&$e!==""||typeof $e=="number")return ue=ue.get(he)||null,Q(ie,ue,""+$e,et);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case E:return ue=ue.get($e.key===null?he:$e.key)||null,ne(ie,ue,$e,et);case A:return ue=ue.get($e.key===null?he:$e.key)||null,pe(ie,ue,$e,et);case L:var it=$e._init;return Ue(ue,ie,he,it($e._payload),et)}if(Z($e)||W($e))return ue=ue.get(he)||null,ke(ie,ue,$e,et,null);fv(ie,$e)}return null}function Qe(ue,ie,he,$e){for(var et=null,it=null,ot=ie,gt=ie=0,_r=null;ot!==null&&gt<he.length;gt++){ot.index>gt?(_r=ot,ot=null):_r=ot.sibling;var qt=Se(ue,ot,he[gt],$e);if(qt===null){ot===null&&(ot=_r);break}f&&ot&&qt.alternate===null&&p(ue,ot),ie=T(qt,ie,gt),it===null?et=qt:it.sibling=qt,it=qt,ot=_r}if(gt===he.length)return b(ue,ot),Sn&&Jl(ue,gt),et;if(ot===null){for(;gt<he.length;gt++)ot=Te(ue,he[gt],$e),ot!==null&&(ie=T(ot,ie,gt),it===null?et=ot:it.sibling=ot,it=ot);return Sn&&Jl(ue,gt),et}for(ot=I(ue,ot);gt<he.length;gt++)_r=Ue(ot,ue,gt,he[gt],$e),_r!==null&&(f&&_r.alternate!==null&&ot.delete(_r.key===null?gt:_r.key),ie=T(_r,ie,gt),it===null?et=_r:it.sibling=_r,it=_r);return f&&ot.forEach(function(Xc){return p(ue,Xc)}),Sn&&Jl(ue,gt),et}function Je(ue,ie,he,$e){var et=W(he);if(typeof et!="function")throw Error(n(150));if(he=et.call(he),he==null)throw Error(n(151));for(var it=et=null,ot=ie,gt=ie=0,_r=null,qt=he.next();ot!==null&&!qt.done;gt++,qt=he.next()){ot.index>gt?(_r=ot,ot=null):_r=ot.sibling;var Xc=Se(ue,ot,qt.value,$e);if(Xc===null){ot===null&&(ot=_r);break}f&&ot&&Xc.alternate===null&&p(ue,ot),ie=T(Xc,ie,gt),it===null?et=Xc:it.sibling=Xc,it=Xc,ot=_r}if(qt.done)return b(ue,ot),Sn&&Jl(ue,gt),et;if(ot===null){for(;!qt.done;gt++,qt=he.next())qt=Te(ue,qt.value,$e),qt!==null&&(ie=T(qt,ie,gt),it===null?et=qt:it.sibling=qt,it=qt);return Sn&&Jl(ue,gt),et}for(ot=I(ue,ot);!qt.done;gt++,qt=he.next())qt=Ue(ot,ue,gt,qt.value,$e),qt!==null&&(f&&qt.alternate!==null&&ot.delete(qt.key===null?gt:qt.key),ie=T(qt,ie,gt),it===null?et=qt:it.sibling=qt,it=qt);return f&&ot.forEach(function(eJ){return p(ue,eJ)}),Sn&&Jl(ue,gt),et}function er(ue,ie,he,$e){if(typeof he=="object"&&he!==null&&he.type===R&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case E:e:{for(var et=he.key,it=ie;it!==null;){if(it.key===et){if(et=he.type,et===R){if(it.tag===7){b(ue,it.sibling),ie=C(it,he.props.children),ie.return=ue,ue=ie;break e}}else if(it.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===L&&oD(et)===it.type){b(ue,it.sibling),ie=C(it,he.props),ie.ref=Dp(ue,it,he),ie.return=ue,ue=ie;break e}b(ue,it);break}else p(ue,it);it=it.sibling}he.type===R?(ie=au(he.props.children,ue.mode,$e,he.key),ie.return=ue,ue=ie):($e=Fv(he.type,he.key,he.props,null,ue.mode,$e),$e.ref=Dp(ue,ie,he),$e.return=ue,ue=$e)}return B(ue);case A:e:{for(it=he.key;ie!==null;){if(ie.key===it)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){b(ue,ie.sibling),ie=C(ie,he.children||[]),ie.return=ue,ue=ie;break e}else{b(ue,ie);break}else p(ue,ie);ie=ie.sibling}ie=wE(he,ue.mode,$e),ie.return=ue,ue=ie}return B(ue);case L:return it=he._init,er(ue,ie,it(he._payload),$e)}if(Z(he))return Qe(ue,ie,he,$e);if(W(he))return Je(ue,ie,he,$e);fv(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ie!==null&&ie.tag===6?(b(ue,ie.sibling),ie=C(ie,he),ie.return=ue,ue=ie):(b(ue,ie),ie=bE(he,ue.mode,$e),ie.return=ue,ue=ie),B(ue)):b(ue,ie)}return er}var Zd=aD(!0),cD=aD(!1),hv=Bc(null),pv=null,Jd=null,Nk=null;function _k(){Nk=Jd=pv=null}function $k(f){var p=hv.current;bn(hv),f._currentValue=p}function Rk(f,p,b){for(;f!==null;){var I=f.alternate;if((f.childLanes&p)!==p?(f.childLanes|=p,I!==null&&(I.childLanes|=p)):I!==null&&(I.childLanes&p)!==p&&(I.childLanes|=p),f===b)break;f=f.return}}function ef(f,p){pv=f,Nk=Jd=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&p)!==0&&(Ps=!0),f.firstContext=null)}function Oi(f){var p=f._currentValue;if(Nk!==f)if(f={context:f,memoizedValue:p,next:null},Jd===null){if(pv===null)throw Error(n(308));Jd=f,pv.dependencies={lanes:0,firstContext:f}}else Jd=Jd.next=f;return p}var eu=null;function Ok(f){eu===null?eu=[f]:eu.push(f)}function lD(f,p,b,I){var C=p.interleaved;return C===null?(b.next=b,Ok(p)):(b.next=C.next,C.next=b),p.interleaved=b,Ba(f,I)}function Ba(f,p){f.lanes|=p;var b=f.alternate;for(b!==null&&(b.lanes|=p),b=f,f=f.return;f!==null;)f.childLanes|=p,b=f.alternate,b!==null&&(b.childLanes|=p),b=f,f=f.return;return b.tag===3?b.stateNode:null}var Uc=!1;function Pk(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uD(f,p){f=f.updateQueue,p.updateQueue===f&&(p.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Ma(f,p){return{eventTime:f,lane:p,tag:0,payload:null,callback:null,next:null}}function Vc(f,p,b){var I=f.updateQueue;if(I===null)return null;if(I=I.shared,(Wt&2)!==0){var C=I.pending;return C===null?p.next=p:(p.next=C.next,C.next=p),I.pending=p,Ba(f,b)}return C=I.interleaved,C===null?(p.next=p,Ok(I)):(p.next=C.next,C.next=p),I.interleaved=p,Ba(f,b)}function mv(f,p,b){if(p=p.updateQueue,p!==null&&(p=p.shared,(b&4194240)!==0)){var I=p.lanes;I&=f.pendingLanes,b|=I,p.lanes=b,KS(f,b)}}function dD(f,p){var b=f.updateQueue,I=f.alternate;if(I!==null&&(I=I.updateQueue,b===I)){var C=null,T=null;if(b=b.firstBaseUpdate,b!==null){do{var B={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};T===null?C=T=B:T=T.next=B,b=b.next}while(b!==null);T===null?C=T=p:T=T.next=p}else C=T=p;b={baseState:I.baseState,firstBaseUpdate:C,lastBaseUpdate:T,shared:I.shared,effects:I.effects},f.updateQueue=b;return}f=b.lastBaseUpdate,f===null?b.firstBaseUpdate=p:f.next=p,b.lastBaseUpdate=p}function gv(f,p,b,I){var C=f.updateQueue;Uc=!1;var T=C.firstBaseUpdate,B=C.lastBaseUpdate,Q=C.shared.pending;if(Q!==null){C.shared.pending=null;var ne=Q,pe=ne.next;ne.next=null,B===null?T=pe:B.next=pe,B=ne;var ke=f.alternate;ke!==null&&(ke=ke.updateQueue,Q=ke.lastBaseUpdate,Q!==B&&(Q===null?ke.firstBaseUpdate=pe:Q.next=pe,ke.lastBaseUpdate=ne))}if(T!==null){var Te=C.baseState;B=0,ke=pe=ne=null,Q=T;do{var Se=Q.lane,Ue=Q.eventTime;if((I&Se)===Se){ke!==null&&(ke=ke.next={eventTime:Ue,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var Qe=f,Je=Q;switch(Se=p,Ue=b,Je.tag){case 1:if(Qe=Je.payload,typeof Qe=="function"){Te=Qe.call(Ue,Te,Se);break e}Te=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Je.payload,Se=typeof Qe=="function"?Qe.call(Ue,Te,Se):Qe,Se==null)break e;Te=X({},Te,Se);break e;case 2:Uc=!0}}Q.callback!==null&&Q.lane!==0&&(f.flags|=64,Se=C.effects,Se===null?C.effects=[Q]:Se.push(Q))}else Ue={eventTime:Ue,lane:Se,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},ke===null?(pe=ke=Ue,ne=Te):ke=ke.next=Ue,B|=Se;if(Q=Q.next,Q===null){if(Q=C.shared.pending,Q===null)break;Se=Q,Q=Se.next,Se.next=null,C.lastBaseUpdate=Se,C.shared.pending=null}}while(!0);if(ke===null&&(ne=Te),C.baseState=ne,C.firstBaseUpdate=pe,C.lastBaseUpdate=ke,p=C.shared.interleaved,p!==null){C=p;do B|=C.lane,C=C.next;while(C!==p)}else T===null&&(C.shared.lanes=0);ru|=B,f.lanes=B,f.memoizedState=Te}}function fD(f,p,b){if(f=p.effects,p.effects=null,f!==null)for(p=0;p<f.length;p++){var I=f[p],C=I.callback;if(C!==null){if(I.callback=null,I=b,typeof C!="function")throw Error(n(191,C));C.call(I)}}}var Fp={},Yo=Bc(Fp),Lp=Bc(Fp),Bp=Bc(Fp);function tu(f){if(f===Fp)throw Error(n(174));return f}function Dk(f,p){switch(hn(Bp,p),hn(Lp,f),hn(Yo,Fp),f=p.nodeType,f){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:xt(null,"");break;default:f=f===8?p.parentNode:p,p=f.namespaceURI||null,f=f.tagName,p=xt(p,f)}bn(Yo),hn(Yo,p)}function tf(){bn(Yo),bn(Lp),bn(Bp)}function hD(f){tu(Bp.current);var p=tu(Yo.current),b=xt(p,f.type);p!==b&&(hn(Lp,f),hn(Yo,b))}function Fk(f){Lp.current===f&&(bn(Yo),bn(Lp))}var Dn=Bc(0);function yv(f){for(var p=f;p!==null;){if(p.tag===13){var b=p.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Lk=[];function Bk(){for(var f=0;f<Lk.length;f++)Lk[f]._workInProgressVersionPrimary=null;Lk.length=0}var vv=k.ReactCurrentDispatcher,Mk=k.ReactCurrentBatchConfig,nu=0,Fn=null,vr=null,Ar=null,bv=!1,Mp=!1,zp=0,IZ=0;function ss(){throw Error(n(321))}function zk(f,p){if(p===null)return!1;for(var b=0;b<p.length&&b<f.length;b++)if(!po(f[b],p[b]))return!1;return!0}function Uk(f,p,b,I,C,T){if(nu=T,Fn=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,vv.current=f===null||f.memoizedState===null?CZ:TZ,f=b(I,C),Mp){T=0;do{if(Mp=!1,zp=0,25<=T)throw Error(n(301));T+=1,Ar=vr=null,p.updateQueue=null,vv.current=AZ,f=b(I,C)}while(Mp)}if(vv.current=Iv,p=vr!==null&&vr.next!==null,nu=0,Ar=vr=Fn=null,bv=!1,p)throw Error(n(300));return f}function Vk(){var f=zp!==0;return zp=0,f}function Zo(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Fn.memoizedState=Ar=f:Ar=Ar.next=f,Ar}function Pi(){if(vr===null){var f=Fn.alternate;f=f!==null?f.memoizedState:null}else f=vr.next;var p=Ar===null?Fn.memoizedState:Ar.next;if(p!==null)Ar=p,vr=f;else{if(f===null)throw Error(n(310));vr=f,f={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},Ar===null?Fn.memoizedState=Ar=f:Ar=Ar.next=f}return Ar}function Up(f,p){return typeof p=="function"?p(f):p}function jk(f){var p=Pi(),b=p.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=f;var I=vr,C=I.baseQueue,T=b.pending;if(T!==null){if(C!==null){var B=C.next;C.next=T.next,T.next=B}I.baseQueue=C=T,b.pending=null}if(C!==null){T=C.next,I=I.baseState;var Q=B=null,ne=null,pe=T;do{var ke=pe.lane;if((nu&ke)===ke)ne!==null&&(ne=ne.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),I=pe.hasEagerState?pe.eagerState:f(I,pe.action);else{var Te={lane:ke,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};ne===null?(Q=ne=Te,B=I):ne=ne.next=Te,Fn.lanes|=ke,ru|=ke}pe=pe.next}while(pe!==null&&pe!==T);ne===null?B=I:ne.next=Q,po(I,p.memoizedState)||(Ps=!0),p.memoizedState=I,p.baseState=B,p.baseQueue=ne,b.lastRenderedState=I}if(f=b.interleaved,f!==null){C=f;do T=C.lane,Fn.lanes|=T,ru|=T,C=C.next;while(C!==f)}else C===null&&(b.lanes=0);return[p.memoizedState,b.dispatch]}function Hk(f){var p=Pi(),b=p.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=f;var I=b.dispatch,C=b.pending,T=p.memoizedState;if(C!==null){b.pending=null;var B=C=C.next;do T=f(T,B.action),B=B.next;while(B!==C);po(T,p.memoizedState)||(Ps=!0),p.memoizedState=T,p.baseQueue===null&&(p.baseState=T),b.lastRenderedState=T}return[T,I]}function pD(){}function mD(f,p){var b=Fn,I=Pi(),C=p(),T=!po(I.memoizedState,C);if(T&&(I.memoizedState=C,Ps=!0),I=I.queue,Wk(vD.bind(null,b,I,f),[f]),I.getSnapshot!==p||T||Ar!==null&&Ar.memoizedState.tag&1){if(b.flags|=2048,Vp(9,yD.bind(null,b,I,C,p),void 0,null),Nr===null)throw Error(n(349));(nu&30)!==0||gD(b,p,C)}return C}function gD(f,p,b){f.flags|=16384,f={getSnapshot:p,value:b},p=Fn.updateQueue,p===null?(p={lastEffect:null,stores:null},Fn.updateQueue=p,p.stores=[f]):(b=p.stores,b===null?p.stores=[f]:b.push(f))}function yD(f,p,b,I){p.value=b,p.getSnapshot=I,bD(p)&&wD(f)}function vD(f,p,b){return b(function(){bD(p)&&wD(f)})}function bD(f){var p=f.getSnapshot;f=f.value;try{var b=p();return!po(f,b)}catch{return!0}}function wD(f){var p=Ba(f,1);p!==null&&bo(p,f,1,-1)}function xD(f){var p=Zo();return typeof f=="function"&&(f=f()),p.memoizedState=p.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Up,lastRenderedState:f},p.queue=f,f=f.dispatch=EZ.bind(null,Fn,f),[p.memoizedState,f]}function Vp(f,p,b,I){return f={tag:f,create:p,destroy:b,deps:I,next:null},p=Fn.updateQueue,p===null?(p={lastEffect:null,stores:null},Fn.updateQueue=p,p.lastEffect=f.next=f):(b=p.lastEffect,b===null?p.lastEffect=f.next=f:(I=b.next,b.next=f,f.next=I,p.lastEffect=f)),f}function ID(){return Pi().memoizedState}function wv(f,p,b,I){var C=Zo();Fn.flags|=f,C.memoizedState=Vp(1|p,b,void 0,I===void 0?null:I)}function xv(f,p,b,I){var C=Pi();I=I===void 0?null:I;var T=void 0;if(vr!==null){var B=vr.memoizedState;if(T=B.destroy,I!==null&&zk(I,B.deps)){C.memoizedState=Vp(p,b,T,I);return}}Fn.flags|=f,C.memoizedState=Vp(1|p,b,T,I)}function SD(f,p){return wv(8390656,8,f,p)}function Wk(f,p){return xv(2048,8,f,p)}function kD(f,p){return xv(4,2,f,p)}function ED(f,p){return xv(4,4,f,p)}function CD(f,p){if(typeof p=="function")return f=f(),p(f),function(){p(null)};if(p!=null)return f=f(),p.current=f,function(){p.current=null}}function TD(f,p,b){return b=b!=null?b.concat([f]):null,xv(4,4,CD.bind(null,p,f),b)}function Gk(){}function AD(f,p){var b=Pi();p=p===void 0?null:p;var I=b.memoizedState;return I!==null&&p!==null&&zk(p,I[1])?I[0]:(b.memoizedState=[f,p],f)}function ND(f,p){var b=Pi();p=p===void 0?null:p;var I=b.memoizedState;return I!==null&&p!==null&&zk(p,I[1])?I[0]:(f=f(),b.memoizedState=[f,p],f)}function _D(f,p,b){return(nu&21)===0?(f.baseState&&(f.baseState=!1,Ps=!0),f.memoizedState=b):(po(b,p)||(b=oP(),Fn.lanes|=b,ru|=b,f.baseState=!0),p)}function SZ(f,p){var b=tn;tn=b!==0&&4>b?b:4,f(!0);var I=Mk.transition;Mk.transition={};try{f(!1),p()}finally{tn=b,Mk.transition=I}}function $D(){return Pi().memoizedState}function kZ(f,p,b){var I=Gc(f);if(b={lane:I,action:b,hasEagerState:!1,eagerState:null,next:null},RD(f))OD(p,b);else if(b=lD(f,p,b,I),b!==null){var C=bs();bo(b,f,I,C),PD(b,p,I)}}function EZ(f,p,b){var I=Gc(f),C={lane:I,action:b,hasEagerState:!1,eagerState:null,next:null};if(RD(f))OD(p,C);else{var T=f.alternate;if(f.lanes===0&&(T===null||T.lanes===0)&&(T=p.lastRenderedReducer,T!==null))try{var B=p.lastRenderedState,Q=T(B,b);if(C.hasEagerState=!0,C.eagerState=Q,po(Q,B)){var ne=p.interleaved;ne===null?(C.next=C,Ok(p)):(C.next=ne.next,ne.next=C),p.interleaved=C;return}}catch{}finally{}b=lD(f,p,C,I),b!==null&&(C=bs(),bo(b,f,I,C),PD(b,p,I))}}function RD(f){var p=f.alternate;return f===Fn||p!==null&&p===Fn}function OD(f,p){Mp=bv=!0;var b=f.pending;b===null?p.next=p:(p.next=b.next,b.next=p),f.pending=p}function PD(f,p,b){if((b&4194240)!==0){var I=p.lanes;I&=f.pendingLanes,b|=I,p.lanes=b,KS(f,b)}}var Iv={readContext:Oi,useCallback:ss,useContext:ss,useEffect:ss,useImperativeHandle:ss,useInsertionEffect:ss,useLayoutEffect:ss,useMemo:ss,useReducer:ss,useRef:ss,useState:ss,useDebugValue:ss,useDeferredValue:ss,useTransition:ss,useMutableSource:ss,useSyncExternalStore:ss,useId:ss,unstable_isNewReconciler:!1},CZ={readContext:Oi,useCallback:function(f,p){return Zo().memoizedState=[f,p===void 0?null:p],f},useContext:Oi,useEffect:SD,useImperativeHandle:function(f,p,b){return b=b!=null?b.concat([f]):null,wv(4194308,4,CD.bind(null,p,f),b)},useLayoutEffect:function(f,p){return wv(4194308,4,f,p)},useInsertionEffect:function(f,p){return wv(4,2,f,p)},useMemo:function(f,p){var b=Zo();return p=p===void 0?null:p,f=f(),b.memoizedState=[f,p],f},useReducer:function(f,p,b){var I=Zo();return p=b!==void 0?b(p):p,I.memoizedState=I.baseState=p,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:p},I.queue=f,f=f.dispatch=kZ.bind(null,Fn,f),[I.memoizedState,f]},useRef:function(f){var p=Zo();return f={current:f},p.memoizedState=f},useState:xD,useDebugValue:Gk,useDeferredValue:function(f){return Zo().memoizedState=f},useTransition:function(){var f=xD(!1),p=f[0];return f=SZ.bind(null,f[1]),Zo().memoizedState=f,[p,f]},useMutableSource:function(){},useSyncExternalStore:function(f,p,b){var I=Fn,C=Zo();if(Sn){if(b===void 0)throw Error(n(407));b=b()}else{if(b=p(),Nr===null)throw Error(n(349));(nu&30)!==0||gD(I,p,b)}C.memoizedState=b;var T={value:b,getSnapshot:p};return C.queue=T,SD(vD.bind(null,I,T,f),[f]),I.flags|=2048,Vp(9,yD.bind(null,I,T,b,p),void 0,null),b},useId:function(){var f=Zo(),p=Nr.identifierPrefix;if(Sn){var b=La,I=Fa;b=(I&~(1<<32-ho(I)-1)).toString(32)+b,p=":"+p+"R"+b,b=zp++,0<b&&(p+="H"+b.toString(32)),p+=":"}else b=IZ++,p=":"+p+"r"+b.toString(32)+":";return f.memoizedState=p},unstable_isNewReconciler:!1},TZ={readContext:Oi,useCallback:AD,useContext:Oi,useEffect:Wk,useImperativeHandle:TD,useInsertionEffect:kD,useLayoutEffect:ED,useMemo:ND,useReducer:jk,useRef:ID,useState:function(){return jk(Up)},useDebugValue:Gk,useDeferredValue:function(f){var p=Pi();return _D(p,vr.memoizedState,f)},useTransition:function(){var f=jk(Up)[0],p=Pi().memoizedState;return[f,p]},useMutableSource:pD,useSyncExternalStore:mD,useId:$D,unstable_isNewReconciler:!1},AZ={readContext:Oi,useCallback:AD,useContext:Oi,useEffect:Wk,useImperativeHandle:TD,useInsertionEffect:kD,useLayoutEffect:ED,useMemo:ND,useReducer:Hk,useRef:ID,useState:function(){return Hk(Up)},useDebugValue:Gk,useDeferredValue:function(f){var p=Pi();return vr===null?p.memoizedState=f:_D(p,vr.memoizedState,f)},useTransition:function(){var f=Hk(Up)[0],p=Pi().memoizedState;return[f,p]},useMutableSource:pD,useSyncExternalStore:mD,useId:$D,unstable_isNewReconciler:!1};function go(f,p){if(f&&f.defaultProps){p=X({},p),f=f.defaultProps;for(var b in f)p[b]===void 0&&(p[b]=f[b]);return p}return p}function qk(f,p,b,I){p=f.memoizedState,b=b(I,p),b=b==null?p:X({},p,b),f.memoizedState=b,f.lanes===0&&(f.updateQueue.baseState=b)}var Sv={isMounted:function(f){return(f=f._reactInternals)?Xl(f)===f:!1},enqueueSetState:function(f,p,b){f=f._reactInternals;var I=bs(),C=Gc(f),T=Ma(I,C);T.payload=p,b!=null&&(T.callback=b),p=Vc(f,T,C),p!==null&&(bo(p,f,C,I),mv(p,f,C))},enqueueReplaceState:function(f,p,b){f=f._reactInternals;var I=bs(),C=Gc(f),T=Ma(I,C);T.tag=1,T.payload=p,b!=null&&(T.callback=b),p=Vc(f,T,C),p!==null&&(bo(p,f,C,I),mv(p,f,C))},enqueueForceUpdate:function(f,p){f=f._reactInternals;var b=bs(),I=Gc(f),C=Ma(b,I);C.tag=2,p!=null&&(C.callback=p),p=Vc(f,C,I),p!==null&&(bo(p,f,I,b),mv(p,f,I))}};function DD(f,p,b,I,C,T,B){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(I,T,B):p.prototype&&p.prototype.isPureReactComponent?!Ap(b,I)||!Ap(C,T):!0}function FD(f,p,b){var I=!1,C=Mc,T=p.contextType;return typeof T=="object"&&T!==null?T=Oi(T):(C=Os(p)?Yl:rs.current,I=p.contextTypes,T=(I=I!=null)?Kd(f,C):Mc),p=new p(b,T),f.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Sv,f.stateNode=p,p._reactInternals=f,I&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=C,f.__reactInternalMemoizedMaskedChildContext=T),p}function LD(f,p,b,I){f=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(b,I),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(b,I),p.state!==f&&Sv.enqueueReplaceState(p,p.state,null)}function Kk(f,p,b,I){var C=f.stateNode;C.props=b,C.state=f.memoizedState,C.refs={},Pk(f);var T=p.contextType;typeof T=="object"&&T!==null?C.context=Oi(T):(T=Os(p)?Yl:rs.current,C.context=Kd(f,T)),C.state=f.memoizedState,T=p.getDerivedStateFromProps,typeof T=="function"&&(qk(f,p,T,b),C.state=f.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(p=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),p!==C.state&&Sv.enqueueReplaceState(C,C.state,null),gv(f,b,C,I),C.state=f.memoizedState),typeof C.componentDidMount=="function"&&(f.flags|=4194308)}function nf(f,p){try{var b="",I=p;do b+=ge(I),I=I.return;while(I);var C=b}catch(T){C=`
Error generating stack: `+T.message+`
`+T.stack}return{value:f,source:p,stack:C,digest:null}}function Xk(f,p,b){return{value:f,source:null,stack:b??null,digest:p??null}}function Qk(f,p){try{console.error(p.value)}catch(b){setTimeout(function(){throw b})}}var NZ=typeof WeakMap=="function"?WeakMap:Map;function BD(f,p,b){b=Ma(-1,b),b.tag=3,b.payload={element:null};var I=p.value;return b.callback=function(){_v||(_v=!0,dE=I),Qk(f,p)},b}function MD(f,p,b){b=Ma(-1,b),b.tag=3;var I=f.type.getDerivedStateFromError;if(typeof I=="function"){var C=p.value;b.payload=function(){return I(C)},b.callback=function(){Qk(f,p)}}var T=f.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(b.callback=function(){Qk(f,p),typeof I!="function"&&(Hc===null?Hc=new Set([this]):Hc.add(this));var B=p.stack;this.componentDidCatch(p.value,{componentStack:B!==null?B:""})}),b}function zD(f,p,b){var I=f.pingCache;if(I===null){I=f.pingCache=new NZ;var C=new Set;I.set(p,C)}else C=I.get(p),C===void 0&&(C=new Set,I.set(p,C));C.has(b)||(C.add(b),f=jZ.bind(null,f,p,b),p.then(f,f))}function UD(f){do{var p;if((p=f.tag===13)&&(p=f.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return f;f=f.return}while(f!==null);return null}function VD(f,p,b,I,C){return(f.mode&1)===0?(f===p?f.flags|=65536:(f.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(p=Ma(-1,1),p.tag=2,Vc(b,p,1))),b.lanes|=1),f):(f.flags|=65536,f.lanes=C,f)}var _Z=k.ReactCurrentOwner,Ps=!1;function vs(f,p,b,I){p.child=f===null?cD(p,null,b,I):Zd(p,f.child,b,I)}function jD(f,p,b,I,C){b=b.render;var T=p.ref;return ef(p,C),I=Uk(f,p,b,I,T,C),b=Vk(),f!==null&&!Ps?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~C,za(f,p,C)):(Sn&&b&&kk(p),p.flags|=1,vs(f,p,I,C),p.child)}function HD(f,p,b,I,C){if(f===null){var T=b.type;return typeof T=="function"&&!vE(T)&&T.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(p.tag=15,p.type=T,WD(f,p,T,I,C)):(f=Fv(b.type,null,I,p,p.mode,C),f.ref=p.ref,f.return=p,p.child=f)}if(T=f.child,(f.lanes&C)===0){var B=T.memoizedProps;if(b=b.compare,b=b!==null?b:Ap,b(B,I)&&f.ref===p.ref)return za(f,p,C)}return p.flags|=1,f=Kc(T,I),f.ref=p.ref,f.return=p,p.child=f}function WD(f,p,b,I,C){if(f!==null){var T=f.memoizedProps;if(Ap(T,I)&&f.ref===p.ref)if(Ps=!1,p.pendingProps=I=T,(f.lanes&C)!==0)(f.flags&131072)!==0&&(Ps=!0);else return p.lanes=f.lanes,za(f,p,C)}return Yk(f,p,b,I,C)}function GD(f,p,b){var I=p.pendingProps,C=I.children,T=f!==null?f.memoizedState:null;if(I.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},hn(sf,hi),hi|=b;else{if((b&1073741824)===0)return f=T!==null?T.baseLanes|b:b,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:f,cachePool:null,transitions:null},p.updateQueue=null,hn(sf,hi),hi|=f,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},I=T!==null?T.baseLanes:b,hn(sf,hi),hi|=I}else T!==null?(I=T.baseLanes|b,p.memoizedState=null):I=b,hn(sf,hi),hi|=I;return vs(f,p,C,b),p.child}function qD(f,p){var b=p.ref;(f===null&&b!==null||f!==null&&f.ref!==b)&&(p.flags|=512,p.flags|=2097152)}function Yk(f,p,b,I,C){var T=Os(b)?Yl:rs.current;return T=Kd(p,T),ef(p,C),b=Uk(f,p,b,I,T,C),I=Vk(),f!==null&&!Ps?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~C,za(f,p,C)):(Sn&&I&&kk(p),p.flags|=1,vs(f,p,b,C),p.child)}function KD(f,p,b,I,C){if(Os(b)){var T=!0;av(p)}else T=!1;if(ef(p,C),p.stateNode===null)Ev(f,p),FD(p,b,I),Kk(p,b,I,C),I=!0;else if(f===null){var B=p.stateNode,Q=p.memoizedProps;B.props=Q;var ne=B.context,pe=b.contextType;typeof pe=="object"&&pe!==null?pe=Oi(pe):(pe=Os(b)?Yl:rs.current,pe=Kd(p,pe));var ke=b.getDerivedStateFromProps,Te=typeof ke=="function"||typeof B.getSnapshotBeforeUpdate=="function";Te||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Q!==I||ne!==pe)&&LD(p,B,I,pe),Uc=!1;var Se=p.memoizedState;B.state=Se,gv(p,I,B,C),ne=p.memoizedState,Q!==I||Se!==ne||Rs.current||Uc?(typeof ke=="function"&&(qk(p,b,ke,I),ne=p.memoizedState),(Q=Uc||DD(p,b,Q,I,Se,ne,pe))?(Te||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(p.flags|=4194308)):(typeof B.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=I,p.memoizedState=ne),B.props=I,B.state=ne,B.context=pe,I=Q):(typeof B.componentDidMount=="function"&&(p.flags|=4194308),I=!1)}else{B=p.stateNode,uD(f,p),Q=p.memoizedProps,pe=p.type===p.elementType?Q:go(p.type,Q),B.props=pe,Te=p.pendingProps,Se=B.context,ne=b.contextType,typeof ne=="object"&&ne!==null?ne=Oi(ne):(ne=Os(b)?Yl:rs.current,ne=Kd(p,ne));var Ue=b.getDerivedStateFromProps;(ke=typeof Ue=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(Q!==Te||Se!==ne)&&LD(p,B,I,ne),Uc=!1,Se=p.memoizedState,B.state=Se,gv(p,I,B,C);var Qe=p.memoizedState;Q!==Te||Se!==Qe||Rs.current||Uc?(typeof Ue=="function"&&(qk(p,b,Ue,I),Qe=p.memoizedState),(pe=Uc||DD(p,b,pe,I,Se,Qe,ne)||!1)?(ke||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(I,Qe,ne),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(I,Qe,ne)),typeof B.componentDidUpdate=="function"&&(p.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof B.componentDidUpdate!="function"||Q===f.memoizedProps&&Se===f.memoizedState||(p.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===f.memoizedProps&&Se===f.memoizedState||(p.flags|=1024),p.memoizedProps=I,p.memoizedState=Qe),B.props=I,B.state=Qe,B.context=ne,I=pe):(typeof B.componentDidUpdate!="function"||Q===f.memoizedProps&&Se===f.memoizedState||(p.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||Q===f.memoizedProps&&Se===f.memoizedState||(p.flags|=1024),I=!1)}return Zk(f,p,b,I,T,C)}function Zk(f,p,b,I,C,T){qD(f,p);var B=(p.flags&128)!==0;if(!I&&!B)return C&&JP(p,b,!1),za(f,p,T);I=p.stateNode,_Z.current=p;var Q=B&&typeof b.getDerivedStateFromError!="function"?null:I.render();return p.flags|=1,f!==null&&B?(p.child=Zd(p,f.child,null,T),p.child=Zd(p,null,Q,T)):vs(f,p,Q,T),p.memoizedState=I.state,C&&JP(p,b,!0),p.child}function XD(f){var p=f.stateNode;p.pendingContext?YP(f,p.pendingContext,p.pendingContext!==p.context):p.context&&YP(f,p.context,!1),Dk(f,p.containerInfo)}function QD(f,p,b,I,C){return Yd(),Ak(C),p.flags|=256,vs(f,p,b,I),p.child}var Jk={dehydrated:null,treeContext:null,retryLane:0};function eE(f){return{baseLanes:f,cachePool:null,transitions:null}}function YD(f,p,b){var I=p.pendingProps,C=Dn.current,T=!1,B=(p.flags&128)!==0,Q;if((Q=B)||(Q=f!==null&&f.memoizedState===null?!1:(C&2)!==0),Q?(T=!0,p.flags&=-129):(f===null||f.memoizedState!==null)&&(C|=1),hn(Dn,C&1),f===null)return Tk(p),f=p.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((p.mode&1)===0?p.lanes=1:f.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(B=I.children,f=I.fallback,T?(I=p.mode,T=p.child,B={mode:"hidden",children:B},(I&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=B):T=Lv(B,I,0,null),f=au(f,I,b,null),T.return=p,f.return=p,T.sibling=f,p.child=T,p.child.memoizedState=eE(b),p.memoizedState=Jk,f):tE(p,B));if(C=f.memoizedState,C!==null&&(Q=C.dehydrated,Q!==null))return $Z(f,p,B,I,Q,C,b);if(T){T=I.fallback,B=p.mode,C=f.child,Q=C.sibling;var ne={mode:"hidden",children:I.children};return(B&1)===0&&p.child!==C?(I=p.child,I.childLanes=0,I.pendingProps=ne,p.deletions=null):(I=Kc(C,ne),I.subtreeFlags=C.subtreeFlags&14680064),Q!==null?T=Kc(Q,T):(T=au(T,B,b,null),T.flags|=2),T.return=p,I.return=p,I.sibling=T,p.child=I,I=T,T=p.child,B=f.child.memoizedState,B=B===null?eE(b):{baseLanes:B.baseLanes|b,cachePool:null,transitions:B.transitions},T.memoizedState=B,T.childLanes=f.childLanes&~b,p.memoizedState=Jk,I}return T=f.child,f=T.sibling,I=Kc(T,{mode:"visible",children:I.children}),(p.mode&1)===0&&(I.lanes=b),I.return=p,I.sibling=null,f!==null&&(b=p.deletions,b===null?(p.deletions=[f],p.flags|=16):b.push(f)),p.child=I,p.memoizedState=null,I}function tE(f,p){return p=Lv({mode:"visible",children:p},f.mode,0,null),p.return=f,f.child=p}function kv(f,p,b,I){return I!==null&&Ak(I),Zd(p,f.child,null,b),f=tE(p,p.pendingProps.children),f.flags|=2,p.memoizedState=null,f}function $Z(f,p,b,I,C,T,B){if(b)return p.flags&256?(p.flags&=-257,I=Xk(Error(n(422))),kv(f,p,B,I)):p.memoizedState!==null?(p.child=f.child,p.flags|=128,null):(T=I.fallback,C=p.mode,I=Lv({mode:"visible",children:I.children},C,0,null),T=au(T,C,B,null),T.flags|=2,I.return=p,T.return=p,I.sibling=T,p.child=I,(p.mode&1)!==0&&Zd(p,f.child,null,B),p.child.memoizedState=eE(B),p.memoizedState=Jk,T);if((p.mode&1)===0)return kv(f,p,B,null);if(C.data==="$!"){if(I=C.nextSibling&&C.nextSibling.dataset,I)var Q=I.dgst;return I=Q,T=Error(n(419)),I=Xk(T,I,void 0),kv(f,p,B,I)}if(Q=(B&f.childLanes)!==0,Ps||Q){if(I=Nr,I!==null){switch(B&-B){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=(C&(I.suspendedLanes|B))!==0?0:C,C!==0&&C!==T.retryLane&&(T.retryLane=C,Ba(f,C),bo(I,f,C,-1))}return yE(),I=Xk(Error(n(421))),kv(f,p,B,I)}return C.data==="$?"?(p.flags|=128,p.child=f.child,p=HZ.bind(null,f),C._reactRetry=p,null):(f=T.treeContext,fi=Lc(C.nextSibling),di=p,Sn=!0,mo=null,f!==null&&($i[Ri++]=Fa,$i[Ri++]=La,$i[Ri++]=Zl,Fa=f.id,La=f.overflow,Zl=p),p=tE(p,I.children),p.flags|=4096,p)}function ZD(f,p,b){f.lanes|=p;var I=f.alternate;I!==null&&(I.lanes|=p),Rk(f.return,p,b)}function nE(f,p,b,I,C){var T=f.memoizedState;T===null?f.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:I,tail:b,tailMode:C}:(T.isBackwards=p,T.rendering=null,T.renderingStartTime=0,T.last=I,T.tail=b,T.tailMode=C)}function JD(f,p,b){var I=p.pendingProps,C=I.revealOrder,T=I.tail;if(vs(f,p,I.children,b),I=Dn.current,(I&2)!==0)I=I&1|2,p.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=p.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&ZD(f,b,p);else if(f.tag===19)ZD(f,b,p);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===p)break e;for(;f.sibling===null;){if(f.return===null||f.return===p)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}I&=1}if(hn(Dn,I),(p.mode&1)===0)p.memoizedState=null;else switch(C){case"forwards":for(b=p.child,C=null;b!==null;)f=b.alternate,f!==null&&yv(f)===null&&(C=b),b=b.sibling;b=C,b===null?(C=p.child,p.child=null):(C=b.sibling,b.sibling=null),nE(p,!1,C,b,T);break;case"backwards":for(b=null,C=p.child,p.child=null;C!==null;){if(f=C.alternate,f!==null&&yv(f)===null){p.child=C;break}f=C.sibling,C.sibling=b,b=C,C=f}nE(p,!0,b,null,T);break;case"together":nE(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function Ev(f,p){(p.mode&1)===0&&f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2)}function za(f,p,b){if(f!==null&&(p.dependencies=f.dependencies),ru|=p.lanes,(b&p.childLanes)===0)return null;if(f!==null&&p.child!==f.child)throw Error(n(153));if(p.child!==null){for(f=p.child,b=Kc(f,f.pendingProps),p.child=b,b.return=p;f.sibling!==null;)f=f.sibling,b=b.sibling=Kc(f,f.pendingProps),b.return=p;b.sibling=null}return p.child}function RZ(f,p,b){switch(p.tag){case 3:XD(p),Yd();break;case 5:hD(p);break;case 1:Os(p.type)&&av(p);break;case 4:Dk(p,p.stateNode.containerInfo);break;case 10:var I=p.type._context,C=p.memoizedProps.value;hn(hv,I._currentValue),I._currentValue=C;break;case 13:if(I=p.memoizedState,I!==null)return I.dehydrated!==null?(hn(Dn,Dn.current&1),p.flags|=128,null):(b&p.child.childLanes)!==0?YD(f,p,b):(hn(Dn,Dn.current&1),f=za(f,p,b),f!==null?f.sibling:null);hn(Dn,Dn.current&1);break;case 19:if(I=(b&p.childLanes)!==0,(f.flags&128)!==0){if(I)return JD(f,p,b);p.flags|=128}if(C=p.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),hn(Dn,Dn.current),I)break;return null;case 22:case 23:return p.lanes=0,GD(f,p,b)}return za(f,p,b)}var eF,rE,tF,nF;eF=function(f,p){for(var b=p.child;b!==null;){if(b.tag===5||b.tag===6)f.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},rE=function(){},tF=function(f,p,b,I){var C=f.memoizedProps;if(C!==I){f=p.stateNode,tu(Yo.current);var T=null;switch(b){case"input":C=Mt(f,C),I=Mt(f,I),T=[];break;case"select":C=X({},C,{value:void 0}),I=X({},I,{value:void 0}),T=[];break;case"textarea":C=ye(f,C),I=ye(f,I),T=[];break;default:typeof C.onClick!="function"&&typeof I.onClick=="function"&&(f.onclick=sv)}Dd(b,I);var B;b=null;for(pe in C)if(!I.hasOwnProperty(pe)&&C.hasOwnProperty(pe)&&C[pe]!=null)if(pe==="style"){var Q=C[pe];for(B in Q)Q.hasOwnProperty(B)&&(b||(b={}),b[B]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(s.hasOwnProperty(pe)?T||(T=[]):(T=T||[]).push(pe,null));for(pe in I){var ne=I[pe];if(Q=C?.[pe],I.hasOwnProperty(pe)&&ne!==Q&&(ne!=null||Q!=null))if(pe==="style")if(Q){for(B in Q)!Q.hasOwnProperty(B)||ne&&ne.hasOwnProperty(B)||(b||(b={}),b[B]="");for(B in ne)ne.hasOwnProperty(B)&&Q[B]!==ne[B]&&(b||(b={}),b[B]=ne[B])}else b||(T||(T=[]),T.push(pe,b)),b=ne;else pe==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Q=Q?Q.__html:void 0,ne!=null&&Q!==ne&&(T=T||[]).push(pe,ne)):pe==="children"?typeof ne!="string"&&typeof ne!="number"||(T=T||[]).push(pe,""+ne):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(s.hasOwnProperty(pe)?(ne!=null&&pe==="onScroll"&&vn("scroll",f),T||Q===ne||(T=[])):(T=T||[]).push(pe,ne))}b&&(T=T||[]).push("style",b);var pe=T;(p.updateQueue=pe)&&(p.flags|=4)}},nF=function(f,p,b,I){b!==I&&(p.flags|=4)};function jp(f,p){if(!Sn)switch(f.tailMode){case"hidden":p=f.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?f.tail=null:b.sibling=null;break;case"collapsed":b=f.tail;for(var I=null;b!==null;)b.alternate!==null&&(I=b),b=b.sibling;I===null?p||f.tail===null?f.tail=null:f.tail.sibling=null:I.sibling=null}}function is(f){var p=f.alternate!==null&&f.alternate.child===f.child,b=0,I=0;if(p)for(var C=f.child;C!==null;)b|=C.lanes|C.childLanes,I|=C.subtreeFlags&14680064,I|=C.flags&14680064,C.return=f,C=C.sibling;else for(C=f.child;C!==null;)b|=C.lanes|C.childLanes,I|=C.subtreeFlags,I|=C.flags,C.return=f,C=C.sibling;return f.subtreeFlags|=I,f.childLanes=b,p}function OZ(f,p,b){var I=p.pendingProps;switch(Ek(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return is(p),null;case 1:return Os(p.type)&&ov(),is(p),null;case 3:return I=p.stateNode,tf(),bn(Rs),bn(rs),Bk(),I.pendingContext&&(I.context=I.pendingContext,I.pendingContext=null),(f===null||f.child===null)&&(dv(p)?p.flags|=4:f===null||f.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,mo!==null&&(pE(mo),mo=null))),rE(f,p),is(p),null;case 5:Fk(p);var C=tu(Bp.current);if(b=p.type,f!==null&&p.stateNode!=null)tF(f,p,b,I,C),f.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!I){if(p.stateNode===null)throw Error(n(166));return is(p),null}if(f=tu(Yo.current),dv(p)){I=p.stateNode,b=p.type;var T=p.memoizedProps;switch(I[Qo]=p,I[Op]=T,f=(p.mode&1)!==0,b){case"dialog":vn("cancel",I),vn("close",I);break;case"iframe":case"object":case"embed":vn("load",I);break;case"video":case"audio":for(C=0;C<_p.length;C++)vn(_p[C],I);break;case"source":vn("error",I);break;case"img":case"image":case"link":vn("error",I),vn("load",I);break;case"details":vn("toggle",I);break;case"input":Ft(I,T),vn("invalid",I);break;case"select":I._wrapperState={wasMultiple:!!T.multiple},vn("invalid",I);break;case"textarea":De(I,T),vn("invalid",I)}Dd(b,T),C=null;for(var B in T)if(T.hasOwnProperty(B)){var Q=T[B];B==="children"?typeof Q=="string"?I.textContent!==Q&&(T.suppressHydrationWarning!==!0&&rv(I.textContent,Q,f),C=["children",Q]):typeof Q=="number"&&I.textContent!==""+Q&&(T.suppressHydrationWarning!==!0&&rv(I.textContent,Q,f),C=["children",""+Q]):s.hasOwnProperty(B)&&Q!=null&&B==="onScroll"&&vn("scroll",I)}switch(b){case"input":st(I),en(I,T,!0);break;case"textarea":st(I),Ee(I);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(I.onclick=sv)}I=C,p.updateQueue=I,I!==null&&(p.flags|=4)}else{B=C.nodeType===9?C:C.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Ge(b)),f==="http://www.w3.org/1999/xhtml"?b==="script"?(f=B.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof I.is=="string"?f=B.createElement(b,{is:I.is}):(f=B.createElement(b),b==="select"&&(B=f,I.multiple?B.multiple=!0:I.size&&(B.size=I.size))):f=B.createElementNS(f,b),f[Qo]=p,f[Op]=I,eF(f,p,!1,!1),p.stateNode=f;e:{switch(B=fp(b,I),b){case"dialog":vn("cancel",f),vn("close",f),C=I;break;case"iframe":case"object":case"embed":vn("load",f),C=I;break;case"video":case"audio":for(C=0;C<_p.length;C++)vn(_p[C],f);C=I;break;case"source":vn("error",f),C=I;break;case"img":case"image":case"link":vn("error",f),vn("load",f),C=I;break;case"details":vn("toggle",f),C=I;break;case"input":Ft(f,I),C=Mt(f,I),vn("invalid",f);break;case"option":C=I;break;case"select":f._wrapperState={wasMultiple:!!I.multiple},C=X({},I,{value:void 0}),vn("invalid",f);break;case"textarea":De(f,I),C=ye(f,I),vn("invalid",f);break;default:C=I}Dd(b,C),Q=C;for(T in Q)if(Q.hasOwnProperty(T)){var ne=Q[T];T==="style"?_c(f,ne):T==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&Zn(f,ne)):T==="children"?typeof ne=="string"?(b!=="textarea"||ne!=="")&&$s(f,ne):typeof ne=="number"&&$s(f,""+ne):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(s.hasOwnProperty(T)?ne!=null&&T==="onScroll"&&vn("scroll",f):ne!=null&&S(f,T,ne,B))}switch(b){case"input":st(f),en(f,I,!1);break;case"textarea":st(f),Ee(f);break;case"option":I.value!=null&&f.setAttribute("value",""+Ae(I.value));break;case"select":f.multiple=!!I.multiple,T=I.value,T!=null?le(f,!!I.multiple,T,!1):I.defaultValue!=null&&le(f,!!I.multiple,I.defaultValue,!0);break;default:typeof C.onClick=="function"&&(f.onclick=sv)}switch(b){case"button":case"input":case"select":case"textarea":I=!!I.autoFocus;break e;case"img":I=!0;break e;default:I=!1}}I&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return is(p),null;case 6:if(f&&p.stateNode!=null)nF(f,p,f.memoizedProps,I);else{if(typeof I!="string"&&p.stateNode===null)throw Error(n(166));if(b=tu(Bp.current),tu(Yo.current),dv(p)){if(I=p.stateNode,b=p.memoizedProps,I[Qo]=p,(T=I.nodeValue!==b)&&(f=di,f!==null))switch(f.tag){case 3:rv(I.nodeValue,b,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&rv(I.nodeValue,b,(f.mode&1)!==0)}T&&(p.flags|=4)}else I=(b.nodeType===9?b:b.ownerDocument).createTextNode(I),I[Qo]=p,p.stateNode=I}return is(p),null;case 13:if(bn(Dn),I=p.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Sn&&fi!==null&&(p.mode&1)!==0&&(p.flags&128)===0)iD(),Yd(),p.flags|=98560,T=!1;else if(T=dv(p),I!==null&&I.dehydrated!==null){if(f===null){if(!T)throw Error(n(318));if(T=p.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(n(317));T[Qo]=p}else Yd(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;is(p),T=!1}else mo!==null&&(pE(mo),mo=null),T=!0;if(!T)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=b,p):(I=I!==null,I!==(f!==null&&f.memoizedState!==null)&&I&&(p.child.flags|=8192,(p.mode&1)!==0&&(f===null||(Dn.current&1)!==0?br===0&&(br=3):yE())),p.updateQueue!==null&&(p.flags|=4),is(p),null);case 4:return tf(),rE(f,p),f===null&&$p(p.stateNode.containerInfo),is(p),null;case 10:return $k(p.type._context),is(p),null;case 17:return Os(p.type)&&ov(),is(p),null;case 19:if(bn(Dn),T=p.memoizedState,T===null)return is(p),null;if(I=(p.flags&128)!==0,B=T.rendering,B===null)if(I)jp(T,!1);else{if(br!==0||f!==null&&(f.flags&128)!==0)for(f=p.child;f!==null;){if(B=yv(f),B!==null){for(p.flags|=128,jp(T,!1),I=B.updateQueue,I!==null&&(p.updateQueue=I,p.flags|=4),p.subtreeFlags=0,I=b,b=p.child;b!==null;)T=b,f=I,T.flags&=14680066,B=T.alternate,B===null?(T.childLanes=0,T.lanes=f,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=B.childLanes,T.lanes=B.lanes,T.child=B.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=B.memoizedProps,T.memoizedState=B.memoizedState,T.updateQueue=B.updateQueue,T.type=B.type,f=B.dependencies,T.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),b=b.sibling;return hn(Dn,Dn.current&1|2),p.child}f=f.sibling}T.tail!==null&&Jn()>of&&(p.flags|=128,I=!0,jp(T,!1),p.lanes=4194304)}else{if(!I)if(f=yv(B),f!==null){if(p.flags|=128,I=!0,b=f.updateQueue,b!==null&&(p.updateQueue=b,p.flags|=4),jp(T,!0),T.tail===null&&T.tailMode==="hidden"&&!B.alternate&&!Sn)return is(p),null}else 2*Jn()-T.renderingStartTime>of&&b!==1073741824&&(p.flags|=128,I=!0,jp(T,!1),p.lanes=4194304);T.isBackwards?(B.sibling=p.child,p.child=B):(b=T.last,b!==null?b.sibling=B:p.child=B,T.last=B)}return T.tail!==null?(p=T.tail,T.rendering=p,T.tail=p.sibling,T.renderingStartTime=Jn(),p.sibling=null,b=Dn.current,hn(Dn,I?b&1|2:b&1),p):(is(p),null);case 22:case 23:return gE(),I=p.memoizedState!==null,f!==null&&f.memoizedState!==null!==I&&(p.flags|=8192),I&&(p.mode&1)!==0?(hi&1073741824)!==0&&(is(p),p.subtreeFlags&6&&(p.flags|=8192)):is(p),null;case 24:return null;case 25:return null}throw Error(n(156,p.tag))}function PZ(f,p){switch(Ek(p),p.tag){case 1:return Os(p.type)&&ov(),f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 3:return tf(),bn(Rs),bn(rs),Bk(),f=p.flags,(f&65536)!==0&&(f&128)===0?(p.flags=f&-65537|128,p):null;case 5:return Fk(p),null;case 13:if(bn(Dn),f=p.memoizedState,f!==null&&f.dehydrated!==null){if(p.alternate===null)throw Error(n(340));Yd()}return f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 19:return bn(Dn),null;case 4:return tf(),null;case 10:return $k(p.type._context),null;case 22:case 23:return gE(),null;case 24:return null;default:return null}}var Cv=!1,os=!1,DZ=typeof WeakSet=="function"?WeakSet:Set,qe=null;function rf(f,p){var b=f.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(I){jn(f,p,I)}else b.current=null}function sE(f,p,b){try{b()}catch(I){jn(f,p,I)}}var rF=!1;function FZ(f,p){if(gk=Gy,f=DP(),ck(f)){if("selectionStart"in f)var b={start:f.selectionStart,end:f.selectionEnd};else e:{b=(b=f.ownerDocument)&&b.defaultView||window;var I=b.getSelection&&b.getSelection();if(I&&I.rangeCount!==0){b=I.anchorNode;var C=I.anchorOffset,T=I.focusNode;I=I.focusOffset;try{b.nodeType,T.nodeType}catch{b=null;break e}var B=0,Q=-1,ne=-1,pe=0,ke=0,Te=f,Se=null;t:for(;;){for(var Ue;Te!==b||C!==0&&Te.nodeType!==3||(Q=B+C),Te!==T||I!==0&&Te.nodeType!==3||(ne=B+I),Te.nodeType===3&&(B+=Te.nodeValue.length),(Ue=Te.firstChild)!==null;)Se=Te,Te=Ue;for(;;){if(Te===f)break t;if(Se===b&&++pe===C&&(Q=B),Se===T&&++ke===I&&(ne=B),(Ue=Te.nextSibling)!==null)break;Te=Se,Se=Te.parentNode}Te=Ue}b=Q===-1||ne===-1?null:{start:Q,end:ne}}else b=null}b=b||{start:0,end:0}}else b=null;for(yk={focusedElem:f,selectionRange:b},Gy=!1,qe=p;qe!==null;)if(p=qe,f=p.child,(p.subtreeFlags&1028)!==0&&f!==null)f.return=p,qe=f;else for(;qe!==null;){p=qe;try{var Qe=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var Je=Qe.memoizedProps,er=Qe.memoizedState,ue=p.stateNode,ie=ue.getSnapshotBeforeUpdate(p.elementType===p.type?Je:go(p.type,Je),er);ue.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var he=p.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch($e){jn(p,p.return,$e)}if(f=p.sibling,f!==null){f.return=p.return,qe=f;break}qe=p.return}return Qe=rF,rF=!1,Qe}function Hp(f,p,b){var I=p.updateQueue;if(I=I!==null?I.lastEffect:null,I!==null){var C=I=I.next;do{if((C.tag&f)===f){var T=C.destroy;C.destroy=void 0,T!==void 0&&sE(p,b,T)}C=C.next}while(C!==I)}}function Tv(f,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var b=p=p.next;do{if((b.tag&f)===f){var I=b.create;b.destroy=I()}b=b.next}while(b!==p)}}function iE(f){var p=f.ref;if(p!==null){var b=f.stateNode;switch(f.tag){case 5:f=b;break;default:f=b}typeof p=="function"?p(f):p.current=f}}function sF(f){var p=f.alternate;p!==null&&(f.alternate=null,sF(p)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(p=f.stateNode,p!==null&&(delete p[Qo],delete p[Op],delete p[xk],delete p[vZ],delete p[bZ])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function iF(f){return f.tag===5||f.tag===3||f.tag===4}function oF(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||iF(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function oE(f,p,b){var I=f.tag;if(I===5||I===6)f=f.stateNode,p?b.nodeType===8?b.parentNode.insertBefore(f,p):b.insertBefore(f,p):(b.nodeType===8?(p=b.parentNode,p.insertBefore(f,b)):(p=b,p.appendChild(f)),b=b._reactRootContainer,b!=null||p.onclick!==null||(p.onclick=sv));else if(I!==4&&(f=f.child,f!==null))for(oE(f,p,b),f=f.sibling;f!==null;)oE(f,p,b),f=f.sibling}function aE(f,p,b){var I=f.tag;if(I===5||I===6)f=f.stateNode,p?b.insertBefore(f,p):b.appendChild(f);else if(I!==4&&(f=f.child,f!==null))for(aE(f,p,b),f=f.sibling;f!==null;)aE(f,p,b),f=f.sibling}var Gr=null,yo=!1;function jc(f,p,b){for(b=b.child;b!==null;)aF(f,p,b),b=b.sibling}function aF(f,p,b){if(Xo&&typeof Xo.onCommitFiberUnmount=="function")try{Xo.onCommitFiberUnmount(zy,b)}catch{}switch(b.tag){case 5:os||rf(b,p);case 6:var I=Gr,C=yo;Gr=null,jc(f,p,b),Gr=I,yo=C,Gr!==null&&(yo?(f=Gr,b=b.stateNode,f.nodeType===8?f.parentNode.removeChild(b):f.removeChild(b)):Gr.removeChild(b.stateNode));break;case 18:Gr!==null&&(yo?(f=Gr,b=b.stateNode,f.nodeType===8?wk(f.parentNode,b):f.nodeType===1&&wk(f,b),Ip(f)):wk(Gr,b.stateNode));break;case 4:I=Gr,C=yo,Gr=b.stateNode.containerInfo,yo=!0,jc(f,p,b),Gr=I,yo=C;break;case 0:case 11:case 14:case 15:if(!os&&(I=b.updateQueue,I!==null&&(I=I.lastEffect,I!==null))){C=I=I.next;do{var T=C,B=T.destroy;T=T.tag,B!==void 0&&((T&2)!==0||(T&4)!==0)&&sE(b,p,B),C=C.next}while(C!==I)}jc(f,p,b);break;case 1:if(!os&&(rf(b,p),I=b.stateNode,typeof I.componentWillUnmount=="function"))try{I.props=b.memoizedProps,I.state=b.memoizedState,I.componentWillUnmount()}catch(Q){jn(b,p,Q)}jc(f,p,b);break;case 21:jc(f,p,b);break;case 22:b.mode&1?(os=(I=os)||b.memoizedState!==null,jc(f,p,b),os=I):jc(f,p,b);break;default:jc(f,p,b)}}function cF(f){var p=f.updateQueue;if(p!==null){f.updateQueue=null;var b=f.stateNode;b===null&&(b=f.stateNode=new DZ),p.forEach(function(I){var C=WZ.bind(null,f,I);b.has(I)||(b.add(I),I.then(C,C))})}}function vo(f,p){var b=p.deletions;if(b!==null)for(var I=0;I<b.length;I++){var C=b[I];try{var T=f,B=p,Q=B;e:for(;Q!==null;){switch(Q.tag){case 5:Gr=Q.stateNode,yo=!1;break e;case 3:Gr=Q.stateNode.containerInfo,yo=!0;break e;case 4:Gr=Q.stateNode.containerInfo,yo=!0;break e}Q=Q.return}if(Gr===null)throw Error(n(160));aF(T,B,C),Gr=null,yo=!1;var ne=C.alternate;ne!==null&&(ne.return=null),C.return=null}catch(pe){jn(C,p,pe)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)lF(p,f),p=p.sibling}function lF(f,p){var b=f.alternate,I=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(vo(p,f),Jo(f),I&4){try{Hp(3,f,f.return),Tv(3,f)}catch(Je){jn(f,f.return,Je)}try{Hp(5,f,f.return)}catch(Je){jn(f,f.return,Je)}}break;case 1:vo(p,f),Jo(f),I&512&&b!==null&&rf(b,b.return);break;case 5:if(vo(p,f),Jo(f),I&512&&b!==null&&rf(b,b.return),f.flags&32){var C=f.stateNode;try{$s(C,"")}catch(Je){jn(f,f.return,Je)}}if(I&4&&(C=f.stateNode,C!=null)){var T=f.memoizedProps,B=b!==null?b.memoizedProps:T,Q=f.type,ne=f.updateQueue;if(f.updateQueue=null,ne!==null)try{Q==="input"&&T.type==="radio"&&T.name!=null&&Pt(C,T),fp(Q,B);var pe=fp(Q,T);for(B=0;B<ne.length;B+=2){var ke=ne[B],Te=ne[B+1];ke==="style"?_c(C,Te):ke==="dangerouslySetInnerHTML"?Zn(C,Te):ke==="children"?$s(C,Te):S(C,ke,Te,pe)}switch(Q){case"input":Xt(C,T);break;case"textarea":Ne(C,T);break;case"select":var Se=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!T.multiple;var Ue=T.value;Ue!=null?le(C,!!T.multiple,Ue,!1):Se!==!!T.multiple&&(T.defaultValue!=null?le(C,!!T.multiple,T.defaultValue,!0):le(C,!!T.multiple,T.multiple?[]:"",!1))}C[Op]=T}catch(Je){jn(f,f.return,Je)}}break;case 6:if(vo(p,f),Jo(f),I&4){if(f.stateNode===null)throw Error(n(162));C=f.stateNode,T=f.memoizedProps;try{C.nodeValue=T}catch(Je){jn(f,f.return,Je)}}break;case 3:if(vo(p,f),Jo(f),I&4&&b!==null&&b.memoizedState.isDehydrated)try{Ip(p.containerInfo)}catch(Je){jn(f,f.return,Je)}break;case 4:vo(p,f),Jo(f);break;case 13:vo(p,f),Jo(f),C=f.child,C.flags&8192&&(T=C.memoizedState!==null,C.stateNode.isHidden=T,!T||C.alternate!==null&&C.alternate.memoizedState!==null||(uE=Jn())),I&4&&cF(f);break;case 22:if(ke=b!==null&&b.memoizedState!==null,f.mode&1?(os=(pe=os)||ke,vo(p,f),os=pe):vo(p,f),Jo(f),I&8192){if(pe=f.memoizedState!==null,(f.stateNode.isHidden=pe)&&!ke&&(f.mode&1)!==0)for(qe=f,ke=f.child;ke!==null;){for(Te=qe=ke;qe!==null;){switch(Se=qe,Ue=Se.child,Se.tag){case 0:case 11:case 14:case 15:Hp(4,Se,Se.return);break;case 1:rf(Se,Se.return);var Qe=Se.stateNode;if(typeof Qe.componentWillUnmount=="function"){I=Se,b=Se.return;try{p=I,Qe.props=p.memoizedProps,Qe.state=p.memoizedState,Qe.componentWillUnmount()}catch(Je){jn(I,b,Je)}}break;case 5:rf(Se,Se.return);break;case 22:if(Se.memoizedState!==null){fF(Te);continue}}Ue!==null?(Ue.return=Se,qe=Ue):fF(Te)}ke=ke.sibling}e:for(ke=null,Te=f;;){if(Te.tag===5){if(ke===null){ke=Te;try{C=Te.stateNode,pe?(T=C.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(Q=Te.stateNode,ne=Te.memoizedProps.style,B=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Q.style.display=fo("display",B))}catch(Je){jn(f,f.return,Je)}}}else if(Te.tag===6){if(ke===null)try{Te.stateNode.nodeValue=pe?"":Te.memoizedProps}catch(Je){jn(f,f.return,Je)}}else if((Te.tag!==22&&Te.tag!==23||Te.memoizedState===null||Te===f)&&Te.child!==null){Te.child.return=Te,Te=Te.child;continue}if(Te===f)break e;for(;Te.sibling===null;){if(Te.return===null||Te.return===f)break e;ke===Te&&(ke=null),Te=Te.return}ke===Te&&(ke=null),Te.sibling.return=Te.return,Te=Te.sibling}}break;case 19:vo(p,f),Jo(f),I&4&&cF(f);break;case 21:break;default:vo(p,f),Jo(f)}}function Jo(f){var p=f.flags;if(p&2){try{e:{for(var b=f.return;b!==null;){if(iF(b)){var I=b;break e}b=b.return}throw Error(n(160))}switch(I.tag){case 5:var C=I.stateNode;I.flags&32&&($s(C,""),I.flags&=-33);var T=oF(f);aE(f,T,C);break;case 3:case 4:var B=I.stateNode.containerInfo,Q=oF(f);oE(f,Q,B);break;default:throw Error(n(161))}}catch(ne){jn(f,f.return,ne)}f.flags&=-3}p&4096&&(f.flags&=-4097)}function LZ(f,p,b){qe=f,uF(f)}function uF(f,p,b){for(var I=(f.mode&1)!==0;qe!==null;){var C=qe,T=C.child;if(C.tag===22&&I){var B=C.memoizedState!==null||Cv;if(!B){var Q=C.alternate,ne=Q!==null&&Q.memoizedState!==null||os;Q=Cv;var pe=os;if(Cv=B,(os=ne)&&!pe)for(qe=C;qe!==null;)B=qe,ne=B.child,B.tag===22&&B.memoizedState!==null?hF(C):ne!==null?(ne.return=B,qe=ne):hF(C);for(;T!==null;)qe=T,uF(T),T=T.sibling;qe=C,Cv=Q,os=pe}dF(f)}else(C.subtreeFlags&8772)!==0&&T!==null?(T.return=C,qe=T):dF(f)}}function dF(f){for(;qe!==null;){var p=qe;if((p.flags&8772)!==0){var b=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:os||Tv(5,p);break;case 1:var I=p.stateNode;if(p.flags&4&&!os)if(b===null)I.componentDidMount();else{var C=p.elementType===p.type?b.memoizedProps:go(p.type,b.memoizedProps);I.componentDidUpdate(C,b.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var T=p.updateQueue;T!==null&&fD(p,T,I);break;case 3:var B=p.updateQueue;if(B!==null){if(b=null,p.child!==null)switch(p.child.tag){case 5:b=p.child.stateNode;break;case 1:b=p.child.stateNode}fD(p,B,b)}break;case 5:var Q=p.stateNode;if(b===null&&p.flags&4){b=Q;var ne=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&b.focus();break;case"img":ne.src&&(b.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var pe=p.alternate;if(pe!==null){var ke=pe.memoizedState;if(ke!==null){var Te=ke.dehydrated;Te!==null&&Ip(Te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}os||p.flags&512&&iE(p)}catch(Se){jn(p,p.return,Se)}}if(p===f){qe=null;break}if(b=p.sibling,b!==null){b.return=p.return,qe=b;break}qe=p.return}}function fF(f){for(;qe!==null;){var p=qe;if(p===f){qe=null;break}var b=p.sibling;if(b!==null){b.return=p.return,qe=b;break}qe=p.return}}function hF(f){for(;qe!==null;){var p=qe;try{switch(p.tag){case 0:case 11:case 15:var b=p.return;try{Tv(4,p)}catch(ne){jn(p,b,ne)}break;case 1:var I=p.stateNode;if(typeof I.componentDidMount=="function"){var C=p.return;try{I.componentDidMount()}catch(ne){jn(p,C,ne)}}var T=p.return;try{iE(p)}catch(ne){jn(p,T,ne)}break;case 5:var B=p.return;try{iE(p)}catch(ne){jn(p,B,ne)}}}catch(ne){jn(p,p.return,ne)}if(p===f){qe=null;break}var Q=p.sibling;if(Q!==null){Q.return=p.return,qe=Q;break}qe=p.return}}var BZ=Math.ceil,Av=k.ReactCurrentDispatcher,cE=k.ReactCurrentOwner,Di=k.ReactCurrentBatchConfig,Wt=0,Nr=null,sr=null,qr=0,hi=0,sf=Bc(0),br=0,Wp=null,ru=0,Nv=0,lE=0,Gp=null,Ds=null,uE=0,of=1/0,Ua=null,_v=!1,dE=null,Hc=null,$v=!1,Wc=null,Rv=0,qp=0,fE=null,Ov=-1,Pv=0;function bs(){return(Wt&6)!==0?Jn():Ov!==-1?Ov:Ov=Jn()}function Gc(f){return(f.mode&1)===0?1:(Wt&2)!==0&&qr!==0?qr&-qr:xZ.transition!==null?(Pv===0&&(Pv=oP()),Pv):(f=tn,f!==0||(f=window.event,f=f===void 0?16:mP(f.type)),f)}function bo(f,p,b,I){if(50<qp)throw qp=0,fE=null,Error(n(185));yp(f,b,I),((Wt&2)===0||f!==Nr)&&(f===Nr&&((Wt&2)===0&&(Nv|=b),br===4&&qc(f,qr)),Fs(f,I),b===1&&Wt===0&&(p.mode&1)===0&&(of=Jn()+500,cv&&zc()))}function Fs(f,p){var b=f.callbackNode;xY(f,p);var I=jy(f,f===Nr?qr:0);if(I===0)b!==null&&rP(b),f.callbackNode=null,f.callbackPriority=0;else if(p=I&-I,f.callbackPriority!==p){if(b!=null&&rP(b),p===1)f.tag===0?wZ(mF.bind(null,f)):eD(mF.bind(null,f)),gZ(function(){(Wt&6)===0&&zc()}),b=null;else{switch(aP(I)){case 1:b=WS;break;case 4:b=sP;break;case 16:b=My;break;case 536870912:b=iP;break;default:b=My}b=SF(b,pF.bind(null,f))}f.callbackPriority=p,f.callbackNode=b}}function pF(f,p){if(Ov=-1,Pv=0,(Wt&6)!==0)throw Error(n(327));var b=f.callbackNode;if(af()&&f.callbackNode!==b)return null;var I=jy(f,f===Nr?qr:0);if(I===0)return null;if((I&30)!==0||(I&f.expiredLanes)!==0||p)p=Dv(f,I);else{p=I;var C=Wt;Wt|=2;var T=yF();(Nr!==f||qr!==p)&&(Ua=null,of=Jn()+500,iu(f,p));do try{UZ();break}catch(Q){gF(f,Q)}while(!0);_k(),Av.current=T,Wt=C,sr!==null?p=0:(Nr=null,qr=0,p=br)}if(p!==0){if(p===2&&(C=GS(f),C!==0&&(I=C,p=hE(f,C))),p===1)throw b=Wp,iu(f,0),qc(f,I),Fs(f,Jn()),b;if(p===6)qc(f,I);else{if(C=f.current.alternate,(I&30)===0&&!MZ(C)&&(p=Dv(f,I),p===2&&(T=GS(f),T!==0&&(I=T,p=hE(f,T))),p===1))throw b=Wp,iu(f,0),qc(f,I),Fs(f,Jn()),b;switch(f.finishedWork=C,f.finishedLanes=I,p){case 0:case 1:throw Error(n(345));case 2:ou(f,Ds,Ua);break;case 3:if(qc(f,I),(I&130023424)===I&&(p=uE+500-Jn(),10<p)){if(jy(f,0)!==0)break;if(C=f.suspendedLanes,(C&I)!==I){bs(),f.pingedLanes|=f.suspendedLanes&C;break}f.timeoutHandle=bk(ou.bind(null,f,Ds,Ua),p);break}ou(f,Ds,Ua);break;case 4:if(qc(f,I),(I&4194240)===I)break;for(p=f.eventTimes,C=-1;0<I;){var B=31-ho(I);T=1<<B,B=p[B],B>C&&(C=B),I&=~T}if(I=C,I=Jn()-I,I=(120>I?120:480>I?480:1080>I?1080:1920>I?1920:3e3>I?3e3:4320>I?4320:1960*BZ(I/1960))-I,10<I){f.timeoutHandle=bk(ou.bind(null,f,Ds,Ua),I);break}ou(f,Ds,Ua);break;case 5:ou(f,Ds,Ua);break;default:throw Error(n(329))}}}return Fs(f,Jn()),f.callbackNode===b?pF.bind(null,f):null}function hE(f,p){var b=Gp;return f.current.memoizedState.isDehydrated&&(iu(f,p).flags|=256),f=Dv(f,p),f!==2&&(p=Ds,Ds=b,p!==null&&pE(p)),f}function pE(f){Ds===null?Ds=f:Ds.push.apply(Ds,f)}function MZ(f){for(var p=f;;){if(p.flags&16384){var b=p.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var I=0;I<b.length;I++){var C=b[I],T=C.getSnapshot;C=C.value;try{if(!po(T(),C))return!1}catch{return!1}}}if(b=p.child,p.subtreeFlags&16384&&b!==null)b.return=p,p=b;else{if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function qc(f,p){for(p&=~lE,p&=~Nv,f.suspendedLanes|=p,f.pingedLanes&=~p,f=f.expirationTimes;0<p;){var b=31-ho(p),I=1<<b;f[b]=-1,p&=~I}}function mF(f){if((Wt&6)!==0)throw Error(n(327));af();var p=jy(f,0);if((p&1)===0)return Fs(f,Jn()),null;var b=Dv(f,p);if(f.tag!==0&&b===2){var I=GS(f);I!==0&&(p=I,b=hE(f,I))}if(b===1)throw b=Wp,iu(f,0),qc(f,p),Fs(f,Jn()),b;if(b===6)throw Error(n(345));return f.finishedWork=f.current.alternate,f.finishedLanes=p,ou(f,Ds,Ua),Fs(f,Jn()),null}function mE(f,p){var b=Wt;Wt|=1;try{return f(p)}finally{Wt=b,Wt===0&&(of=Jn()+500,cv&&zc())}}function su(f){Wc!==null&&Wc.tag===0&&(Wt&6)===0&&af();var p=Wt;Wt|=1;var b=Di.transition,I=tn;try{if(Di.transition=null,tn=1,f)return f()}finally{tn=I,Di.transition=b,Wt=p,(Wt&6)===0&&zc()}}function gE(){hi=sf.current,bn(sf)}function iu(f,p){f.finishedWork=null,f.finishedLanes=0;var b=f.timeoutHandle;if(b!==-1&&(f.timeoutHandle=-1,mZ(b)),sr!==null)for(b=sr.return;b!==null;){var I=b;switch(Ek(I),I.tag){case 1:I=I.type.childContextTypes,I!=null&&ov();break;case 3:tf(),bn(Rs),bn(rs),Bk();break;case 5:Fk(I);break;case 4:tf();break;case 13:bn(Dn);break;case 19:bn(Dn);break;case 10:$k(I.type._context);break;case 22:case 23:gE()}b=b.return}if(Nr=f,sr=f=Kc(f.current,null),qr=hi=p,br=0,Wp=null,lE=Nv=ru=0,Ds=Gp=null,eu!==null){for(p=0;p<eu.length;p++)if(b=eu[p],I=b.interleaved,I!==null){b.interleaved=null;var C=I.next,T=b.pending;if(T!==null){var B=T.next;T.next=C,I.next=B}b.pending=I}eu=null}return f}function gF(f,p){do{var b=sr;try{if(_k(),vv.current=Iv,bv){for(var I=Fn.memoizedState;I!==null;){var C=I.queue;C!==null&&(C.pending=null),I=I.next}bv=!1}if(nu=0,Ar=vr=Fn=null,Mp=!1,zp=0,cE.current=null,b===null||b.return===null){br=1,Wp=p,sr=null;break}e:{var T=f,B=b.return,Q=b,ne=p;if(p=qr,Q.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var pe=ne,ke=Q,Te=ke.tag;if((ke.mode&1)===0&&(Te===0||Te===11||Te===15)){var Se=ke.alternate;Se?(ke.updateQueue=Se.updateQueue,ke.memoizedState=Se.memoizedState,ke.lanes=Se.lanes):(ke.updateQueue=null,ke.memoizedState=null)}var Ue=UD(B);if(Ue!==null){Ue.flags&=-257,VD(Ue,B,Q,T,p),Ue.mode&1&&zD(T,pe,p),p=Ue,ne=pe;var Qe=p.updateQueue;if(Qe===null){var Je=new Set;Je.add(ne),p.updateQueue=Je}else Qe.add(ne);break e}else{if((p&1)===0){zD(T,pe,p),yE();break e}ne=Error(n(426))}}else if(Sn&&Q.mode&1){var er=UD(B);if(er!==null){(er.flags&65536)===0&&(er.flags|=256),VD(er,B,Q,T,p),Ak(nf(ne,Q));break e}}T=ne=nf(ne,Q),br!==4&&(br=2),Gp===null?Gp=[T]:Gp.push(T),T=B;do{switch(T.tag){case 3:T.flags|=65536,p&=-p,T.lanes|=p;var ue=BD(T,ne,p);dD(T,ue);break e;case 1:Q=ne;var ie=T.type,he=T.stateNode;if((T.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(Hc===null||!Hc.has(he)))){T.flags|=65536,p&=-p,T.lanes|=p;var $e=MD(T,Q,p);dD(T,$e);break e}}T=T.return}while(T!==null)}bF(b)}catch(et){p=et,sr===b&&b!==null&&(sr=b=b.return);continue}break}while(!0)}function yF(){var f=Av.current;return Av.current=Iv,f===null?Iv:f}function yE(){(br===0||br===3||br===2)&&(br=4),Nr===null||(ru&268435455)===0&&(Nv&268435455)===0||qc(Nr,qr)}function Dv(f,p){var b=Wt;Wt|=2;var I=yF();(Nr!==f||qr!==p)&&(Ua=null,iu(f,p));do try{zZ();break}catch(C){gF(f,C)}while(!0);if(_k(),Wt=b,Av.current=I,sr!==null)throw Error(n(261));return Nr=null,qr=0,br}function zZ(){for(;sr!==null;)vF(sr)}function UZ(){for(;sr!==null&&!fY();)vF(sr)}function vF(f){var p=IF(f.alternate,f,hi);f.memoizedProps=f.pendingProps,p===null?bF(f):sr=p,cE.current=null}function bF(f){var p=f;do{var b=p.alternate;if(f=p.return,(p.flags&32768)===0){if(b=OZ(b,p,hi),b!==null){sr=b;return}}else{if(b=PZ(b,p),b!==null){b.flags&=32767,sr=b;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{br=6,sr=null;return}}if(p=p.sibling,p!==null){sr=p;return}sr=p=f}while(p!==null);br===0&&(br=5)}function ou(f,p,b){var I=tn,C=Di.transition;try{Di.transition=null,tn=1,VZ(f,p,b,I)}finally{Di.transition=C,tn=I}return null}function VZ(f,p,b,I){do af();while(Wc!==null);if((Wt&6)!==0)throw Error(n(327));b=f.finishedWork;var C=f.finishedLanes;if(b===null)return null;if(f.finishedWork=null,f.finishedLanes=0,b===f.current)throw Error(n(177));f.callbackNode=null,f.callbackPriority=0;var T=b.lanes|b.childLanes;if(IY(f,T),f===Nr&&(sr=Nr=null,qr=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||$v||($v=!0,SF(My,function(){return af(),null})),T=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||T){T=Di.transition,Di.transition=null;var B=tn;tn=1;var Q=Wt;Wt|=4,cE.current=null,FZ(f,b),lF(b,f),cZ(yk),Gy=!!gk,yk=gk=null,f.current=b,LZ(b),hY(),Wt=Q,tn=B,Di.transition=T}else f.current=b;if($v&&($v=!1,Wc=f,Rv=C),T=f.pendingLanes,T===0&&(Hc=null),gY(b.stateNode),Fs(f,Jn()),p!==null)for(I=f.onRecoverableError,b=0;b<p.length;b++)C=p[b],I(C.value,{componentStack:C.stack,digest:C.digest});if(_v)throw _v=!1,f=dE,dE=null,f;return(Rv&1)!==0&&f.tag!==0&&af(),T=f.pendingLanes,(T&1)!==0?f===fE?qp++:(qp=0,fE=f):qp=0,zc(),null}function af(){if(Wc!==null){var f=aP(Rv),p=Di.transition,b=tn;try{if(Di.transition=null,tn=16>f?16:f,Wc===null)var I=!1;else{if(f=Wc,Wc=null,Rv=0,(Wt&6)!==0)throw Error(n(331));var C=Wt;for(Wt|=4,qe=f.current;qe!==null;){var T=qe,B=T.child;if((qe.flags&16)!==0){var Q=T.deletions;if(Q!==null){for(var ne=0;ne<Q.length;ne++){var pe=Q[ne];for(qe=pe;qe!==null;){var ke=qe;switch(ke.tag){case 0:case 11:case 15:Hp(8,ke,T)}var Te=ke.child;if(Te!==null)Te.return=ke,qe=Te;else for(;qe!==null;){ke=qe;var Se=ke.sibling,Ue=ke.return;if(sF(ke),ke===pe){qe=null;break}if(Se!==null){Se.return=Ue,qe=Se;break}qe=Ue}}}var Qe=T.alternate;if(Qe!==null){var Je=Qe.child;if(Je!==null){Qe.child=null;do{var er=Je.sibling;Je.sibling=null,Je=er}while(Je!==null)}}qe=T}}if((T.subtreeFlags&2064)!==0&&B!==null)B.return=T,qe=B;else e:for(;qe!==null;){if(T=qe,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:Hp(9,T,T.return)}var ue=T.sibling;if(ue!==null){ue.return=T.return,qe=ue;break e}qe=T.return}}var ie=f.current;for(qe=ie;qe!==null;){B=qe;var he=B.child;if((B.subtreeFlags&2064)!==0&&he!==null)he.return=B,qe=he;else e:for(B=ie;qe!==null;){if(Q=qe,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:Tv(9,Q)}}catch(et){jn(Q,Q.return,et)}if(Q===B){qe=null;break e}var $e=Q.sibling;if($e!==null){$e.return=Q.return,qe=$e;break e}qe=Q.return}}if(Wt=C,zc(),Xo&&typeof Xo.onPostCommitFiberRoot=="function")try{Xo.onPostCommitFiberRoot(zy,f)}catch{}I=!0}return I}finally{tn=b,Di.transition=p}}return!1}function wF(f,p,b){p=nf(b,p),p=BD(f,p,1),f=Vc(f,p,1),p=bs(),f!==null&&(yp(f,1,p),Fs(f,p))}function jn(f,p,b){if(f.tag===3)wF(f,f,b);else for(;p!==null;){if(p.tag===3){wF(p,f,b);break}else if(p.tag===1){var I=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof I.componentDidCatch=="function"&&(Hc===null||!Hc.has(I))){f=nf(b,f),f=MD(p,f,1),p=Vc(p,f,1),f=bs(),p!==null&&(yp(p,1,f),Fs(p,f));break}}p=p.return}}function jZ(f,p,b){var I=f.pingCache;I!==null&&I.delete(p),p=bs(),f.pingedLanes|=f.suspendedLanes&b,Nr===f&&(qr&b)===b&&(br===4||br===3&&(qr&130023424)===qr&&500>Jn()-uE?iu(f,0):lE|=b),Fs(f,p)}function xF(f,p){p===0&&((f.mode&1)===0?p=1:(p=Vy,Vy<<=1,(Vy&130023424)===0&&(Vy=4194304)));var b=bs();f=Ba(f,p),f!==null&&(yp(f,p,b),Fs(f,b))}function HZ(f){var p=f.memoizedState,b=0;p!==null&&(b=p.retryLane),xF(f,b)}function WZ(f,p){var b=0;switch(f.tag){case 13:var I=f.stateNode,C=f.memoizedState;C!==null&&(b=C.retryLane);break;case 19:I=f.stateNode;break;default:throw Error(n(314))}I!==null&&I.delete(p),xF(f,b)}var IF;IF=function(f,p,b){if(f!==null)if(f.memoizedProps!==p.pendingProps||Rs.current)Ps=!0;else{if((f.lanes&b)===0&&(p.flags&128)===0)return Ps=!1,RZ(f,p,b);Ps=(f.flags&131072)!==0}else Ps=!1,Sn&&(p.flags&1048576)!==0&&tD(p,uv,p.index);switch(p.lanes=0,p.tag){case 2:var I=p.type;Ev(f,p),f=p.pendingProps;var C=Kd(p,rs.current);ef(p,b),C=Uk(null,p,I,f,C,b);var T=Vk();return p.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Os(I)?(T=!0,av(p)):T=!1,p.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,Pk(p),C.updater=Sv,p.stateNode=C,C._reactInternals=p,Kk(p,I,f,b),p=Zk(null,p,I,!0,T,b)):(p.tag=0,Sn&&T&&kk(p),vs(null,p,C,b),p=p.child),p;case 16:I=p.elementType;e:{switch(Ev(f,p),f=p.pendingProps,C=I._init,I=C(I._payload),p.type=I,C=p.tag=qZ(I),f=go(I,f),C){case 0:p=Yk(null,p,I,f,b);break e;case 1:p=KD(null,p,I,f,b);break e;case 11:p=jD(null,p,I,f,b);break e;case 14:p=HD(null,p,I,go(I.type,f),b);break e}throw Error(n(306,I,""))}return p;case 0:return I=p.type,C=p.pendingProps,C=p.elementType===I?C:go(I,C),Yk(f,p,I,C,b);case 1:return I=p.type,C=p.pendingProps,C=p.elementType===I?C:go(I,C),KD(f,p,I,C,b);case 3:e:{if(XD(p),f===null)throw Error(n(387));I=p.pendingProps,T=p.memoizedState,C=T.element,uD(f,p),gv(p,I,null,b);var B=p.memoizedState;if(I=B.element,T.isDehydrated)if(T={element:I,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},p.updateQueue.baseState=T,p.memoizedState=T,p.flags&256){C=nf(Error(n(423)),p),p=QD(f,p,I,b,C);break e}else if(I!==C){C=nf(Error(n(424)),p),p=QD(f,p,I,b,C);break e}else for(fi=Lc(p.stateNode.containerInfo.firstChild),di=p,Sn=!0,mo=null,b=cD(p,null,I,b),p.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Yd(),I===C){p=za(f,p,b);break e}vs(f,p,I,b)}p=p.child}return p;case 5:return hD(p),f===null&&Tk(p),I=p.type,C=p.pendingProps,T=f!==null?f.memoizedProps:null,B=C.children,vk(I,C)?B=null:T!==null&&vk(I,T)&&(p.flags|=32),qD(f,p),vs(f,p,B,b),p.child;case 6:return f===null&&Tk(p),null;case 13:return YD(f,p,b);case 4:return Dk(p,p.stateNode.containerInfo),I=p.pendingProps,f===null?p.child=Zd(p,null,I,b):vs(f,p,I,b),p.child;case 11:return I=p.type,C=p.pendingProps,C=p.elementType===I?C:go(I,C),jD(f,p,I,C,b);case 7:return vs(f,p,p.pendingProps,b),p.child;case 8:return vs(f,p,p.pendingProps.children,b),p.child;case 12:return vs(f,p,p.pendingProps.children,b),p.child;case 10:e:{if(I=p.type._context,C=p.pendingProps,T=p.memoizedProps,B=C.value,hn(hv,I._currentValue),I._currentValue=B,T!==null)if(po(T.value,B)){if(T.children===C.children&&!Rs.current){p=za(f,p,b);break e}}else for(T=p.child,T!==null&&(T.return=p);T!==null;){var Q=T.dependencies;if(Q!==null){B=T.child;for(var ne=Q.firstContext;ne!==null;){if(ne.context===I){if(T.tag===1){ne=Ma(-1,b&-b),ne.tag=2;var pe=T.updateQueue;if(pe!==null){pe=pe.shared;var ke=pe.pending;ke===null?ne.next=ne:(ne.next=ke.next,ke.next=ne),pe.pending=ne}}T.lanes|=b,ne=T.alternate,ne!==null&&(ne.lanes|=b),Rk(T.return,b,p),Q.lanes|=b;break}ne=ne.next}}else if(T.tag===10)B=T.type===p.type?null:T.child;else if(T.tag===18){if(B=T.return,B===null)throw Error(n(341));B.lanes|=b,Q=B.alternate,Q!==null&&(Q.lanes|=b),Rk(B,b,p),B=T.sibling}else B=T.child;if(B!==null)B.return=T;else for(B=T;B!==null;){if(B===p){B=null;break}if(T=B.sibling,T!==null){T.return=B.return,B=T;break}B=B.return}T=B}vs(f,p,C.children,b),p=p.child}return p;case 9:return C=p.type,I=p.pendingProps.children,ef(p,b),C=Oi(C),I=I(C),p.flags|=1,vs(f,p,I,b),p.child;case 14:return I=p.type,C=go(I,p.pendingProps),C=go(I.type,C),HD(f,p,I,C,b);case 15:return WD(f,p,p.type,p.pendingProps,b);case 17:return I=p.type,C=p.pendingProps,C=p.elementType===I?C:go(I,C),Ev(f,p),p.tag=1,Os(I)?(f=!0,av(p)):f=!1,ef(p,b),FD(p,I,C),Kk(p,I,C,b),Zk(null,p,I,!0,f,b);case 19:return JD(f,p,b);case 22:return GD(f,p,b)}throw Error(n(156,p.tag))};function SF(f,p){return nP(f,p)}function GZ(f,p,b,I){this.tag=f,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=I,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fi(f,p,b,I){return new GZ(f,p,b,I)}function vE(f){return f=f.prototype,!(!f||!f.isReactComponent)}function qZ(f){if(typeof f=="function")return vE(f)?1:0;if(f!=null){if(f=f.$$typeof,f===M)return 11;if(f===D)return 14}return 2}function Kc(f,p){var b=f.alternate;return b===null?(b=Fi(f.tag,p,f.key,f.mode),b.elementType=f.elementType,b.type=f.type,b.stateNode=f.stateNode,b.alternate=f,f.alternate=b):(b.pendingProps=p,b.type=f.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=f.flags&14680064,b.childLanes=f.childLanes,b.lanes=f.lanes,b.child=f.child,b.memoizedProps=f.memoizedProps,b.memoizedState=f.memoizedState,b.updateQueue=f.updateQueue,p=f.dependencies,b.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},b.sibling=f.sibling,b.index=f.index,b.ref=f.ref,b}function Fv(f,p,b,I,C,T){var B=2;if(I=f,typeof f=="function")vE(f)&&(B=1);else if(typeof f=="string")B=5;else e:switch(f){case R:return au(b.children,C,T,p);case N:B=8,C|=8;break;case P:return f=Fi(12,b,p,C|2),f.elementType=P,f.lanes=T,f;case G:return f=Fi(13,b,p,C),f.elementType=G,f.lanes=T,f;case q:return f=Fi(19,b,p,C),f.elementType=q,f.lanes=T,f;case K:return Lv(b,C,T,p);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case O:B=10;break e;case _:B=9;break e;case M:B=11;break e;case D:B=14;break e;case L:B=16,I=null;break e}throw Error(n(130,f==null?f:typeof f,""))}return p=Fi(B,b,p,C),p.elementType=f,p.type=I,p.lanes=T,p}function au(f,p,b,I){return f=Fi(7,f,I,p),f.lanes=b,f}function Lv(f,p,b,I){return f=Fi(22,f,I,p),f.elementType=K,f.lanes=b,f.stateNode={isHidden:!1},f}function bE(f,p,b){return f=Fi(6,f,null,p),f.lanes=b,f}function wE(f,p,b){return p=Fi(4,f.children!==null?f.children:[],f.key,p),p.lanes=b,p.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},p}function KZ(f,p,b,I,C){this.tag=p,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qS(0),this.expirationTimes=qS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qS(0),this.identifierPrefix=I,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function xE(f,p,b,I,C,T,B,Q,ne){return f=new KZ(f,p,b,Q,ne),p===1?(p=1,T===!0&&(p|=8)):p=0,T=Fi(3,null,null,p),f.current=T,T.stateNode=f,T.memoizedState={element:I,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pk(T),f}function XZ(f,p,b){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:I==null?null:""+I,children:f,containerInfo:p,implementation:b}}function kF(f){if(!f)return Mc;f=f._reactInternals;e:{if(Xl(f)!==f||f.tag!==1)throw Error(n(170));var p=f;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Os(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(n(171))}if(f.tag===1){var b=f.type;if(Os(b))return ZP(f,b,p)}return p}function EF(f,p,b,I,C,T,B,Q,ne){return f=xE(b,I,!0,f,C,T,B,Q,ne),f.context=kF(null),b=f.current,I=bs(),C=Gc(b),T=Ma(I,C),T.callback=p??null,Vc(b,T,C),f.current.lanes=C,yp(f,C,I),Fs(f,I),f}function Bv(f,p,b,I){var C=p.current,T=bs(),B=Gc(C);return b=kF(b),p.context===null?p.context=b:p.pendingContext=b,p=Ma(T,B),p.payload={element:f},I=I===void 0?null:I,I!==null&&(p.callback=I),f=Vc(C,p,B),f!==null&&(bo(f,C,B,T),mv(f,C,B)),B}function Mv(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function CF(f,p){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var b=f.retryLane;f.retryLane=b!==0&&b<p?b:p}}function IE(f,p){CF(f,p),(f=f.alternate)&&CF(f,p)}function QZ(){return null}var TF=typeof reportError=="function"?reportError:function(f){console.error(f)};function SE(f){this._internalRoot=f}zv.prototype.render=SE.prototype.render=function(f){var p=this._internalRoot;if(p===null)throw Error(n(409));Bv(f,p,null,null)},zv.prototype.unmount=SE.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var p=f.containerInfo;su(function(){Bv(null,f,null,null)}),p[Pa]=null}};function zv(f){this._internalRoot=f}zv.prototype.unstable_scheduleHydration=function(f){if(f){var p=uP();f={blockedOn:null,target:f,priority:p};for(var b=0;b<Pc.length&&p!==0&&p<Pc[b].priority;b++);Pc.splice(b,0,f),b===0&&hP(f)}};function kE(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function Uv(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function AF(){}function YZ(f,p,b,I,C){if(C){if(typeof I=="function"){var T=I;I=function(){var pe=Mv(B);T.call(pe)}}var B=EF(p,I,f,0,null,!1,!1,"",AF);return f._reactRootContainer=B,f[Pa]=B.current,$p(f.nodeType===8?f.parentNode:f),su(),B}for(;C=f.lastChild;)f.removeChild(C);if(typeof I=="function"){var Q=I;I=function(){var pe=Mv(ne);Q.call(pe)}}var ne=xE(f,0,!1,null,null,!1,!1,"",AF);return f._reactRootContainer=ne,f[Pa]=ne.current,$p(f.nodeType===8?f.parentNode:f),su(function(){Bv(p,ne,b,I)}),ne}function Vv(f,p,b,I,C){var T=b._reactRootContainer;if(T){var B=T;if(typeof C=="function"){var Q=C;C=function(){var ne=Mv(B);Q.call(ne)}}Bv(p,B,f,C)}else B=YZ(b,p,f,C,I);return Mv(B)}cP=function(f){switch(f.tag){case 3:var p=f.stateNode;if(p.current.memoizedState.isDehydrated){var b=gp(p.pendingLanes);b!==0&&(KS(p,b|1),Fs(p,Jn()),(Wt&6)===0&&(of=Jn()+500,zc()))}break;case 13:su(function(){var I=Ba(f,1);if(I!==null){var C=bs();bo(I,f,1,C)}}),IE(f,1)}},XS=function(f){if(f.tag===13){var p=Ba(f,134217728);if(p!==null){var b=bs();bo(p,f,134217728,b)}IE(f,134217728)}},lP=function(f){if(f.tag===13){var p=Gc(f),b=Ba(f,p);if(b!==null){var I=bs();bo(b,f,p,I)}IE(f,p)}},uP=function(){return tn},dP=function(f,p){var b=tn;try{return tn=f,p()}finally{tn=b}},US=function(f,p,b){switch(p){case"input":if(Xt(f,b),p=b.name,b.type==="radio"&&p!=null){for(b=f;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<b.length;p++){var I=b[p];if(I!==f&&I.form===f.form){var C=iv(I);if(!C)throw Error(n(90));dt(I),Xt(I,C)}}}break;case"textarea":Ne(f,b);break;case"select":p=b.value,p!=null&&le(f,!!b.multiple,p,!1)}},XO=mE,QO=su;var ZZ={usingClientEntryPoint:!1,Events:[Pp,Gd,iv,qO,KO,mE]},Kp={findFiberByHostInstance:Ql,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JZ={bundleType:Kp.bundleType,version:Kp.version,rendererPackageName:Kp.rendererPackageName,rendererConfig:Kp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=eP(f),f===null?null:f.stateNode},findFiberByHostInstance:Kp.findFiberByHostInstance||QZ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jv.isDisabled&&jv.supportsFiber)try{zy=jv.inject(JZ),Xo=jv}catch{}}return Ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZZ,Ls.createPortal=function(f,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kE(p))throw Error(n(200));return XZ(f,p,null,b)},Ls.createRoot=function(f,p){if(!kE(f))throw Error(n(299));var b=!1,I="",C=TF;return p!=null&&(p.unstable_strictMode===!0&&(b=!0),p.identifierPrefix!==void 0&&(I=p.identifierPrefix),p.onRecoverableError!==void 0&&(C=p.onRecoverableError)),p=xE(f,1,!1,null,null,b,!1,I,C),f[Pa]=p.current,$p(f.nodeType===8?f.parentNode:f),new SE(p)},Ls.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var p=f._reactInternals;if(p===void 0)throw typeof f.render=="function"?Error(n(188)):(f=Object.keys(f).join(","),Error(n(268,f)));return f=eP(p),f=f===null?null:f.stateNode,f},Ls.flushSync=function(f){return su(f)},Ls.hydrate=function(f,p,b){if(!Uv(p))throw Error(n(200));return Vv(null,f,p,!0,b)},Ls.hydrateRoot=function(f,p,b){if(!kE(f))throw Error(n(405));var I=b!=null&&b.hydratedSources||null,C=!1,T="",B=TF;if(b!=null&&(b.unstable_strictMode===!0&&(C=!0),b.identifierPrefix!==void 0&&(T=b.identifierPrefix),b.onRecoverableError!==void 0&&(B=b.onRecoverableError)),p=EF(p,null,f,1,b??null,C,!1,T,B),f[Pa]=p.current,$p(f),I)for(f=0;f<I.length;f++)b=I[f],C=b._getVersion,C=C(b._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[b,C]:p.mutableSourceEagerHydrationData.push(b,C);return new zv(p)},Ls.render=function(f,p,b){if(!Uv(p))throw Error(n(200));return Vv(null,f,p,!1,b)},Ls.unmountComponentAtNode=function(f){if(!Uv(f))throw Error(n(40));return f._reactRootContainer?(su(function(){Vv(null,null,f,!1,function(){f._reactRootContainer=null,f[Pa]=null})}),!0):!1},Ls.unstable_batchedUpdates=mE,Ls.unstable_renderSubtreeIntoContainer=function(f,p,b,I){if(!Uv(b))throw Error(n(200));if(f==null||f._reactInternals===void 0)throw Error(n(38));return Vv(f,p,b,!1,I)},Ls.version="18.3.1-next-f1338f8080-20240426",Ls}var FF;function $z(){if(FF)return TE.exports;FF=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),TE.exports=cJ(),TE.exports}var LF;function lJ(){if(LF)return Hv;LF=1;var t=$z();return Hv.createRoot=t.createRoot,Hv.hydrateRoot=t.hydrateRoot,Hv}var uJ=lJ();function dJ(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,s,i,o=[],a="",c=t.split("/");for(c[0]||c.shift();s=c.shift();)n=s[0],n==="*"?(o.push(n),a+=s[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),a+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}var z=Xg();const tr=Wo(z),OA=_z({__proto__:null,default:tr},[z]);var _E={exports:{}},$E={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BF;function fJ(){if(BF)return $E;BF=1;var t=Xg();function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(d,h){var m=h(),g=r({inst:{value:m,getSnapshot:h}}),v=g[0].inst,y=g[1];return i(function(){v.value=m,v.getSnapshot=h,c(v)&&y({inst:v})},[d,m,h]),s(function(){return c(v)&&y({inst:v}),d(function(){c(v)&&y({inst:v})})},[d]),o(m),m}function c(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function l(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:a;return $E.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,$E}var MF;function hJ(){return MF||(MF=1,_E.exports=fJ()),_E.exports}var pJ=hJ();const mJ=OA.useInsertionEffect,gJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yJ=gJ?z.useLayoutEffect:z.useEffect,vJ=mJ||yJ,Rz=t=>{const e=z.useRef([t,(...n)=>e[0](...n)]).current;return vJ(()=>{e[0]=t}),e[1]},bJ="popstate",PA="pushState",DA="replaceState",wJ="hashchange",zF=[bJ,PA,DA,wJ],xJ=t=>{for(const e of zF)addEventListener(e,t);return()=>{for(const e of zF)removeEventListener(e,t)}},Oz=(t,e)=>pJ.useSyncExternalStore(xJ,t,e),IJ=()=>location.search,SJ=({ssrSearch:t=""}={})=>Oz(IJ,()=>t),UF=()=>location.pathname,kJ=({ssrPath:t}={})=>Oz(UF,t?()=>t:UF),EJ=(t,{replace:e=!1,state:n=null}={})=>history[e?DA:PA](n,"",t),CJ=(t={})=>[kJ(t),EJ],VF=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[VF]>"u"){for(const t of[PA,DA]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),r=new Event(t);return r.arguments=arguments,dispatchEvent(r),n}}Object.defineProperty(window,VF,{value:!0})}const TJ=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Pz=(t="")=>t==="/"?"":t,AJ=(t,e)=>t[0]==="~"?t.slice(1):Pz(e)+t,NJ=(t="",e)=>TJ(jF(Pz(t)),jF(e)),jF=t=>{try{return decodeURI(t)}catch{return t}},Dz={hook:CJ,searchHook:SJ,parser:dJ,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},Fz=z.createContext(Dz),Yx=()=>z.useContext(Fz),Lz={},Bz=z.createContext(Lz),_J=()=>z.useContext(Bz),FA=t=>{const[e,n]=t.hook(t);return[NJ(t.base,e),Rz((r,s)=>n(AJ(r,t.base),s))]},Mz=(t,e,n,r)=>{const{pattern:s,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",r),o=s.exec(n)||[],[a,...c]=o;return a!==void 0?[!0,(()=>{const l=i!==!1?Object.fromEntries(i.map((d,h)=>[d,c[h]])):o.groups;let u={...c};return l&&Object.assign(u,l),u})(),...r?[a]:[]]:[!1,null]},$J=({children:t,...e})=>{const n=Yx(),r=e.hook?Dz:n;let s=r;const[i,o]=e.ssrPath?.split("?")??[];o&&(e.ssrSearch=o,e.ssrPath=i),e.hrefs=e.hrefs??e.hook?.hrefs;let a=z.useRef({}),c=a.current,l=c;for(let u in r){const d=u==="base"?r[u]+(e[u]||""):e[u]||r[u];c===l&&d!==l[u]&&(a.current=l={...l}),l[u]=d,(d!==r[u]||d!==s[u])&&(s=l)}return z.createElement(Fz.Provider,{value:s,children:t})},HF=({children:t,component:e},n)=>e?z.createElement(e,{params:n}):typeof t=="function"?t(n):t,RJ=t=>{let e=z.useRef(Lz);const n=e.current;return e.current=Object.keys(t).length!==Object.keys(n).length||Object.entries(t).some(([r,s])=>s!==n[r])?t:n},WF=({path:t,nest:e,match:n,...r})=>{const s=Yx(),[i]=FA(s),[o,a,c]=n??Mz(s.parser,t,i,e),l=RJ({..._J(),...a});if(!o)return null;const u=c?z.createElement($J,{base:c},HF(r,l)):HF(r,l);return z.createElement(Bz.Provider,{value:l,children:u})},OJ=z.forwardRef((t,e)=>{const n=Yx(),[r,s]=FA(n),{to:i="",href:o=i,onClick:a,asChild:c,children:l,className:u,replace:d,state:h,...m}=t,g=Rz(y=>{y.ctrlKey||y.metaKey||y.altKey||y.shiftKey||y.button!==0||(a?.(y),y.defaultPrevented||(y.preventDefault(),s(o,t)))}),v=n.hrefs(o[0]==="~"?o.slice(1):n.base+o,n);return c&&z.isValidElement(l)?z.cloneElement(l,{onClick:g,href:v}):z.createElement("a",{...m,onClick:g,href:v,className:u?.call?u(r===o):u,children:l,ref:e})}),zz=t=>Array.isArray(t)?t.flatMap(e=>zz(e&&e.type===z.Fragment?e.props.children:e)):[t],PJ=({children:t,location:e})=>{const n=Yx(),[r]=FA(n);for(const s of zz(t)){let i=0;if(z.isValidElement(s)&&(i=Mz(n.parser,s.props.path,e||r,s.props.nest))[0])return z.cloneElement(s,{match:i})}return null};var Qg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},DJ={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},FJ=class{#e=DJ;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Su=new FJ;function LJ(t){setTimeout(t,0)}var Uu=typeof window>"u"||"Deno"in globalThis;function Vs(){}function BJ(t,e){return typeof t=="function"?t(e):t}function iC(t){return typeof t=="number"&&t>=0&&t!==1/0}function Uz(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ll(t,e){return typeof t=="function"?t(e):t}function Wi(t,e){return typeof t=="function"?t(e):t}function GF(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==LA(o,e.options))return!1}else if(!Wm(e.queryKey,o))return!1}if(n!=="all"){const c=e.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function qF(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Hm(e.options.mutationKey)!==Hm(i))return!1}else if(!Wm(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function LA(t,e){return(e?.queryKeyHashFn||Hm)(t)}function Hm(t){return JSON.stringify(t,(e,n)=>aC(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Wm(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Wm(t[n],e[n])):!1}var MJ=Object.prototype.hasOwnProperty;function Vz(t,e){if(t===e)return t;const n=KF(t)&&KF(e);if(!n&&!(aC(t)&&aC(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),o=i.length,a=n?new Array(o):{};let c=0;for(let l=0;l<o;l++){const u=n?l:i[l],d=t[u],h=e[u];if(d===h){a[u]=d,(n?l<s:MJ.call(t,u))&&c++;continue}if(d===null||h===null||typeof d!="object"||typeof h!="object"){a[u]=h;continue}const m=Vz(d,h);a[u]=m,m===d&&c++}return s===o&&c===s?t:a}function oC(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function KF(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function aC(t){if(!XF(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!XF(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function XF(t){return Object.prototype.toString.call(t)==="[object Object]"}function zJ(t){return new Promise(e=>{Su.setTimeout(e,t)})}function cC(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Vz(t,e):e}function UJ(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function VJ(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var BA=Symbol();function jz(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===BA?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function jJ(t,e){return typeof t=="function"?t(...e):!!t}var HJ=class extends Qg{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Uu&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},MA=new HJ;function lC(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}var WJ=LJ;function GJ(){let t=[],e=0,n=a=>{a()},r=a=>{a()},s=WJ;const i=a=>{e?t.push(a):s(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&s(()=>{r(()=>{a.forEach(c=>{n(c)})})})};return{batch:a=>{let c;e++;try{c=a()}finally{e--,e||o()}return c},batchCalls:a=>(...c)=>{i(()=>{a(...c)})},schedule:i,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var Xr=GJ(),qJ=class extends Qg{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Uu&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},nw=new qJ;function KJ(t){return Math.min(1e3*2**t,3e4)}function Hz(t){return(t??"online")==="online"?nw.isOnline():!0}var uC=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Wz(t){let e=!1,n=0,r;const s=lC(),i=()=>s.status!=="pending",o=v=>{if(!i()){const y=new uC(v);h(y),t.onCancel?.(y)}},a=()=>{e=!0},c=()=>{e=!1},l=()=>MA.isFocused()&&(t.networkMode==="always"||nw.isOnline())&&t.canRun(),u=()=>Hz(t.networkMode)&&t.canRun(),d=v=>{i()||(r?.(),s.resolve(v))},h=v=>{i()||(r?.(),s.reject(v))},m=()=>new Promise(v=>{r=y=>{(i()||l())&&v(y)},t.onPause?.()}).then(()=>{r=void 0,i()||t.onContinue?.()}),g=()=>{if(i())return;let v;const y=n===0?t.initialPromise:void 0;try{v=y??t.fn()}catch(w){v=Promise.reject(w)}Promise.resolve(v).then(d).catch(w=>{if(i())return;const x=t.retry??(Uu?0:3),S=t.retryDelay??KJ,k=typeof S=="function"?S(n,w):S,E=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,w);if(e||!E){h(w);return}n++,t.onFail?.(n,w),zJ(k).then(()=>l()?void 0:m()).then(()=>{e?h(w):g()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r?.(),s),cancelRetry:a,continueRetry:c,canStart:u,start:()=>(u()?g():m().then(g),s)}}var Gz=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),iC(this.gcTime)&&(this.#e=Su.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Uu?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Su.clearTimeout(this.#e),this.#e=void 0)}},XJ=class extends Gz{#e;#t;#n;#s;#r;#a;#o;constructor(t){super(),this.#o=!1,this.#a=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#s=t.client,this.#n=this.#s.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=QF(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#a,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=QF(this.options);e.data!==void 0&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=cC(this.state.data,t,this.options);return this.#i({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#i({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Vs).catch(Vs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>Wi(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===BA||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ll(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Uz(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const a=this.observers.find(c=>c.options.queryFn);a&&this.setOptions(a.options)}const n=new AbortController,r=a=>{Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(this.#o=!0,n.signal)})},s=()=>{const a=jz(this.options,e),l=(()=>{const u={client:this.#s,queryKey:this.queryKey,meta:this.meta};return r(u),u})();return this.#o=!1,this.options.persister?this.options.persister(a,l,this):a(l)},o=(()=>{const a={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:s};return r(a),a})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#i({type:"fetch",meta:o.fetchOptions?.meta}),this.#r=Wz({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:a=>{a instanceof uC&&a.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(a,c)=>{this.#i({type:"failed",failureCount:a,error:c})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const a=await this.#r.start();if(a===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(a),this.#n.config.onSuccess?.(a,this),this.#n.config.onSettled?.(a,this.state.error,this),a}catch(a){if(a instanceof uC){if(a.silent)return this.#r.promise;if(a.revert){if(this.state.data===void 0)throw a;return this.state.data}}throw this.#i({type:"error",error:a}),this.#n.config.onError?.(a,this),this.#n.config.onSettled?.(this.state.data,a,this),a}finally{this.scheduleGc()}}#i(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...qz(n.data,this.options),fetchMeta:t.meta??null};case"success":const r={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?r:void 0,r;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),Xr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function qz(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Hz(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function QF(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var QJ=class extends Qg{constructor(t,e){super(),this.options=e,this.#e=t,this.#i=null,this.#o=lC(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#s=void 0;#r;#a;#o;#i;#m;#f;#h;#l;#u;#c;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),YF(this.#t,this.options)?this.#d():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return dC(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return dC(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#w(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Wi(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#I(),this.#t.setOptions(this.options),e._defaulted&&!oC(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&ZF(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),r&&(this.#t!==n||Wi(this.options.enabled,this.#t)!==Wi(e.enabled,this.#t)||ll(this.options.staleTime,this.#t)!==ll(e.staleTime,this.#t))&&this.#g();const s=this.#y();r&&(this.#t!==n||Wi(this.options.enabled,this.#t)!==Wi(e.enabled,this.#t)||s!==this.#c)&&this.#v(s)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return ZJ(this,n)&&(this.#s=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#s}trackResult(t,e){return new Proxy(t,{get:(n,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,r))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#d(t){this.#I();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Vs)),e}#g(){this.#w();const t=ll(this.options.staleTime,this.#t);if(Uu||this.#s.isStale||!iC(t))return;const n=Uz(this.#s.dataUpdatedAt,t)+1;this.#l=Su.setTimeout(()=>{this.#s.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#x(),this.#c=t,!(Uu||Wi(this.options.enabled,this.#t)===!1||!iC(this.#c)||this.#c===0)&&(this.#u=Su.setInterval(()=>{(this.options.refetchIntervalInBackground||MA.isFocused())&&this.#d()},this.#c))}#b(){this.#g(),this.#v(this.#y())}#w(){this.#l&&(Su.clearTimeout(this.#l),this.#l=void 0)}#x(){this.#u&&(Su.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,r=this.options,s=this.#s,i=this.#r,o=this.#a,c=t!==n?t.state:this.#n,{state:l}=t;let u={...l},d=!1,h;if(e._optimisticResults){const N=this.hasListeners(),P=!N&&YF(t,e),O=N&&ZF(t,n,e,r);(P||O)&&(u={...u,...qz(l.data,t.options)}),e._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:m,errorUpdatedAt:g,status:v}=u;h=u.data;let y=!1;if(e.placeholderData!==void 0&&h===void 0&&v==="pending"){let N;s?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(N=s.data,y=!0):N=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,N!==void 0&&(v="success",h=cC(s?.data,N,e),d=!0)}if(e.select&&h!==void 0&&!y)if(s&&h===i?.data&&e.select===this.#m)h=this.#f;else try{this.#m=e.select,h=e.select(h),h=cC(s?.data,h,e),this.#f=h,this.#i=null}catch(N){this.#i=N}this.#i&&(m=this.#i,h=this.#f,g=Date.now(),v="error");const w=u.fetchStatus==="fetching",x=v==="pending",S=v==="error",k=x&&w,E=h!==void 0,R={status:v,fetchStatus:u.fetchStatus,isPending:x,isSuccess:v==="success",isError:S,isInitialLoading:k,isLoading:k,data:h,dataUpdatedAt:u.dataUpdatedAt,error:m,errorUpdatedAt:g,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>c.dataUpdateCount||u.errorUpdateCount>c.errorUpdateCount,isFetching:w,isRefetching:w&&!x,isLoadingError:S&&!E,isPaused:u.fetchStatus==="paused",isPlaceholderData:d,isRefetchError:S&&E,isStale:zA(t,e),refetch:this.refetch,promise:this.#o,isEnabled:Wi(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const N=_=>{R.status==="error"?_.reject(R.error):R.data!==void 0&&_.resolve(R.data)},P=()=>{const _=this.#o=R.promise=lC();N(_)},O=this.#o;switch(O.status){case"pending":t.queryHash===n.queryHash&&N(O);break;case"fulfilled":(R.status==="error"||R.data!==O.value)&&P();break;case"rejected":(R.status!=="error"||R.error!==O.reason)&&P();break}}return R}updateResult(){const t=this.#s,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#h=this.#t),oC(e,t))return;this.#s=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,s=typeof r=="function"?r():r;if(s==="all"||!s&&!this.#p.size)return!0;const i=new Set(s??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#s).some(o=>{const a=o;return this.#s[a]!==t[a]&&i.has(a)})};this.#S({listeners:n()})}#I(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#S(t){Xr.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#s)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function YJ(t,e){return Wi(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function YF(t,e){return YJ(t,e)||t.state.data!==void 0&&dC(t,e,e.refetchOnMount)}function dC(t,e,n){if(Wi(e.enabled,t)!==!1&&ll(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&zA(t,e)}return!1}function ZF(t,e,n,r){return(t!==e||Wi(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&zA(t,n)}function zA(t,e){return Wi(e.enabled,t)!==!1&&t.isStaleByTime(ll(e.staleTime,t))}function ZJ(t,e){return!oC(t.getCurrentResult(),e)}function JF(t){return{onFetch:(e,n)=>{const r=e.options,s=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let a={pages:[],pageParams:[]},c=0;const l=async()=>{let u=!1;const d=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(e.signal.aborted?u=!0:e.signal.addEventListener("abort",()=>{u=!0}),e.signal)})},h=jz(e.options,e.fetchOptions),m=async(g,v,y)=>{if(u)return Promise.reject();if(v==null&&g.pages.length)return Promise.resolve(g);const x=(()=>{const A={client:e.client,queryKey:e.queryKey,pageParam:v,direction:y?"backward":"forward",meta:e.options.meta};return d(A),A})(),S=await h(x),{maxPages:k}=e.options,E=y?VJ:UJ;return{pages:E(g.pages,S,k),pageParams:E(g.pageParams,v,k)}};if(s&&i.length){const g=s==="backward",v=g?JJ:e3,y={pages:i,pageParams:o},w=v(r,y);a=await m(y,w,g)}else{const g=t??i.length;do{const v=c===0?o[0]??r.initialPageParam:e3(r,a);if(c>0&&v==null)break;a=await m(a,v),c++}while(c<g)}return a};e.options.persister?e.fetchFn=()=>e.options.persister?.(l,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=l}}}function e3(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function JJ(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var eee=class extends Gz{#e;#t;#n;#s;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||tee(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=Wz({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(i,o)=>{this.#r({type:"failed",failureCount:i,error:o})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",s=!this.#s.canStart();try{if(r)e();else{this.#r({type:"pending",variables:t,isPaused:s}),await this.#n.config.onMutate?.(t,this,n);const o=await this.options.onMutate?.(t,n);o!==this.state.context&&this.#r({type:"pending",context:o,variables:t,isPaused:s})}const i=await this.#s.start();return await this.#n.config.onSuccess?.(i,t,this.state.context,this,n),await this.options.onSuccess?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(i,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(i,null,t,this.state.context,n),this.#r({type:"success",data:i}),i}catch(i){try{throw await this.#n.config.onError?.(i,t,this.state.context,this,n),await this.options.onError?.(i,t,this.state.context,n),await this.#n.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,i,t,this.state.context,n),i}finally{this.#r({type:"error",error:i})}}finally{this.#n.runNext(this)}}#r(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Xr.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function tee(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nee=class extends Qg{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const r=new eee({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(r),r}add(t){this.#e.add(t);const e=Wv(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Wv(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Wv(t);if(typeof e=="string"){const r=this.#t.get(e)?.find(s=>s.state.status==="pending");return!r||r===t}else return!0}runNext(t){const e=Wv(t);return typeof e=="string"?this.#t.get(e)?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Xr.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>qF(e,n))}findAll(t={}){return this.getAll().filter(e=>qF(t,e))}notify(t){Xr.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Xr.batch(()=>Promise.all(t.map(e=>e.continue().catch(Vs))))}};function Wv(t){return t.options.scope?.id}var ree=class extends Qg{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const r=e.queryKey,s=e.queryHash??LA(r,e);let i=this.get(s);return i||(i=new XJ({client:t,queryKey:r,queryHash:s,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(r)}),this.add(i)),i}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Xr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>GF(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>GF(t,n)):e}notify(t){Xr.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Xr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Xr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},see=class{#e;#t;#n;#s;#r;#a;#o;#i;constructor(t={}){this.#e=t.queryCache||new ree,this.#t=t.mutationCache||new nee,this.#n=t.defaultOptions||{},this.#s=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=MA.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=nw.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#i?.(),this.#i=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ll(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=this.#e.get(r.queryHash)?.state.data,o=BJ(e,i);if(o!==void 0)return this.#e.build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Xr.batch(()=>this.#e.findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Xr.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Xr.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Xr.batch(()=>this.#e.findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(Vs).catch(Vs)}invalidateQueries(t,e={}){return Xr.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Xr.batch(()=>this.#e.findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Vs)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Vs)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(ll(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Vs).catch(Vs)}fetchInfiniteQuery(t){return t.behavior=JF(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Vs).catch(Vs)}ensureInfiniteQueryData(t){return t.behavior=JF(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return nw.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#s.set(Hm(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#s.values()],n={};return e.forEach(r=>{Wm(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Hm(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(r=>{Wm(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=LA(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===BA&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Kz=z.createContext(void 0),iee=t=>{const e=z.useContext(Kz);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},oee=({client:t,children:e})=>(z.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),F.jsx(Kz.Provider,{value:t,children:e})),Xz=z.createContext(!1),aee=()=>z.useContext(Xz);Xz.Provider;function cee(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var lee=z.createContext(cee()),uee=()=>z.useContext(lee),dee=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},fee=t=>{z.useEffect(()=>{t.clearReset()},[t])},hee=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:s})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(s&&t.data===void 0||jJ(n,[t.error,r])),pee=t=>{if(t.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},mee=(t,e)=>t.isLoading&&t.isFetching&&!e,gee=(t,e)=>t?.suspense&&e.isPending,t3=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function yee(t,e,n){const r=aee(),s=uee(),i=iee(),o=i.defaultQueryOptions(t);i.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",pee(o),dee(o,s),fee(s);const a=!i.getQueryCache().get(o.queryHash),[c]=z.useState(()=>new e(i,o)),l=c.getOptimisticResult(o),u=!r&&t.subscribed!==!1;if(z.useSyncExternalStore(z.useCallback(d=>{const h=u?c.subscribe(Xr.batchCalls(d)):Vs;return c.updateResult(),h},[c,u]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),z.useEffect(()=>{c.setOptions(o)},[o,c]),gee(o,l))throw t3(o,c,s);if(hee({result:l,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw l.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(o,l),o.experimental_prefetchInRender&&!Uu&&mee(l,r)&&(a?t3(o,c,s):i.getQueryCache().get(o.queryHash)?.promise)?.catch(Vs).finally(()=>{c.updateResult()}),o.notifyOnChangeProps?l:c.trackResult(l)}function RE(t,e){return yee(t,QJ)}async function vee(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}const bee=({on401:t})=>async({queryKey:e})=>{const n=await fetch(e.join("/"),{credentials:"include"});return await vee(n),await n.json()},wee=new see({defaultOptions:{queries:{queryFn:bee({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),xee=1,Iee=1e6;let OE=0;function See(){return OE=(OE+1)%Number.MAX_SAFE_INTEGER,OE.toString()}const PE=new Map,n3=t=>{if(PE.has(t))return;const e=setTimeout(()=>{PE.delete(t),$m({type:"REMOVE_TOAST",toastId:t})},Iee);PE.set(t,e)},kee=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,xee)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?n3(n):t.toasts.forEach(r=>{n3(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},_b=[];let $b={toasts:[]};function $m(t){$b=kee($b,t),_b.forEach(e=>{e($b)})}function Eee({...t}){const e=See(),n=s=>$m({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>$m({type:"DISMISS_TOAST",toastId:e});return $m({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:n}}function Zx(){const[t,e]=z.useState($b);return z.useEffect(()=>(_b.push(e),()=>{const n=_b.indexOf(e);n>-1&&_b.splice(n,1)}),[t]),{...t,toast:Eee,dismiss:n=>$m({type:"DISMISS_TOAST",toastId:n})}}var Jx=$z();const Cee=Wo(Jx);function lt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t?.(s),n===!1||!s.defaultPrevented)return e?.(s)}}function r3(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function e1(...t){return e=>{let n=!1;const r=t.map(s=>{const i=r3(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():r3(t[s],null)}}}}function Lr(...t){return z.useCallback(e1(...t),t)}function Ol(t,e=[]){let n=[];function r(i,o){const a=z.createContext(o),c=n.length;n=[...n,o];const l=d=>{const{scope:h,children:m,...g}=d,v=h?.[t]?.[c]||a,y=z.useMemo(()=>g,Object.values(g));return F.jsx(v.Provider,{value:y,children:m})};l.displayName=i+"Provider";function u(d,h){const m=h?.[t]?.[c]||a,g=z.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[l,u]}const s=()=>{const i=n.map(o=>z.createContext(o));return function(a){const c=a?.[t]||i;return z.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return s.scopeName=t,[r,Tee(s,...e)]}function Tee(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:c,scopeName:l})=>{const d=c(i)[`__scope${l}`];return{...a,...d}},{});return z.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Gm(t){const e=Nee(t),n=z.forwardRef((r,s)=>{const{children:i,...o}=r,a=z.Children.toArray(i),c=a.find($ee);if(c){const l=c.props.children,u=a.map(d=>d===c?z.Children.count(l)>1?z.Children.only(null):z.isValidElement(l)?l.props.children:null:d);return F.jsx(e,{...o,ref:s,children:z.isValidElement(l)?z.cloneElement(l,void 0,u):null})}return F.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Aee=Gm("Slot");function Nee(t){const e=z.forwardRef((n,r)=>{const{children:s,...i}=n;if(z.isValidElement(s)){const o=Oee(s),a=Ree(i,s.props);return s.type!==z.Fragment&&(a.ref=r?e1(r,o):o),z.cloneElement(s,a)}return z.Children.count(s)>1?z.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Qz=Symbol("radix.slottable");function _ee(t){const e=({children:n})=>F.jsx(F.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=Qz,e}function $ee(t){return z.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Qz}function Ree(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{const c=i(...a);return s(...a),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Oee(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function UA(t){const e=t+"CollectionProvider",[n,r]=Ol(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:y,children:w}=v,x=tr.useRef(null),S=tr.useRef(new Map).current;return F.jsx(s,{scope:y,itemMap:S,collectionRef:x,children:w})};o.displayName=e;const a=t+"CollectionSlot",c=Gm(a),l=tr.forwardRef((v,y)=>{const{scope:w,children:x}=v,S=i(a,w),k=Lr(y,S.collectionRef);return F.jsx(c,{ref:k,children:x})});l.displayName=a;const u=t+"CollectionItemSlot",d="data-radix-collection-item",h=Gm(u),m=tr.forwardRef((v,y)=>{const{scope:w,children:x,...S}=v,k=tr.useRef(null),E=Lr(y,k),A=i(u,w);return tr.useEffect(()=>(A.itemMap.set(k,{ref:k,...S}),()=>void A.itemMap.delete(k))),F.jsx(h,{[d]:"",ref:E,children:x})});m.displayName=u;function g(v){const y=i(t+"CollectionConsumer",v);return tr.useCallback(()=>{const x=y.collectionRef.current;if(!x)return[];const S=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((A,R)=>S.indexOf(A.ref.current)-S.indexOf(R.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:l,ItemSlot:m},g,r]}var Pee=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],yn=Pee.reduce((t,e)=>{const n=Gm(`Primitive.${e}`),r=z.forwardRef((s,i)=>{const{asChild:o,...a}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),F.jsx(c,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function VA(t,e){t&&Jx.flushSync(()=>t.dispatchEvent(e))}function Si(t){const e=z.useRef(t);return z.useEffect(()=>{e.current=t}),z.useMemo(()=>(...n)=>e.current?.(...n),[])}function Dee(t,e=globalThis?.document){const n=Si(t);z.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Fee="DismissableLayer",fC="dismissableLayer.update",Lee="dismissableLayer.pointerDownOutside",Bee="dismissableLayer.focusOutside",s3,Yz=z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),t1=z.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...c}=t,l=z.useContext(Yz),[u,d]=z.useState(null),h=u?.ownerDocument??globalThis?.document,[,m]=z.useState({}),g=Lr(e,R=>d(R)),v=Array.from(l.layers),[y]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),w=v.indexOf(y),x=u?v.indexOf(u):-1,S=l.layersWithOutsidePointerEventsDisabled.size>0,k=x>=w,E=zee(R=>{const N=R.target,P=[...l.branches].some(O=>O.contains(N));!k||P||(s?.(R),o?.(R),R.defaultPrevented||a?.())},h),A=Uee(R=>{const N=R.target;[...l.branches].some(O=>O.contains(N))||(i?.(R),o?.(R),R.defaultPrevented||a?.())},h);return Dee(R=>{x===l.layers.size-1&&(r?.(R),!R.defaultPrevented&&a&&(R.preventDefault(),a()))},h),z.useEffect(()=>{if(u)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(s3=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),i3(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=s3)}},[u,h,n,l]),z.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),i3())},[u,l]),z.useEffect(()=>{const R=()=>m({});return document.addEventListener(fC,R),()=>document.removeEventListener(fC,R)},[]),F.jsx(yn.div,{...c,ref:g,style:{pointerEvents:S?k?"auto":"none":void 0,...t.style},onFocusCapture:lt(t.onFocusCapture,A.onFocusCapture),onBlurCapture:lt(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:lt(t.onPointerDownCapture,E.onPointerDownCapture)})});t1.displayName=Fee;var Mee="DismissableLayerBranch",Zz=z.forwardRef((t,e)=>{const n=z.useContext(Yz),r=z.useRef(null),s=Lr(e,r);return z.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),F.jsx(yn.div,{...t,ref:s})});Zz.displayName=Mee;function zee(t,e=globalThis?.document){const n=Si(t),r=z.useRef(!1),s=z.useRef(()=>{});return z.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let c=function(){Jz(Lee,n,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Uee(t,e=globalThis?.document){const n=Si(t),r=z.useRef(!1);return z.useEffect(()=>{const s=i=>{i.target&&!r.current&&Jz(Bee,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function i3(){const t=new CustomEvent(fC);document.dispatchEvent(t)}function Jz(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?VA(s,i):s.dispatchEvent(i)}var Vee=t1,jee=Zz,cc=globalThis?.document?z.useLayoutEffect:()=>{},Hee="Portal",jA=z.forwardRef((t,e)=>{const{container:n,...r}=t,[s,i]=z.useState(!1);cc(()=>i(!0),[]);const o=n||s&&globalThis?.document?.body;return o?Cee.createPortal(F.jsx(yn.div,{...r,ref:e}),o):null});jA.displayName=Hee;function Wee(t,e){return z.useReducer((n,r)=>e[n][r]??n,t)}var gd=t=>{const{present:e,children:n}=t,r=Gee(e),s=typeof n=="function"?n({present:r.isPresent}):z.Children.only(n),i=Lr(r.ref,qee(s));return typeof n=="function"||r.isPresent?z.cloneElement(s,{ref:i}):null};gd.displayName="Presence";function Gee(t){const[e,n]=z.useState(),r=z.useRef(null),s=z.useRef(t),i=z.useRef("none"),o=t?"mounted":"unmounted",[a,c]=Wee(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return z.useEffect(()=>{const l=Gv(r.current);i.current=a==="mounted"?l:"none"},[a]),cc(()=>{const l=r.current,u=s.current;if(u!==t){const h=i.current,m=Gv(l);t?c("MOUNT"):m==="none"||l?.display==="none"?c("UNMOUNT"):c(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),cc(()=>{if(e){let l;const u=e.ownerDocument.defaultView??window,d=m=>{const v=Gv(r.current).includes(CSS.escape(m.animationName));if(m.target===e&&v&&(c("ANIMATION_END"),!s.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",l=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},h=m=>{m.target===e&&(i.current=Gv(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(l),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:z.useCallback(l=>{r.current=l?getComputedStyle(l):null,n(l)},[])}}function Gv(t){return t?.animationName||"none"}function qee(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Kee=OA[" useInsertionEffect ".trim().toString()]||cc;function HA({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=Xee({defaultProp:e,onChange:n}),a=t!==void 0,c=a?t:s;{const u=z.useRef(t!==void 0);z.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const l=z.useCallback(u=>{if(a){const d=Qee(u)?u(t):u;d!==t&&o.current?.(d)}else i(u)},[a,t,i,o]);return[c,l]}function Xee({defaultProp:t,onChange:e}){const[n,r]=z.useState(t),s=z.useRef(n),i=z.useRef(e);return Kee(()=>{i.current=e},[e]),z.useEffect(()=>{s.current!==n&&(i.current?.(n),s.current=n)},[n,s]),[n,r,i]}function Qee(t){return typeof t=="function"}var Yee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Zee="VisuallyHidden",n1=z.forwardRef((t,e)=>F.jsx(yn.span,{...t,ref:e,style:{...Yee,...t.style}}));n1.displayName=Zee;var Jee=n1,WA="ToastProvider",[GA,ete,tte]=UA("Toast"),[eU]=Ol("Toast",[tte]),[nte,r1]=eU(WA),tU=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[a,c]=z.useState(null),[l,u]=z.useState(0),d=z.useRef(!1),h=z.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${WA}\`. Expected non-empty \`string\`.`),F.jsx(GA.Provider,{scope:e,children:F.jsx(nte,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:l,viewport:a,onViewportChange:c,onToastAdd:z.useCallback(()=>u(m=>m+1),[]),onToastRemove:z.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:o})})};tU.displayName=WA;var nU="ToastViewport",rte=["F8"],hC="toast.viewportPause",pC="toast.viewportResume",rU=z.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=rte,label:s="Notifications ({hotkey})",...i}=t,o=r1(nU,n),a=ete(n),c=z.useRef(null),l=z.useRef(null),u=z.useRef(null),d=z.useRef(null),h=Lr(e,d,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;z.useEffect(()=>{const y=w=>{r.length!==0&&r.every(S=>w[S]||w.code===S)&&d.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),z.useEffect(()=>{const y=c.current,w=d.current;if(g&&y&&w){const x=()=>{if(!o.isClosePausedRef.current){const A=new CustomEvent(hC);w.dispatchEvent(A),o.isClosePausedRef.current=!0}},S=()=>{if(o.isClosePausedRef.current){const A=new CustomEvent(pC);w.dispatchEvent(A),o.isClosePausedRef.current=!1}},k=A=>{!y.contains(A.relatedTarget)&&S()},E=()=>{y.contains(document.activeElement)||S()};return y.addEventListener("focusin",x),y.addEventListener("focusout",k),y.addEventListener("pointermove",x),y.addEventListener("pointerleave",E),window.addEventListener("blur",x),window.addEventListener("focus",S),()=>{y.removeEventListener("focusin",x),y.removeEventListener("focusout",k),y.removeEventListener("pointermove",x),y.removeEventListener("pointerleave",E),window.removeEventListener("blur",x),window.removeEventListener("focus",S)}}},[g,o.isClosePausedRef]);const v=z.useCallback(({tabbingDirection:y})=>{const x=a().map(S=>{const k=S.ref.current,E=[k,...gte(k)];return y==="forwards"?E:E.reverse()});return(y==="forwards"?x.reverse():x).flat()},[a]);return z.useEffect(()=>{const y=d.current;if(y){const w=x=>{const S=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!S){const E=document.activeElement,A=x.shiftKey;if(x.target===y&&A){l.current?.focus();return}const P=v({tabbingDirection:A?"backwards":"forwards"}),O=P.findIndex(_=>_===E);DE(P.slice(O+1))?x.preventDefault():A?l.current?.focus():u.current?.focus()}};return y.addEventListener("keydown",w),()=>y.removeEventListener("keydown",w)}},[a,v]),F.jsxs(jee,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&F.jsx(mC,{ref:l,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"forwards"});DE(y)}}),F.jsx(GA.Slot,{scope:n,children:F.jsx(yn.ol,{tabIndex:-1,...i,ref:h})}),g&&F.jsx(mC,{ref:u,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"backwards"});DE(y)}})]})});rU.displayName=nU;var sU="ToastFocusProxy",mC=z.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=r1(sU,n);return F.jsx(n1,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{const a=o.relatedTarget;!i.viewport?.contains(a)&&r()}})});mC.displayName=sU;var Yg="Toast",ste="toast.swipeStart",ite="toast.swipeMove",ote="toast.swipeCancel",ate="toast.swipeEnd",iU=z.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[a,c]=HA({prop:r,defaultProp:s??!0,onChange:i,caller:Yg});return F.jsx(gd,{present:n||a,children:F.jsx(ute,{open:a,...o,ref:e,onClose:()=>c(!1),onPause:Si(t.onPause),onResume:Si(t.onResume),onSwipeStart:lt(t.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:lt(t.onSwipeMove,l=>{const{x:u,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:lt(t.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:lt(t.onSwipeEnd,l=>{const{x:u,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),c(!1)})})})});iU.displayName=Yg;var[cte,lte]=eU(Yg,{onClose(){}}),ute=z.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:c,onResume:l,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:m,...g}=t,v=r1(Yg,n),[y,w]=z.useState(null),x=Lr(e,q=>w(q)),S=z.useRef(null),k=z.useRef(null),E=s||v.duration,A=z.useRef(0),R=z.useRef(E),N=z.useRef(0),{onToastAdd:P,onToastRemove:O}=v,_=Si(()=>{y?.contains(document.activeElement)&&v.viewport?.focus(),o()}),M=z.useCallback(q=>{!q||q===1/0||(window.clearTimeout(N.current),A.current=new Date().getTime(),N.current=window.setTimeout(_,q))},[_]);z.useEffect(()=>{const q=v.viewport;if(q){const D=()=>{M(R.current),l?.()},L=()=>{const K=new Date().getTime()-A.current;R.current=R.current-K,window.clearTimeout(N.current),c?.()};return q.addEventListener(hC,L),q.addEventListener(pC,D),()=>{q.removeEventListener(hC,L),q.removeEventListener(pC,D)}}},[v.viewport,E,c,l,M]),z.useEffect(()=>{i&&!v.isClosePausedRef.current&&M(E)},[i,E,v.isClosePausedRef,M]),z.useEffect(()=>(P(),()=>O()),[P,O]);const G=z.useMemo(()=>y?fU(y):null,[y]);return v.viewport?F.jsxs(F.Fragment,{children:[G&&F.jsx(dte,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:G}),F.jsx(cte,{scope:n,onClose:_,children:Jx.createPortal(F.jsx(GA.ItemSlot,{scope:n,children:F.jsx(Vee,{asChild:!0,onEscapeKeyDown:lt(a,()=>{v.isFocusedToastEscapeKeyDownRef.current||_(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:F.jsx(yn.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...g,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:lt(t.onKeyDown,q=>{q.key==="Escape"&&(a?.(q.nativeEvent),q.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,_()))}),onPointerDown:lt(t.onPointerDown,q=>{q.button===0&&(S.current={x:q.clientX,y:q.clientY})}),onPointerMove:lt(t.onPointerMove,q=>{if(!S.current)return;const D=q.clientX-S.current.x,L=q.clientY-S.current.y,K=!!k.current,j=["left","right"].includes(v.swipeDirection),W=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,X=j?W(0,D):0,H=j?0:W(0,L),Y=q.pointerType==="touch"?10:2,ce={x:X,y:H},de={originalEvent:q,delta:ce};K?(k.current=ce,qv(ite,d,de,{discrete:!1})):o3(ce,v.swipeDirection,Y)?(k.current=ce,qv(ste,u,de,{discrete:!1}),q.target.setPointerCapture(q.pointerId)):(Math.abs(D)>Y||Math.abs(L)>Y)&&(S.current=null)}),onPointerUp:lt(t.onPointerUp,q=>{const D=k.current,L=q.target;if(L.hasPointerCapture(q.pointerId)&&L.releasePointerCapture(q.pointerId),k.current=null,S.current=null,D){const K=q.currentTarget,j={originalEvent:q,delta:D};o3(D,v.swipeDirection,v.swipeThreshold)?qv(ate,m,j,{discrete:!0}):qv(ote,h,j,{discrete:!0}),K.addEventListener("click",W=>W.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),dte=t=>{const{__scopeToast:e,children:n,...r}=t,s=r1(Yg,e),[i,o]=z.useState(!1),[a,c]=z.useState(!1);return pte(()=>o(!0)),z.useEffect(()=>{const l=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(l)},[]),a?null:F.jsx(jA,{asChild:!0,children:F.jsx(n1,{...r,children:i&&F.jsxs(F.Fragment,{children:[s.label," ",n]})})})},fte="ToastTitle",oU=z.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return F.jsx(yn.div,{...r,ref:e})});oU.displayName=fte;var hte="ToastDescription",aU=z.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return F.jsx(yn.div,{...r,ref:e})});aU.displayName=hte;var cU="ToastAction",lU=z.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?F.jsx(dU,{altText:n,asChild:!0,children:F.jsx(qA,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${cU}\`. Expected non-empty \`string\`.`),null)});lU.displayName=cU;var uU="ToastClose",qA=z.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=lte(uU,n);return F.jsx(dU,{asChild:!0,children:F.jsx(yn.button,{type:"button",...r,ref:e,onClick:lt(t.onClick,s.onClose)})})});qA.displayName=uU;var dU=z.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return F.jsx(yn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function fU(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),mte(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...fU(r))}}),e}function qv(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?VA(s,i):s.dispatchEvent(i)}var o3=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function pte(t=()=>{}){const e=Si(t);cc(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function mte(t){return t.nodeType===t.ELEMENT_NODE}function gte(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function DE(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var yte=tU,hU=rU,pU=iU,mU=oU,gU=aU,yU=lU,vU=qA;function bU(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=bU(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function wU(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=bU(t))&&(r&&(r+=" "),r+=e);return r}const a3=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,c3=wU,Zg=(t,e)=>n=>{var r;if(e?.variants==null)return c3(t,n?.class,n?.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(l=>{const u=n?.[l],d=i?.[l];if(u===null)return null;const h=a3(u)||a3(d);return s[l][h]}),a=n&&Object.entries(n).reduce((l,u)=>{let[d,h]=u;return h===void 0||(l[d]=h),l},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((l,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(g=>{let[v,y]=g;return Array.isArray(y)?y.includes({...i,...a}[v]):{...i,...a}[v]===y})?[...l,d,h]:l},[]);return c3(t,o,c,n?.class,n?.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xU=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bte={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=z.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},c)=>z.createElement("svg",{ref:c,...bte,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:xU("lucide",s),...a},[...o.map(([l,u])=>z.createElement(l,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=(t,e)=>{const n=z.forwardRef(({className:r,...s},i)=>z.createElement(wte,{ref:i,iconNode:e,className:xU(`lucide-${vte(t)}`,r),...s}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=Vn("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=Vn("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=Vn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=Vn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IU=Vn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=Vn("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=Vn("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=Vn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=Vn("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=Vn("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SU=Vn("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=Vn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=Vn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=Vn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=Vn("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=Vn("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=Vn("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=Vn("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=Vn("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=Vn("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=Vn("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=Vn("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pte=Vn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),KA="-",Dte=t=>{const e=Lte(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(KA);return a[0]===""&&a.length!==1&&a.shift(),kU(a,e)||Fte(o)},getConflictingClassGroupIds:(o,a)=>{const c=n[o]||[];return a&&r[o]?[...c,...r[o]]:c}}},kU=(t,e)=>{if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?kU(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(KA);return e.validators.find(({validator:o})=>o(i))?.classGroupId},f3=/^\[(.+)\]$/,Fte=t=>{if(f3.test(t)){const e=f3.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Lte=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return Mte(Object.entries(t.classGroups),n).forEach(([i,o])=>{vC(o,r,i,e)}),r},vC=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:h3(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(Bte(s)){vC(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{vC(o,h3(e,i),n,r)})})},h3=(t,e)=>{let n=t;return e.split(KA).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Bte=t=>t.isThemeGetter,Mte=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,s]}):t,zte=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},EU="!",Ute=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,o=a=>{const c=[];let l=0,u=0,d;for(let y=0;y<a.length;y++){let w=a[y];if(l===0){if(w===s&&(r||a.slice(y,y+i)===e)){c.push(a.slice(u,y)),u=y+i;continue}if(w==="/"){d=y;continue}}w==="["?l++:w==="]"&&l--}const h=c.length===0?a:a.substring(u),m=h.startsWith(EU),g=m?h.substring(1):h,v=d&&d>u?d-u:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:v}};return n?a=>n({className:a,parseClassName:o}):o},Vte=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},jte=t=>({cache:zte(t.cacheSize),parseClassName:Ute(t),...Dte(t)}),Hte=/\s+/,Wte=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(Hte);let a="";for(let c=o.length-1;c>=0;c-=1){const l=o[c],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:m}=n(l);let g=!!m,v=r(g?h.substring(0,m):h);if(!v){if(!g){a=l+(a.length>0?" "+a:a);continue}if(v=r(h),!v){a=l+(a.length>0?" "+a:a);continue}g=!1}const y=Vte(u).join(":"),w=d?y+EU:y,x=w+v;if(i.includes(x))continue;i.push(x);const S=s(v,g);for(let k=0;k<S.length;++k){const E=S[k];i.push(w+E)}a=l+(a.length>0?" "+a:a)}return a};function Gte(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=CU(e))&&(r&&(r+=" "),r+=n);return r}const CU=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=CU(t[r]))&&(n&&(n+=" "),n+=e);return n};function qte(t,...e){let n,r,s,i=o;function o(c){const l=e.reduce((u,d)=>d(u),t());return n=jte(l),r=n.cache.get,s=n.cache.set,i=a,a(c)}function a(c){const l=r(c);if(l)return l;const u=Wte(c,n);return s(c,u),u}return function(){return i(Gte.apply(null,arguments))}}const wn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},TU=/^\[(?:([a-z-]+):)?(.+)\]$/i,Kte=/^\d+\/\d+$/,Xte=new Set(["px","full","screen"]),Qte=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yte=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Zte=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Jte=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ene=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Va=t=>Mf(t)||Xte.has(t)||Kte.test(t),Qc=t=>$h(t,"length",cne),Mf=t=>!!t&&!Number.isNaN(Number(t)),FE=t=>$h(t,"number",Mf),Qp=t=>!!t&&Number.isInteger(Number(t)),tne=t=>t.endsWith("%")&&Mf(t.slice(0,-1)),Et=t=>TU.test(t),Yc=t=>Qte.test(t),nne=new Set(["length","size","percentage"]),rne=t=>$h(t,nne,AU),sne=t=>$h(t,"position",AU),ine=new Set(["image","url"]),one=t=>$h(t,ine,une),ane=t=>$h(t,"",lne),Yp=()=>!0,$h=(t,e,n)=>{const r=TU.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},cne=t=>Yte.test(t)&&!Zte.test(t),AU=()=>!1,lne=t=>Jte.test(t),une=t=>ene.test(t),dne=()=>{const t=wn("colors"),e=wn("spacing"),n=wn("blur"),r=wn("brightness"),s=wn("borderColor"),i=wn("borderRadius"),o=wn("borderSpacing"),a=wn("borderWidth"),c=wn("contrast"),l=wn("grayscale"),u=wn("hueRotate"),d=wn("invert"),h=wn("gap"),m=wn("gradientColorStops"),g=wn("gradientColorStopPositions"),v=wn("inset"),y=wn("margin"),w=wn("opacity"),x=wn("padding"),S=wn("saturate"),k=wn("scale"),E=wn("sepia"),A=wn("skew"),R=wn("space"),N=wn("translate"),P=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto",Et,e],M=()=>[Et,e],G=()=>["",Va,Qc],q=()=>["auto",Mf,Et],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],L=()=>["solid","dashed","dotted","double","none"],K=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],j=()=>["start","end","center","between","around","evenly","stretch"],W=()=>["","0",Et],X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[Mf,Et];return{cacheSize:500,separator:":",theme:{colors:[Yp],spacing:[Va,Qc],blur:["none","",Yc,Et],brightness:H(),borderColor:[t],borderRadius:["none","","full",Yc,Et],borderSpacing:M(),borderWidth:G(),contrast:H(),grayscale:W(),hueRotate:H(),invert:W(),gap:M(),gradientColorStops:[t],gradientColorStopPositions:[tne,Qc],inset:_(),margin:_(),opacity:H(),padding:M(),saturate:H(),scale:H(),sepia:W(),skew:H(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",Et]}],container:["container"],columns:[{columns:[Yc]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),Et]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qp,Et]}],basis:[{basis:_()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Et]}],grow:[{grow:W()}],shrink:[{shrink:W()}],order:[{order:["first","last","none",Qp,Et]}],"grid-cols":[{"grid-cols":[Yp]}],"col-start-end":[{col:["auto",{span:["full",Qp,Et]},Et]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[Yp]}],"row-start-end":[{row:["auto",{span:[Qp,Et]},Et]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Et]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Et]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...j()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...j(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...j(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Et,e]}],"min-w":[{"min-w":[Et,e,"min","max","fit"]}],"max-w":[{"max-w":[Et,e,"none","full","min","max","fit","prose",{screen:[Yc]},Yc]}],h:[{h:[Et,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Et,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Et,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Et,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Yc,Qc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",FE]}],"font-family":[{font:[Yp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Et]}],"line-clamp":[{"line-clamp":["none",Mf,FE]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Va,Et]}],"list-image":[{"list-image":["none",Et]}],"list-style-type":[{list:["none","disc","decimal",Et]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Va,Qc]}],"underline-offset":[{"underline-offset":["auto",Va,Et]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Et]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Et]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),sne]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",rne]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},one]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...L(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:L()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...L()]}],"outline-offset":[{"outline-offset":[Va,Et]}],"outline-w":[{outline:[Va,Qc]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[Va,Qc]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Yc,ane]}],"shadow-color":[{shadow:[Yp]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...K(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":K()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Yc,Et]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[S]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Et]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",Et]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",Et]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Qp,Et]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Et]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Et]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Et]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Va,Qc,FE]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},fne=qte(dne);function sn(...t){return fne(wU(t))}const hne=yte,NU=z.forwardRef(({className:t,...e},n)=>F.jsx(hU,{ref:n,className:sn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));NU.displayName=hU.displayName;const pne=Zg("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),_U=z.forwardRef(({className:t,variant:e,...n},r)=>F.jsx(pU,{ref:r,className:sn(pne({variant:e}),t),...n}));_U.displayName=pU.displayName;const mne=z.forwardRef(({className:t,...e},n)=>F.jsx(yU,{ref:n,className:sn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));mne.displayName=yU.displayName;const $U=z.forwardRef(({className:t,...e},n)=>F.jsx(vU,{ref:n,className:sn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:F.jsx(Pte,{className:"h-4 w-4"})}));$U.displayName=vU.displayName;const RU=z.forwardRef(({className:t,...e},n)=>F.jsx(mU,{ref:n,className:sn("text-sm font-semibold",t),...e}));RU.displayName=mU.displayName;const OU=z.forwardRef(({className:t,...e},n)=>F.jsx(gU,{ref:n,className:sn("text-sm opacity-90",t),...e}));OU.displayName=gU.displayName;function gne(){const{toasts:t}=Zx();return F.jsxs(hne,{children:[t.map(function({id:e,title:n,description:r,action:s,...i}){return F.jsxs(_U,{...i,children:[F.jsxs("div",{className:"grid gap-1",children:[n&&F.jsx(RU,{children:n}),r&&F.jsx(OU,{children:r})]}),s,F.jsx($U,{})]},e)}),F.jsx(NU,{})]})}var yne=OA[" useId ".trim().toString()]||(()=>{}),vne=0;function bC(t){const[e,n]=z.useState(yne());return cc(()=>{n(r=>r??String(vne++))},[t]),e?`radix-${e}`:""}const bne=["top","right","bottom","left"],pl=Math.min,pi=Math.max,rw=Math.round,Kv=Math.floor,ga=t=>({x:t,y:t}),wne={left:"right",right:"left",bottom:"top",top:"bottom"},xne={start:"end",end:"start"};function wC(t,e,n){return pi(t,pl(e,n))}function lc(t,e){return typeof t=="function"?t(e):t}function uc(t){return t.split("-")[0]}function Rh(t){return t.split("-")[1]}function XA(t){return t==="x"?"y":"x"}function QA(t){return t==="y"?"height":"width"}const Ine=new Set(["top","bottom"]);function ha(t){return Ine.has(uc(t))?"y":"x"}function YA(t){return XA(ha(t))}function Sne(t,e,n){n===void 0&&(n=!1);const r=Rh(t),s=YA(t),i=QA(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=sw(o)),[o,sw(o)]}function kne(t){const e=sw(t);return[xC(t),e,xC(e)]}function xC(t){return t.replace(/start|end/g,e=>xne[e])}const p3=["left","right"],m3=["right","left"],Ene=["top","bottom"],Cne=["bottom","top"];function Tne(t,e,n){switch(t){case"top":case"bottom":return n?e?m3:p3:e?p3:m3;case"left":case"right":return e?Ene:Cne;default:return[]}}function Ane(t,e,n,r){const s=Rh(t);let i=Tne(uc(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(xC)))),i}function sw(t){return t.replace(/left|right|bottom|top/g,e=>wne[e])}function Nne(t){return{top:0,right:0,bottom:0,left:0,...t}}function PU(t){return typeof t!="number"?Nne(t):{top:t,right:t,bottom:t,left:t}}function iw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function g3(t,e,n){let{reference:r,floating:s}=t;const i=ha(e),o=YA(e),a=QA(o),c=uc(e),l=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[a]/2-s[a]/2;let m;switch(c){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Rh(e)){case"start":m[o]-=h*(n&&l?-1:1);break;case"end":m[o]+=h*(n&&l?-1:1);break}return m}const _ne=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:d}=g3(l,r,c),h=r,m={},g=0;for(let v=0;v<a.length;v++){const{name:y,fn:w}=a[v],{x,y:S,data:k,reset:E}=await w({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:l,platform:o,elements:{reference:t,floating:e}});u=x??u,d=S??d,m={...m,[y]:{...m[y],...k}},E&&g<=50&&(g++,typeof E=="object"&&(E.placement&&(h=E.placement),E.rects&&(l=E.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):E.rects),{x:u,y:d}=g3(l,h,c)),v=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function qm(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=lc(e,t),g=PU(m),y=a[h?d==="floating"?"reference":"floating":d],w=iw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),x=d==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),k=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},E=iw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:S,strategy:c}):x);return{top:(w.top-E.top+g.top)/k.y,bottom:(E.bottom-w.bottom+g.bottom)/k.y,left:(w.left-E.left+g.left)/k.x,right:(E.right-w.right+g.right)/k.x}}const $ne=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:c}=e,{element:l,padding:u=0}=lc(t,e)||{};if(l==null)return{};const d=PU(u),h={x:n,y:r},m=YA(s),g=QA(m),v=await o.getDimensions(l),y=m==="y",w=y?"top":"left",x=y?"bottom":"right",S=y?"clientHeight":"clientWidth",k=i.reference[g]+i.reference[m]-h[m]-i.floating[g],E=h[m]-i.reference[m],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l));let R=A?A[S]:0;(!R||!await(o.isElement==null?void 0:o.isElement(A)))&&(R=a.floating[S]||i.floating[g]);const N=k/2-E/2,P=R/2-v[g]/2-1,O=pl(d[w],P),_=pl(d[x],P),M=O,G=R-v[g]-_,q=R/2-v[g]/2+N,D=wC(M,q,G),L=!c.arrow&&Rh(s)!=null&&q!==D&&i.reference[g]/2-(q<M?O:_)-v[g]/2<0,K=L?q<M?q-M:q-G:0;return{[m]:h[m]+K,data:{[m]:D,centerOffset:q-D-K,...L&&{alignmentOffset:K}},reset:L}}}),Rne=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0,...y}=lc(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const w=uc(s),x=ha(a),S=uc(a)===a,k=await(c.isRTL==null?void 0:c.isRTL(l.floating)),E=h||(S||!v?[sw(a)]:kne(a)),A=g!=="none";!h&&A&&E.push(...Ane(a,v,g,k));const R=[a,...E],N=await qm(e,y),P=[];let O=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&P.push(N[w]),d){const q=Sne(s,o,k);P.push(N[q[0]],N[q[1]])}if(O=[...O,{placement:s,overflows:P}],!P.every(q=>q<=0)){var _,M;const q=(((_=i.flip)==null?void 0:_.index)||0)+1,D=R[q];if(D&&(!(d==="alignment"?x!==ha(D):!1)||O.every(j=>ha(j.placement)===x?j.overflows[0]>0:!0)))return{data:{index:q,overflows:O},reset:{placement:D}};let L=(M=O.filter(K=>K.overflows[0]<=0).sort((K,j)=>K.overflows[1]-j.overflows[1])[0])==null?void 0:M.placement;if(!L)switch(m){case"bestFit":{var G;const K=(G=O.filter(j=>{if(A){const W=ha(j.placement);return W===x||W==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(W=>W>0).reduce((W,X)=>W+X,0)]).sort((j,W)=>j[1]-W[1])[0])==null?void 0:G[0];K&&(L=K);break}case"initialPlacement":L=a;break}if(s!==L)return{reset:{placement:L}}}return{}}}};function y3(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function v3(t){return bne.some(e=>t[e]>=0)}const One=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=lc(t,e);switch(r){case"referenceHidden":{const i=await qm(e,{...s,elementContext:"reference"}),o=y3(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:v3(o)}}}case"escaped":{const i=await qm(e,{...s,altBoundary:!0}),o=y3(i,n.floating);return{data:{escapedOffsets:o,escaped:v3(o)}}}default:return{}}}}},DU=new Set(["left","top"]);async function Pne(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=uc(n),a=Rh(n),c=ha(n)==="y",l=DU.has(o)?-1:1,u=i&&c?-1:1,d=lc(e,t);let{mainAxis:h,crossAxis:m,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&typeof g=="number"&&(m=a==="end"?g*-1:g),c?{x:m*u,y:h*l}:{x:h*l,y:m*u}}const Dne=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,c=await Pne(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},Fne=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x:w,y:x}=y;return{x:w,y:x}}},...c}=lc(t,e),l={x:n,y:r},u=await qm(e,c),d=ha(uc(s)),h=XA(d);let m=l[h],g=l[d];if(i){const y=h==="y"?"top":"left",w=h==="y"?"bottom":"right",x=m+u[y],S=m-u[w];m=wC(x,m,S)}if(o){const y=d==="y"?"top":"left",w=d==="y"?"bottom":"right",x=g+u[y],S=g-u[w];g=wC(x,g,S)}const v=a.fn({...e,[h]:m,[d]:g});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[h]:i,[d]:o}}}}}},Lne=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:c=!0,crossAxis:l=!0}=lc(t,e),u={x:n,y:r},d=ha(s),h=XA(d);let m=u[h],g=u[d];const v=lc(a,e),y=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const S=h==="y"?"height":"width",k=i.reference[h]-i.floating[S]+y.mainAxis,E=i.reference[h]+i.reference[S]-y.mainAxis;m<k?m=k:m>E&&(m=E)}if(l){var w,x;const S=h==="y"?"width":"height",k=DU.has(uc(s)),E=i.reference[d]-i.floating[S]+(k&&((w=o.offset)==null?void 0:w[d])||0)+(k?0:y.crossAxis),A=i.reference[d]+i.reference[S]+(k?0:((x=o.offset)==null?void 0:x[d])||0)-(k?y.crossAxis:0);g<E?g=E:g>A&&(g=A)}return{[h]:m,[d]:g}}}},Bne=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:c=()=>{},...l}=lc(t,e),u=await qm(e,l),d=uc(s),h=Rh(s),m=ha(s)==="y",{width:g,height:v}=i.floating;let y,w;d==="top"||d==="bottom"?(y=d,w=h===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(w=d,y=h==="end"?"top":"bottom");const x=v-u.top-u.bottom,S=g-u.left-u.right,k=pl(v-u[y],x),E=pl(g-u[w],S),A=!e.middlewareData.shift;let R=k,N=E;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(R=x),A&&!h){const O=pi(u.left,0),_=pi(u.right,0),M=pi(u.top,0),G=pi(u.bottom,0);m?N=g-2*(O!==0||_!==0?O+_:pi(u.left,u.right)):R=v-2*(M!==0||G!==0?M+G:pi(u.top,u.bottom))}await c({...e,availableWidth:N,availableHeight:R});const P=await o.getDimensions(a.floating);return g!==P.width||v!==P.height?{reset:{rects:!0}}:{}}}};function i1(){return typeof window<"u"}function Oh(t){return FU(t)?(t.nodeName||"").toLowerCase():"#document"}function wi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _a(t){var e;return(e=(FU(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function FU(t){return i1()?t instanceof Node||t instanceof wi(t).Node:!1}function Lo(t){return i1()?t instanceof Element||t instanceof wi(t).Element:!1}function Ia(t){return i1()?t instanceof HTMLElement||t instanceof wi(t).HTMLElement:!1}function b3(t){return!i1()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof wi(t).ShadowRoot}const Mne=new Set(["inline","contents"]);function Jg(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Bo(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!Mne.has(s)}const zne=new Set(["table","td","th"]);function Une(t){return zne.has(Oh(t))}const Vne=[":popover-open",":modal"];function o1(t){return Vne.some(e=>{try{return t.matches(e)}catch{return!1}})}const jne=["transform","translate","scale","rotate","perspective"],Hne=["transform","translate","scale","rotate","perspective","filter"],Wne=["paint","layout","strict","content"];function ZA(t){const e=JA(),n=Lo(t)?Bo(t):t;return jne.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Hne.some(r=>(n.willChange||"").includes(r))||Wne.some(r=>(n.contain||"").includes(r))}function Gne(t){let e=ml(t);for(;Ia(e)&&!Jf(e);){if(ZA(e))return e;if(o1(e))return null;e=ml(e)}return null}function JA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const qne=new Set(["html","body","#document"]);function Jf(t){return qne.has(Oh(t))}function Bo(t){return wi(t).getComputedStyle(t)}function a1(t){return Lo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ml(t){if(Oh(t)==="html")return t;const e=t.assignedSlot||t.parentNode||b3(t)&&t.host||_a(t);return b3(e)?e.host:e}function LU(t){const e=ml(t);return Jf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ia(e)&&Jg(e)?e:LU(e)}function Km(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=LU(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=wi(s);if(i){const a=IC(o);return e.concat(o,o.visualViewport||[],Jg(s)?s:[],a&&n?Km(a):[])}return e.concat(s,Km(s,[],n))}function IC(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function BU(t){const e=Bo(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Ia(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=rw(n)!==i||rw(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function eN(t){return Lo(t)?t:t.contextElement}function zf(t){const e=eN(t);if(!Ia(e))return ga(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=BU(e);let o=(i?rw(n.width):n.width)/r,a=(i?rw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Kne=ga(0);function MU(t){const e=wi(t);return!JA()||!e.visualViewport?Kne:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Xne(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==wi(t)?!1:e}function Vu(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=eN(t);let o=ga(1);e&&(r?Lo(r)&&(o=zf(r)):o=zf(t));const a=Xne(i,n,r)?MU(i):ga(0);let c=(s.left+a.x)/o.x,l=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(i){const h=wi(i),m=r&&Lo(r)?wi(r):r;let g=h,v=IC(g);for(;v&&r&&m!==g;){const y=zf(v),w=v.getBoundingClientRect(),x=Bo(v),S=w.left+(v.clientLeft+parseFloat(x.paddingLeft))*y.x,k=w.top+(v.clientTop+parseFloat(x.paddingTop))*y.y;c*=y.x,l*=y.y,u*=y.x,d*=y.y,c+=S,l+=k,g=wi(v),v=IC(g)}}return iw({width:u,height:d,x:c,y:l})}function c1(t,e){const n=a1(t).scrollLeft;return e?e.left+n:Vu(_a(t)).left+n}function zU(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-c1(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function Qne(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=_a(r),a=e?o1(e.floating):!1;if(r===o||a&&i)return n;let c={scrollLeft:0,scrollTop:0},l=ga(1);const u=ga(0),d=Ia(r);if((d||!d&&!i)&&((Oh(r)!=="body"||Jg(o))&&(c=a1(r)),Ia(r))){const m=Vu(r);l=zf(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=o&&!d&&!i?zU(o,c):ga(0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x+h.x,y:n.y*l.y-c.scrollTop*l.y+u.y+h.y}}function Yne(t){return Array.from(t.getClientRects())}function Zne(t){const e=_a(t),n=a1(t),r=t.ownerDocument.body,s=pi(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=pi(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+c1(t);const a=-n.scrollTop;return Bo(r).direction==="rtl"&&(o+=pi(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}const w3=25;function Jne(t,e){const n=wi(t),r=_a(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,c=0;if(s){i=s.width,o=s.height;const u=JA();(!u||u&&e==="fixed")&&(a=s.offsetLeft,c=s.offsetTop)}const l=c1(r);if(l<=0){const u=r.ownerDocument,d=u.body,h=getComputedStyle(d),m=u.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,g=Math.abs(r.clientWidth-d.clientWidth-m);g<=w3&&(i-=g)}else l<=w3&&(i+=l);return{width:i,height:o,x:a,y:c}}const ere=new Set(["absolute","fixed"]);function tre(t,e){const n=Vu(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Ia(t)?zf(t):ga(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,c=s*i.x,l=r*i.y;return{width:o,height:a,x:c,y:l}}function x3(t,e,n){let r;if(e==="viewport")r=Jne(t,n);else if(e==="document")r=Zne(_a(t));else if(Lo(e))r=tre(e,n);else{const s=MU(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return iw(r)}function UU(t,e){const n=ml(t);return n===e||!Lo(n)||Jf(n)?!1:Bo(n).position==="fixed"||UU(n,e)}function nre(t,e){const n=e.get(t);if(n)return n;let r=Km(t,[],!1).filter(a=>Lo(a)&&Oh(a)!=="body"),s=null;const i=Bo(t).position==="fixed";let o=i?ml(t):t;for(;Lo(o)&&!Jf(o);){const a=Bo(o),c=ZA(o);!c&&a.position==="fixed"&&(s=null),(i?!c&&!s:!c&&a.position==="static"&&!!s&&ere.has(s.position)||Jg(o)&&!c&&UU(t,o))?r=r.filter(u=>u!==o):s=a,o=ml(o)}return e.set(t,r),r}function rre(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?o1(e)?[]:nre(e,this._c):[].concat(n),r],a=o[0],c=o.reduce((l,u)=>{const d=x3(e,u,s);return l.top=pi(d.top,l.top),l.right=pl(d.right,l.right),l.bottom=pl(d.bottom,l.bottom),l.left=pi(d.left,l.left),l},x3(e,a,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function sre(t){const{width:e,height:n}=BU(t);return{width:e,height:n}}function ire(t,e,n){const r=Ia(e),s=_a(e),i=n==="fixed",o=Vu(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const c=ga(0);function l(){c.x=c1(s)}if(r||!r&&!i)if((Oh(e)!=="body"||Jg(s))&&(a=a1(e)),r){const m=Vu(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&l();i&&!r&&s&&l();const u=s&&!r&&!i?zU(s,a):ga(0),d=o.left+a.scrollLeft-c.x-u.x,h=o.top+a.scrollTop-c.y-u.y;return{x:d,y:h,width:o.width,height:o.height}}function LE(t){return Bo(t).position==="static"}function I3(t,e){if(!Ia(t)||Bo(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return _a(t)===n&&(n=n.ownerDocument.body),n}function VU(t,e){const n=wi(t);if(o1(t))return n;if(!Ia(t)){let s=ml(t);for(;s&&!Jf(s);){if(Lo(s)&&!LE(s))return s;s=ml(s)}return n}let r=I3(t,e);for(;r&&Une(r)&&LE(r);)r=I3(r,e);return r&&Jf(r)&&LE(r)&&!ZA(r)?n:r||Gne(t)||n}const ore=async function(t){const e=this.getOffsetParent||VU,n=this.getDimensions,r=await n(t.floating);return{reference:ire(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function are(t){return Bo(t).direction==="rtl"}const cre={convertOffsetParentRelativeRectToViewportRelativeRect:Qne,getDocumentElement:_a,getClippingRect:rre,getOffsetParent:VU,getElementRects:ore,getClientRects:Yne,getDimensions:sre,getScale:zf,isElement:Lo,isRTL:are};function jU(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function lre(t,e){let n=null,r;const s=_a(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,c){a===void 0&&(a=!1),c===void 0&&(c=1),i();const l=t.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=l;if(a||e(),!h||!m)return;const g=Kv(d),v=Kv(s.clientWidth-(u+h)),y=Kv(s.clientHeight-(d+m)),w=Kv(u),S={rootMargin:-g+"px "+-v+"px "+-y+"px "+-w+"px",threshold:pi(0,pl(1,c))||1};let k=!0;function E(A){const R=A[0].intersectionRatio;if(R!==c){if(!k)return o();R?o(!1,R):r=setTimeout(()=>{o(!1,1e-7)},1e3)}R===1&&!jU(l,t.getBoundingClientRect())&&o(),k=!1}try{n=new IntersectionObserver(E,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(E,S)}n.observe(t)}return o(!0),i}function ure(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,l=eN(t),u=s||i?[...l?Km(l):[],...Km(e)]:[];u.forEach(w=>{s&&w.addEventListener("scroll",n,{passive:!0}),i&&w.addEventListener("resize",n)});const d=l&&a?lre(l,n):null;let h=-1,m=null;o&&(m=new ResizeObserver(w=>{let[x]=w;x&&x.target===l&&m&&(m.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(e)})),n()}),l&&!c&&m.observe(l),m.observe(e));let g,v=c?Vu(t):null;c&&y();function y(){const w=Vu(t);v&&!jU(v,w)&&n(),v=w,g=requestAnimationFrame(y)}return n(),()=>{var w;u.forEach(x=>{s&&x.removeEventListener("scroll",n),i&&x.removeEventListener("resize",n)}),d?.(),(w=m)==null||w.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const dre=Dne,fre=Fne,hre=Rne,pre=Bne,mre=One,S3=$ne,gre=Lne,yre=(t,e,n)=>{const r=new Map,s={platform:cre,...n},i={...s.platform,_c:r};return _ne(t,e,{...s,platform:i})};var vre=typeof document<"u",bre=function(){},Rb=vre?z.useLayoutEffect:bre;function ow(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!ow(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!ow(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function HU(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function k3(t,e){const n=HU(t);return Math.round(e*n)/n}function BE(t){const e=z.useRef(t);return Rb(()=>{e.current=t}),e}function wre(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:c,open:l}=t,[u,d]=z.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,m]=z.useState(r);ow(h,r)||m(r);const[g,v]=z.useState(null),[y,w]=z.useState(null),x=z.useCallback(j=>{j!==A.current&&(A.current=j,v(j))},[]),S=z.useCallback(j=>{j!==R.current&&(R.current=j,w(j))},[]),k=i||g,E=o||y,A=z.useRef(null),R=z.useRef(null),N=z.useRef(u),P=c!=null,O=BE(c),_=BE(s),M=BE(l),G=z.useCallback(()=>{if(!A.current||!R.current)return;const j={placement:e,strategy:n,middleware:h};_.current&&(j.platform=_.current),yre(A.current,R.current,j).then(W=>{const X={...W,isPositioned:M.current!==!1};q.current&&!ow(N.current,X)&&(N.current=X,Jx.flushSync(()=>{d(X)}))})},[h,e,n,_,M]);Rb(()=>{l===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(j=>({...j,isPositioned:!1})))},[l]);const q=z.useRef(!1);Rb(()=>(q.current=!0,()=>{q.current=!1}),[]),Rb(()=>{if(k&&(A.current=k),E&&(R.current=E),k&&E){if(O.current)return O.current(k,E,G);G()}},[k,E,G,O,P]);const D=z.useMemo(()=>({reference:A,floating:R,setReference:x,setFloating:S}),[x,S]),L=z.useMemo(()=>({reference:k,floating:E}),[k,E]),K=z.useMemo(()=>{const j={position:n,left:0,top:0};if(!L.floating)return j;const W=k3(L.floating,u.x),X=k3(L.floating,u.y);return a?{...j,transform:"translate("+W+"px, "+X+"px)",...HU(L.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:W,top:X}},[n,a,L.floating,u.x,u.y]);return z.useMemo(()=>({...u,update:G,refs:D,elements:L,floatingStyles:K}),[u,G,D,L,K])}const xre=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?S3({element:r.current,padding:s}).fn(n):{}:r?S3({element:r,padding:s}).fn(n):{}}}},Ire=(t,e)=>({...dre(t),options:[t,e]}),Sre=(t,e)=>({...fre(t),options:[t,e]}),kre=(t,e)=>({...gre(t),options:[t,e]}),Ere=(t,e)=>({...hre(t),options:[t,e]}),Cre=(t,e)=>({...pre(t),options:[t,e]}),Tre=(t,e)=>({...mre(t),options:[t,e]}),Are=(t,e)=>({...xre(t),options:[t,e]});var Nre="Arrow",WU=z.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return F.jsx(yn.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:F.jsx("polygon",{points:"0,0 30,0 15,10"})})});WU.displayName=Nre;var _re=WU;function $re(t){const[e,n]=z.useState(void 0);return cc(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const c=i.borderBoxSize,l=Array.isArray(c)?c[0]:c;o=l.inlineSize,a=l.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var tN="Popper",[GU,l1]=Ol(tN),[Rre,qU]=GU(tN),KU=t=>{const{__scopePopper:e,children:n}=t,[r,s]=z.useState(null);return F.jsx(Rre,{scope:e,anchor:r,onAnchorChange:s,children:n})};KU.displayName=tN;var XU="PopperAnchor",QU=z.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=qU(XU,n),o=z.useRef(null),a=Lr(e,o),c=z.useRef(null);return z.useEffect(()=>{const l=c.current;c.current=r?.current||o.current,l!==c.current&&i.onAnchorChange(c.current)}),r?null:F.jsx(yn.div,{...s,ref:a})});QU.displayName=XU;var nN="PopperContent",[Ore,Pre]=GU(nN),YU=z.forwardRef((t,e)=>{const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:c=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:g,...v}=t,y=qU(nN,n),[w,x]=z.useState(null),S=Lr(e,we=>x(we)),[k,E]=z.useState(null),A=$re(k),R=A?.width??0,N=A?.height??0,P=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},_=Array.isArray(l)?l:[l],M=_.length>0,G={padding:O,boundary:_.filter(Fre),altBoundary:M},{refs:q,floatingStyles:D,placement:L,isPositioned:K,middlewareData:j}=wre({strategy:"fixed",placement:P,whileElementsMounted:(...we)=>ure(...we,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[Ire({mainAxis:s+N,alignmentAxis:o}),c&&Sre({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?kre():void 0,...G}),c&&Ere({...G}),Cre({...G,apply:({elements:we,rects:Ae,availableWidth:_e,availableHeight:je})=>{const{width:st,height:dt}=Ae.reference,yt=we.floating.style;yt.setProperty("--radix-popper-available-width",`${_e}px`),yt.setProperty("--radix-popper-available-height",`${je}px`),yt.setProperty("--radix-popper-anchor-width",`${st}px`),yt.setProperty("--radix-popper-anchor-height",`${dt}px`)}}),k&&Are({element:k,padding:a}),Lre({arrowWidth:R,arrowHeight:N}),h&&Tre({strategy:"referenceHidden",...G})]}),[W,X]=eV(L),H=Si(g);cc(()=>{K&&H?.()},[K,H]);const Y=j.arrow?.x,ce=j.arrow?.y,de=j.arrow?.centerOffset!==0,[ge,be]=z.useState();return cc(()=>{w&&be(window.getComputedStyle(w).zIndex)},[w]),F.jsx("div",{ref:q.setFloating,"data-radix-popper-content-wrapper":"",style:{...D,transform:K?D.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ge,"--radix-popper-transform-origin":[j.transformOrigin?.x,j.transformOrigin?.y].join(" "),...j.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:F.jsx(Ore,{scope:n,placedSide:W,onArrowChange:E,arrowX:Y,arrowY:ce,shouldHideArrow:de,children:F.jsx(yn.div,{"data-side":W,"data-align":X,...v,ref:S,style:{...v.style,animation:K?void 0:"none"}})})})});YU.displayName=nN;var ZU="PopperArrow",Dre={top:"bottom",right:"left",bottom:"top",left:"right"},JU=z.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=Pre(ZU,r),o=Dre[i.placedSide];return F.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:F.jsx(_re,{...s,ref:n,style:{...s.style,display:"block"}})})});JU.displayName=ZU;function Fre(t){return t!==null}var Lre=t=>({name:"transformOrigin",options:t,fn(e){const{placement:n,rects:r,middlewareData:s}=e,o=s.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[l,u]=eV(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(s.arrow?.x??0)+a/2,m=(s.arrow?.y??0)+c/2;let g="",v="";return l==="bottom"?(g=o?d:`${h}px`,v=`${-c}px`):l==="top"?(g=o?d:`${h}px`,v=`${r.floating.height+c}px`):l==="right"?(g=`${-c}px`,v=o?d:`${m}px`):l==="left"&&(g=`${r.floating.width+c}px`,v=o?d:`${m}px`),{data:{x:g,y:v}}}});function eV(t){const[e,n="center"]=t.split("-");return[e,n]}var Bre=KU,tV=QU,nV=YU,rV=JU,[u1]=Ol("Tooltip",[l1]),rN=l1(),sV="TooltipProvider",Mre=700,E3="tooltip.open",[zre,iV]=u1(sV),oV=t=>{const{__scopeTooltip:e,delayDuration:n=Mre,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=t,o=z.useRef(!0),a=z.useRef(!1),c=z.useRef(0);return z.useEffect(()=>{const l=c.current;return()=>window.clearTimeout(l)},[]),F.jsx(zre,{scope:e,isOpenDelayedRef:o,delayDuration:n,onOpen:z.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:z.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:z.useCallback(l=>{a.current=l},[]),disableHoverableContent:s,children:i})};oV.displayName=sV;var aV="Tooltip",[BXe,d1]=u1(aV),SC="TooltipTrigger",Ure=z.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=d1(SC,n),i=iV(SC,n),o=rN(n),a=z.useRef(null),c=Lr(e,a,s.onTriggerChange),l=z.useRef(!1),u=z.useRef(!1),d=z.useCallback(()=>l.current=!1,[]);return z.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),F.jsx(tV,{asChild:!0,...o,children:F.jsx(yn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:c,onPointerMove:lt(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:lt(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:lt(t.onPointerDown,()=>{s.open&&s.onClose(),l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:lt(t.onFocus,()=>{l.current||s.onOpen()}),onBlur:lt(t.onBlur,s.onClose),onClick:lt(t.onClick,s.onClose)})})});Ure.displayName=SC;var Vre="TooltipPortal",[MXe,jre]=u1(Vre,{forceMount:void 0}),eh="TooltipContent",cV=z.forwardRef((t,e)=>{const n=jre(eh,t.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=t,o=d1(eh,t.__scopeTooltip);return F.jsx(gd,{present:r||o.open,children:o.disableHoverableContent?F.jsx(lV,{side:s,...i,ref:e}):F.jsx(Hre,{side:s,...i,ref:e})})}),Hre=z.forwardRef((t,e)=>{const n=d1(eh,t.__scopeTooltip),r=iV(eh,t.__scopeTooltip),s=z.useRef(null),i=Lr(e,s),[o,a]=z.useState(null),{trigger:c,onClose:l}=n,u=s.current,{onPointerInTransitChange:d}=r,h=z.useCallback(()=>{a(null),d(!1)},[d]),m=z.useCallback((g,v)=>{const y=g.currentTarget,w={x:g.clientX,y:g.clientY},x=Xre(w,y.getBoundingClientRect()),S=Qre(w,x),k=Yre(v.getBoundingClientRect()),E=Jre([...S,...k]);a(E),d(!0)},[d]);return z.useEffect(()=>()=>h(),[h]),z.useEffect(()=>{if(c&&u){const g=y=>m(y,u),v=y=>m(y,c);return c.addEventListener("pointerleave",g),u.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",v)}}},[c,u,m,h]),z.useEffect(()=>{if(o){const g=v=>{const y=v.target,w={x:v.clientX,y:v.clientY},x=c?.contains(y)||u?.contains(y),S=!Zre(w,o);x?h():S&&(h(),l())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,u,o,l,h]),F.jsx(lV,{...t,ref:i})}),[Wre,Gre]=u1(aV,{isInside:!1}),qre=_ee("TooltipContent"),lV=z.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,c=d1(eh,n),l=rN(n),{onClose:u}=c;return z.useEffect(()=>(document.addEventListener(E3,u),()=>document.removeEventListener(E3,u)),[u]),z.useEffect(()=>{if(c.trigger){const d=h=>{h.target?.contains(c.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[c.trigger,u]),F.jsx(t1,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:F.jsxs(nV,{"data-state":c.stateAttribute,...l,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[F.jsx(qre,{children:r}),F.jsx(Wre,{scope:n,isInside:!0,children:F.jsx(Jee,{id:c.contentId,role:"tooltip",children:s||r})})]})})});cV.displayName=eh;var uV="TooltipArrow",Kre=z.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,s=rN(n);return Gre(uV,n).isInside?null:F.jsx(rV,{...s,...r,ref:e})});Kre.displayName=uV;function Xre(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Qre(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function Yre(t){const{top:e,right:n,bottom:r,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:r},{x:s,y:r}]}function Zre(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],c=e[o],l=a.x,u=a.y,d=c.x,h=c.y;u>r!=h>r&&n<(d-l)*(r-u)/(h-u)+l&&(s=!s)}return s}function Jre(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),ese(e)}function ese(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const s=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const s=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var tse=oV,dV=cV;const nse=tse,rse=z.forwardRef(({className:t,sideOffset:e=4,...n},r)=>F.jsx(dV,{ref:r,sideOffset:e,className:sn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n}));rse.displayName=dV.displayName;var _n;(function(t){t.NUMBER="NUMBER_NUMBER",t.HEX="NUMBER_HEX",t.STR="NUMBER_STR",t.BIGINT="NUMBER_BIGINT"})(_n||(_n={}));var Es;(function(t){t.HEX="BYTES_HEX",t.UINT8ARRAY="BYTES_UINT8ARRAY"})(Es||(Es={}));const Fr={number:_n.BIGINT,bytes:Es.HEX},vt={number:_n.HEX,bytes:Es.HEX};var tc;(function(t){t.EARLIEST="earliest",t.LATEST="latest",t.PENDING="pending",t.SAFE="safe",t.FINALIZED="finalized",t.COMMITTED="committed"})(tc||(tc={}));var Rm;(function(t){t.chainstart="chainstart",t.frontier="frontier",t.homestead="homestead",t.dao="dao",t.tangerineWhistle="tangerineWhistle",t.spuriousDragon="spuriousDragon",t.byzantium="byzantium",t.constantinople="constantinople",t.petersburg="petersburg",t.istanbul="istanbul",t.muirGlacier="muirGlacier",t.berlin="berlin",t.london="london",t.altair="altair",t.arrowGlacier="arrowGlacier",t.grayGlacier="grayGlacier",t.bellatrix="bellatrix",t.merge="merge",t.capella="capella",t.shanghai="shanghai"})(Rm||(Rm={}));const wc=Object.getPrototypeOf(Uint8Array);var C3=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const T3=Symbol.for("web3/base-provider");class yd{static isWeb3Provider(e){return e instanceof yd||!!(e&&e[T3])}get[T3](){return!0}send(e,n){this.request(e).then(r=>{n(null,r)}).catch(r=>{n(r)})}sendAsync(e){return C3(this,void 0,void 0,function*(){return this.request(e)})}asEIP1193Provider(){const e=Object.create(this),n=e.request;return e.request=function(s){return C3(this,void 0,void 0,function*(){return(yield n(s)).result})},e.asEIP1193Provider=void 0,e}}class sse extends Array{constructor(e){super(),this._accountProvider=e}}const ise=100,ose=101,ase=201,cse=202,lse=203,use=204,dse=205,fse=206,hse=207,pse=208,mse=300,gse=301,yse=310,vse=311,bse=400,wse=402,xse=405,Ise=407,Sse=408,kse=410,Ese=411,Cse=412,Tse=413,Ase=414,Nse=415,_se=416,$se=417,Rse=418,Ose=419,Pse=420,Dse=421,Fse=422,Lse=423,Bse=424,Mse=425,zse=426,Use=427,Vse=428,jse=429,Hse=430,Wse=431,Gse=432,qse=433,Kse=434,Xse=435,Qse=436,Yse=437,Zse=438,Jse=439,eie=440,tie=441,nie=500,rie=503,sie=505,iie=506,oie=507,aie=600,cie=602,lie=603,uie=604,die=701,fie=702,hie=703,pie=704,mie=705,gie=706,yie=707,vie=709,bie=801,wie=802,xie=4001,Iie=4100,Sie=4200,kie=4900,Eie=4901,Cie=902,Tie=903,Aie=1001,Nie=1002,_ie=1003,$ie=1004,Rie=1005,Oie=1006,Pie=1008,Die=1009,Fie=1010,Lie=1011,Bie=1012,Mie=1014,zie=1015,Uie=1100,fV=1101,Vie=1200,aw=-32700,cw=-32600,lw=-32601,uw=-32602,dw=-32603,fw=-32e3,hw=-32001,pw=-32002,mw=-32003,gw=-32004,yw=-32005,vw=-32006;class ht extends Error{get innerError(){return this.cause instanceof Om?this.cause.errors:this.cause}set innerError(e){Array.isArray(e)?this.cause=new Om(e):this.cause=e}constructor(e,n){super(e),Array.isArray(n)?this.cause=new Om(n):this.cause=n,this.name=this.constructor.name,typeof Error.captureStackTrace=="function"?Error.captureStackTrace(new.target.constructor):this.stack=new Error().stack}static convertToString(e,n=!1){if(e==null)return"undefined";const r=JSON.stringify(e,(s,i)=>typeof i=="bigint"?i.toString():i);return n&&["bigint","string"].includes(typeof e)?r.replace(/['\\"]+/g,""):r}toJSON(){return{name:this.name,code:this.code,message:this.message,cause:this.cause,innerError:this.cause}}}class Om extends ht{constructor(e){super(`Multiple errors occurred: [${e.map(n=>n.message).join("], [")}]`),this.code=pse,this.errors=e}}class Rt extends ht{constructor(e,n){super(`Invalid value given "${ht.convertToString(e,!0)}". Error: ${n}.`),this.name=this.constructor.name}}class bw extends ht{constructor(){super("Private key must be 32 bytes."),this.code=die}}class hV extends ht{constructor(){super("Invalid Private Key, Not a valid string or uint8Array"),this.code=fie}}class jie extends ht{constructor(e){super(`"${e}"`),this.code=wie}}class pV extends ht{constructor(){super("Invalid key derivation function"),this.code=hie}}class Hie extends ht{constructor(){super("Key derivation failed - possibly wrong password"),this.code=pie}}class Wie extends ht{constructor(){super("Unsupported key store version"),this.code=mie}}class Gie extends ht{constructor(){super("Password cannot be empty"),this.code=gie}}class qie extends ht{constructor(){super("Initialization vector must be 16 bytes"),this.code=yie}}class Kie extends ht{constructor(){super("c > 1000, pbkdf2 is less secure with less iterations"),this.code=vie}}class Ph extends ht{constructor(e,n){super(e),this.code=nie,n&&(this.errorCode=n.code,this.errorReason=n.reason)}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{errorCode:this.errorCode,errorReason:this.errorReason})}}class Xm extends Ph{constructor(e){super("Connection not open",e),this.code=rie}}class mV extends Ph{constructor(e){super(`Maximum number of reconnect attempts reached! (${e})`),this.code=sie}}class gV extends Ph{constructor(){super("CONNECTION ERROR: Provider started to reconnect before the response got received!"),this.code=iie}}class yV extends Ph{constructor(e){super(`Request already sent with following id: ${e}`),this.code=oie}}class ks extends ht{constructor(e,n){super(e),this.code=mse,this.receipt=n}}class A3 extends ht{constructor(e,n){super(`The resolver at ${e} does not implement requested method: "${n}".`),this.address=e,this.name=n,this.code=gse}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{address:this.address,name:this.name})}}class f1 extends ks{constructor(e){if(super(e.message||"Error"),this.name="name"in e&&e.name||this.constructor.name,this.stack="stack"in e&&e.stack||void 0,this.code=e.code,typeof e.data=="object"){let n;e.data&&"originalError"in e.data?n=e.data.originalError:n=e.data,this.data=n.data,this.cause=new f1(n)}else this.data=e.data}setDecodedProperties(e,n,r){this.errorName=e,this.errorSignature=n,this.errorArgs=r}toJSON(){let e=Object.assign(Object.assign({},super.toJSON()),{data:this.data});return this.errorName&&(e=Object.assign(Object.assign({},e),{errorName:this.errorName,errorSignature:this.errorSignature,errorArgs:this.errorArgs})),e}}class Ou extends ks{constructor(e){super("Error happened while trying to execute a function inside a smart contract"),this.code=yse,this.cause=new f1(e)}}class Xie extends Rt{constructor(e){var n,r;super(`data: ${(n=e.data)!==null&&n!==void 0?n:"undefined"}, input: ${(r=e.input)!==null&&r!==void 0?r:"undefined"}`,`You can't have "data" and "input" as properties of a contract at the same time, please use either "data" or "input" instead.`),this.code=vse}}class Qie extends ht{constructor(e){super(`ENS is not supported on network ${e}`),this.code=Cie}}class Yie extends ht{constructor(){super("Network not synced"),this.code=Tie}}class N3 extends ht{constructor(e){super(`Invalid parameters passed. "${typeof e<"u"?e:""}"`),this.hint=e,this.code=hse}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{hint:this.hint})}}class ro extends ht{constructor(){super(...arguments),this.code=ase}}class ja extends ht{constructor(){super("The method you're trying to call is not implemented."),this.code=cse}}class h1 extends ht{constructor(){super(...arguments),this.code=lse}}class Zie extends ht{constructor(){super(...arguments),this.code=use}}class Oe extends ht{constructor(e,n){super(e),this.code=dse,this.props=n??{}}}class Jie extends ht{constructor(e){super(`A plugin with the namespace: ${e} has already been registered.`),this.code=fse}}class Ob extends ht{constructor(){super(...arguments),this.code=aie}}class Qm extends ht{constructor(e){super(`Client URL "${e}" is invalid.`),this.code=cie}}class Qa extends ht{constructor(){super(...arguments),this.code=lie}}class vV extends ht{constructor(){super(...arguments),this.code=uie}}class eoe extends Rt{constructor(){super(...arguments),this.code=bie}}class sN extends ht{constructor(e,n){super(e),this.receipt=n,this.code=bse}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{receipt:this.receipt})}}class ww extends ht{constructor(e,n,r,s){super(`Transaction has been reverted by the EVM${r===void 0?"":`:
 ${ht.convertToString(r)}`}`),this.reason=e,this.signature=n,this.receipt=r,this.data=s,this.code=wse}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{reason:this.reason,signature:this.signature,receipt:this.receipt,data:this.data})}}class bV extends ww{constructor(e,n,r,s,i,o,a){super(e),this.reason=e,this.customErrorName=n,this.customErrorDecodedSignature=r,this.customErrorArguments=s,this.signature=i,this.receipt=o,this.data=a,this.code=Zse}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{reason:this.reason,customErrorName:this.customErrorName,customErrorDecodedSignature:this.customErrorDecodedSignature,customErrorArguments:this.customErrorArguments,signature:this.signature,receipt:this.receipt,data:this.data})}}class wV extends sN{constructor(e){super(`Transaction has been reverted by the EVM${e===void 0?"":`:
 ${ht.convertToString(e)}`}`,e),this.code=xse}}class toe extends sN{constructor(){super("Raw transaction undefined"),this.code=Ise}}class _3 extends sN{constructor(){super("Transaction not found"),this.code=Hse}}class noe extends Rt{constructor(e){super(e,"invalid transaction with invalid sender"),this.code=Sse}}class roe extends Rt{constructor(e){super(e,"invalid transaction with invalid receiver"),this.code=Yse}}class soe extends Rt{constructor(){super("MissingCustomChainError","If tx.common is provided it must have tx.common.customChain"),this.code=kse}}class ioe extends Rt{constructor(){super("MissingCustomChainIdError","If tx.common is provided it must have tx.common.customChain and tx.common.customChain.chainId"),this.code=Ese}}class ooe extends Rt{constructor(e){super(JSON.stringify(e),"Chain Id doesnt match in tx.chainId tx.common.customChain.chainId"),this.code=Cse}}class aoe extends Rt{constructor(e){super(JSON.stringify(e),"Chain doesnt match in tx.chain tx.common.basechain"),this.code=Xse}}class coe extends Rt{constructor(e){super(JSON.stringify(e),"hardfork doesnt match in tx.hardfork tx.common.hardfork"),this.code=Qse}}class loe extends Rt{constructor(){super("CommonOrChainAndHardforkError","Please provide the common object or the chain and hardfork property but not all together."),this.code=Tse}}class uoe extends Rt{constructor(e){var n,r;super("MissingChainOrHardforkError",`When specifying chain and hardfork, both values must be defined. Received "chain": ${(n=e.chain)!==null&&n!==void 0?n:"undefined"}, "hardfork": ${(r=e.hardfork)!==null&&r!==void 0?r:"undefined"}`),this.code=Ase}}class doe extends ht{constructor(){super('Missing properties in transaction, either define "gas" and "gasPrice" for type 0 transactions or "gas", "maxPriorityFeePerGas" and "maxFeePerGas" for type 2 transactions'),this.code=eie}}class foe extends Rt{constructor(e){var n,r,s,i;super(`gas: ${(n=e.gas)!==null&&n!==void 0?n:"undefined"}, gasPrice: ${(r=e.gasPrice)!==null&&r!==void 0?r:"undefined"}, maxPriorityFeePerGas: ${(s=e.maxPriorityFeePerGas)!==null&&s!==void 0?s:"undefined"}, maxFeePerGas: ${(i=e.maxFeePerGas)!==null&&i!==void 0?i:"undefined"}`,'"gas" is missing'),this.code=Nse,this.cause=new doe}}class hoe extends ht{constructor(){super('Missing properties in transaction, either define "gas" and "gasPrice" for type 0 transactions or "gas", "maxPriorityFeePerGas" and "maxFeePerGas" for type 2 transactions, not both'),this.code=tie}}class poe extends Rt{constructor(e){var n,r,s,i;super(`gas: ${(n=e.gas)!==null&&n!==void 0?n:"undefined"}, gasPrice: ${(r=e.gasPrice)!==null&&r!==void 0?r:"undefined"}, maxPriorityFeePerGas: ${(s=e.maxPriorityFeePerGas)!==null&&s!==void 0?s:"undefined"}, maxFeePerGas: ${(i=e.maxFeePerGas)!==null&&i!==void 0?i:"undefined"}`,"transaction must specify legacy or fee market gas properties, not both"),this.code=Kse,this.cause=new hoe}}class moe extends Rt{constructor(e){var n,r;super(`gas: ${(n=e.gas)!==null&&n!==void 0?n:"undefined"}, gasPrice: ${(r=e.gasPrice)!==null&&r!==void 0?r:"undefined"}`,"Gas or gasPrice is lower than 0"),this.code=_se}}class goe extends Rt{constructor(e){var n,r;super(`maxPriorityFeePerGas: ${(n=e.maxPriorityFeePerGas)!==null&&n!==void 0?n:"undefined"}, maxFeePerGas: ${(r=e.maxFeePerGas)!==null&&r!==void 0?r:"undefined"}`,"maxPriorityFeePerGas or maxFeePerGas is lower than 0"),this.code=$se}}class yoe extends Rt{constructor(e){super(e,"eip-1559 transactions don't support gasPrice"),this.code=Rse}}class xV extends Rt{constructor(e){var n,r;super(`maxPriorityFeePerGas: ${(n=e.maxPriorityFeePerGas)!==null&&n!==void 0?n:"undefined"}, maxFeePerGas: ${(r=e.maxFeePerGas)!==null&&r!==void 0?r:"undefined"}`,"pre-eip-1559 transaction don't support maxFeePerGas/maxPriorityFeePerGas"),this.code=Ose}}class voe extends Rt{constructor(e){super(e,"invalid transaction object"),this.code=Pse}}class boe extends Rt{constructor(e){var n,r;super(`nonce: ${(n=e.nonce)!==null&&n!==void 0?n:"undefined"}, chainId: ${(r=e.chainId)!==null&&r!==void 0?r:"undefined"}`,"Nonce or chainId is lower than 0"),this.code=Dse}}class woe extends Rt{constructor(){super("UnableToPopulateNonceError","unable to populate nonce, no from address available"),this.code=Fse}}class xoe extends Rt{constructor(){super("Eip1559NotSupportedError","Network doesn't support eip-1559"),this.code=Lse}}class $3 extends Rt{constructor(e){super(e,"unsupported transaction type"),this.code=Bse}}class IV extends Rt{constructor(e){var n,r;super(`data: ${(n=e.data)!==null&&n!==void 0?n:"undefined"}, input: ${(r=e.input)!==null&&r!==void 0?r:"undefined"}`,`You can't have "data" and "input" as properties of transactions at the same time, please use either "data" or "input" instead.`),this.code=Mse}}class Ioe extends ht{constructor(e){super(`The connected Ethereum Node did not respond within ${e.numberOfSeconds} seconds, please make sure your transaction was properly sent and you are connected to a healthy Node. Be aware that transaction might still be pending or mined!
	Transaction Hash: ${e.transactionHash?e.transactionHash.toString():"not available"}`),this.code=Wse}}function SV(t){return`Please make sure your transaction was properly sent and there are no previous pending transaction for the same account. However, be aware that it might still be mined!
	Transaction Hash: ${t?t.toString():"not available"}`}class kV extends ht{constructor(e){super(`Transaction was not mined within ${e.numberOfSeconds} seconds. ${SV(e.transactionHash)}`),this.code=zse}}class EV extends ht{constructor(e){super(`Transaction started at ${e.starterBlockNumber} but was not mined within ${e.numberOfBlocks} blocks. ${SV(e.transactionHash)}`),this.code=Gse}}class Soe extends Rt{constructor(e){var n,r;super(`receipt: ${JSON.stringify(e.receipt)}, blockHash: ${(n=e.blockHash)===null||n===void 0?void 0:n.toString()}, transactionHash: ${(r=e.transactionHash)===null||r===void 0?void 0:r.toString()}`,"Receipt missing or blockHash null"),this.code=Use}}class koe extends Rt{constructor(e){super(`receipt: ${JSON.stringify(e.receipt)}`,"Receipt missing block number"),this.code=Vse}}class kC extends ht{constructor(e){super(`Invalid signature. "${e}"`),this.code=qse}}class R3 extends Rt{constructor(){super("LocalWalletNotAvailableError","Attempted to index account in local wallet, but no wallet is available"),this.code=jse}}class Eoe extends ht{constructor(e,n){const r=[];e.forEach(s=>r.push(s.keyword)),super(`The following properties are invalid for the transaction type ${n}: ${r.join(", ")}`),this.code=Jse}}class Js extends Rt{constructor(e){super(e,"can not parse as byte data"),this.code=Nie}}class Pl extends Rt{constructor(e){super(e,"can not parse as number data"),this.code=_ie}}class vd extends Rt{constructor(e){super(e,"invalid ethereum address"),this.code=Rie}}class Coe extends Rt{constructor(e){super(e,"not a valid string"),this.code=Aie}}class CV extends Rt{constructor(e){super(e,"invalid unit"),this.code=$ie}}class TV extends Rt{constructor(e){super(e,"not a valid unit. Must be a positive integer"),this.code=zie}}class iN extends Rt{constructor(e){super(e,"can not be converted to hex"),this.code=Oie}}class AV extends Rt{constructor(e){super(e,"value greater than the nibble width"),this.code=Mie}}class e0 extends Rt{constructor(e){super(e,"not a valid boolean."),this.code=Pie}}class Toe extends Rt{constructor(e){super(e,"not a valid unsigned integer."),this.code=Die}}class O3 extends Rt{constructor(e){super(e,"invalid size given."),this.code=Fie}}class P3 extends Rt{constructor(e){super(e,"value is larger than size."),this.code=Lie}}class Aoe extends Rt{constructor(e){super(e,"invalid string given"),this.code=Bie}}const Noe=t=>!Array.isArray(t)&&t.jsonrpc==="2.0"&&!!t&&(t.result===void 0||t.result===null)&&"error"in t&&(typeof t.id=="number"||typeof t.id=="string"),D3=t=>Noe(t)?t.error.message:"";class ca extends ht{constructor(e,n,r,s){var i;super(n??`Returned error: ${Array.isArray(e)?e.map(a=>D3(a)).join(","):D3(e)}`),this.code=ise,n||(this.data=Array.isArray(e)?e.map(a=>{var c;return(c=a.error)===null||c===void 0?void 0:c.data}):(i=e?.error)===null||i===void 0?void 0:i.data),this.statusCode=s,this.request=r;let o;"error"in e?o=e.error:e instanceof Array&&(o=e.filter(a=>a.error).map(a=>a.error)),Array.isArray(o)&&o.length>0?this.cause=new Om(o):this.cause=o}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{data:this.data,request:this.request,statusCode:this.statusCode})}}class t0 extends ca{constructor(e,n){super(e,void 0,n),this.code=ose;let r;"error"in e?r=e.error:e instanceof Array&&(r=e.map(s=>s.error)),Array.isArray(r)?this.cause=new Om(r):this.cause=r}}class F3 extends ht{constructor(e,n){super(`Web3Config hardfork doesnt match in defaultHardfork ${e} and common.hardfork ${n}`),this.code=fV}}class L3 extends ht{constructor(e,n){super(`Web3Config chain doesnt match in defaultHardfork ${e} and common.hardfork ${n}`),this.code=fV}}const NV="An Rpc error has occured with a code of *code*",fs={[aw]:{message:"Parse error",description:"Invalid JSON"},[cw]:{message:"Invalid request",description:"JSON is not a valid request object	"},[lw]:{message:"Method not found",description:"Method does not exist	"},[uw]:{message:"Invalid params",description:"Invalid method parameters"},[dw]:{message:"Internal error",description:"Internal JSON-RPC error"},[fw]:{message:"Invalid input",description:"Missing or invalid parameters"},[hw]:{message:"Resource not found",description:"Requested resource not found"},[pw]:{message:"Resource unavailable",description:"Requested resource not available"},[mw]:{message:"Transaction rejected",description:"Transaction creation failed"},[gw]:{message:"Method not supported",description:"Method is not implemented"},[yw]:{message:"Limit exceeded",description:"Request exceeds defined limit"},[vw]:{message:"JSON-RPC version not supported",description:"Version of JSON-RPC protocol is not supported"},[xie]:{name:"User Rejected Request",message:"The user rejected the request."},[Iie]:{name:"Unauthorized",message:"The requested method and/or account has not been authorized by the user."},[Sie]:{name:"Unsupported Method",message:"The Provider does not support the requested method."},[kie]:{name:"Disconnected",message:"The Provider is disconnected from all chains."},[Eie]:{name:"Chain Disconnected",message:"The Provider is not connected to the requested chain."},"0-999":{name:"",message:"Not used."},1e3:{name:"Normal Closure",message:"The connection successfully completed the purpose for which it was created."},1001:{name:"Going Away",message:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{name:"Protocol error",message:"The endpoint is terminating the connection due to a protocol error."},1003:{name:"Unsupported Data",message:"The connection is being terminated because the endpoint received data of a type it cannot accept. (For example, a text-only endpoint received binary data.)"},1004:{name:"Reserved",message:"Reserved. A meaning might be defined in the future."},1005:{name:"No Status Rcvd",message:"Reserved. Indicates that no status code was provided even though one was expected."},1006:{name:"Abnormal Closure",message:"Reserved. Indicates that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{name:"Invalid frame payload data",message:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{name:"Policy Violation",message:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{name:"Message Too Big",message:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{name:"Mandatory Ext.",message:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{name:"Internal Error",message:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{name:"Service Restart",message:"The server is terminating the connection because it is restarting."},1013:{name:"Try Again Later",message:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{name:"Bad Gateway",message:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{name:"TLS handshake",message:"Reserved. Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},"1016-2999":{name:"",message:"For definition by future revisions of the WebSocket Protocol specification, and for definition by extension specifications."},"3000-3999":{name:"",message:"For use by libraries, frameworks, and applications. These status codes are registered directly with IANA. The interpretation of these codes is undefined by the WebSocket protocol."},"4000-4999":{name:"",message:"For private use, and thus can't be registered. Such codes can be used by prior agreements between WebSocket applications. The interpretation of these codes is undefined by the WebSocket protocol."}};class Ti extends ht{constructor(e,n){super(n??NV.replace("*code*",e.error.code.toString())),this.code=e.error.code,this.id=e.id,this.jsonrpc=e.jsonrpc,this.jsonRpcError=e.error}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{error:this.jsonRpcError,id:this.id,jsonRpc:this.jsonrpc})}}class oN extends ht{constructor(e,n){var r,s,i,o;if(!e)super();else if(!((r=fs[e])===null||r===void 0)&&r.message)super(fs[e].message);else{const a=Object.keys(fs).find(c=>typeof c=="string"&&e>=parseInt(c.split("-")[0],10)&&e<=parseInt(c.split("-")[1],10));super((i=(s=fs[a??""])===null||s===void 0?void 0:s.message)!==null&&i!==void 0?i:NV.replace("*code*",(o=e?.toString())!==null&&o!==void 0?o:'""'))}this.code=e,this.data=n}}class _oe extends Ti{constructor(e){super(e,fs[aw].message),this.code=aw}}class $oe extends Ti{constructor(e){super(e,fs[cw].message),this.code=cw}}class Roe extends Ti{constructor(e){super(e,fs[lw].message),this.code=lw}}class Ooe extends Ti{constructor(e){super(e,fs[uw].message),this.code=uw}}class Poe extends Ti{constructor(e){super(e,fs[dw].message),this.code=dw}}class Doe extends Ti{constructor(e){super(e,fs[fw].message),this.code=fw}}class Foe extends Ti{constructor(e){super(e,fs[gw].message),this.code=gw}}class Loe extends Ti{constructor(e){super(e,fs[pw].message),this.code=pw}}class Boe extends Ti{constructor(e){super(e,fs[hw].message),this.code=hw}}class Moe extends Ti{constructor(e){super(e,fs[vw].message),this.code=vw}}class zoe extends Ti{constructor(e){super(e,fs[mw].message),this.code=mw}}class Uoe extends Ti{constructor(e){super(e,fs[yw].message),this.code=yw}}const hs=new Map;hs.set(aw,{error:_oe});hs.set(cw,{error:$oe});hs.set(lw,{error:Roe});hs.set(uw,{error:Ooe});hs.set(dw,{error:Poe});hs.set(fw,{error:Doe});hs.set(gw,{error:Foe});hs.set(pw,{error:Loe});hs.set(mw,{error:zoe});hs.set(hw,{error:Boe});hs.set(vw,{error:Moe});hs.set(yw,{error:Uoe});class Voe extends ht{constructor(e){super(`Format for the type ${e} is unsupported`),this.type=e,this.code=Vie}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{type:this.type})}}const ME=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */new Uint8Array(new Uint32Array([287454020]).buffer)[0];function joe(t=32){if(ME&&typeof ME.getRandomValues=="function")return ME.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}var jt;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(jt||(jt={}));var EC;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(EC||(EC={}));const He=jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ya=t=>{switch(typeof t){case"undefined":return He.undefined;case"string":return He.string;case"number":return Number.isNaN(t)?He.nan:He.number;case"boolean":return He.boolean;case"function":return He.function;case"bigint":return He.bigint;case"symbol":return He.symbol;case"object":return Array.isArray(t)?He.array:t===null?He.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?He.promise:typeof Map<"u"&&t instanceof Map?He.map:typeof Set<"u"&&t instanceof Set?He.set:typeof Date<"u"&&t instanceof Date?He.date:He.object;default:return He.unknown}},Ce=jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Hoe=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class xi extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}static assert(e){if(!(e instanceof xi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,jt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const i=s.path[0];n[i]=n[i]||[],n[i].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}xi.create=t=>new xi(t);const th=(t,e)=>{let n;switch(t.code){case Ce.invalid_type:t.received===He.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Ce.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,jt.jsonStringifyReplacer)}`;break;case Ce.unrecognized_keys:n=`Unrecognized key(s) in object: ${jt.joinValues(t.keys,", ")}`;break;case Ce.invalid_union:n="Invalid input";break;case Ce.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${jt.joinValues(t.options)}`;break;case Ce.invalid_enum_value:n=`Invalid enum value. Expected ${jt.joinValues(t.options)}, received '${t.received}'`;break;case Ce.invalid_arguments:n="Invalid function arguments";break;case Ce.invalid_return_type:n="Invalid function return type";break;case Ce.invalid_date:n="Invalid date";break;case Ce.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:jt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Ce.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Ce.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Ce.custom:n="Invalid input";break;case Ce.invalid_intersection_types:n="Intersection results could not be merged";break;case Ce.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Ce.not_finite:n="Number must be finite";break;default:n=e.defaultError,jt.assertNever(t)}return{message:n}};let _V=th;function Woe(t){_V=t}function xw(){return _V}const Iw=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}},Goe=[];function Le(t,e){const n=xw(),r=Iw({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===th?void 0:th].filter(s=>!!s)});t.common.issues.push(r)}class ps{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return ct;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const i=await s.key,o=await s.value;r.push({key:i,value:o})}return ps.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const ct=Object.freeze({status:"aborted"}),Ff=t=>({status:"dirty",value:t}),Cs=t=>({status:"valid",value:t}),CC=t=>t.status==="aborted",TC=t=>t.status==="dirty",ju=t=>t.status==="valid",Ym=t=>typeof Promise<"u"&&t instanceof Promise;var tt;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(tt||(tt={}));class Sa{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const B3=(t,e)=>{if(ju(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new xi(t.common.issues);return this._error=n,this._error}}};function St(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{const{message:c}=t;return o.code==="invalid_enum_value"?{message:c??a.defaultError}:typeof a.data>"u"?{message:c??r??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:c??n??a.defaultError}},description:s}}class At{get description(){return this._def.description}_getType(e){return Ya(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ya(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ps,ctx:{common:e.parent.common,data:e.data,parsedType:Ya(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Ym(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ya(e)},s=this._parseSync({data:e,path:r.path,parent:r});return B3(r,s)}"~validate"(e){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ya(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return ju(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>ju(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ya(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Ym(s)?s:Promise.resolve(s));return B3(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Ce.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Mo({schema:this,typeName:ft.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return ya.create(this,this._def)}nullable(){return bl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _o.create(this)}promise(){return rh.create(this,this._def)}or(e){return tg.create([this,e],this._def)}and(e){return ng.create(this,e,this._def)}transform(e){return new Mo({...St(this._def),schema:this,typeName:ft.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new ag({...St(this._def),innerType:this,defaultValue:n,typeName:ft.ZodDefault})}brand(){return new aN({typeName:ft.ZodBranded,type:this,...St(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new cg({...St(this._def),innerType:this,catchValue:n,typeName:ft.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return n0.create(this,e)}readonly(){return lg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const qoe=/^c[^\s-]{8,}$/i,Koe=/^[0-9a-z]+$/,Xoe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Qoe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Yoe=/^[a-z0-9_-]{21}$/i,Zoe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Joe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,eae=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tae="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let zE;const nae=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rae=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,sae=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,iae=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,oae=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,aae=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,$V="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",cae=new RegExp(`^${$V}$`);function RV(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function lae(t){return new RegExp(`^${RV(t)}$`)}function OV(t){let e=`${$V}T${RV(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function uae(t,e){return!!((e==="v4"||!e)&&nae.test(t)||(e==="v6"||!e)&&sae.test(t))}function dae(t,e){if(!Zoe.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function fae(t,e){return!!((e==="v4"||!e)&&rae.test(t)||(e==="v6"||!e)&&iae.test(t))}class Ao extends At{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==He.string){const i=this._getOrReturnCtx(e);return Le(i,{code:Ce.invalid_type,expected:He.string,received:i.parsedType}),ct}const r=new ps;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?Le(s,{code:Ce.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Le(s,{code:Ce.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")eae.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"email",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")zE||(zE=new RegExp(tae,"u")),zE.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"emoji",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Qoe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"uuid",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Yoe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"nanoid",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")qoe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"cuid",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Koe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"cuid2",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Xoe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"ulid",code:Ce.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Le(s,{validation:"url",code:Ce.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"regex",code:Ce.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?OV(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?cae.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?lae(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Joe.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"duration",code:Ce.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?uae(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"ip",code:Ce.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?dae(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"jwt",code:Ce.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?fae(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"cidr",code:Ce.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?oae.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"base64",code:Ce.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?aae.test(e.data)||(s=this._getOrReturnCtx(e,s),Le(s,{validation:"base64url",code:Ce.invalid_string,message:i.message}),r.dirty()):jt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:Ce.invalid_string,...tt.errToObj(r)})}_addCheck(e){return new Ao({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...tt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...tt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...tt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...tt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...tt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...tt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...tt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...tt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...tt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...tt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...tt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...tt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...tt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...tt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...tt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...tt.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...tt.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...tt.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...tt.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...tt.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...tt.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...tt.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...tt.errToObj(n)})}nonempty(e){return this.min(1,tt.errToObj(e))}trim(){return new Ao({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ao({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ao({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ao.create=t=>new Ao({checks:[],typeName:ft.ZodString,coerce:t?.coerce??!1,...St(t)});function hae(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(t.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return i%o/10**s}class gl extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==He.number){const i=this._getOrReturnCtx(e);return Le(i,{code:Ce.invalid_type,expected:He.number,received:i.parsedType}),ct}let r;const s=new ps;for(const i of this._def.checks)i.kind==="int"?jt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?hae(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.not_finite,message:i.message}),s.dirty()):jt.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,tt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,tt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,tt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,tt.toString(n))}setLimit(e,n,r,s){return new gl({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:tt.toString(s)}]})}_addCheck(e){return new gl({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:tt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:tt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:tt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:tt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:tt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:tt.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:tt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:tt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:tt.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&jt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}gl.create=t=>new gl({checks:[],typeName:ft.ZodNumber,coerce:t?.coerce||!1,...St(t)});class yl extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==He.bigint)return this._getInvalidInput(e);let r;const s=new ps;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Le(r,{code:Ce.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):jt.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return Le(n,{code:Ce.invalid_type,expected:He.bigint,received:n.parsedType}),ct}gte(e,n){return this.setLimit("min",e,!0,tt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,tt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,tt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,tt.toString(n))}setLimit(e,n,r,s){return new yl({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:tt.toString(s)}]})}_addCheck(e){return new yl({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:tt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:tt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:tt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:tt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:tt.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}yl.create=t=>new yl({checks:[],typeName:ft.ZodBigInt,coerce:t?.coerce??!1,...St(t)});class Zm extends At{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==He.boolean){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.boolean,received:r.parsedType}),ct}return Cs(e.data)}}Zm.create=t=>new Zm({typeName:ft.ZodBoolean,coerce:t?.coerce||!1,...St(t)});class Hu extends At{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==He.date){const i=this._getOrReturnCtx(e);return Le(i,{code:Ce.invalid_type,expected:He.date,received:i.parsedType}),ct}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Le(i,{code:Ce.invalid_date}),ct}const r=new ps;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Le(s,{code:Ce.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):jt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Hu({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:tt.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:tt.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Hu.create=t=>new Hu({checks:[],coerce:t?.coerce||!1,typeName:ft.ZodDate,...St(t)});class Sw extends At{_parse(e){if(this._getType(e)!==He.symbol){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.symbol,received:r.parsedType}),ct}return Cs(e.data)}}Sw.create=t=>new Sw({typeName:ft.ZodSymbol,...St(t)});class Jm extends At{_parse(e){if(this._getType(e)!==He.undefined){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.undefined,received:r.parsedType}),ct}return Cs(e.data)}}Jm.create=t=>new Jm({typeName:ft.ZodUndefined,...St(t)});class eg extends At{_parse(e){if(this._getType(e)!==He.null){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.null,received:r.parsedType}),ct}return Cs(e.data)}}eg.create=t=>new eg({typeName:ft.ZodNull,...St(t)});class nh extends At{constructor(){super(...arguments),this._any=!0}_parse(e){return Cs(e.data)}}nh.create=t=>new nh({typeName:ft.ZodAny,...St(t)});class Pu extends At{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Cs(e.data)}}Pu.create=t=>new Pu({typeName:ft.ZodUnknown,...St(t)});class dc extends At{_parse(e){const n=this._getOrReturnCtx(e);return Le(n,{code:Ce.invalid_type,expected:He.never,received:n.parsedType}),ct}}dc.create=t=>new dc({typeName:ft.ZodNever,...St(t)});class kw extends At{_parse(e){if(this._getType(e)!==He.undefined){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.void,received:r.parsedType}),ct}return Cs(e.data)}}kw.create=t=>new kw({typeName:ft.ZodVoid,...St(t)});class _o extends At{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==He.array)return Le(n,{code:Ce.invalid_type,expected:He.array,received:n.parsedType}),ct;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(Le(n,{code:o?Ce.too_big:Ce.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Le(n,{code:Ce.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Le(n,{code:Ce.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Sa(n,o,n.path,a)))).then(o=>ps.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Sa(n,o,n.path,a)));return ps.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new _o({...this._def,minLength:{value:e,message:tt.toString(n)}})}max(e,n){return new _o({...this._def,maxLength:{value:e,message:tt.toString(n)}})}length(e,n){return new _o({...this._def,exactLength:{value:e,message:tt.toString(n)}})}nonempty(e){return this.min(1,e)}}_o.create=(t,e)=>new _o({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ft.ZodArray,...St(e)});function If(t){if(t instanceof Bn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ya.create(If(r))}return new Bn({...t._def,shape:()=>e})}else return t instanceof _o?new _o({...t._def,type:If(t.element)}):t instanceof ya?ya.create(If(t.unwrap())):t instanceof bl?bl.create(If(t.unwrap())):t instanceof ka?ka.create(t.items.map(e=>If(e))):t}class Bn extends At{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=jt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==He.object){const l=this._getOrReturnCtx(e);return Le(l,{code:Ce.invalid_type,expected:He.object,received:l.parsedType}),ct}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof dc&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Sa(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof dc){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(Le(s,{code:Ce.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Sa(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key,h=await u.value;l.push({key:d,value:h,alwaysSet:u.alwaysSet})}return l}).then(l=>ps.mergeObjectSync(r,l)):ps.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return tt.errToObj,new Bn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:tt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new Bn({...this._def,unknownKeys:"strip"})}passthrough(){return new Bn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Bn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Bn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ft.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Bn({...this._def,catchall:e})}pick(e){const n={};for(const r of jt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Bn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of jt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new Bn({...this._def,shape:()=>n})}deepPartial(){return If(this)}partial(e){const n={};for(const r of jt.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}return new Bn({...this._def,shape:()=>n})}required(e){const n={};for(const r of jt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof ya;)i=i._def.innerType;n[r]=i}return new Bn({...this._def,shape:()=>n})}keyof(){return PV(jt.objectKeys(this.shape))}}Bn.create=(t,e)=>new Bn({shape:()=>t,unknownKeys:"strip",catchall:dc.create(),typeName:ft.ZodObject,...St(e)});Bn.strictCreate=(t,e)=>new Bn({shape:()=>t,unknownKeys:"strict",catchall:dc.create(),typeName:ft.ZodObject,...St(e)});Bn.lazycreate=(t,e)=>new Bn({shape:t,unknownKeys:"strip",catchall:dc.create(),typeName:ft.ZodObject,...St(e)});class tg extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new xi(a.ctx.common.issues));return Le(n,{code:Ce.invalid_union,unionErrors:o}),ct}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new xi(c));return Le(n,{code:Ce.invalid_union,unionErrors:a}),ct}}get options(){return this._def.options}}tg.create=(t,e)=>new tg({options:t,typeName:ft.ZodUnion,...St(e)});const Xa=t=>t instanceof sg?Xa(t.schema):t instanceof Mo?Xa(t.innerType()):t instanceof ig?[t.value]:t instanceof vl?t.options:t instanceof og?jt.objectValues(t.enum):t instanceof ag?Xa(t._def.innerType):t instanceof Jm?[void 0]:t instanceof eg?[null]:t instanceof ya?[void 0,...Xa(t.unwrap())]:t instanceof bl?[null,...Xa(t.unwrap())]:t instanceof aN||t instanceof lg?Xa(t.unwrap()):t instanceof cg?Xa(t._def.innerType):[];class p1 extends At{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.object)return Le(n,{code:Ce.invalid_type,expected:He.object,received:n.parsedType}),ct;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Le(n,{code:Ce.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=Xa(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new p1({typeName:ft.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...St(r)})}}function AC(t,e){const n=Ya(t),r=Ya(e);if(t===e)return{valid:!0,data:t};if(n===He.object&&r===He.object){const s=jt.objectKeys(e),i=jt.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=AC(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===He.array&&r===He.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=AC(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===He.date&&r===He.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ng extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(CC(i)||CC(o))return ct;const a=AC(i.value,o.value);return a.valid?((TC(i)||TC(o))&&n.dirty(),{status:n.value,value:a.data}):(Le(r,{code:Ce.invalid_intersection_types}),ct)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ng.create=(t,e,n)=>new ng({left:t,right:e,typeName:ft.ZodIntersection,...St(n)});class ka extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.array)return Le(r,{code:Ce.invalid_type,expected:He.array,received:r.parsedType}),ct;if(r.data.length<this._def.items.length)return Le(r,{code:Ce.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ct;!this._def.rest&&r.data.length>this._def.items.length&&(Le(r,{code:Ce.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Sa(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>ps.mergeArray(n,o)):ps.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new ka({...this._def,rest:e})}}ka.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ka({items:t,typeName:ft.ZodTuple,rest:null,...St(e)})};class rg extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.object)return Le(r,{code:Ce.invalid_type,expected:He.object,received:r.parsedType}),ct;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Sa(r,a,r.path,a)),value:o._parse(new Sa(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?ps.mergeObjectAsync(n,s):ps.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof At?new rg({keyType:e,valueType:n,typeName:ft.ZodRecord,...St(r)}):new rg({keyType:Ao.create(),valueType:e,typeName:ft.ZodRecord,...St(n)})}}class Ew extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.map)return Le(r,{code:Ce.invalid_type,expected:He.map,received:r.parsedType}),ct;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Sa(r,a,r.path,[l,"key"])),value:i._parse(new Sa(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return ct;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return ct;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}Ew.create=(t,e,n)=>new Ew({valueType:e,keyType:t,typeName:ft.ZodMap,...St(n)});class Wu extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.set)return Le(r,{code:Ce.invalid_type,expected:He.set,received:r.parsedType}),ct;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Le(r,{code:Ce.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Le(r,{code:Ce.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return ct;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Sa(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new Wu({...this._def,minSize:{value:e,message:tt.toString(n)}})}max(e,n){return new Wu({...this._def,maxSize:{value:e,message:tt.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Wu.create=(t,e)=>new Wu({valueType:t,minSize:null,maxSize:null,typeName:ft.ZodSet,...St(e)});class Uf extends At{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.function)return Le(n,{code:Ce.invalid_type,expected:He.function,received:n.parsedType}),ct;function r(a,c){return Iw({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,xw(),th].filter(l=>!!l),issueData:{code:Ce.invalid_arguments,argumentsError:c}})}function s(a,c){return Iw({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,xw(),th].filter(l=>!!l),issueData:{code:Ce.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof rh){const a=this;return Cs(async function(...c){const l=new xi([]),u=await a._def.args.parseAsync(c,i).catch(m=>{throw l.addIssue(r(c,m)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(m=>{throw l.addIssue(s(d,m)),l})})}else{const a=this;return Cs(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new xi([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new xi([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Uf({...this._def,args:ka.create(e).rest(Pu.create())})}returns(e){return new Uf({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Uf({args:e||ka.create([]).rest(Pu.create()),returns:n||Pu.create(),typeName:ft.ZodFunction,...St(r)})}}class sg extends At{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}sg.create=(t,e)=>new sg({getter:t,typeName:ft.ZodLazy,...St(e)});class ig extends At{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Le(n,{received:n.data,code:Ce.invalid_literal,expected:this._def.value}),ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}ig.create=(t,e)=>new ig({value:t,typeName:ft.ZodLiteral,...St(e)});function PV(t,e){return new vl({values:t,typeName:ft.ZodEnum,...St(e)})}class vl extends At{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Le(n,{expected:jt.joinValues(r),received:n.parsedType,code:Ce.invalid_type}),ct}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Le(n,{received:n.data,code:Ce.invalid_enum_value,options:r}),ct}return Cs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return vl.create(e,{...this._def,...n})}exclude(e,n=this._def){return vl.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}vl.create=PV;class og extends At{_parse(e){const n=jt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==He.string&&r.parsedType!==He.number){const s=jt.objectValues(n);return Le(r,{expected:jt.joinValues(s),received:r.parsedType,code:Ce.invalid_type}),ct}if(this._cache||(this._cache=new Set(jt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=jt.objectValues(n);return Le(r,{received:r.data,code:Ce.invalid_enum_value,options:s}),ct}return Cs(e.data)}get enum(){return this._def.values}}og.create=(t,e)=>new og({values:t,typeName:ft.ZodNativeEnum,...St(e)});class rh extends At{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.promise&&n.common.async===!1)return Le(n,{code:Ce.invalid_type,expected:He.promise,received:n.parsedType}),ct;const r=n.parsedType===He.promise?n.data:Promise.resolve(n.data);return Cs(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}rh.create=(t,e)=>new rh({type:t,typeName:ft.ZodPromise,...St(e)});class Mo extends At{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ft.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Le(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return ct;const c=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return c.status==="aborted"?ct:c.status==="dirty"||n.value==="dirty"?Ff(c.value):c});{if(n.value==="aborted")return ct;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?ct:a.status==="dirty"||n.value==="dirty"?Ff(a.value):a}}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?ct:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?ct:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ju(o))return ct;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>ju(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):ct);jt.assertNever(s)}}Mo.create=(t,e,n)=>new Mo({schema:t,typeName:ft.ZodEffects,effect:e,...St(n)});Mo.createWithPreprocess=(t,e,n)=>new Mo({schema:e,effect:{type:"preprocess",transform:t},typeName:ft.ZodEffects,...St(n)});class ya extends At{_parse(e){return this._getType(e)===He.undefined?Cs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ya.create=(t,e)=>new ya({innerType:t,typeName:ft.ZodOptional,...St(e)});class bl extends At{_parse(e){return this._getType(e)===He.null?Cs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}bl.create=(t,e)=>new bl({innerType:t,typeName:ft.ZodNullable,...St(e)});class ag extends At{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===He.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}ag.create=(t,e)=>new ag({innerType:t,typeName:ft.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...St(e)});class cg extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ym(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new xi(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new xi(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}cg.create=(t,e)=>new cg({innerType:t,typeName:ft.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...St(e)});class Cw extends At{_parse(e){if(this._getType(e)!==He.nan){const r=this._getOrReturnCtx(e);return Le(r,{code:Ce.invalid_type,expected:He.nan,received:r.parsedType}),ct}return{status:"valid",value:e.data}}}Cw.create=t=>new Cw({typeName:ft.ZodNaN,...St(t)});const pae=Symbol("zod_brand");class aN extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class n0 extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ct:i.status==="dirty"?(n.dirty(),Ff(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ct:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new n0({in:e,out:n,typeName:ft.ZodPipeline})}}class lg extends At{_parse(e){const n=this._def.innerType._parse(e),r=s=>(ju(s)&&(s.value=Object.freeze(s.value)),s);return Ym(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}lg.create=(t,e)=>new lg({innerType:t,typeName:ft.ZodReadonly,...St(e)});function M3(t,e){const n=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof n=="string"?{message:n}:n}function DV(t,e={},n){return t?nh.create().superRefine((r,s)=>{const i=t(r);if(i instanceof Promise)return i.then(o=>{if(!o){const a=M3(e,r),c=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:c})}});if(!i){const o=M3(e,r),a=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:a})}}):nh.create()}const mae={object:Bn.lazycreate};var ft;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ft||(ft={}));const gae=(t,e={message:`Input not instance of ${t.name}`})=>DV(n=>n instanceof t,e),cN=Ao.create,FV=gl.create,yae=Cw.create,vae=yl.create,LV=Zm.create,bae=Hu.create,wae=Sw.create,xae=Jm.create,Iae=eg.create,NC=nh.create,Sae=Pu.create,kae=dc.create,Eae=kw.create,BV=_o.create,Pm=Bn.create,Cae=Bn.strictCreate,MV=tg.create,Tae=p1.create,Aae=ng.create,zV=ka.create,Nae=rg.create,_ae=Ew.create,$ae=Wu.create,Rae=Uf.create,Oae=sg.create,Pae=ig.create,Dae=vl.create,Fae=og.create,Lae=rh.create,z3=Mo.create,Bae=ya.create,Mae=bl.create,zae=Mo.createWithPreprocess,Uae=n0.create,Vae=()=>cN().optional(),jae=()=>FV().optional(),Hae=()=>LV().optional(),Wae={string:(t=>Ao.create({...t,coerce:!0})),number:(t=>gl.create({...t,coerce:!0})),boolean:(t=>Zm.create({...t,coerce:!0})),bigint:(t=>yl.create({...t,coerce:!0})),date:(t=>Hu.create({...t,coerce:!0}))},Gae=ct,U3=Object.freeze(Object.defineProperty({__proto__:null,BRAND:pae,DIRTY:Ff,EMPTY_PATH:Goe,INVALID:ct,NEVER:Gae,OK:Cs,ParseStatus:ps,Schema:At,ZodAny:nh,ZodArray:_o,ZodBigInt:yl,ZodBoolean:Zm,ZodBranded:aN,ZodCatch:cg,ZodDate:Hu,ZodDefault:ag,ZodDiscriminatedUnion:p1,ZodEffects:Mo,ZodEnum:vl,ZodError:xi,get ZodFirstPartyTypeKind(){return ft},ZodFunction:Uf,ZodIntersection:ng,ZodIssueCode:Ce,ZodLazy:sg,ZodLiteral:ig,ZodMap:Ew,ZodNaN:Cw,ZodNativeEnum:og,ZodNever:dc,ZodNull:eg,ZodNullable:bl,ZodNumber:gl,ZodObject:Bn,ZodOptional:ya,ZodParsedType:He,ZodPipeline:n0,ZodPromise:rh,ZodReadonly:lg,ZodRecord:rg,ZodSchema:At,ZodSet:Wu,ZodString:Ao,ZodSymbol:Sw,ZodTransformer:Mo,ZodTuple:ka,ZodType:At,ZodUndefined:Jm,ZodUnion:tg,ZodUnknown:Pu,ZodVoid:kw,addIssueToContext:Le,any:NC,array:BV,bigint:vae,boolean:LV,coerce:Wae,custom:DV,date:bae,datetimeRegex:OV,defaultErrorMap:th,discriminatedUnion:Tae,effect:z3,enum:Dae,function:Rae,getErrorMap:xw,getParsedType:Ya,instanceof:gae,intersection:Aae,isAborted:CC,isAsync:Ym,isDirty:TC,isValid:ju,late:mae,lazy:Oae,literal:Pae,makeIssue:Iw,map:_ae,nan:yae,nativeEnum:Fae,never:kae,null:Iae,nullable:Mae,number:FV,object:Pm,get objectUtil(){return EC},oboolean:Hae,onumber:jae,optional:Bae,ostring:Vae,pipeline:Uae,preprocess:zae,promise:Lae,quotelessJson:Hoe,record:Nae,set:$ae,setErrorMap:Woe,strictObject:Cae,string:cN,symbol:wae,transformer:z3,tuple:zV,undefined:xae,union:MV,unknown:Sae,get util(){return jt},void:Eae},Symbol.toStringTag,{value:"Module"})),qae=t=>t.message?t.message:"unspecified error";class sh extends ht{constructor(e){super(),this.code=Uie,this.errors=e,super.message=`Web3 validator found ${e.length} error[s]:
${this._compileErrors().join(`
`)}`}_compileErrors(){return this.errors.map(qae)}}function ug(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Kae(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Xae(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function m1(t,...e){if(!Xae(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Qae(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ug(t.outputLen),ug(t.blockLen)}function _C(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function UV(t,e){m1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Yae={number:ug,bool:Kae,bytes:m1,hash:Qae,exists:_C,output:UV},Xv=BigInt(2**32-1),V3=BigInt(32);function Zae(t,e=!1){return e?{h:Number(t&Xv),l:Number(t>>V3&Xv)}:{h:Number(t>>V3&Xv)|0,l:Number(t&Xv)|0}}function Jae(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Zae(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const ece=(t,e,n)=>t<<n|e>>>32-n,tce=(t,e,n)=>e<<n|t>>>32-n,nce=(t,e,n)=>e<<n-32|t>>>64-n,rce=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sce=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),j3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,ice=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function H3(t){for(let e=0;e<t.length;e++)t[e]=ice(t[e])}function VV(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function jV(t){return typeof t=="string"&&(t=VV(t)),m1(t),t}let oce=class{clone(){return this._cloneInto()}};function ace(t){const e=r=>t().update(jV(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const HV=[],WV=[],GV=[],cce=BigInt(0),Zp=BigInt(1),lce=BigInt(2),uce=BigInt(7),dce=BigInt(256),fce=BigInt(113);for(let t=0,e=Zp,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],HV.push(2*(5*r+n)),WV.push((t+1)*(t+2)/2%64);let s=cce;for(let i=0;i<7;i++)e=(e<<Zp^(e>>uce)*fce)%dce,e&lce&&(s^=Zp<<(Zp<<BigInt(i))-Zp);GV.push(s)}const[hce,pce]=Jae(GV,!0),W3=(t,e,n)=>n>32?nce(t,e,n):ece(t,e,n),G3=(t,e,n)=>n>32?rce(t,e,n):tce(t,e,n);function mce(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=W3(l,u,1)^n[a],h=G3(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=WV[o],c=W3(s,i,a),l=G3(s,i,a),u=HV[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=hce[r],t[1]^=pce[r]}n.fill(0)}let gce=class qV extends oce{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ug(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=sce(this.state)}keccak(){j3||H3(this.state32),mce(this.state32,this.rounds),j3||H3(this.state32),this.posOut=0,this.pos=0}update(e){_C(this);const{blockLen:n,state:r}=this;e=jV(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){_C(this,!1),m1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ug(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(UV(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new qV(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const yce=(t,e,n)=>ace(()=>new gce(e,t,n)),q3=yce(1,136,256/8);function vce(t){return e=>(Yae.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const KV=(()=>{const t=vce(q3);return t.create=q3.create,t})(),bce=["bool","int","uint","bytes","string","address","tuple"],XV=t=>typeof t=="object"&&"type"in t&&"name"in t,lN=t=>typeof t=="string",pt=t=>typeof t=="string"&&/^((-)?0x[0-9a-f]+|(0x))$/i.test(t);function g1(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/))}const zo=t=>typeof t=="number"||typeof t=="bigint"||typeof t=="string"&&/^((-0x|0x|-)?[0-9a-f]+|(0x))$/i.test(t);function Dh(t){if(typeof t!="string")throw new Error(`[isHexPrefixed] input must be type 'string', received type ${typeof t}`);return t.startsWith("0x")}const Fh=function(t){for(const[e,n]of Object.entries(t))if(n!==void 0&&n.length>0&&n[0]===0)throw new Error(`${e} cannot have leading zeroes, received: ${n.toString()}`)},wce=["hex","number","blockNumber","blockNumberOrTag","filter","bloom"],bd=t=>{let e=t.replace(/ /,""),n,r=!1,s=[];if(t.includes("[")&&(e=e.slice(0,e.indexOf("[")),s=[...t.matchAll(/(?:\[(\d*)\])/g)].map(i=>parseInt(i[1],10)).map(i=>Number.isNaN(i)?-1:i),r=s.length>0),bce.includes(e))return{baseType:e,isArray:r,baseTypeSize:n,arraySizes:s};if(e.startsWith("int"))n=parseInt(e.substring(3),10),e="int";else if(e.startsWith("uint"))n=parseInt(t.substring(4),10),e="uint";else if(e.startsWith("bytes"))n=parseInt(e.substring(5),10),e="bytes";else return{baseType:void 0,isArray:!1,baseTypeSize:void 0,arraySizes:s};return{baseType:e,isArray:r,baseTypeSize:n,arraySizes:s}},UE=(t,e={})=>{if(Object.keys(e).includes("type"))throw new sh([{keyword:"eth",message:'Either "eth" or "type" can be presented in schema',params:{eth:t},instancePath:"",schemaPath:""}]);const{baseType:r,baseTypeSize:s}=bd(t);if(!r&&!wce.includes(t))throw new sh([{keyword:"eth",message:`Eth data type "${t}" is not valid`,params:{eth:t},instancePath:"",schemaPath:""}]);if(r){if(r==="tuple")throw new Error('"tuple" type is not implemented directly.');return{format:`${r}${s??""}`,required:!0}}return t?{format:t,required:!0}:{}},Tw=(t,e="/0")=>{const n={type:"array",items:[],maxItems:t.length,minItems:t.length};for(const[r,s]of t.entries()){let i,o,a=[];XV(s)?(i=s.type,o=s.name||`${e}/${r}`,a=s.components):typeof s=="string"?(i=s,o=`${e}/${r}`):Array.isArray(s)&&(s[0]&&typeof s[0]=="string"&&s[0].startsWith("tuple")&&!Array.isArray(s[0])&&s[1]&&Array.isArray(s[1])?(i=s[0],o=`${e}/${r}`,a=s[1]):(i="tuple",o=`${e}/${r}`,a=s));const{baseType:c,isArray:l,arraySizes:u}=bd(i);let d,h=n;for(let m=u.length-1;m>0;m-=1)d={type:"array",$id:o,items:[],maxItems:u[m],minItems:u[m]},u[m]<0&&(delete d.maxItems,delete d.minItems),Array.isArray(h.items)?h.items.length===0?h.items=[d]:h.items.push(d):h.items=[h.items,d],h=d;if(c==="tuple"&&!l){const m=Tw(a,o);m.$id=o,h.items.push(m)}else if(c==="tuple"&&l){const m=u[0],g=Object.assign({type:"array",$id:o,items:Tw(a,o)},m>=0&&{minItems:m,maxItems:m});h.items.push(g)}else if(l){const m=u[0],g=Object.assign({type:"array",$id:o,items:UE(i)},m>=0&&{minItems:m,maxItems:m});h.items.push(g)}else Array.isArray(h.items)?h.items.push(Object.assign({$id:o},UE(i))):h.items.push(Object.assign({$id:o},UE(i)));h=n}return n},Lh=t=>Tw(t),uN=(t,e)=>e===1?t:uN(t[0],e-1),Dm=(t,e,n)=>{const r=[];for(const[s,i]of t.entries()){let o,a,c=[];XV(i)?(o=i.type,a=i.name,c=i.components):typeof i=="string"?o=i:Array.isArray(i)&&(i[1]&&Array.isArray(i[1])?(o=i[0],c=i[1]):(o="tuple",c=i));const{baseType:l,isArray:u,arraySizes:d}=bd(o),h=Array.isArray(e)?e[s]:e[a];if(l==="tuple"&&!u)r.push(Dm(c,h,n));else if(l==="tuple"&&u){const m=[];for(const g of h)if(d.length>1){const v=uN(g,d.length-1),y=[];for(const w of v)y.push(Dm(c,w,n));m.push(y)}else m.push(Dm(c,g,n));r.push(m)}else r.push(h)}return n=n??[],n.push(...r),n},QV=t=>{if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-55;if(t>=97&&t<=102)return t-87;throw new Error(`Invalid code point: ${t}`)},wd=t=>{if(!pt(t))throw new Error("Invalid hex string");const[e,n]=t.startsWith("-")?[!0,t.slice(1)]:[!1,t],r=BigInt(n);return r>Number.MAX_SAFE_INTEGER?e?-r:r:r<Number.MIN_SAFE_INTEGER?r:e?-1*Number(r):Number(r)},Dl=t=>{if((typeof t=="number"||typeof t=="bigint")&&t<0)return`-0x${t.toString(16).slice(1)}`;if((typeof t=="number"||typeof t=="bigint")&&t>=0)return`0x${t.toString(16)}`;if(typeof t=="string"&&pt(t)){const[e,n]=t.startsWith("-")?[!0,t.slice(1)]:[!1,t],r=n.split(/^(-)?0(x|X)/).slice(-1)[0];return`${e?"-":""}0x${r.replace(/^0+/,"").toLowerCase()}`}if(typeof t=="string"&&!pt(t))return Dl(BigInt(t));throw new Pl(t)},so=(t,e,n="0")=>{if(typeof t=="string"&&!pt(t))return t.padStart(e,n);const r=typeof t=="string"&&pt(t)?t:Dl(t),[s,i]=r.startsWith("-")?["-0x",r.slice(3)]:["0x",r.slice(2)];return`${s}${i.padStart(e,n)}`};function Ur(t){let e="0x";for(const n of t){const r=n.toString(16);e+=r.length===1?`0${r}`:r}return e}const Ha={zero:48,nine:57,A:65,F:70,a:97,f:102};function K3(t){if(t>=Ha.zero&&t<=Ha.nine)return t-Ha.zero;if(t>=Ha.A&&t<=Ha.F)return t-(Ha.A-10);if(t>=Ha.a&&t<=Ha.f)return t-(Ha.a-10)}function kr(t){let e=0;if(t.startsWith("0")&&(t[1]==="x"||t[1]==="X")&&(e=2),t.length%2!==0)throw new Js(`hex string has odd length: ${t}`);const n=(t.length-e)/2,r=new Uint8Array(n);for(let s=0,i=e;s<n;s+=1){const o=K3(t.charCodeAt(i++)),a=K3(t.charCodeAt(i++));if(o===void 0||a===void 0)throw new Js(`Invalid byte sequence ("${t[i-2]}${t[i-1]}" in "${t}").`);r[s]=o*16+a}return r}function Go(t){var e;return!(t instanceof Uint8Array)&&((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"?Uint8Array.from(t):t}const Ai=Object.freeze(Object.defineProperty({__proto__:null,abiSchemaToJsonSchema:Tw,codePointToInt:QV,ensureIfUint8Array:Go,ethAbiToJsonSchema:Lh,fetchArrayElement:uN,hexToNumber:wd,hexToUint8Array:kr,numberToHex:Dl,padLeft:so,parseBaseType:bd,transformJsonDataToAbiFormat:Dm,uint8ArrayToHexString:Ur},Symbol.toStringTag,{value:"Module"})),$C=t=>{var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"},xc=(t,e={abiType:"bytes"})=>{if(typeof t!="string"&&!Array.isArray(t)&&!$C(t)||typeof t=="string"&&pt(t)&&t.startsWith("-")||typeof t=="string"&&!pt(t))return!1;let n;if(typeof t=="string"){if(t.length%2!==0)return!1;n=kr(t)}else if(Array.isArray(t)){if(t.some(r=>r<0||r>255||!Number.isInteger(r)))return!1;n=new Uint8Array(t)}else n=t;if(e?.abiType){const{baseTypeSize:r}=bd(e.abiType);return r?n.length===r:!0}return e?.size?n.length===e?.size:!0},YV=t=>{if(!/^(0x)?[0-9a-f]{40}$/i.test(t))return!1;const e=t.slice(2),n=VV(e.toLowerCase()),r=Ur(KV(Go(n))).slice(2);for(let s=0;s<40;s+=1)if(parseInt(r[s],16)>7&&e[s].toUpperCase()!==e[s]||parseInt(r[s],16)<=7&&e[s].toLowerCase()!==e[s])return!1;return!0},mr=(t,e=!0)=>{if(typeof t!="string"&&!$C(t))return!1;let n;return $C(t)?n=Ur(t):typeof t=="string"&&!pt(t)?n=t.toLowerCase().startsWith("0x")?t:`0x${t}`:n=t,/^(0x)?[0-9a-f]{40}$/i.test(n)?/^(0x|0X)?[0-9a-f]{40}$/.test(n)||/^(0x|0X)?[0-9A-F]{40}$/.test(n)?!0:e?YV(n):!0:!1},Gu=(t,e)=>{if(e===BigInt(0))return BigInt(1);let n=t;for(let r=1;r<e;r+=1)n*=t;return n},ki=(t,e={abiType:"uint"})=>{if(!["number","string","bigint"].includes(typeof t)||typeof t=="string"&&t.length===0)return!1;let n;if(e?.abiType){const{baseTypeSize:s}=bd(e.abiType);s&&(n=s)}else e.bitSize&&(n=e.bitSize);const r=Gu(BigInt(2),BigInt(n??256))-BigInt(1);try{const s=typeof t=="string"&&pt(t)?BigInt(wd(t)):BigInt(t);return s>=0&&s<=r}catch{return!1}},fc=(t,e={abiType:"int"})=>{if(!["number","string","bigint"].includes(typeof t)||typeof t=="number"&&t>Number.MAX_SAFE_INTEGER)return!1;let n;if(e?.abiType){const{baseTypeSize:i,baseType:o}=bd(e.abiType);if(o!=="int")return!1;i&&(n=i)}else e.bitSize&&(n=e.bitSize);const r=Gu(BigInt(2),BigInt((n??256)-1)),s=BigInt(-1)*Gu(BigInt(2),BigInt((n??256)-1));try{const i=typeof t=="string"&&pt(t)?BigInt(wd(t)):BigInt(t);return i>=s&&i<=r}catch{return!1}},ZV=t=>!!(fc(t)||typeof t=="string"&&/[0-9.]/.test(t)&&t.indexOf(".")===t.lastIndexOf(".")||typeof t=="number"),JV=t=>ki(t),Br=t=>Object.values(tc).includes(t),RC=t=>Br(t)||JV(t),Bh=t=>typeof t!="string"||!/^(0x)?[0-9a-f]{512}$/i.test(t)?!1:!!(/^(0x)?[0-9a-f]{512}$/.test(t)||/^(0x)?[0-9A-F]{512}$/.test(t)),y1=(t,e)=>{if(typeof e=="string"&&!pt(e)||!Bh(t))return!1;const n=typeof e=="string"?kr(e):e,r=Ur(KV(n)).slice(2);for(let s=0;s<12;s+=4){const i=(parseInt(r.slice(s,s+2),16)<<8)+parseInt(r.slice(s+2,s+4),16)&2047,o=QV(t.charCodeAt(t.length-1-Math.floor(i/4))),a=1<<i%4;if((o&a)!==a)return!1}return!0},xce=(t,e)=>{if(!Bh(t)||!mr(e))return!1;const n=so(e,64);return y1(t,n)},Ice=(t,e)=>!Bh(t)||!mr(e)?!1:y1(t,e),Sce=t=>["number","string","boolean"].includes(typeof t)?typeof t=="boolean"?!0:typeof t=="string"&&!pt(t)?t==="1"||t==="0":typeof t=="string"&&pt(t)?t==="0x1"||t==="0x0":t===1||t===0:!1,oe=t=>t==null,Rn=t=>typeof t=="object"&&!oe(t)&&!Array.isArray(t)&&!(t instanceof wc),Aw=t=>typeof t!="string"||!/^(0x)?[0-9a-f]{64}$/i.test(t)?!1:!!(/^(0x)?[0-9a-f]{64}$/.test(t)||/^(0x)?[0-9A-F]{64}$/.test(t)),kce=(t,e)=>!Bh(t)||!Aw(e)?!1:y1(t,e),Ece=t=>{const e=["fromBlock","toBlock","address","topics","blockHash"];if(oe(t)||typeof t!="object"||!Object.keys(t).every(n=>e.includes(n))||!oe(t.fromBlock)&&!RC(t.fromBlock)||!oe(t.toBlock)&&!RC(t.toBlock))return!1;if(!oe(t.address)){if(Array.isArray(t.address)){if(!t.address.every(n=>mr(n)))return!1}else if(!mr(t.address))return!1}return!(!oe(t.topics)&&!t.topics.every(n=>oe(n)?!0:Array.isArray(n)?n.every(r=>Aw(r)):!!Aw(n)))},qu={address:t=>mr(t),bloom:t=>Bh(t),blockNumber:t=>JV(t),blockTag:t=>Br(t),blockNumberOrTag:t=>RC(t),bool:t=>Sce(t),bytes:t=>xc(t),filter:t=>Ece(t),hex:t=>pt(t),uint:t=>ki(t),int:t=>fc(t),number:t=>ZV(t),string:t=>lN(t)};for(let t=8;t<=256;t+=8)qu[`int${t}`]=e=>fc(e,{bitSize:t}),qu[`uint${t}`]=e=>ki(e,{bitSize:t});for(let t=1;t<=32;t+=1)qu[`bytes${t}`]=e=>xc(e,{size:t});qu.bytes256=qu.bytes;const gm=t=>{if((!t?.type||t?.type==="object")&&t?.properties){const e={};for(const n of Object.keys(t.properties)){const r=gm(t.properties[n]);r&&(e[n]=r)}return Array.isArray(t.required)?Pm(e).partial().required(t.required.reduce((n,r)=>Object.assign(Object.assign({},n),{[r]:!0}),{})):Pm(e).partial()}if(t?.type==="array"&&t?.items){if(Array.isArray(t.items)&&t.items.length>1&&t.maxItems!==void 0&&new Set(t.items.map(r=>r.$id)).size===t.items.length){const r=[];for(const s of t.items){const i=gm(s);i&&r.push(i)}return zV(r)}const e=Array.isArray(t.items)?t.items[0]:t.items;let n=BV(gm(e));return n=t.minItems!==void 0?n.min(t.minItems):n,n=t.maxItems!==void 0?n.max(t.maxItems):n,n}if(t.oneOf&&Array.isArray(t.oneOf))return MV(t.oneOf.map(e=>gm(e)));if(t?.format){if(!qu[t.format])throw new Voe(t.format);return NC().refine(qu[t.format],e=>({params:{value:e,format:t.format}}))}return t?.type&&t?.type!=="object"&&typeof U3[String(t.type)]=="function"?U3[String(t.type)]():Pm({data:NC()}).partial()};class Lf{static factory(){return Lf.validatorInstance||(Lf.validatorInstance=new Lf),Lf.validatorInstance}validate(e,n,r){var s,i;const a=gm(e).safeParse(n);if(!a.success){const c=this.convertErrors((i=(s=a.error)===null||s===void 0?void 0:s.issues)!==null&&i!==void 0?i:[]);if(c){if(r?.silent)return c;throw new sh(c)}}}convertErrors(e){if(e&&Array.isArray(e)&&e.length>0)return e.map(n=>{var r;let s,i,o,a;a=n.path.join("/");const c=String(n.path[n.path.length-1]),l=n.path.join("/");if(n.code===Ce.too_big)i="maxItems",a=`${l}/maxItems`,o={limit:n.maximum},s=`must NOT have more than ${n.maximum} items`;else if(n.code===Ce.too_small)i="minItems",a=`${l}/minItems`,o={limit:n.minimum},s=`must NOT have fewer than ${n.minimum} items`;else if(n.code===Ce.custom){const{value:u,format:d}=(r=n.params)!==null&&r!==void 0?r:{};typeof u>"u"?s=`value at "/${a}" is required`:s=`value "${typeof u=="object"?JSON.stringify(u):u}" at "/${a}" must pass "${d}" validation`,o={value:u}}return{keyword:i??c,instancePath:l?`/${l}`:"",schemaPath:a?`#${a}`:"#",params:o??{value:n.message},message:s??n.message}})}}class Cce{constructor(){this._validator=Lf.factory()}validateJSONSchema(e,n,r){return this._validator.validate(e,n,r)}validate(e,n,r={silent:!1}){var s,i;const o=Lh(e);if(!(Array.isArray(o.items)&&((s=o.items)===null||s===void 0?void 0:s.length)===0&&n.length===0)){if(Array.isArray(o.items)&&((i=o.items)===null||i===void 0?void 0:i.length)===0&&n.length!==0)throw new sh([{instancePath:"/0",schemaPath:"/",keyword:"required",message:"empty schema against data can not be validated",params:n}]);return this._validator.validate(o,n,r)}}}const Me=new Cce;function Tce(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const OC=t=>{if(Me.validate(["bytes"],[t]),Tce(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Ace}=Ai,Nce=t=>Ace(OC(t)),ej=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?OC(`0x${t}`):OC(t),_ce=(t,e)=>{typeof t!="bigint"&&Me.validate(["int"],[t]);let n=Dl(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},$ce=(t,e)=>e?t<0?"int256":"uint256":_ce(t);var VE={exports:{}},X3;function Rce(){return X3||(X3=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||c,h),g=n?n+l:l;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,g=new Array(m);h<m;h++)g[h]=d[h].fn;return g},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,m,g){var v=n?n+l:l;if(!this._events[v])return!1;var y=this._events[v],w=arguments.length,x,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,m),!0;case 6:return y.fn.call(y.context,u,d,h,m,g),!0}for(S=1,x=new Array(w-1);S<w;S++)x[S-1]=arguments[S];y.fn.apply(y.context,x)}else{var k=y.length,E;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,h);break;default:if(!x)for(E=1,x=new Array(w-1);E<w;E++)x[E-1]=arguments[E];y[S].fn.apply(y[S].context,x)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,y=[],w=g.length;v<w;v++)(g[v].fn!==u||h&&!g[v].once||d&&g[v].context!==d)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(VE)),VE.exports}var Oce=Rce();const Pce=Wo(Oce);let Dce=class extends Pce{constructor(){super(...arguments),this.maxListeners=Number.MAX_SAFE_INTEGER}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}};const Ln=oe;function Fce(t){return joe(t)}const Lce=t=>Fce(t);function Bce(t){return(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}const Mce=()=>{const t=Lce(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;const e=Nce(t);return[e.substring(2,10),e.substring(10,14),e.substring(14,18),e.substring(18,22),e.substring(22,34)].join("-")},zce=t=>{const e=t.error.code;return hs.has(e)||e>=-32099&&e<=-32e3},Fm=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"result"in t&&oe(t.error)&&(typeof t.id=="number"||typeof t.id=="string"),Lm=t=>!Array.isArray(t)&&t.jsonrpc==="2.0"&&!!t&&oe(t.result)&&"error"in t&&(typeof t.id=="number"||typeof t.id=="string"),Uce=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&!oe(t.params)&&!oe(t.method),Q3=t=>Fm(t)||Lm(t),Vce=t=>Array.isArray(t)?t.every(Q3):Q3(t),jce=t=>Array.isArray(t)&&t.length>0&&Vce(t);let Hce;const dN=t=>{var e,n,r,s;return{jsonrpc:(e=t.jsonrpc)!==null&&e!==void 0?e:"2.0",id:(r=(n=t.id)!==null&&n!==void 0?n:Hce)!==null&&r!==void 0?r:Mce(),method:t.method,params:(s=t.params)!==null&&s!==void 0?s:void 0}},Wce=t=>t.map(e=>dN(e)),cu=t=>Array.isArray(t)&&t.length>0;var jE=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},tj;let Y3=class{constructor({timeout:e,eagerStart:n,timeoutMessage:r}={timeout:0,eagerStart:!1,timeoutMessage:"DeferredPromise timed out"}){this[tj]="Promise",this._state="pending",this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i}),this._timeoutMessage=r,this._timeoutInterval=e,n&&this.startTimer()}get state(){return this._state}then(e,n){return jE(this,void 0,void 0,function*(){return this._promise.then(e,n)})}catch(e){return jE(this,void 0,void 0,function*(){return this._promise.catch(e)})}finally(e){return jE(this,void 0,void 0,function*(){return this._promise.finally(e)})}resolve(e){this._resolve(e),this._state="fulfilled",this._clearTimeout()}reject(e){this._reject(e),this._state="rejected",this._clearTimeout()}startTimer(){this._timeoutInterval&&this._timeoutInterval>0&&(this._timeoutId=setTimeout(this._checkTimeout.bind(this),this._timeoutInterval))}_checkTimeout(){this._state==="pending"&&this._timeoutId&&this.reject(new h1(this._timeoutMessage))}_clearTimeout(){this._timeoutId&&clearTimeout(this._timeoutId)}};tj=Symbol.toStringTag;class v1{constructor(){this._emitter=new Dce}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,n){this._emitter.emit(e,n)}listenerCount(e){return this._emitter.listenerCount(e)}listeners(e){return this._emitter.listeners(e)}eventNames(){return this._emitter.eventNames()}removeAllListeners(){return this._emitter.removeAllListeners()}setMaxListenerWarningThreshold(e){this._emitter.setMaxListeners(e)}getMaxListeners(){return this._emitter.getMaxListeners()}}var Ku;(function(t){t.CONFIG_CHANGE="CONFIG_CHANGE"})(Ku||(Ku={}));class Gce extends v1{constructor(e){super(),this.config={handleRevert:!1,defaultAccount:void 0,defaultBlock:"latest",transactionBlockTimeout:50,transactionConfirmationBlocks:24,transactionPollingInterval:1e3,transactionPollingTimeout:750*1e3,transactionReceiptPollingInterval:void 0,transactionSendTimeout:750*1e3,transactionConfirmationPollingInterval:void 0,blockHeaderTimeout:10,maxListenersWarningThreshold:100,contractDataInputFill:"data",defaultNetworkId:void 0,defaultChain:"mainnet",defaultHardfork:"london",defaultCommon:void 0,defaultTransactionType:"0x2",defaultMaxPriorityFeePerGas:$ce(25e8),enableExperimentalFeatures:{useSubscriptionWhenCheckingBlockTimeout:!1,useRpcCallSpecification:!1},transactionBuilder:void 0,transactionTypeParser:void 0,customTransactionSchema:void 0,defaultReturnFormat:Fr,ignoreGasPricing:!1},this.setConfig(e??{})}setConfig(e){const n=Object.keys(e);for(const r of n)this._triggerConfigChange(r,e[r]),!Ln(e[r])&&typeof e[r]=="number"&&r==="maxListenersWarningThreshold"&&this.setMaxListenerWarningThreshold(Number(e[r]));Object.assign(this.config,e)}get handleRevert(){return this.config.handleRevert}set handleRevert(e){this._triggerConfigChange("handleRevert",e),this.config.handleRevert=e}get contractDataInputFill(){return this.config.contractDataInputFill}set contractDataInputFill(e){this._triggerConfigChange("contractDataInputFill",e),this.config.contractDataInputFill=e}get defaultAccount(){return this.config.defaultAccount}set defaultAccount(e){this._triggerConfigChange("defaultAccount",e),this.config.defaultAccount=e}get defaultBlock(){return this.config.defaultBlock}set defaultBlock(e){this._triggerConfigChange("defaultBlock",e),this.config.defaultBlock=e}get transactionSendTimeout(){return this.config.transactionSendTimeout}set transactionSendTimeout(e){this._triggerConfigChange("transactionSendTimeout",e),this.config.transactionSendTimeout=e}get transactionBlockTimeout(){return this.config.transactionBlockTimeout}set transactionBlockTimeout(e){this._triggerConfigChange("transactionBlockTimeout",e),this.config.transactionBlockTimeout=e}get transactionConfirmationBlocks(){return this.config.transactionConfirmationBlocks}set transactionConfirmationBlocks(e){this._triggerConfigChange("transactionConfirmationBlocks",e),this.config.transactionConfirmationBlocks=e}get transactionPollingInterval(){return this.config.transactionPollingInterval}set transactionPollingInterval(e){this._triggerConfigChange("transactionPollingInterval",e),this.config.transactionPollingInterval=e,this.transactionReceiptPollingInterval=e,this.transactionConfirmationPollingInterval=e}get transactionPollingTimeout(){return this.config.transactionPollingTimeout}set transactionPollingTimeout(e){this._triggerConfigChange("transactionPollingTimeout",e),this.config.transactionPollingTimeout=e}get transactionReceiptPollingInterval(){return this.config.transactionReceiptPollingInterval}set transactionReceiptPollingInterval(e){this._triggerConfigChange("transactionReceiptPollingInterval",e),this.config.transactionReceiptPollingInterval=e}get transactionConfirmationPollingInterval(){return this.config.transactionConfirmationPollingInterval}set transactionConfirmationPollingInterval(e){this._triggerConfigChange("transactionConfirmationPollingInterval",e),this.config.transactionConfirmationPollingInterval=e}get blockHeaderTimeout(){return this.config.blockHeaderTimeout}set blockHeaderTimeout(e){this._triggerConfigChange("blockHeaderTimeout",e),this.config.blockHeaderTimeout=e}get enableExperimentalFeatures(){return this.config.enableExperimentalFeatures}set enableExperimentalFeatures(e){this._triggerConfigChange("enableExperimentalFeatures",e),this.config.enableExperimentalFeatures=e}get maxListenersWarningThreshold(){return this.config.maxListenersWarningThreshold}set maxListenersWarningThreshold(e){this._triggerConfigChange("maxListenersWarningThreshold",e),this.setMaxListenerWarningThreshold(e),this.config.maxListenersWarningThreshold=e}get defaultReturnFormat(){return this.config.defaultReturnFormat}set defaultReturnFormat(e){this._triggerConfigChange("defaultReturnFormat",e),this.config.defaultReturnFormat=e}get defaultNetworkId(){return this.config.defaultNetworkId}set defaultNetworkId(e){this._triggerConfigChange("defaultNetworkId",e),this.config.defaultNetworkId=e}get defaultChain(){return this.config.defaultChain}set defaultChain(e){if(!Ln(this.config.defaultCommon)&&!Ln(this.config.defaultCommon.baseChain)&&e!==this.config.defaultCommon.baseChain)throw new L3(this.config.defaultChain,e);this._triggerConfigChange("defaultChain",e),this.config.defaultChain=e}get defaultHardfork(){return this.config.defaultHardfork}set defaultHardfork(e){if(!Ln(this.config.defaultCommon)&&!Ln(this.config.defaultCommon.hardfork)&&e!==this.config.defaultCommon.hardfork)throw new F3(this.config.defaultCommon.hardfork,e);this._triggerConfigChange("defaultHardfork",e),this.config.defaultHardfork=e}get defaultCommon(){return this.config.defaultCommon}set defaultCommon(e){if(!Ln(this.config.defaultHardfork)&&!Ln(e)&&!Ln(e.hardfork)&&this.config.defaultHardfork!==e.hardfork)throw new F3(this.config.defaultHardfork,e.hardfork);if(!Ln(this.config.defaultChain)&&!Ln(e)&&!Ln(e.baseChain)&&this.config.defaultChain!==e.baseChain)throw new L3(this.config.defaultChain,e.baseChain);this._triggerConfigChange("defaultCommon",e),this.config.defaultCommon=e}get ignoreGasPricing(){return this.config.ignoreGasPricing}set ignoreGasPricing(e){this._triggerConfigChange("ignoreGasPricing",e),this.config.ignoreGasPricing=e}get defaultTransactionType(){return this.config.defaultTransactionType}set defaultTransactionType(e){this._triggerConfigChange("defaultTransactionType",e),this.config.defaultTransactionType=e}get defaultMaxPriorityFeePerGas(){return this.config.defaultMaxPriorityFeePerGas}set defaultMaxPriorityFeePerGas(e){this._triggerConfigChange("defaultMaxPriorityFeePerGas",e),this.config.defaultMaxPriorityFeePerGas=e}get transactionBuilder(){return this.config.transactionBuilder}set transactionBuilder(e){this._triggerConfigChange("transactionBuilder",e),this.config.transactionBuilder=e}get transactionTypeParser(){return this.config.transactionTypeParser}set transactionTypeParser(e){this._triggerConfigChange("transactionTypeParser",e),this.config.transactionTypeParser=e}get customTransactionSchema(){return this.config.customTransactionSchema}set customTransactionSchema(e){this._triggerConfigChange("customTransactionSchema",e),this.config.customTransactionSchema=e}_triggerConfigChange(e,n){this.emit(Ku.CONFIG_CHANGE,{name:e,oldValue:this.config[e],newValue:n})}}var Qv={exports:{}},Z3;function qce(){return Z3||(Z3=1,(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Df<"u"&&Df,r=(function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Df<"u"&&Df||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(D){return D&&DataView.prototype.isPrototypeOf(D)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(D){return D&&u.indexOf(Object.prototype.toString.call(D))>-1};function h(D){if(typeof D!="string"&&(D=String(D)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(D)||D==="")throw new TypeError('Invalid character in header field name: "'+D+'"');return D.toLowerCase()}function m(D){return typeof D!="string"&&(D=String(D)),D}function g(D){var L={next:function(){var K=D.shift();return{done:K===void 0,value:K}}};return c.iterable&&(L[Symbol.iterator]=function(){return L}),L}function v(D){this.map={},D instanceof v?D.forEach(function(L,K){this.append(K,L)},this):Array.isArray(D)?D.forEach(function(L){if(L.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+L.length);this.append(L[0],L[1])},this):D&&Object.getOwnPropertyNames(D).forEach(function(L){this.append(L,D[L])},this)}v.prototype.append=function(D,L){D=h(D),L=m(L);var K=this.map[D];this.map[D]=K?K+", "+L:L},v.prototype.delete=function(D){delete this.map[h(D)]},v.prototype.get=function(D){return D=h(D),this.has(D)?this.map[D]:null},v.prototype.has=function(D){return this.map.hasOwnProperty(h(D))},v.prototype.set=function(D,L){this.map[h(D)]=m(L)},v.prototype.forEach=function(D,L){for(var K in this.map)this.map.hasOwnProperty(K)&&D.call(L,this.map[K],K,this)},v.prototype.keys=function(){var D=[];return this.forEach(function(L,K){D.push(K)}),g(D)},v.prototype.values=function(){var D=[];return this.forEach(function(L){D.push(L)}),g(D)},v.prototype.entries=function(){var D=[];return this.forEach(function(L,K){D.push([K,L])}),g(D)},c.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries);function y(D){if(!D._noBody){if(D.bodyUsed)return Promise.reject(new TypeError("Already read"));D.bodyUsed=!0}}function w(D){return new Promise(function(L,K){D.onload=function(){L(D.result)},D.onerror=function(){K(D.error)}})}function x(D){var L=new FileReader,K=w(L);return L.readAsArrayBuffer(D),K}function S(D){var L=new FileReader,K=w(L),j=/charset=([A-Za-z0-9_-]+)/.exec(D.type),W=j?j[1]:"utf-8";return L.readAsText(D,W),K}function k(D){for(var L=new Uint8Array(D),K=new Array(L.length),j=0;j<L.length;j++)K[j]=String.fromCharCode(L[j]);return K.join("")}function E(D){if(D.slice)return D.slice(0);var L=new Uint8Array(D.byteLength);return L.set(new Uint8Array(D)),L.buffer}function A(){return this.bodyUsed=!1,this._initBody=function(D){this.bodyUsed=this.bodyUsed,this._bodyInit=D,D?typeof D=="string"?this._bodyText=D:c.blob&&Blob.prototype.isPrototypeOf(D)?this._bodyBlob=D:c.formData&&FormData.prototype.isPrototypeOf(D)?this._bodyFormData=D:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)?this._bodyText=D.toString():c.arrayBuffer&&c.blob&&l(D)?(this._bodyArrayBuffer=E(D.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(D)||d(D))?this._bodyArrayBuffer=E(D):this._bodyText=D=Object.prototype.toString.call(D):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof D=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var D=y(this);if(D)return D;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var D=y(this);return D||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(x);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var D=y(this);if(D)return D;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(k(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function N(D){var L=D.toUpperCase();return R.indexOf(L)>-1?L:D}function P(D,L){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');L=L||{};var K=L.body;if(D instanceof P){if(D.bodyUsed)throw new TypeError("Already read");this.url=D.url,this.credentials=D.credentials,L.headers||(this.headers=new v(D.headers)),this.method=D.method,this.mode=D.mode,this.signal=D.signal,!K&&D._bodyInit!=null&&(K=D._bodyInit,D.bodyUsed=!0)}else this.url=String(D);if(this.credentials=L.credentials||this.credentials||"same-origin",(L.headers||!this.headers)&&(this.headers=new v(L.headers)),this.method=N(L.method||this.method||"GET"),this.mode=L.mode||this.mode||null,this.signal=L.signal||this.signal||(function(){if("AbortController"in a){var X=new AbortController;return X.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&K)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(K),(this.method==="GET"||this.method==="HEAD")&&(L.cache==="no-store"||L.cache==="no-cache")){var j=/([?&])_=[^&]*/;if(j.test(this.url))this.url=this.url.replace(j,"$1_="+new Date().getTime());else{var W=/\?/;this.url+=(W.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}P.prototype.clone=function(){return new P(this,{body:this._bodyInit})};function O(D){var L=new FormData;return D.trim().split("&").forEach(function(K){if(K){var j=K.split("="),W=j.shift().replace(/\+/g," "),X=j.join("=").replace(/\+/g," ");L.append(decodeURIComponent(W),decodeURIComponent(X))}}),L}function _(D){var L=new v,K=D.replace(/\r?\n[\t ]+/g," ");return K.split("\r").map(function(j){return j.indexOf(`
`)===0?j.substr(1,j.length):j}).forEach(function(j){var W=j.split(":"),X=W.shift().trim();if(X){var H=W.join(":").trim();try{L.append(X,H)}catch(Y){console.warn("Response "+Y.message)}}}),L}A.call(P.prototype);function M(D,L){if(!(this instanceof M))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(L||(L={}),this.type="default",this.status=L.status===void 0?200:L.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=L.statusText===void 0?"":""+L.statusText,this.headers=new v(L.headers),this.url=L.url||"",this._initBody(D)}A.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},M.error=function(){var D=new M(null,{status:200,statusText:""});return D.ok=!1,D.status=0,D.type="error",D};var G=[301,302,303,307,308];M.redirect=function(D,L){if(G.indexOf(L)===-1)throw new RangeError("Invalid status code");return new M(null,{status:L,headers:{location:D}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(L,K){this.message=L,this.name=K;var j=Error(L);this.stack=j.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function q(D,L){return new Promise(function(K,j){var W=new P(D,L);if(W.signal&&W.signal.aborted)return j(new o.DOMException("Aborted","AbortError"));var X=new XMLHttpRequest;function H(){X.abort()}X.onload=function(){var de={statusText:X.statusText,headers:_(X.getAllResponseHeaders()||"")};W.url.indexOf("file://")===0&&(X.status<200||X.status>599)?de.status=200:de.status=X.status,de.url="responseURL"in X?X.responseURL:de.headers.get("X-Request-URL");var ge="response"in X?X.response:X.responseText;setTimeout(function(){K(new M(ge,de))},0)},X.onerror=function(){setTimeout(function(){j(new TypeError("Network request failed"))},0)},X.ontimeout=function(){setTimeout(function(){j(new TypeError("Network request timed out"))},0)},X.onabort=function(){setTimeout(function(){j(new o.DOMException("Aborted","AbortError"))},0)};function Y(de){try{return de===""&&a.location.href?a.location.href:de}catch{return de}}if(X.open(W.method,Y(W.url),!0),W.credentials==="include"?X.withCredentials=!0:W.credentials==="omit"&&(X.withCredentials=!1),"responseType"in X&&(c.blob?X.responseType="blob":c.arrayBuffer&&(X.responseType="arraybuffer")),L&&typeof L.headers=="object"&&!(L.headers instanceof v||a.Headers&&L.headers instanceof a.Headers)){var ce=[];Object.getOwnPropertyNames(L.headers).forEach(function(de){ce.push(h(de)),X.setRequestHeader(de,m(L.headers[de]))}),W.headers.forEach(function(de,ge){ce.indexOf(ge)===-1&&X.setRequestHeader(ge,de)})}else W.headers.forEach(function(de,ge){X.setRequestHeader(ge,de)});W.signal&&(W.signal.addEventListener("abort",H),X.onreadystatechange=function(){X.readyState===4&&W.signal.removeEventListener("abort",H)}),X.send(typeof W._bodyInit>"u"?null:W._bodyInit)})}return q.polyfill=!0,a.fetch||(a.fetch=q,a.Headers=v,a.Request=P,a.Response=M),o.Headers=v,o.Request=P,o.Response=M,o.fetch=q,o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Qv,Qv.exports)),Qv.exports}var Kce=qce();const Xce=Wo(Kce);var Qce=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class b1 extends yd{constructor(e,n){if(super(),!b1.validateClientUrl(e))throw new Qm(e);this.clientUrl=e,this.httpProviderOptions=n}static validateClientUrl(e){return typeof e=="string"?/^http(s)?:\/\//i.test(e):!1}getStatus(){throw new ja}supportsSubscriptions(){return!1}request(e,n){var r;return Qce(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},(r=this.httpProviderOptions)===null||r===void 0?void 0:r.providerOptions),n),i=yield Xce(this.clientUrl,Object.assign(Object.assign({},s),{method:"POST",headers:Object.assign(Object.assign({},s.headers),{"Content-Type":"application/json"}),body:JSON.stringify(e)}));if(!i.ok)throw new ca(yield i.json(),void 0,void 0,i.status);return yield i.json()})}on(){throw new ja}removeListener(){throw new ja}once(){throw new ja}removeAllListeners(){throw new ja}connect(){throw new ja}disconnect(){throw new ja}reset(){throw new ja}reconnect(){throw new ja}}var Sf=null;typeof WebSocket<"u"?Sf=WebSocket:typeof MozWebSocket<"u"?Sf=MozWebSocket:typeof global<"u"?Sf=global.WebSocket||global.MozWebSocket:typeof window<"u"?Sf=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Sf=self.WebSocket||self.MozWebSocket);const Yce=Sf,HE=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Zce(t=32){if(HE&&typeof HE.getRandomValues=="function")return HE.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Jce(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const ele=t=>{if(Me.validate(["bytes"],[t]),Jce(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:tle}=Ai,nle=t=>tle(ele(t));var WE={exports:{}},J3;function rle(){return J3||(J3=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||c,h),g=n?n+l:l;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,g=new Array(m);h<m;h++)g[h]=d[h].fn;return g},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,m,g){var v=n?n+l:l;if(!this._events[v])return!1;var y=this._events[v],w=arguments.length,x,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,m),!0;case 6:return y.fn.call(y.context,u,d,h,m,g),!0}for(S=1,x=new Array(w-1);S<w;S++)x[S-1]=arguments[S];y.fn.apply(y.context,x)}else{var k=y.length,E;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,h);break;default:if(!x)for(E=1,x=new Array(w-1);E<w;E++)x[E-1]=arguments[E];y[S].fn.apply(y[S].context,x)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,y=[],w=g.length;v<w;v++)(g[v].fn!==u||h&&!g[v].once||d&&g[v].context!==d)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(WE)),WE.exports}var sle=rle();const ile=Wo(sle),PC=oe;function ole(t){return Zce(t)}const ale=t=>ole(t),cle=()=>{const t=ale(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;const e=nle(t);return[e.substring(2,10),e.substring(10,14),e.substring(14,18),e.substring(18,22),e.substring(22,34)].join("-")},nj=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"result"in t&&oe(t.error)&&(typeof t.id=="number"||typeof t.id=="string"),rj=t=>!Array.isArray(t)&&t.jsonrpc==="2.0"&&!!t&&oe(t.result)&&"error"in t&&(typeof t.id=="number"||typeof t.id=="string"),lle=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&!oe(t.params)&&!oe(t.method),eL=t=>nj(t)||rj(t),ule=t=>Array.isArray(t)?t.every(eL):eL(t),tL=t=>Array.isArray(t)&&t.length>0&&ule(t);let dle;const nL=t=>{var e,n,r,s;return{jsonrpc:(e=t.jsonrpc)!==null&&e!==void 0?e:"2.0",id:(r=(n=t.id)!==null&&n!==void 0?n:dle)!==null&&r!==void 0?r:cle(),method:t.method,params:(s=t.params)!==null&&s!==void 0?s:void 0}},fle=t=>Array.isArray(t)&&t.length>0;var GE=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},sj;let hle=class{constructor({timeout:e,eagerStart:n,timeoutMessage:r}={timeout:0,eagerStart:!1,timeoutMessage:"DeferredPromise timed out"}){this[sj]="Promise",this._state="pending",this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i}),this._timeoutMessage=r,this._timeoutInterval=e,n&&this.startTimer()}get state(){return this._state}then(e,n){return GE(this,void 0,void 0,function*(){return this._promise.then(e,n)})}catch(e){return GE(this,void 0,void 0,function*(){return this._promise.catch(e)})}finally(e){return GE(this,void 0,void 0,function*(){return this._promise.finally(e)})}resolve(e){this._resolve(e),this._state="fulfilled",this._clearTimeout()}reject(e){this._reject(e),this._state="rejected",this._clearTimeout()}startTimer(){this._timeoutInterval&&this._timeoutInterval>0&&(this._timeoutId=setTimeout(this._checkTimeout.bind(this),this._timeoutInterval))}_checkTimeout(){this._state==="pending"&&this._timeoutId&&this.reject(new h1(this._timeoutMessage))}_clearTimeout(){this._timeoutId&&clearTimeout(this._timeoutId)}};sj=Symbol.toStringTag;let ple=class{constructor(e,n){this.eventEmitter=e,this.autoReconnect=n,this.chunkTimeout=1e3*15}clearQueues(){typeof this._clearQueues=="function"&&this._clearQueues()}onError(e){this._clearQueues=e}parseResponse(e){const n=[];return e.replace(/\}[\n\r]?\{/g,"}|--|{").replace(/\}\][\n\r]?\[\{/g,"}]|--|[{").replace(/\}[\n\r]?\[\{/g,"}|--|[{").replace(/\}\][\n\r]?\{/g,"}]|--|{").split("|--|").forEach(s=>{let i=s;this.lastChunk&&(i=this.lastChunk+i);let o;try{o=JSON.parse(i)}catch{this.lastChunk=i,this.lastChunkTimeout&&clearTimeout(this.lastChunkTimeout),this.lastChunkTimeout=setTimeout(()=>{this.autoReconnect||(this.clearQueues(),this.eventEmitter.emit("error",new t0({id:1,jsonrpc:"2.0",error:{code:2,message:"Chunk timeout"}})))},this.chunkTimeout);return}clearTimeout(this.lastChunkTimeout),this.lastChunk=void 0,o&&n.push(o)}),n}};var rL=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};let mle=class extends yd{constructor(){super(...arguments),this._eventEmitter=new ile,this._chainId="",this._accounts=[]}_getChainId(){return rL(this,void 0,void 0,function*(){var e;const n=yield this.request(nL({method:"eth_chainId",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:""})}_getAccounts(){return rL(this,void 0,void 0,function*(){var e;const n=yield this.request(nL({method:"eth_accounts",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:[]})}_onConnect(){Promise.all([this._getChainId().then(e=>{e!==this._chainId&&(this._chainId=e,this._eventEmitter.emit("chainChanged",this._chainId))}).catch(e=>{console.error(e)}),this._getAccounts().then(e=>{this._accounts.length===e.length&&e.every(n=>e.includes(n))||(this._accounts=e,this._onAccountsChanged())}).catch(e=>{console.error(e)})]).then(()=>this._eventEmitter.emit("connect",{chainId:this._chainId})).catch(e=>{console.error(e)})}_onDisconnect(e,n){this._eventEmitter.emit("disconnect",new oN(e,n))}_onAccountsChanged(){this._eventEmitter.emit("accountsChanged",this._accounts)}};var qE=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const gle={autoReconnect:!0,delay:5e3,maxAttempts:5},yle=1e3;let vle=class extends mle{get SocketConnection(){return this._socketConnection}constructor(e,n,r){if(super(),this._connectionStatus="connecting",this._onMessageHandler=this._onMessage.bind(this),this._onOpenHandler=this._onConnect.bind(this),this._onCloseHandler=this._onCloseEvent.bind(this),this._onErrorHandler=this._onError.bind(this),!this._validateProviderPath(e))throw new Qm(e);this._socketPath=e,this._socketOptions=n,this._reconnectOptions=Object.assign(Object.assign({},gle),r??{}),this._pendingRequestsQueue=new Map,this._sentRequestsQueue=new Map,this._init(),this.connect(),this.chunkResponseParser=new ple(this._eventEmitter,this._reconnectOptions.autoReconnect),this.chunkResponseParser.onError(()=>{this._clearQueues()}),this.isReconnecting=!1}_init(){this._reconnectAttempts=0}connect(){try{this._openSocketConnection(),this._connectionStatus="connecting",this._addSocketListeners()}catch(e){if(this.isReconnecting)setImmediate(()=>{this._reconnect()});else throw this._connectionStatus="disconnected",e&&e.message?new Ph(`Error while connecting to ${this._socketPath}. Reason: ${e.message}`):new Qm(this._socketPath)}}_validateProviderPath(e){return!!e}getPendingRequestQueueSize(){return this._pendingRequestsQueue.size}getSentRequestsQueueSize(){return this._sentRequestsQueue.size}supportsSubscriptions(){return!0}on(e,n){this._eventEmitter.on(e,n)}once(e,n){this._eventEmitter.once(e,n)}removeListener(e,n){this._eventEmitter.removeListener(e,n)}_onDisconnect(e,n){this._connectionStatus="disconnected",super._onDisconnect(e,n)}disconnect(e,n){const r=e??yle;this._removeSocketListeners(),this.getStatus()!=="disconnected"&&this._closeSocketConnection(r,n),this._onDisconnect(r,n)}safeDisconnect(e,n){return qE(this,arguments,void 0,function*(r,s,i=!1,o=1e3){let a=0;yield qE(this,void 0,void 0,function*(){return new Promise(l=>{const u=setInterval(()=>{i&&a>=5&&this.clearQueues(),this.getPendingRequestQueueSize()===0&&this.getSentRequestsQueueSize()===0&&(clearInterval(u),l(!0)),a+=1},o)})}),this.disconnect(r,s)})}removeAllListeners(e){this._eventEmitter.removeAllListeners(e)}_onError(e){this.isReconnecting?this._reconnect():this._eventEmitter.emit("error",e)}reset(){this._sentRequestsQueue.clear(),this._pendingRequestsQueue.clear(),this._init(),this._removeSocketListeners(),this._addSocketListeners()}_reconnect(){this.isReconnecting||(this.isReconnecting=!0,this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((e,n)=>{e.deferredPromise.reject(new gV),this._sentRequestsQueue.delete(n)}),this._reconnectAttempts<this._reconnectOptions.maxAttempts?(this._reconnectAttempts+=1,setTimeout(()=>{this._removeSocketListeners(),this.connect(),this.isReconnecting=!1},this._reconnectOptions.delay)):(this.isReconnecting=!1,this._clearQueues(),this._removeSocketListeners(),this._eventEmitter.emit("error",new mV(this._reconnectOptions.maxAttempts))))}request(e){return qE(this,void 0,void 0,function*(){if(PC(this._socketConnection))throw new Error("Connection is undefined");this.getStatus()==="disconnected"&&this.connect();const n=fle(e)?e[0].id:e.id;if(!n)throw new vV("Request Id not defined");if(this._sentRequestsQueue.has(n))throw new yV(n);const r=new hle;r.catch(i=>{this._eventEmitter.emit("error",i)});const s={payload:e,deferredPromise:r};if(this.getStatus()==="connecting")return this._pendingRequestsQueue.set(n,s),s.deferredPromise;this._sentRequestsQueue.set(n,s);try{this._sendToSocket(s.payload)}catch(i){this._sentRequestsQueue.delete(n),this._eventEmitter.emit("error",i)}return r})}_onConnect(){this._connectionStatus="connected",this._reconnectAttempts=0,super._onConnect(),this._sendPendingRequests()}_sendPendingRequests(){for(const[e,n]of this._pendingRequestsQueue.entries())try{this._sendToSocket(n.payload),this._pendingRequestsQueue.delete(e),this._sentRequestsQueue.set(e,n)}catch(r){this._pendingRequestsQueue.delete(e),this._eventEmitter.emit("error",r)}}_onMessage(e){const n=this._parseResponses(e);if(!(PC(n)||n.length===0))for(const r of n){if(lle(r)&&r.method.endsWith("_subscription")){this._eventEmitter.emit("message",r);return}const s=tL(r)?r[0].id:r.id,i=this._sentRequestsQueue.get(s);if(!i)return;(tL(r)||nj(r)||rj(r))&&(this._eventEmitter.emit("message",r),i.deferredPromise.resolve(r)),this._sentRequestsQueue.delete(s)}}clearQueues(e){this._clearQueues(e)}_clearQueues(e){this._pendingRequestsQueue.size>0&&this._pendingRequestsQueue.forEach((n,r)=>{n.deferredPromise.reject(new Xm(e)),this._pendingRequestsQueue.delete(r)}),this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((n,r)=>{n.deferredPromise.reject(new Xm(e)),this._sentRequestsQueue.delete(r)}),this._removeSocketListeners()}};class ij extends vle{constructor(e,n,r){super(e,n,r)}_validateProviderPath(e){return typeof e=="string"?/^ws(s)?:\/\//i.test(e):!1}getStatus(){if(this._socketConnection&&!PC(this._socketConnection))switch(this._socketConnection.readyState){case this._socketConnection.CONNECTING:return"connecting";case this._socketConnection.OPEN:return"connected";default:return"disconnected"}return"disconnected"}_openSocketConnection(){this._socketConnection=new Yce(this._socketPath,void 0,this._socketOptions&&Object.keys(this._socketOptions).length===0?void 0:this._socketOptions)}_closeSocketConnection(e,n){var r;(r=this._socketConnection)===null||r===void 0||r.close(e,n)}_sendToSocket(e){var n;if(this.getStatus()==="disconnected")throw new Xm;(n=this._socketConnection)===null||n===void 0||n.send(JSON.stringify(e))}_parseResponses(e){return this.chunkResponseParser.parseResponse(e.data)}_addSocketListeners(){var e,n,r,s;(e=this._socketConnection)===null||e===void 0||e.addEventListener("open",this._onOpenHandler),(n=this._socketConnection)===null||n===void 0||n.addEventListener("message",this._onMessageHandler),(r=this._socketConnection)===null||r===void 0||r.addEventListener("close",i=>this._onCloseHandler(i)),(s=this._socketConnection)===null||s===void 0||s.addEventListener("error",this._onErrorHandler)}_removeSocketListeners(){var e,n,r;(e=this._socketConnection)===null||e===void 0||e.removeEventListener("message",this._onMessageHandler),(n=this._socketConnection)===null||n===void 0||n.removeEventListener("open",this._onOpenHandler),(r=this._socketConnection)===null||r===void 0||r.removeEventListener("close",this._onCloseHandler)}_onCloseEvent(e){var n;if(this._reconnectOptions.autoReconnect&&(![1e3,1001].includes(e.code)||!e.wasClean)){this._reconnect();return}this._clearQueues(e),this._removeSocketListeners(),this._onDisconnect(e.code,e.reason),(n=this._socketConnection)===null||n===void 0||n.removeEventListener("error",this._onErrorHandler)}}const oj=t=>yd.isWeb3Provider(t),aj=t=>typeof t!="string"&&"request"in t&&t.request.constructor.name==="Function",cj=t=>typeof t!="string"&&"request"in t&&t.request.constructor.name==="AsyncFunction",lj=t=>typeof t!="string"&&"send"in t,uj=t=>typeof t!="string"&&"sendAsync"in t,Nw=t=>t&&(oj(t)||cj(t)||aj(t)||uj(t)||lj(t)),ble=t=>t&&"supportsSubscriptions"in t?t.supportsSubscriptions():!!(t&&typeof t!="string"&&"on"in t);var KE=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},ih;(function(t){t.PROVIDER_CHANGED="PROVIDER_CHANGED",t.BEFORE_PROVIDER_CHANGE="BEFORE_PROVIDER_CHANGE"})(ih||(ih={}));const sL={HttpProvider:b1,WebsocketProvider:ij};class Du extends v1{constructor(e,n,r){super(),Ln(e)||this.setProvider(e),this.useRpcCallSpecification=n,Ln(r)||(this.middleware=r)}static get providers(){return sL}get provider(){return this._provider}get providers(){return sL}setProvider(e){let n;if(e&&typeof e=="string"&&this.providers)if(/^http(s)?:\/\//i.test(e))n=new this.providers.HttpProvider(e);else if(/^ws(s)?:\/\//i.test(e))n=new this.providers.WebsocketProvider(e);else throw new Ob(`Can't autodetect provider for "${e}"`);else Ln(e)?n=void 0:n=e;return this.emit(ih.BEFORE_PROVIDER_CHANGE,this._provider),this._provider=n,this.emit(ih.PROVIDER_CHANGED,this._provider),!0}setMiddleware(e){this.middleware=e}send(e){return KE(this,void 0,void 0,function*(){const n=Object.assign({},e);let r=yield this._sendRequest(n);if(Ln(this.middleware)||(r=yield this.middleware.processResponse(r)),Fm(r))return r.result;throw new ca(r)})}sendBatch(e){return KE(this,void 0,void 0,function*(){return yield this._sendRequest(e)})}_sendRequest(e){return KE(this,void 0,void 0,function*(){const{provider:n}=this;if(Ln(n))throw new Ob("Provider not available. Use `.setProvider` or `.provider=` to initialize the provider.");let r=cu(e)?Wce(e):dN(e);if(Ln(this.middleware)||(r=yield this.middleware.processRequest(r)),oj(n)){let s;try{s=yield n.request(r)}catch(i){s=i}return this._processJsonRpcResponse(r,s,{legacy:!1,error:!1})}if(cj(n))return n.request(r).then(s=>this._processJsonRpcResponse(r,s,{legacy:!0,error:!1})).catch(s=>this._processJsonRpcResponse(r,s,{legacy:!0,error:!0}));if(aj(n))return new Promise((s,i)=>{const o=l=>{i(this._processJsonRpcResponse(r,l,{legacy:!0,error:!0}))},a=l=>s(this._processJsonRpcResponse(r,l,{legacy:!0,error:!1})),c=n.request(r,(l,u)=>l?o(l):a(u));Bce(c)&&c.then(a).catch(u=>{try{const d=this._processJsonRpcResponse(r,u,{legacy:!0,error:!0});i(d)}catch(d){i(d)}})});if(lj(n))return new Promise((s,i)=>{n.send(r,(o,a)=>{if(o)return i(this._processJsonRpcResponse(r,o,{legacy:!0,error:!0}));if(Ln(a))throw new ca({},'Got a "nullish" response from provider.');return s(this._processJsonRpcResponse(r,a,{legacy:!0,error:!1}))})});if(uj(n))return n.sendAsync(r).then(s=>this._processJsonRpcResponse(r,s,{legacy:!0,error:!1})).catch(s=>this._processJsonRpcResponse(r,s,{legacy:!0,error:!0}));throw new Ob("Provider does not have a request or send method to use.")})}_processJsonRpcResponse(e,n,{legacy:r,error:s}){if(Ln(n))return this._buildResponse(e,null,s);if(Lm(n)){if(this.useRpcCallSpecification&&zce(n)){const i=n;if(hs.get(i.error.code)){const o=hs.get(i.error.code).error;throw new o(i)}else throw new Ti(i)}else if(!Du._isReverted(n))throw new t0(n,e)}if(Fm(n))return n;if(n instanceof Error)throw Du._isReverted(n),n;if(!r&&cu(e)&&jce(n)||r&&!s&&cu(e))return n;if(r&&s&&cu(e))throw n;if(r&&!Lm(n)&&!Fm(n))return this._buildResponse(e,n,s);throw cu(e)&&!Array.isArray(n)?new ca(n,"Got normal response for a batch request."):!cu(e)&&Array.isArray(n)?new ca(n,"Got batch response for a normal request."):new ca(n,"Invalid response")}static _isReverted(e){let n;if(Lm(e)?n=e.error:e instanceof Error&&(n=e),n?.message.includes("revert"))throw new Ou(n);return!1}_buildResponse(e,n,r){const s={jsonrpc:"2.0",id:cu(e)?e[0].id:"id"in e?e.id:null};return r?Object.assign(Object.assign({},s),{error:n}):Object.assign(Object.assign({},s),{result:n})}}var Jp=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class _w{constructor(e,n,r=!1){this.requestManager=e,this.registeredSubscriptions=n,this.tolerateUnlinkedSubscription=r,this._subscriptions=new Map,this.requestManager.on(ih.BEFORE_PROVIDER_CHANGE,()=>Jp(this,void 0,void 0,function*(){yield this.unsubscribe()})),this.requestManager.on(ih.PROVIDER_CHANGED,()=>{this.clear(),this.listenToProviderEvents()}),this.listenToProviderEvents()}listenToProviderEvents(){const e=this.requestManager.provider;!this.requestManager.provider||typeof e?.supportsSubscriptions=="function"&&!e?.supportsSubscriptions()||typeof this.requestManager.provider.on=="function"&&(typeof this.requestManager.provider.request=="function"?this.requestManager.provider.on("message",n=>this.messageListener(n)):e.on("data",n=>this.messageListener(n)))}messageListener(e){var n,r,s;if(!e)throw new Qa("Should not call messageListener with no data. Type was");const i=((n=e.params)===null||n===void 0?void 0:n.subscription)||((r=e.data)===null||r===void 0?void 0:r.subscription)||((s=e.id)===null||s===void 0?void 0:s.toString(16));if(i){const o=this._subscriptions.get(i);o?.processSubscriptionData(e)}}subscribe(e,n){return Jp(this,arguments,void 0,function*(r,s,i=Fr){const o=this.registeredSubscriptions[r];if(!o)throw new Qa("Invalid subscription type");const a=new o(s??void 0,{subscriptionManager:this,returnFormat:i});return yield this.addSubscription(a),a})}get subscriptions(){return this._subscriptions}addSubscription(e){return Jp(this,void 0,void 0,function*(){if(!this.requestManager.provider)throw new Ob("Provider not available");if(!this.supportsSubscriptions())throw new Qa("The current provider does not support subscriptions");if(e.id&&this._subscriptions.has(e.id))throw new Qa(`Subscription with id "${e.id}" already exists`);if(yield e.sendSubscriptionRequest(),Ln(e.id))throw new Qa("Subscription is not subscribed yet.");return this._subscriptions.set(e.id,e),e.id})}removeSubscription(e){return Jp(this,void 0,void 0,function*(){const{id:n}=e;if(Ln(n))throw new Qa("Subscription is not subscribed yet. Or, had already been unsubscribed but not through the Subscription Manager.");if(!this._subscriptions.has(n)&&!this.tolerateUnlinkedSubscription)throw new Qa(`Subscription with id "${n.toString()}" does not exists`);return yield e.sendUnsubscribeRequest(),this._subscriptions.delete(n),n})}unsubscribe(e){return Jp(this,void 0,void 0,function*(){const n=[];for(const[r,s]of this.subscriptions.entries())(!e||typeof e=="function"&&e({id:r,sub:s}))&&n.push(this.removeSubscription(s));return Promise.all(n)})}clear(){this._subscriptions.clear()}supportsSubscriptions(){return Ln(this.requestManager.provider)?!1:ble(this.requestManager.provider)}}var em=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class r0 extends v1{constructor(e,n){var r;super(),this.args=e;const{requestManager:s}=n,{subscriptionManager:i}=n;s?this._subscriptionManager=new _w(s,{},!0):this._subscriptionManager=i,this._returnFormat=(r=n?.returnFormat)!==null&&r!==void 0?r:Fr}get id(){return this._id}get lastBlock(){return this._lastBlock}subscribe(){return em(this,void 0,void 0,function*(){return this._subscriptionManager.addSubscription(this)})}processSubscriptionData(e){var n,r;e?.data?this._processSubscriptionResult((r=(n=e?.data)===null||n===void 0?void 0:n.result)!==null&&r!==void 0?r:e?.data):e&&Uce(e)&&this._processSubscriptionResult(e?.params.result)}sendSubscriptionRequest(){return em(this,void 0,void 0,function*(){return this._id=yield this._subscriptionManager.requestManager.send({method:"eth_subscribe",params:this._buildSubscriptionParams()}),this.emit("connected",this._id),this._id})}get returnFormat(){return this._returnFormat}get subscriptionManager(){return this._subscriptionManager}resubscribe(){return em(this,void 0,void 0,function*(){yield this.unsubscribe(),yield this.subscribe()})}unsubscribe(){return em(this,void 0,void 0,function*(){this.id&&(yield this._subscriptionManager.removeSubscription(this))})}sendUnsubscribeRequest(){return em(this,void 0,void 0,function*(){yield this._subscriptionManager.requestManager.send({method:"eth_unsubscribe",params:[this.id]}),this._id=void 0})}formatSubscriptionResult(e){return e}_processSubscriptionResult(e){this.emit("data",this.formatSubscriptionResult(e))}_processSubscriptionError(e){this.emit("error",e)}_buildSubscriptionParams(){throw new Error("Implement in the child class")}}function iL(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function wle(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function w1(t,...e){if(!wle(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function xle(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");iL(t.outputLen),iL(t.blockLen)}function $w(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ile(t,e){w1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const XE=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const QE=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ea=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Sle(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function fN(t){return typeof t=="string"&&(t=Sle(t)),w1(t),t}function kle(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];w1(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let dj=class{clone(){return this._cloneInto()}};function Ele(t){const e=r=>t().update(fN(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Cle(t=32){if(XE&&typeof XE.getRandomValues=="function")return XE.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Tle(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}const Ale=(t,e,n)=>t&e^~t&n,Nle=(t,e,n)=>t&e^t&n^e&n;let _le=class extends dj{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=QE(this.buffer)}update(e){$w(this);const{view:n,buffer:r,blockLen:s}=this;e=fN(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=QE(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){$w(this),Ile(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;Tle(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=QE(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const $le=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jc=new Uint32Array(64);let Rle=class extends _le{constructor(){super(64,32,8,!1),this.A=Zc[0]|0,this.B=Zc[1]|0,this.C=Zc[2]|0,this.D=Zc[3]|0,this.E=Zc[4]|0,this.F=Zc[5]|0,this.G=Zc[6]|0,this.H=Zc[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)Jc[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=Jc[d-15],m=Jc[d-2],g=ea(h,7)^ea(h,18)^h>>>3,v=ea(m,17)^ea(m,19)^m>>>10;Jc[d]=v+Jc[d-7]+g+Jc[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=ea(a,6)^ea(a,11)^ea(a,25),m=u+h+Ale(a,c,l)+$le[d]+Jc[d]|0,v=(ea(r,2)^ea(r,13)^ea(r,22))+Nle(r,s,i)|0;u=l,l=c,c=a,a=o+m|0,o=i,i=s,s=r,r=m+v|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Jc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ole=Ele(()=>new Rle);let fj=class extends dj{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,xle(e);const r=fN(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return $w(this),this.iHash.update(e),this}digestInto(e){$w(this),w1(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hj=(t,e,n)=>new fj(t,e).update(n).digest();hj.create=(t,e)=>new fj(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pj=BigInt(0),x1=BigInt(1),Ple=BigInt(2);function Xu(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function s0(t){if(!Xu(t))throw new Error("Uint8Array expected")}const Dle=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function oh(t){s0(t);let e="";for(let n=0;n<t.length;n++)e+=Dle[t[n]];return e}function mj(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function hN(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const Wa={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function oL(t){if(t>=Wa._0&&t<=Wa._9)return t-Wa._0;if(t>=Wa._A&&t<=Wa._F)return t-(Wa._A-10);if(t>=Wa._a&&t<=Wa._f)return t-(Wa._a-10)}function ah(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=oL(t.charCodeAt(i)),a=oL(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function Fu(t){return hN(oh(t))}function pN(t){return s0(t),hN(oh(Uint8Array.from(t).reverse()))}function ch(t,e){return ah(t.toString(16).padStart(e*2,"0"))}function mN(t,e){return ch(t,e).reverse()}function Fle(t){return ah(mj(t))}function So(t,e,n){let r;if(typeof e=="string")try{r=ah(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Xu(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function dg(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];s0(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}function Lle(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}function Ble(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Mle(t){let e;for(e=0;t>pj;t>>=x1,e+=1);return e}function zle(t,e){return t>>BigInt(e)&x1}function Ule(t,e,n){return t|(n?x1:pj)<<BigInt(e)}const gN=t=>(Ple<<BigInt(t-1))-x1,YE=t=>new Uint8Array(t),aL=t=>Uint8Array.from(t);function gj(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=YE(t),s=YE(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...d)=>n(s,r,...d),c=(d=YE())=>{s=a(aL([0]),d),r=a(),d.length!==0&&(s=a(aL([1]),d),r=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){r=a();const m=r.slice();h.push(m),d+=r.length}return dg(...h)};return(d,h)=>{o(),c(d);let m;for(;!(m=h(l()));)c();return o(),m}}const Vle={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Xu(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function i0(t,e,n={}){const r=(s,i,o)=>{const a=Vle[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}const jle=Object.freeze(Object.defineProperty({__proto__:null,abytes:s0,bitGet:zle,bitLen:Mle,bitMask:gN,bitSet:Ule,bytesToHex:oh,bytesToNumberBE:Fu,bytesToNumberLE:pN,concatBytes:dg,createHmacDrbg:gj,ensureBytes:So,equalBytes:Lle,hexToBytes:ah,hexToNumber:hN,isBytes:Xu,numberToBytesBE:ch,numberToBytesLE:mN,numberToHexUnpadded:mj,numberToVarBytesBE:Fle,utf8ToBytes:Ble,validateObject:i0},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Dr=BigInt(0),rr=BigInt(1),gu=BigInt(2),Hle=BigInt(3),DC=BigInt(4),cL=BigInt(5),lL=BigInt(8);BigInt(9);BigInt(16);function Hs(t,e){const n=t%e;return n>=Dr?n:e+n}function Wle(t,e,n){if(n<=Dr||e<Dr)throw new Error("Expected power/modulo > 0");if(n===rr)return Dr;let r=rr;for(;e>Dr;)e&rr&&(r=r*t%n),t=t*t%n,e>>=rr;return r}function Li(t,e,n){let r=t;for(;e-- >Dr;)r*=r,r%=n;return r}function FC(t,e){if(t===Dr||e<=Dr)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Hs(t,e),r=e,s=Dr,i=rr;for(;n!==Dr;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==rr)throw new Error("invert: does not exist");return Hs(s,e)}function Gle(t){const e=(t-rr)/gu;let n,r,s;for(n=t-rr,r=0;n%gu===Dr;n/=gu,r++);for(s=gu;s<t&&Wle(s,e,t)!==t-rr;s++);if(r===1){const o=(t+rr)/DC;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(n+rr)/gu;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=r,u=a.pow(a.mul(a.ONE,s),n),d=a.pow(c,i),h=a.pow(c,n);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let m=1;for(let v=a.sqr(h);m<l&&!a.eql(v,a.ONE);m++)v=a.sqr(v);const g=a.pow(u,rr<<BigInt(l-m-1));u=a.sqr(g),d=a.mul(d,g),h=a.mul(h,u),l=m}return d}}function qle(t){if(t%DC===Hle){const e=(t+rr)/DC;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%lL===cL){const e=(t-cL)/lL;return function(r,s){const i=r.mul(s,gu),o=r.pow(i,e),a=r.mul(s,o),c=r.mul(r.mul(a,gu),o),l=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(l),s))throw new Error("Cannot find square root");return l}}return Gle(t)}const Kle=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Xle(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Kle.reduce((r,s)=>(r[s]="function",r),e);return i0(t,n)}function Qle(t,e,n){if(n<Dr)throw new Error("Expected power > 0");if(n===Dr)return t.ONE;if(n===rr)return e;let r=t.ONE,s=e;for(;n>Dr;)n&rr&&(r=t.mul(r,s)),s=t.sqr(s),n>>=rr;return r}function Yle(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function yj(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Zle(t,e,n=!1,r={}){if(t<=Dr)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=yj(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=qle(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:gN(s),ZERO:Dr,ONE:rr,create:c=>Hs(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Dr<=c&&c<t},is0:c=>c===Dr,isOdd:c=>(c&rr)===rr,neg:c=>Hs(-c,t),eql:(c,l)=>c===l,sqr:c=>Hs(c*c,t),add:(c,l)=>Hs(c+l,t),sub:(c,l)=>Hs(c-l,t),mul:(c,l)=>Hs(c*l,t),pow:(c,l)=>Qle(a,c,l),div:(c,l)=>Hs(c*FC(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>FC(c,t),sqrt:r.sqrt||(c=>o(a,c)),invertBatch:c=>Yle(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?mN(c,i):ch(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return n?pN(c):Fu(c)}});return Object.freeze(a)}function vj(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function bj(t){const e=vj(t);return e+Math.ceil(e/2)}function Jle(t,e,n=!1){const r=t.length,s=vj(e),i=bj(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=n?Fu(t):pN(t),a=Hs(o,e-rr)+rr;return n?mN(a,s):ch(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const eue=BigInt(0),ZE=BigInt(1);function tue(t,e){const n=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:n,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>eue;)i&ZE&&(o=o.add(a)),a=a.double(),i>>=ZE;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=r(i),c=[];let l=s,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=r(s);let l=t.ZERO,u=t.BASE;const d=BigInt(2**s-1),h=2**s,m=BigInt(s);for(let g=0;g<a;g++){const v=g*c;let y=Number(o&d);o>>=m,y>c&&(y-=h,o+=ZE);const w=v,x=v+Math.abs(y)-1,S=g%2!==0,k=y<0;y===0?u=u.add(n(S,i[w])):l=l.add(n(k,i[x]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function wj(t){return Xle(t.Fp),i0(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yj(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function nue(t){const e=wj(t);i0(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:rue,hexToBytes:sue}=jle,Eu={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Eu;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:rue(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Eu,n=typeof t=="string"?sue(t):t;s0(n);let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Eu._parseInt(n.subarray(2)),{d:o,l:a}=Eu._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),s=e(n(t.r)),i=r.length/2,o=s.length/2,a=n(i),c=n(o);return`30${n(o+i+4)}02${c}${s}02${a}${r}`}},nc=BigInt(0),ji=BigInt(1);BigInt(2);const uL=BigInt(3);BigInt(4);function iue(t){const e=nue(t),{Fp:n}=e,r=e.toBytes||((g,v,y)=>{const w=v.toAffine();return dg(Uint8Array.from([4]),n.toBytes(w.x),n.toBytes(w.y))}),s=e.fromBytes||(g=>{const v=g.subarray(1),y=n.fromBytes(v.subarray(0,n.BYTES)),w=n.fromBytes(v.subarray(n.BYTES,2*n.BYTES));return{x:y,y:w}});function i(g){const{a:v,b:y}=e,w=n.sqr(g),x=n.mul(w,g);return n.add(n.add(x,n.mul(g,v)),y)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&nc<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(g){const{allowedPrivateKeyLengths:v,nByteLength:y,wrapPrivateKey:w,n:x}=e;if(v&&typeof g!="bigint"){if(Xu(g)&&(g=oh(g)),typeof g!="string"||!v.includes(g.length))throw new Error("Invalid key");g=g.padStart(y*2,"0")}let S;try{S=typeof g=="bigint"?g:Fu(So("private key",g,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof g}`)}return w&&(S=Hs(S,x)),a(S),S}const l=new Map;function u(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(v,y,w){if(this.px=v,this.py=y,this.pz=w,v==null||!n.isValid(v))throw new Error("x required");if(y==null||!n.isValid(y))throw new Error("y required");if(w==null||!n.isValid(w))throw new Error("z required")}static fromAffine(v){const{x:y,y:w}=v||{};if(!v||!n.isValid(y)||!n.isValid(w))throw new Error("invalid affine point");if(v instanceof d)throw new Error("projective point not allowed");const x=S=>n.eql(S,n.ZERO);return x(y)&&x(w)?d.ZERO:new d(y,w,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const y=n.invertBatch(v.map(w=>w.pz));return v.map((w,x)=>w.toAffine(y[x])).map(d.fromAffine)}static fromHex(v){const y=d.fromAffine(s(So("pointHex",v)));return y.assertValidity(),y}static fromPrivateKey(v){return d.BASE.multiply(c(v))}_setWindowSize(v){this._WINDOW_SIZE=v,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:v,y}=this.toAffine();if(!n.isValid(v)||!n.isValid(y))throw new Error("bad point: x or y not FE");const w=n.sqr(y),x=i(v);if(!n.eql(w,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:v}=this.toAffine();if(n.isOdd)return!n.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){u(v);const{px:y,py:w,pz:x}=this,{px:S,py:k,pz:E}=v,A=n.eql(n.mul(y,E),n.mul(S,x)),R=n.eql(n.mul(w,E),n.mul(k,x));return A&&R}negate(){return new d(this.px,n.neg(this.py),this.pz)}double(){const{a:v,b:y}=e,w=n.mul(y,uL),{px:x,py:S,pz:k}=this;let E=n.ZERO,A=n.ZERO,R=n.ZERO,N=n.mul(x,x),P=n.mul(S,S),O=n.mul(k,k),_=n.mul(x,S);return _=n.add(_,_),R=n.mul(x,k),R=n.add(R,R),E=n.mul(v,R),A=n.mul(w,O),A=n.add(E,A),E=n.sub(P,A),A=n.add(P,A),A=n.mul(E,A),E=n.mul(_,E),R=n.mul(w,R),O=n.mul(v,O),_=n.sub(N,O),_=n.mul(v,_),_=n.add(_,R),R=n.add(N,N),N=n.add(R,N),N=n.add(N,O),N=n.mul(N,_),A=n.add(A,N),O=n.mul(S,k),O=n.add(O,O),N=n.mul(O,_),E=n.sub(E,N),R=n.mul(O,P),R=n.add(R,R),R=n.add(R,R),new d(E,A,R)}add(v){u(v);const{px:y,py:w,pz:x}=this,{px:S,py:k,pz:E}=v;let A=n.ZERO,R=n.ZERO,N=n.ZERO;const P=e.a,O=n.mul(e.b,uL);let _=n.mul(y,S),M=n.mul(w,k),G=n.mul(x,E),q=n.add(y,w),D=n.add(S,k);q=n.mul(q,D),D=n.add(_,M),q=n.sub(q,D),D=n.add(y,x);let L=n.add(S,E);return D=n.mul(D,L),L=n.add(_,G),D=n.sub(D,L),L=n.add(w,x),A=n.add(k,E),L=n.mul(L,A),A=n.add(M,G),L=n.sub(L,A),N=n.mul(P,D),A=n.mul(O,G),N=n.add(A,N),A=n.sub(M,N),N=n.add(M,N),R=n.mul(A,N),M=n.add(_,_),M=n.add(M,_),G=n.mul(P,G),D=n.mul(O,D),M=n.add(M,G),G=n.sub(_,G),G=n.mul(P,G),D=n.add(D,G),_=n.mul(M,D),R=n.add(R,_),_=n.mul(L,D),A=n.mul(q,A),A=n.sub(A,_),_=n.mul(q,M),N=n.mul(L,N),N=n.add(N,_),new d(A,R,N)}subtract(v){return this.add(v.negate())}is0(){return this.equals(d.ZERO)}wNAF(v){return m.wNAFCached(this,l,v,y=>{const w=n.invertBatch(y.map(x=>x.pz));return y.map((x,S)=>x.toAffine(w[S])).map(d.fromAffine)})}multiplyUnsafe(v){const y=d.ZERO;if(v===nc)return y;if(a(v),v===ji)return this;const{endo:w}=e;if(!w)return m.unsafeLadder(this,v);let{k1neg:x,k1:S,k2neg:k,k2:E}=w.splitScalar(v),A=y,R=y,N=this;for(;S>nc||E>nc;)S&ji&&(A=A.add(N)),E&ji&&(R=R.add(N)),N=N.double(),S>>=ji,E>>=ji;return x&&(A=A.negate()),k&&(R=R.negate()),R=new d(n.mul(R.px,w.beta),R.py,R.pz),A.add(R)}multiply(v){a(v);let y=v,w,x;const{endo:S}=e;if(S){const{k1neg:k,k1:E,k2neg:A,k2:R}=S.splitScalar(y);let{p:N,f:P}=this.wNAF(E),{p:O,f:_}=this.wNAF(R);N=m.constTimeNegate(k,N),O=m.constTimeNegate(A,O),O=new d(n.mul(O.px,S.beta),O.py,O.pz),w=N.add(O),x=P.add(_)}else{const{p:k,f:E}=this.wNAF(y);w=k,x=E}return d.normalizeZ([w,x])[0]}multiplyAndAddUnsafe(v,y,w){const x=d.BASE,S=(E,A)=>A===nc||A===ji||!E.equals(x)?E.multiplyUnsafe(A):E.multiply(A),k=S(this,y).add(S(v,w));return k.is0()?void 0:k}toAffine(v){const{px:y,py:w,pz:x}=this,S=this.is0();v==null&&(v=S?n.ONE:n.inv(x));const k=n.mul(y,v),E=n.mul(w,v),A=n.mul(x,v);if(S)return{x:n.ZERO,y:n.ZERO};if(!n.eql(A,n.ONE))throw new Error("invZ was invalid");return{x:k,y:E}}isTorsionFree(){const{h:v,isTorsionFree:y}=e;if(v===ji)return!0;if(y)return y(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:y}=e;return v===ji?this:y?y(d,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return this.assertValidity(),r(d,this,v)}toHex(v=!0){return oh(this.toRawBytes(v))}}d.BASE=new d(e.Gx,e.Gy,n.ONE),d.ZERO=new d(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,m=tue(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function oue(t){const e=wj(t);return i0(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function aue(t){const e=oue(t),{Fp:n,n:r}=e,s=n.BYTES+1,i=2*n.BYTES+1;function o(D){return nc<D&&D<n.ORDER}function a(D){return Hs(D,r)}function c(D){return FC(D,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=iue({...e,toBytes(D,L,K){const j=L.toAffine(),W=n.toBytes(j.x),X=dg;return K?X(Uint8Array.from([L.hasEvenY()?2:3]),W):X(Uint8Array.from([4]),W,n.toBytes(j.y))},fromBytes(D){const L=D.length,K=D[0],j=D.subarray(1);if(L===s&&(K===2||K===3)){const W=Fu(j);if(!o(W))throw new Error("Point is not on curve");const X=d(W);let H;try{H=n.sqrt(X)}catch(de){const ge=de instanceof Error?": "+de.message:"";throw new Error("Point is not on curve"+ge)}const Y=(H&ji)===ji;return(K&1)===1!==Y&&(H=n.neg(H)),{x:W,y:H}}else if(L===i&&K===4){const W=n.fromBytes(j.subarray(0,n.BYTES)),X=n.fromBytes(j.subarray(n.BYTES,2*n.BYTES));return{x:W,y:X}}else throw new Error(`Point of length ${L} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),m=D=>oh(ch(D,e.nByteLength));function g(D){const L=r>>ji;return D>L}function v(D){return g(D)?a(-D):D}const y=(D,L,K)=>Fu(D.slice(L,K));class w{constructor(L,K,j){this.r=L,this.s=K,this.recovery=j,this.assertValidity()}static fromCompact(L){const K=e.nByteLength;return L=So("compactSignature",L,K*2),new w(y(L,0,K),y(L,K,2*K))}static fromDER(L){const{r:K,s:j}=Eu.toSig(So("DER",L));return new w(K,j)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(L){return new w(this.r,this.s,L)}recoverPublicKey(L){const{r:K,s:j,recovery:W}=this,X=R(So("msgHash",L));if(W==null||![0,1,2,3].includes(W))throw new Error("recovery id invalid");const H=W===2||W===3?K+e.n:K;if(H>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const Y=(W&1)===0?"02":"03",ce=l.fromHex(Y+m(H)),de=c(H),ge=a(-X*de),be=a(j*de),we=l.BASE.multiplyAndAddUnsafe(ce,ge,be);if(!we)throw new Error("point at infinify");return we.assertValidity(),we}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return ah(this.toDERHex())}toDERHex(){return Eu.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ah(this.toCompactHex())}toCompactHex(){return m(this.r)+m(this.s)}}const x={isValidPrivateKey(D){try{return u(D),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const D=bj(e.n);return Jle(e.randomBytes(D),e.n)},precompute(D=8,L=l.BASE){return L._setWindowSize(D),L.multiply(BigInt(3)),L}};function S(D,L=!0){return l.fromPrivateKey(D).toRawBytes(L)}function k(D){const L=Xu(D),K=typeof D=="string",j=(L||K)&&D.length;return L?j===s||j===i:K?j===2*s||j===2*i:D instanceof l}function E(D,L,K=!0){if(k(D))throw new Error("first arg must be private key");if(!k(L))throw new Error("second arg must be public key");return l.fromHex(L).multiply(u(D)).toRawBytes(K)}const A=e.bits2int||function(D){const L=Fu(D),K=D.length*8-e.nBitLength;return K>0?L>>BigInt(K):L},R=e.bits2int_modN||function(D){return a(A(D))},N=gN(e.nBitLength);function P(D){if(typeof D!="bigint")throw new Error("bigint expected");if(!(nc<=D&&D<N))throw new Error(`bigint expected < 2^${e.nBitLength}`);return ch(D,e.nByteLength)}function O(D,L,K=_){if(["recovered","canonical"].some(_e=>_e in K))throw new Error("sign() legacy options not supported");const{hash:j,randomBytes:W}=e;let{lowS:X,prehash:H,extraEntropy:Y}=K;X==null&&(X=!0),D=So("msgHash",D),H&&(D=So("prehashed msgHash",j(D)));const ce=R(D),de=u(L),ge=[P(de),P(ce)];if(Y!=null&&Y!==!1){const _e=Y===!0?W(n.BYTES):Y;ge.push(So("extraEntropy",_e))}const be=dg(...ge),we=ce;function Ae(_e){const je=A(_e);if(!h(je))return;const st=c(je),dt=l.BASE.multiply(je).toAffine(),yt=a(dt.x);if(yt===nc)return;const Mt=a(st*a(we+yt*de));if(Mt===nc)return;let Ft=(dt.x===yt?0:2)|Number(dt.y&ji),Pt=Mt;return X&&g(Mt)&&(Pt=v(Mt),Ft^=1),new w(yt,Pt,Ft)}return{seed:be,k2sig:Ae}}const _={lowS:e.lowS,prehash:!1},M={lowS:e.lowS,prehash:!1};function G(D,L,K=_){const{seed:j,k2sig:W}=O(D,L,K),X=e;return gj(X.hash.outputLen,X.nByteLength,X.hmac)(j,W)}l.BASE._setWindowSize(8);function q(D,L,K,j=M){const W=D;if(L=So("msgHash",L),K=So("publicKey",K),"strict"in j)throw new Error("options.strict was renamed to lowS");const{lowS:X,prehash:H}=j;let Y,ce;try{if(typeof W=="string"||Xu(W))try{Y=w.fromDER(W)}catch(dt){if(!(dt instanceof Eu.Err))throw dt;Y=w.fromCompact(W)}else if(typeof W=="object"&&typeof W.r=="bigint"&&typeof W.s=="bigint"){const{r:dt,s:yt}=W;Y=new w(dt,yt)}else throw new Error("PARSE");ce=l.fromHex(K)}catch(dt){if(dt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(X&&Y.hasHighS())return!1;H&&(L=e.hash(L));const{r:de,s:ge}=Y,be=R(L),we=c(ge),Ae=a(be*we),_e=a(de*we),je=l.BASE.multiplyAndAddUnsafe(ce,Ae,_e)?.toAffine();return je?a(je.x)===de:!1}return{CURVE:e,getPublicKey:S,getSharedSecret:E,sign:G,verify:q,ProjectivePoint:l,Signature:w,utils:x}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function cue(t){return{hash:t,hmac:(e,...n)=>hj(t,e,kle(...n)),randomBytes:Cle}}function lue(t,e){const n=r=>aue({...t,...cue(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xj=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),dL=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),uue=BigInt(1),LC=BigInt(2),fL=(t,e)=>(t+e/LC)/e;function due(t){const e=xj,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Li(u,n,e)*u%e,h=Li(d,n,e)*u%e,m=Li(h,LC,e)*l%e,g=Li(m,s,e)*m%e,v=Li(g,i,e)*g%e,y=Li(v,a,e)*v%e,w=Li(y,c,e)*y%e,x=Li(w,a,e)*v%e,S=Li(x,n,e)*u%e,k=Li(S,o,e)*g%e,E=Li(k,r,e)*l%e,A=Li(E,LC,e);if(!BC.eql(BC.sqr(A),t))throw new Error("Cannot find square root");return A}const BC=Zle(xj,void 0,void 0,{sqrt:due}),xd=lue({a:BigInt(0),b:BigInt(7),Fp:BC,n:dL,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=dL,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-uue*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=fL(i*t,e),c=fL(-r*t,e);let l=Hs(t-a*n-c*s,e),u=Hs(-a*r-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},Ole);BigInt(0);xd.ProjectivePoint;const fue=Object.freeze(Object.defineProperty({__proto__:null,secp256k1:xd},Symbol.toStringTag,{value:"Module"}));var JE;const hue=(JE=xd)!==null&&JE!==void 0?JE:fue;BigInt("0xffffffffffffffff");BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const pue=hue.CURVE.n;pue/BigInt(2);var hL;(function(t){t[t.Mainnet=1]="Mainnet",t[t.Goerli=5]="Goerli",t[t.Sepolia=11155111]="Sepolia"})(hL||(hL={}));var pL;(function(t){t.Chainstart="chainstart",t.Homestead="homestead",t.Dao="dao",t.TangerineWhistle="tangerineWhistle",t.SpuriousDragon="spuriousDragon",t.Byzantium="byzantium",t.Constantinople="constantinople",t.Petersburg="petersburg",t.Istanbul="istanbul",t.MuirGlacier="muirGlacier",t.Berlin="berlin",t.London="london",t.ArrowGlacier="arrowGlacier",t.GrayGlacier="grayGlacier",t.MergeForkIdTransition="mergeForkIdTransition",t.Merge="merge",t.Shanghai="shanghai",t.ShardingForkDev="shardingFork"})(pL||(pL={}));var mL;(function(t){t.ProofOfStake="pos",t.ProofOfWork="pow",t.ProofOfAuthority="poa"})(mL||(mL={}));var gL;(function(t){t.Ethash="ethash",t.Clique="clique",t.Casper="casper"})(gL||(gL={}));var yL;(function(t){t.PolygonMainnet="polygon-mainnet",t.PolygonMumbai="polygon-mumbai",t.ArbitrumRinkebyTestnet="arbitrum-rinkeby-testnet",t.ArbitrumOne="arbitrum-one",t.xDaiChain="x-dai-chain",t.OptimisticKovan="optimistic-kovan",t.OptimisticEthereum="optimistic-ethereum"})(yL||(yL={}));var vL;(function(t){t[t.Number=0]="Number",t[t.BigInt=1]="BigInt",t[t.Uint8Array=2]="Uint8Array",t[t.PrefixedHexString=3]="PrefixedHexString"})(vL||(vL={}));var wo={},bL;function mue(){if(bL)return wo;bL=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.RLP=wo.utils=wo.decode=wo.encode=void 0;function t(w){if(Array.isArray(w)){const S=[];let k=0;for(let E=0;E<w.length;E++){const A=t(w[E]);S.push(A),k+=A.length}return u(r(k,192),...S)}const x=y(w);return x.length===1&&x[0]<128?x:u(r(x.length,128),x)}wo.encode=t;function e(w,x,S){if(S>w.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return w.slice(x,S)}function n(w){if(w[0]===0)throw new Error("invalid RLP: extra zeros");return c(a(w))}function r(w,x){if(w<56)return Uint8Array.from([w+x]);const S=h(w),k=S.length/2,E=h(x+55+k);return Uint8Array.from(l(E+S))}function s(w,x=!1){if(typeof w>"u"||w===null||w.length===0)return Uint8Array.from([]);const S=y(w),k=i(S);if(x)return k;if(k.remainder.length!==0)throw new Error("invalid RLP: remainder must be zero");return k.data}wo.decode=s;function i(w){let x,S,k,E,A;const R=[],N=w[0];if(N<=127)return{data:w.slice(0,1),remainder:w.slice(1)};if(N<=183){if(x=N-127,N===128?k=Uint8Array.from([]):k=e(w,1,x),x===2&&k[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:k,remainder:w.slice(x)}}else if(N<=191){if(S=N-182,w.length-1<S)throw new Error("invalid RLP: not enough bytes for string length");if(x=n(e(w,1,S)),x<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return k=e(w,S,x+S),{data:k,remainder:w.slice(x+S)}}else if(N<=247){for(x=N-191,E=e(w,1,x);E.length;)A=i(E),R.push(A.data),E=A.remainder;return{data:R,remainder:w.slice(x)}}else{if(S=N-246,x=n(e(w,1,S)),x<56)throw new Error("invalid RLP: encoded list too short");const P=S+x;if(P>w.length)throw new Error("invalid RLP: total length is larger than the data");for(E=e(w,S,P);E.length;)A=i(E),R.push(A.data),E=A.remainder;return{data:R,remainder:w.slice(P)}}}const o=Array.from({length:256},(w,x)=>x.toString(16).padStart(2,"0"));function a(w){let x="";for(let S=0;S<w.length;S++)x+=o[w[S]];return x}function c(w){const x=Number.parseInt(w,16);if(Number.isNaN(x))throw new Error("Invalid byte sequence");return x}function l(w){if(typeof w!="string")throw new TypeError("hexToBytes: expected string, got "+typeof w);if(w.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const x=new Uint8Array(w.length/2);for(let S=0;S<x.length;S++){const k=S*2;x[S]=c(w.slice(k,k+2))}return x}function u(...w){if(w.length===1)return w[0];const x=w.reduce((k,E)=>k+E.length,0),S=new Uint8Array(x);for(let k=0,E=0;k<w.length;k++){const A=w[k];S.set(A,E),E+=A.length}return S}function d(w){return new TextEncoder().encode(w)}function h(w){if(w<0)throw new Error("Invalid integer as argument, must be unsigned!");const x=w.toString(16);return x.length%2?`0${x}`:x}function m(w){return w.length%2?`0${w}`:w}function g(w){return w.length>=2&&w[0]==="0"&&w[1]==="x"}function v(w){return typeof w!="string"?w:g(w)?w.slice(2):w}function y(w){if(w instanceof Uint8Array)return w;if(typeof w=="string")return g(w)?l(m(v(w))):d(w);if(typeof w=="number"||typeof w=="bigint")return w?l(h(w)):Uint8Array.from([]);if(w==null)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof w)}return wo.utils={bytesToHex:a,concatBytes:u,hexToBytes:l,utf8ToBytes:d},wo.RLP={encode:t,decode:s},wo}var Nn=mue(),e2={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var wL;function gue(){return wL||(wL=1,(function(t){(function(e){e(typeof DO_NOT_EXPORT_CRC>"u"?t:{})})(function(e){e.version="1.2.2";function n(){for(var N=0,P=new Array(256),O=0;O!=256;++O)N=O,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,P[O]=N;return typeof Int32Array<"u"?new Int32Array(P):P}var r=n();function s(N){var P=0,O=0,_=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(_=0;_!=256;++_)M[_]=N[_];for(_=0;_!=256;++_)for(O=N[_],P=256+_;P<4096;P+=256)O=M[P]=O>>>8^N[O&255];var G=[];for(_=1;_!=16;++_)G[_-1]=typeof Int32Array<"u"?M.subarray(_*256,_*256+256):M.slice(_*256,_*256+256);return G}var i=s(r),o=i[0],a=i[1],c=i[2],l=i[3],u=i[4],d=i[5],h=i[6],m=i[7],g=i[8],v=i[9],y=i[10],w=i[11],x=i[12],S=i[13],k=i[14];function E(N,P){for(var O=P^-1,_=0,M=N.length;_<M;)O=O>>>8^r[(O^N.charCodeAt(_++))&255];return~O}function A(N,P){for(var O=P^-1,_=N.length-15,M=0;M<_;)O=k[N[M++]^O&255]^S[N[M++]^O>>8&255]^x[N[M++]^O>>16&255]^w[N[M++]^O>>>24]^y[N[M++]]^v[N[M++]]^g[N[M++]]^m[N[M++]]^h[N[M++]]^d[N[M++]]^u[N[M++]]^l[N[M++]]^c[N[M++]]^a[N[M++]]^o[N[M++]]^r[N[M++]];for(_+=15;M<_;)O=O>>>8^r[(O^N[M++])&255];return~O}function R(N,P){for(var O=P^-1,_=0,M=N.length,G=0,q=0;_<M;)G=N.charCodeAt(_++),G<128?O=O>>>8^r[(O^G)&255]:G<2048?(O=O>>>8^r[(O^(192|G>>6&31))&255],O=O>>>8^r[(O^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,q=N.charCodeAt(_++)&1023,O=O>>>8^r[(O^(240|G>>8&7))&255],O=O>>>8^r[(O^(128|G>>2&63))&255],O=O>>>8^r[(O^(128|q>>6&15|(G&3)<<4))&255],O=O>>>8^r[(O^(128|q&63))&255]):(O=O>>>8^r[(O^(224|G>>12&15))&255],O=O>>>8^r[(O^(128|G>>6&63))&255],O=O>>>8^r[(O^(128|G&63))&255]);return~O}e.table=r,e.bstr=E,e.buf=A,e.str=R})})(e2)),e2}var yue=gue();const yN=Wo(yue),{buf:ZXe}=yN;var xL;(function(t){t[t.EIP155ReplayProtection=155]="EIP155ReplayProtection",t[t.EIP1559FeeMarket=1559]="EIP1559FeeMarket",t[t.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",t[t.EIP2930AccessLists=2930]="EIP2930AccessLists"})(xL||(xL={}));const vue=2;ej(vue.toString(16).padStart(2,"0"));const bue=1;ej(bue.toString(16).padStart(2,"0"));var IL=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const wue=1e3;class xue{constructor(e){this._requestManager=e,this._requests=new Map}get requests(){return[...this._requests.values()].map(e=>e.payload)}add(e){const n=dN(e),r=new Y3;return this._requests.set(n.id,{payload:n,promise:r}),r}execute(e){return IL(this,void 0,void 0,function*(){var n;if(this.requests.length===0)return Promise.resolve([]);const r=new Y3({timeout:(n=e?.timeout)!==null&&n!==void 0?n:wue,eagerStart:!0,timeoutMessage:"Batch request timeout"});return this._processBatchRequest(r).catch(s=>r.reject(s)),r.catch(s=>{s instanceof h1&&this._abortAllRequests("Batch request timeout"),r.reject(s)}),r})}_processBatchRequest(e){return IL(this,void 0,void 0,function*(){var n,r;const s=yield this._requestManager.sendBatch([...this._requests.values()].map(a=>a.payload));if(s.length!==this._requests.size)throw this._abortAllRequests("Invalid batch response"),new ca(s,`Batch request size mismatch the results size. Requests: ${this._requests.size}, Responses: ${s.length}`);const i=this.requests.map(a=>a.id).map(Number).sort((a,c)=>a-c),o=s.map(a=>a.id).map(Number).sort((a,c)=>a-c);if(JSON.stringify(i)!==JSON.stringify(o))throw this._abortAllRequests("Invalid batch response"),new ca(s,`Batch request mismatch the results. Requests: [${i.join()}], Responses: [${o.join()}]`);for(const a of s)Fm(a)?(n=this._requests.get(a.id))===null||n===void 0||n.promise.resolve(a.result):Lm(a)&&((r=this._requests.get(a.id))===null||r===void 0||r.promise.reject(a.error));e.resolve(s)})}_abortAllRequests(e){for(const{promise:n}of this._requests.values())n.reject(new Zie(e))}}var Iue=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};let Xi=class Ij extends Gce{constructor(e){var n;if(super(),this.providers=Du.providers,Ln(e)||typeof e=="string"&&e.trim()!==""||Nw(e)){this._requestManager=new Du(e),this._subscriptionManager=new _w(this._requestManager,{});return}const{config:r,provider:s,requestManager:i,subscriptionManager:o,registeredSubscriptions:a,accountProvider:c,wallet:l,requestManagerMiddleware:u}=e;this.setConfig(r??{}),this._requestManager=i??new Du(s,(n=r?.enableExperimentalFeatures)===null||n===void 0?void 0:n.useSubscriptionWhenCheckingBlockTimeout,u),o?this._subscriptionManager=o:this._subscriptionManager=new _w(this.requestManager,a??{}),c&&(this._accountProvider=c),l&&(this._wallet=l)}get requestManager(){return this._requestManager}get subscriptionManager(){return this._subscriptionManager}get wallet(){return this._wallet}get accountProvider(){return this._accountProvider}static fromContextObject(...e){return new this(...e.reverse())}getContextObject(){var e;return{config:this.config,provider:this.provider,requestManager:this.requestManager,subscriptionManager:this.subscriptionManager,registeredSubscriptions:(e=this.subscriptionManager)===null||e===void 0?void 0:e.registeredSubscriptions,providers:this.providers,wallet:this.wallet,accountProvider:this.accountProvider}}use(e,...n){const r=new e(...n,this.getContextObject());return this.on(Ku.CONFIG_CHANGE,s=>{r.setConfig({[s.name]:s.newValue})}),this[e.name]=r,r}link(e){this.setConfig(e.config),this._requestManager=e.requestManager,this.provider=e.provider,this._subscriptionManager=e.subscriptionManager,this._wallet=e.wallet,this._accountProvider=e._accountProvider,e.on(Ku.CONFIG_CHANGE,n=>{this.setConfig({[n.name]:n.newValue})})}registerPlugin(e){if(this[e.pluginNamespace]!==void 0)throw new Jie(e.pluginNamespace);const n={[e.pluginNamespace]:e};n[e.pluginNamespace].link(this),Object.assign(this,n)}get provider(){return this.currentProvider}set provider(e){this.requestManager.setProvider(e)}get currentProvider(){return this.requestManager.provider}set currentProvider(e){this.requestManager.setProvider(e)}get givenProvider(){return Ij.givenProvider}setProvider(e){return this.provider=e,!0}setRequestManagerMiddleware(e){this.requestManager.setMiddleware(e)}get BatchRequest(){return xue.bind(void 0,this._requestManager)}extend(e){var n;return e.property&&!this[e.property]&&(this[e.property]={}),(n=e.methods)===null||n===void 0||n.forEach(r=>{const s=(...i)=>Iue(this,void 0,void 0,function*(){return this.requestManager.send({method:r.call,params:i})});e.property?this[e.property][r.name]=s:this[r.name]=s}),this}};Xi.providers=Du.providers;function fg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Sue(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function kue(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function I1(t,...e){if(!kue(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Eue(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");fg(t.outputLen),fg(t.blockLen)}function MC(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Sj(t,e){I1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Cue={number:fg,bool:Sue,bytes:I1,hash:Eue,exists:MC,output:Sj},Yv=BigInt(2**32-1),SL=BigInt(32);function Tue(t,e=!1){return e?{h:Number(t&Yv),l:Number(t>>SL&Yv)}:{h:Number(t>>SL&Yv)|0,l:Number(t&Yv)|0}}function Aue(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Tue(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const Nue=(t,e,n)=>t<<n|e>>>32-n,_ue=(t,e,n)=>e<<n|t>>>32-n,$ue=(t,e,n)=>e<<n-32|t>>>64-n,Rue=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Oue=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),kL=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Pue=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function EL(t){for(let e=0;e<t.length;e++)t[e]=Pue(t[e])}function kj(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ej(t){return typeof t=="string"&&(t=kj(t)),I1(t),t}let Due=class{clone(){return this._cloneInto()}};function Fue(t){const e=r=>t().update(Ej(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const Cj=[],Tj=[],Aj=[],Lue=BigInt(0),tm=BigInt(1),Bue=BigInt(2),Mue=BigInt(7),zue=BigInt(256),Uue=BigInt(113);for(let t=0,e=tm,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Cj.push(2*(5*r+n)),Tj.push((t+1)*(t+2)/2%64);let s=Lue;for(let i=0;i<7;i++)e=(e<<tm^(e>>Mue)*Uue)%zue,e&Bue&&(s^=tm<<(tm<<BigInt(i))-tm);Aj.push(s)}const[Vue,jue]=Aue(Aj,!0),CL=(t,e,n)=>n>32?$ue(t,e,n):Nue(t,e,n),TL=(t,e,n)=>n>32?Rue(t,e,n):_ue(t,e,n);function Hue(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=CL(l,u,1)^n[a],h=TL(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Tj[o],c=CL(s,i,a),l=TL(s,i,a),u=Cj[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Vue[r],t[1]^=jue[r]}n.fill(0)}let Wue=class Nj extends Due{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,fg(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Oue(this.state)}keccak(){kL||EL(this.state32),Hue(this.state32,this.rounds),kL||EL(this.state32),this.posOut=0,this.pos=0}update(e){MC(this);const{blockLen:n,state:r}=this;e=Ej(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){MC(this,!1),I1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return fg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Sj(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Nj(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Gue=(t,e,n)=>Fue(()=>new Wue(e,t,n)),AL=Gue(1,136,256/8);function que(t){return e=>(Cue.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const Kue=(()=>{const t=que(AL);return t.create=AL.create,t})();BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const Xue=t=>(Me.validate(["hex"],[t]),wd(t)),Que=kj,Yue=t=>{if(!mr(t,!1))throw new vd(t);const e=t.toLowerCase().replace(/^0x/i,""),n=Ur(Kue(Go(Que(e))));if(oe(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let r="0x";const s=n.replace(/^0x/i,"");for(let i=0;i<e.length;i+=1)parseInt(s[i],16)>7?r+=e[i].toUpperCase():r+=e[i];return r},Zue=(t,e,n="0")=>typeof t=="string"?pt(t)?so(t,e,n):t.padStart(e,n):(Me.validate(["int"],[t]),so(t,e,n)),NL=Zue;class or{constructor(e){if(this.toAddress=()=>{if(this.isDirect()){const n=this._iban.slice(4),r=or._parseInt(n,36),s=NL(r,40);return Yue(s)}throw new Error("Iban is indirect and cannot be converted. Must be length of 34 or 35")},or.isIndirect(e)||or.isDirect(e))this._iban=e;else throw new Error("Invalid IBAN was provided")}static isDirect(e){return e.length===34||e.length===35}isDirect(){return or.isDirect(this._iban)}static isIndirect(e){return e.length===20}isIndirect(){return or.isIndirect(this._iban)}static isValid(e){return/^XE[0-9]{2}(ETH[0-9A-Z]{13}|[0-9A-Z]{30,31})$/.test(e)&&or._mod9710(or._iso13616Prepare(e))===1}isValid(){return or.isValid(this._iban)}static fromBban(e){const s=`0${(98-this._mod9710(this._iso13616Prepare(`XE00${e}`))).toString()}`.slice(-2);return new or(`XE${s}${e}`)}static createIndirect(e){return or.fromBban(`ETH${e.institution}${e.identifier}`)}static fromAddress(e){if(!mr(e))throw new vd(e);const r=BigInt(Xue(e)).toString(36),s=NL(r,15);return or.fromBban(s.toUpperCase())}static toIban(e){return or.fromAddress(e).toString()}client(){return this.isIndirect()?this._iban.slice(11):""}checksum(){return this._iban.slice(2,4)}institution(){return this.isIndirect()?this._iban.slice(7,11):""}toString(){return this._iban}}or._iso13616Prepare=t=>{const r=t.toUpperCase();return`${r.slice(4)}${r.slice(0,4)}`.split("").map(i=>{const o=i.charCodeAt(0);return o>=65&&o<=90?o-65+10:i}).join("")};or._parseInt=(t,e)=>[...t].reduce((n,r)=>BigInt(parseInt(r,e))+BigInt(e)*n,BigInt(0));or._mod9710=t=>{let e=t,n;for(;e.length>2;)n=e.slice(0,9),e=`${(parseInt(n,10)%97).toString()}${e.slice(n.length)}`;return parseInt(e,10)%97};or.toAddress=t=>new or(t).toAddress();var t2=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},_j;class $j extends v1{constructor(e){super(),this[_j]="Promise",this._promise=new Promise(e)}then(e,n){return t2(this,void 0,void 0,function*(){return this._promise.then(e,n)})}catch(e){return t2(this,void 0,void 0,function*(){return this._promise.catch(e)})}finally(e){return t2(this,void 0,void 0,function*(){return this._promise.finally(e)})}on(e,n){return super.on(e,n),this}once(e,n){return super.once(e,n),this}}_j=Symbol.toStringTag;var n2={},_L;function Jue(){return _L||(_L=1,(function(t,e){if(t.setImmediate)return;var n=1,r={},s=!1,i=t.document,o;function a(x){typeof x!="function"&&(x=new Function(""+x));for(var S=new Array(arguments.length-1),k=0;k<S.length;k++)S[k]=arguments[k+1];var E={callback:x,args:S};return r[n]=E,o(n),n++}function c(x){delete r[x]}function l(x){var S=x.callback,k=x.args;switch(k.length){case 0:S();break;case 1:S(k[0]);break;case 2:S(k[0],k[1]);break;case 3:S(k[0],k[1],k[2]);break;default:S.apply(e,k);break}}function u(x){if(s)setTimeout(u,0,x);else{var S=r[x];if(S){s=!0;try{l(S)}finally{c(x),s=!1}}}}function d(){o=function(x){process.nextTick(function(){u(x)})}}function h(){if(t.postMessage&&!t.importScripts){var x=!0,S=t.onmessage;return t.onmessage=function(){x=!1},t.postMessage("","*"),t.onmessage=S,x}}function m(){var x="setImmediate$"+Math.random()+"$",S=function(k){k.source===t&&typeof k.data=="string"&&k.data.indexOf(x)===0&&u(+k.data.slice(x.length))};t.addEventListener?t.addEventListener("message",S,!1):t.attachEvent("onmessage",S),o=function(k){t.postMessage(x+k,"*")}}function g(){var x=new MessageChannel;x.port1.onmessage=function(S){var k=S.data;u(k)},o=function(S){x.port2.postMessage(S)}}function v(){var x=i.documentElement;o=function(S){var k=i.createElement("script");k.onreadystatechange=function(){u(S),k.onreadystatechange=null,x.removeChild(k),k=null},x.appendChild(k)}}function y(){o=function(x){setTimeout(u,0,x)}}var w=Object.getPrototypeOf&&Object.getPrototypeOf(t);w=w&&w.setTimeout?w:t,{}.toString.call(t.process)==="[object process]"?d():h()?m():t.MessageChannel?g():i&&"onreadystatechange"in i.createElement("script")?v():y(),w.setImmediate=a,w.clearImmediate=c})(typeof self>"u"?typeof Df>"u"?n2:Df:self)),n2}Jue();function hg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function ede(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function tde(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function S1(t,...e){if(!tde(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function nde(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");hg(t.outputLen),hg(t.blockLen)}function zC(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Rj(t,e){S1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const rde={number:hg,bool:ede,bytes:S1,hash:nde,exists:zC,output:Rj},Zv=BigInt(2**32-1),$L=BigInt(32);function sde(t,e=!1){return e?{h:Number(t&Zv),l:Number(t>>$L&Zv)}:{h:Number(t>>$L&Zv)|0,l:Number(t&Zv)|0}}function ide(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=sde(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const ode=(t,e,n)=>t<<n|e>>>32-n,ade=(t,e,n)=>e<<n|t>>>32-n,cde=(t,e,n)=>e<<n-32|t>>>64-n,lde=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ude=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),RL=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,dde=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function OL(t){for(let e=0;e<t.length;e++)t[e]=dde(t[e])}function pg(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Oj(t){return typeof t=="string"&&(t=pg(t)),S1(t),t}let fde=class{clone(){return this._cloneInto()}};function hde(t){const e=r=>t().update(Oj(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const Pj=[],Dj=[],Fj=[],pde=BigInt(0),nm=BigInt(1),mde=BigInt(2),gde=BigInt(7),yde=BigInt(256),vde=BigInt(113);for(let t=0,e=nm,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Pj.push(2*(5*r+n)),Dj.push((t+1)*(t+2)/2%64);let s=pde;for(let i=0;i<7;i++)e=(e<<nm^(e>>gde)*vde)%yde,e&mde&&(s^=nm<<(nm<<BigInt(i))-nm);Fj.push(s)}const[bde,wde]=ide(Fj,!0),PL=(t,e,n)=>n>32?cde(t,e,n):ode(t,e,n),DL=(t,e,n)=>n>32?lde(t,e,n):ade(t,e,n);function xde(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=PL(l,u,1)^n[a],h=DL(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Dj[o],c=PL(s,i,a),l=DL(s,i,a),u=Pj[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=bde[r],t[1]^=wde[r]}n.fill(0)}let Ide=class Lj extends fde{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,hg(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ude(this.state)}keccak(){RL||OL(this.state32),xde(this.state32,this.rounds),RL||OL(this.state32),this.posOut=0,this.pos=0}update(e){zC(this);const{blockLen:n,state:r}=this;e=Oj(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){zC(this,!1),S1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return hg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Rj(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Lj(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Sde=(t,e,n)=>hde(()=>new Ide(e,t,n)),FL=Sde(1,136,256/8);function kde(t){if(!(t instanceof Uint8Array))throw new TypeError(`bytesToUtf8 expected Uint8Array, got ${typeof t}`);return new TextDecoder().decode(t)}function Ede(t){return e=>(rde.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const yi=(()=>{const t=Ede(FL);return t.create=FL.create,t})();function Mh(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}function Qu(...t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function vN(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n+=1)if(t[n]!==e[n])return!1;return!0}const Cde={noether:BigInt(0),wei:BigInt(1),kwei:BigInt(1e3),Kwei:BigInt(1e3),babbage:BigInt(1e3),femtoether:BigInt(1e3),mwei:BigInt(1e6),Mwei:BigInt(1e6),lovelace:BigInt(1e6),picoether:BigInt(1e6),gwei:BigInt(1e9),Gwei:BigInt(1e9),shannon:BigInt(1e9),nanoether:BigInt(1e9),nano:BigInt(1e9),szabo:BigInt(1e12),microether:BigInt(1e12),micro:BigInt(1e12),finney:BigInt(1e15),milliether:BigInt(1e15),milli:BigInt(1e15),ether:BigInt("1000000000000000000"),kether:BigInt("1000000000000000000000"),grand:BigInt("1000000000000000000000"),mether:BigInt("1000000000000000000000000"),gether:BigInt("1000000000000000000000000000"),tether:BigInt("1000000000000000000000000000000")},Tde="Warning: Using type `number` with values that are large or contain many decimals may cause loss of precision, it is recommended to use type `string` or `BigInt` when using conversion methods",wl=t=>{if(Me.validate(["bytes"],[t]),Mh(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Ade}=Ai,On=t=>Ade(wl(t)),$o=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?wl(`0x${t}`):wl(t),Nde=t=>(Me.validate(["hex"],[t]),wd(t)),Qs=(t,e)=>{typeof t!="bigint"&&Me.validate(["int"],[t]);let n=Dl(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},LL=t=>{Me.validate(["string"],[t]);let e=t.replace(/^(?:\u0000)/,"");return e=e.replace(/(?:\u0000)$/,""),On(new TextEncoder().encode(e))},_de=t=>kde($o(t)),$de=pg,UC=(t,e)=>{if(typeof t=="string"&&mr(t))return e?"address":`0x${t.toLowerCase().replace(/^0x/i,"")}`;if(typeof t=="boolean")return e?"bool":t?"0x01":"0x00";if(typeof t=="number")return e?t<0?"int256":"uint256":Qs(t);if(typeof t=="bigint")return e?"bigint":Qs(t);if(Mh(t))return e?"bytes":On(t);if(typeof t=="object"&&t)return e?"string":LL(JSON.stringify(t));if(typeof t=="string"){if(t.startsWith("-0x")||t.startsWith("-0X"))return e?"int256":Qs(t);if(pt(t))return e?"bytes":t;if(zo(t)&&!fc(t)&&!ki(t))return e?"bytes":`0x${t}`;if(zo(t)&&!fc(t)&&ki(t))return e?"uint":Qs(t);if(!Number.isFinite(t))return e?"string":LL(t)}throw new iN(t)},ym=t=>{if(typeof t=="number")return t>1e20?(console.warn(Tde),BigInt(t)):t;if(typeof t=="bigint")return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?Number(t):t;if(typeof t=="string"&&pt(t))return Nde(t);try{return ym(BigInt(t))}catch{throw new Pl(t)}},Jv=t=>{if(typeof t=="number")return BigInt(t);if(typeof t=="bigint")return t;if(typeof t=="string"&&zo(t))return t.startsWith("-")?-BigInt(t.substring(1)):BigInt(t);throw new Pl(t)},bN=t=>{if(!mr(t,!1))throw new vd(t);const e=t.toLowerCase().replace(/^0x/i,""),n=Ur(yi(Go($de(e))));if(oe(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let r="0x";const s=n.replace(/^0x/i,"");for(let i=0;i<e.length;i+=1)parseInt(s[i],16)>7?r+=e[i].toUpperCase():r+=e[i];return r};var r2={exports:{}},BL;function Rde(){return BL||(BL=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||c,h),g=n?n+l:l;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,g=new Array(m);h<m;h++)g[h]=d[h].fn;return g},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,m,g){var v=n?n+l:l;if(!this._events[v])return!1;var y=this._events[v],w=arguments.length,x,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,m),!0;case 6:return y.fn.call(y.context,u,d,h,m,g),!0}for(S=1,x=new Array(w-1);S<w;S++)x[S-1]=arguments[S];y.fn.apply(y.context,x)}else{var k=y.length,E;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,h);break;default:if(!x)for(E=1,x=new Array(w-1);E<w;E++)x[E-1]=arguments[E];y[S].fn.apply(y[S].context,x)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,y=[],w=g.length;v<w;v++)(g[v].fn!==u||h&&!g[v].once||d&&g[v].context!==d)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(r2)),r2.exports}var Ode=Rde();const Pde=Wo(Ode);let Dde=class extends Pde{constructor(){super(...arguments),this.maxListeners=Number.MAX_SAFE_INTEGER}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}};const hc=oe,ML=t=>typeof t=="object"&&!oe(t)&&!Array.isArray(t)&&!(t instanceof wc),wN=(t,...e)=>{if(!ML(t))return t;const n=Object.assign({},t);for(const r of e)for(const s in r)ML(r[s])?(n[s]||(n[s]={}),n[s]=wN(n[s],r[s])):!oe(r[s])&&Object.hasOwnProperty.call(r,s)&&(Array.isArray(r[s])||r[s]instanceof wc?n[s]=r[s].slice(0):n[s]=r[s]);return n},Fde=(t,e,n="0")=>typeof t=="string"?pt(t)?so(t,e,n):t.padStart(e,n):(Me.validate(["int"],[t]),so(t,e,n)),{parseBaseType:Lde}=Ai,Bde=(t,e,n=[])=>{let r=Object.assign({},t),s;for(const i of e){if(r.oneOf&&s){const o=s,a=n.find(([c])=>c===o);a&&a[0]===s&&(r=r.oneOf[a[1]])}if(!r.properties&&!r.items)return;r.properties?r=r.properties[i]:r.items&&r.items.properties?r=r.items.properties[i]:r.items&&Rn(r.items)?r=r.items:r.items&&Array.isArray(r.items)&&(r=r.items[parseInt(i,10)]),r&&i&&(s=i)}return r},Rw=(t,e,n)=>{try{const{baseType:r,baseTypeSize:s}=Lde(e);if(r==="int"||r==="uint")switch(n.number){case _n.NUMBER:return Number(Jv(t));case _n.HEX:return Qs(Jv(t));case _n.STR:return Jv(t).toString();case _n.BIGINT:return Jv(t);default:throw new ro(`Invalid format: ${String(n.number)}`)}if(r==="bytes"){let i;switch(s?typeof t=="string"?i=Fde(t,s*2):Mh(t)&&(i=Qu(new Uint8Array(s-t.length),t)):i=t,n.bytes){case Es.HEX:return On(wl(i));case Es.UINT8ARRAY:return wl(i);default:throw new ro(`Invalid format: ${String(n.bytes)}`)}}if(r==="string")return String(t)}catch{return t}return t},zL=({value:t,schemaProp:e,schema:n,object:r,key:s,dataPath:i,format:o,oneOfPath:a=[]})=>{var c,l;if(Array.isArray(t)){let u=e;if(e?.oneOf!==void 0&&e.oneOf.forEach((d,h)=>{var m,g;!Array.isArray(e?.items)&&(typeof t[0]=="object"&&((m=d?.items)===null||m===void 0?void 0:m.type)==="object"||typeof t[0]=="string"&&((g=d?.items)===null||g===void 0?void 0:g.type)!=="object")&&(u=d,a.push([s,h]))}),oe(u?.items))return delete r[s],i.pop(),!0;if(Rn(u.items)&&!oe(u.items.format)){for(let d=0;d<t.length;d+=1)r[s][d]=Rw(t[d],(c=u?.items)===null||c===void 0?void 0:c.format,o);return i.pop(),!0}if(!Array.isArray(u?.items)&&((l=u?.items)===null||l===void 0?void 0:l.type)==="object"){for(const d of t)xN(d,n,i,o,a);return i.pop(),!0}if(Array.isArray(u?.items)){for(let d=0;d<t.length;d+=1)r[s][d]=Rw(t[d],u.items[d].format,o);return i.pop(),!0}}return!1},xN=(t,e,n,r,s=[])=>{var i;if(!Rn(t)&&!Array.isArray(t))return Rw(t,e?.format,r);const o=t;if(Array.isArray(o)&&e?.type==="array"&&((i=e?.items)===null||i===void 0?void 0:i.type)==="object")zL({value:o,schemaProp:e,schema:e,object:o,key:"",dataPath:n,format:r,oneOfPath:s});else for(const[a,c]of Object.entries(o)){n.push(a);let l=Bde(e,n,s);if(oe(l)){delete o[a],n.pop();continue}if(Rn(c)){xN(c,e,n,r,s),n.pop();continue}if(!zL({value:c,schemaProp:l,schema:e,object:o,key:a,dataPath:n,format:r,oneOfPath:s})){if(l?.format===void 0&&l?.oneOf!==void 0){for(const[u,d]of l.oneOf.entries())if(d?.format!==void 0){l=d;break}}o[a]=Rw(c,l.format,r),n.pop()}}return o},Re=(t,e,n=Fr)=>{let r;Rn(e)?r=wN({},e):Array.isArray(e)?r=[...e]:r=e;const s=Rn(t)?t:Lh(t);if(!s.properties&&!s.items&&!s.format)throw new ro("Invalid json schema for formatting");return xN(r,s,[],n)},Bj="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",Mj=t=>{let e;return typeof t=="bigint"||typeof t=="number"?e=pg(t.toString()):Array.isArray(t)?e=new Uint8Array(t):typeof t=="string"&&!pt(t)?e=pg(t):e=wl(t),On(yi(Go(e)))},Mde=t=>{let e;typeof t=="string"?t.startsWith("0x")&&pt(t)?e=$o(t):e=pg(t):e=t;const n=Mj(e);return n===Bj?void 0:n},zj=t=>{const e=Mde(t);return oe(e)?Bj:e};var IN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function zde(t,e,n){return IN(this,void 0,void 0,function*(){let r;const s=yield Promise.race([t instanceof Promise?t:t(),new Promise((i,o)=>{r=setTimeout(()=>i(void 0),e)})]);if(r&&clearTimeout(r),s instanceof Error)throw s;return s})}function Ude(t,e){let n;return[new Promise((s,i)=>{n=setInterval((function o(){return IN(this,void 0,void 0,function*(){try{const a=yield zde(t,e);oe(a)||(clearInterval(n),s(a))}catch(a){clearInterval(n),i(a)}}),o})(),e)}),n]}function Uj(t,e){let n;const r=new Promise((s,i)=>{n=setTimeout(()=>{i(e)},t)});return[n,r]}function Vde(t,e){let n;const r=new Promise((s,i)=>{n=setInterval(()=>{IN(this,void 0,void 0,function*(){const o=yield t();o&&(clearInterval(n),i(o))})},e)});return[n,r]}var mt=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function jde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_protocolVersion",params:[]})})}function Vj(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_syncing",params:[]})})}function Hde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_coinbase",params:[]})})}function Wde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_mining",params:[]})})}function Gde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_hashrate",params:[]})})}function qde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_gasPrice",params:[]})})}function Kde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_maxPriorityFeePerGas",params:[]})})}function Xde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_accounts",params:[]})})}function Qde(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_blockNumber",params:[]})})}function Yde(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["address","blockNumberOrTag"],[e,n]),t.send({method:"eth_getBalance",params:[e,n]})})}function Zde(t,e,n,r){return mt(this,void 0,void 0,function*(){return Me.validate(["address","hex","blockNumberOrTag"],[e,n,r]),t.send({method:"eth_getStorageAt",params:[e,n,r]})})}function Jde(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["address","blockNumberOrTag"],[e,n]),t.send({method:"eth_getTransactionCount",params:[e,n]})})}function efe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32"],[e]),t.send({method:"eth_getBlockTransactionCountByHash",params:[e]})})}function tfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag"],[e]),t.send({method:"eth_getBlockTransactionCountByNumber",params:[e]})})}function nfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32"],[e]),t.send({method:"eth_getUncleCountByBlockHash",params:[e]})})}function rfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag"],[e]),t.send({method:"eth_getUncleCountByBlockNumber",params:[e]})})}function sfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["address","blockNumberOrTag"],[e,n]),t.send({method:"eth_getCode",params:[e,n]})})}function ife(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["address","hex"],[e,n]),t.send({method:"eth_sign",params:[e,n]})})}function ofe(t,e){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_signTransaction",params:[e]})})}function afe(t,e){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_sendTransaction",params:[e]})})}function jj(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["hex"],[e]),t.send({method:"eth_sendRawTransaction",params:[e]})})}function cfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag"],[n]),t.send({method:"eth_call",params:[e,n]})})}function lfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag"],[n]),t.send({method:"eth_estimateGas",params:[e,n]})})}function ufe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32","bool"],[e,n]),t.send({method:"eth_getBlockByHash",params:[e,n]})})}function Hj(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag","bool"],[e,n]),t.send({method:"eth_getBlockByNumber",params:[e,n]})})}function dfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32"],[e]),t.send({method:"eth_getTransactionByHash",params:[e]})})}function ffe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32","hex"],[e,n]),t.send({method:"eth_getTransactionByBlockHashAndIndex",params:[e,n]})})}function hfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag","hex"],[e,n]),t.send({method:"eth_getTransactionByBlockNumberAndIndex",params:[e,n]})})}function pfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32"],[e]),t.send({method:"eth_getTransactionReceipt",params:[e]})})}function mfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes32","hex"],[e,n]),t.send({method:"eth_getUncleByBlockHashAndIndex",params:[e,n]})})}function gfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag","hex"],[e,n]),t.send({method:"eth_getUncleByBlockNumberAndIndex",params:[e,n]})})}function yfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["filter"],[e]),t.send({method:"eth_newFilter",params:[e]})})}function vfe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_newBlockFilter",params:[]})})}function bfe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_newPendingTransactionFilter",params:[]})})}function wfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["hex"],[e]),t.send({method:"eth_uninstallFilter",params:[e]})})}function xfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["hex"],[e]),t.send({method:"eth_getFilterChanges",params:[e]})})}function Ife(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["hex"],[e]),t.send({method:"eth_getFilterLogs",params:[e]})})}function Sfe(t,e){return mt(this,void 0,void 0,function*(){return Me.validate(["filter"],[e]),t.send({method:"eth_getLogs",params:[e]})})}function kfe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_getWork",params:[]})})}function Efe(t,e,n,r){return mt(this,void 0,void 0,function*(){return Me.validate(["bytes8","bytes32","bytes32"],[e,n,r]),t.send({method:"eth_submitWork",params:[e,n,r]})})}function Cfe(t,e,n,r){return mt(this,void 0,void 0,function*(){Me.validate(["hex","blockNumberOrTag"],[e,n]);for(const s of r)Me.validate(["number"],[s]);return t.send({method:"eth_feeHistory",params:[e,n,r]})})}function Tfe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_pendingTransactions",params:[]})})}function Afe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_requestAccounts",params:[]})})}function Nfe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"eth_chainId",params:[]})})}function _fe(t,e,n,r){return mt(this,void 0,void 0,function*(){return Me.validate(["address","bytes32[]","blockNumberOrTag"],[e,n,r]),t.send({method:"eth_getProof",params:[e,n,r]})})}function $fe(t){return mt(this,void 0,void 0,function*(){return t.send({method:"web3_clientVersion",params:[]})})}function Rfe(t,e,n){return mt(this,void 0,void 0,function*(){return Me.validate(["blockNumberOrTag"],[n]),t.send({method:"eth_createAccessList",params:[e,n]})})}function Ofe(t,e,n,r=!1){return mt(this,void 0,void 0,function*(){return Me.validate(["address"],[e]),t.send({method:`eth_signTypedData${r?"":"_v4"}`,params:[e,n]})})}var SN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function Pfe(t){return SN(this,void 0,void 0,function*(){return t.send({method:"net_version",params:[]})})}function Dfe(t){return SN(this,void 0,void 0,function*(){return t.send({method:"net_peerCount",params:[]})})}function Ffe(t){return SN(this,void 0,void 0,function*(){return t.send({method:"net_listening",params:[]})})}var Ic=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const Lfe=t=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_listAccounts",params:[]})}),Bfe=(t,e)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_newAccount",params:[e]})}),Mfe=(t,e,n,r)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_unlockAccount",params:[e,n,r]})}),zfe=(t,e)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_lockAccount",params:[e]})}),Ufe=(t,e,n)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_importRawKey",params:[e,n]})}),Vfe=(t,e,n)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_sendTransaction",params:[e,n]})}),jfe=(t,e,n)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_signTransaction",params:[e,n]})}),Hfe=(t,e,n,r)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_sign",params:[e,n,r]})}),Wfe=(t,e,n)=>Ic(void 0,void 0,void 0,function*(){return t.send({method:"personal_ecRecover",params:[e,n]})}),Gfe=Object.freeze(Object.defineProperty({__proto__:null,secp256k1:xd},Symbol.toStringTag,{value:"Module"}));var s2;const o0=(s2=xd)!==null&&s2!==void 0?s2:Gfe,UL=BigInt("0xffffffffffffffff"),mg=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),qfe=o0.CURVE.n,Kfe=qfe/BigInt(2);var Ow;(function(t){t[t.Mainnet=1]="Mainnet",t[t.Goerli=5]="Goerli",t[t.Sepolia=11155111]="Sepolia"})(Ow||(Ow={}));var pn;(function(t){t.Chainstart="chainstart",t.Homestead="homestead",t.Dao="dao",t.TangerineWhistle="tangerineWhistle",t.SpuriousDragon="spuriousDragon",t.Byzantium="byzantium",t.Constantinople="constantinople",t.Petersburg="petersburg",t.Istanbul="istanbul",t.MuirGlacier="muirGlacier",t.Berlin="berlin",t.London="london",t.ArrowGlacier="arrowGlacier",t.GrayGlacier="grayGlacier",t.MergeForkIdTransition="mergeForkIdTransition",t.Merge="merge",t.Shanghai="shanghai",t.ShardingForkDev="shardingFork"})(pn||(pn={}));var VL;(function(t){t.ProofOfStake="pos",t.ProofOfWork="pow",t.ProofOfAuthority="poa"})(VL||(VL={}));var jL;(function(t){t.Ethash="ethash",t.Clique="clique",t.Casper="casper"})(jL||(jL={}));var as;(function(t){t.PolygonMainnet="polygon-mainnet",t.PolygonMumbai="polygon-mumbai",t.ArbitrumRinkebyTestnet="arbitrum-rinkeby-testnet",t.ArbitrumOne="arbitrum-one",t.xDaiChain="x-dai-chain",t.OptimisticKovan="optimistic-kovan",t.OptimisticEthereum="optimistic-ethereum"})(as||(as={}));var Gi;(function(t){t[t.Number=0]="Number",t[t.BigInt=1]="BigInt",t[t.Uint8Array=2]="Uint8Array",t[t.PrefixedHexString=3]="PrefixedHexString"})(Gi||(Gi={}));const Wj=t=>{if(typeof t!="string")throw new Error(`[stripHexPrefix] input must be type 'string', received ${typeof t}`);return Dh(t)?t.slice(2):t};function Xfe(t){return!t||t==="0x0"?"0x0000000000000000":Dh(t)?`0x${Wj(t).padStart(16,"0")}`:`0x${t.padStart(16,"0")}`}const Gj=function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Received an invalid integer type: ${t}`);return`0x${t.toString(16)}`};function Qfe(t,e=!0){var n,r;const{name:s,config:i,difficulty:o,mixHash:a,gasLimit:c,coinbase:l,baseFeePerGas:u}=t;let{extraData:d,timestamp:h,nonce:m}=t;const g=Number(h),{chainId:v}=i;if(d===""&&(d="0x"),Dh(h)||(h=Gj(parseInt(h))),m.length!==18&&(m=Xfe(m)),i.eip155Block!==i.eip158Block)throw new Error("EIP155 block number must equal EIP 158 block number since both are part of SpuriousDragon hardfork and the client only supports activating the full hardfork");const y={name:s,chainId:v,networkId:v,genesis:{timestamp:h,gasLimit:parseInt(c),difficulty:parseInt(o),nonce:m,extraData:d,mixHash:a,coinbase:l,baseFeePerGas:u},hardfork:void 0,hardforks:[],bootstrapNodes:[],consensus:i.clique!==void 0?{type:"poa",algorithm:"clique",clique:{period:(n=i.clique.period)!==null&&n!==void 0?n:i.clique.blockperiodseconds,epoch:(r=i.clique.epoch)!==null&&r!==void 0?r:i.clique.epochlength}}:{type:"pow",algorithm:"ethash",ethash:{}}},w={[pn.Homestead]:{name:"homesteadBlock"},[pn.Dao]:{name:"daoForkBlock"},[pn.TangerineWhistle]:{name:"eip150Block"},[pn.SpuriousDragon]:{name:"eip155Block"},[pn.Byzantium]:{name:"byzantiumBlock"},[pn.Constantinople]:{name:"constantinopleBlock"},[pn.Petersburg]:{name:"petersburgBlock"},[pn.Istanbul]:{name:"istanbulBlock"},[pn.MuirGlacier]:{name:"muirGlacierBlock"},[pn.Berlin]:{name:"berlinBlock"},[pn.London]:{name:"londonBlock"},[pn.MergeForkIdTransition]:{name:"mergeForkBlock",postMerge:e},[pn.Shanghai]:{name:"shanghaiTime",postMerge:!0,isTimestamp:!0},[pn.ShardingForkDev]:{name:"shardingForkTime",postMerge:!0,isTimestamp:!0}},x=Object.keys(w).reduce((E,A)=>(E[w[A].name]=A,E),{}),S=Object.keys(i).filter(E=>x[E]!==void 0&&i[E]!==void 0&&i[E]!==null);if(y.hardforks=S.map(E=>({name:x[E],block:w[x[E]].isTimestamp===!0||typeof i[E]!="number"?null:i[E],timestamp:w[x[E]].isTimestamp===!0&&typeof i[E]=="number"?i[E]:void 0})).filter(E=>E.block!==null||E.timestamp!==void 0),y.hardforks.sort((E,A)=>{var R,N;return((R=E.block)!==null&&R!==void 0?R:1/0)-((N=A.block)!==null&&N!==void 0?N:1/0)}),y.hardforks.sort((E,A)=>{var R,N;return((R=E.timestamp)!==null&&R!==void 0?R:g)-((N=A.timestamp)!==null&&N!==void 0?N:g)}),i.terminalTotalDifficulty!==void 0){const E={name:pn.Merge,ttd:i.terminalTotalDifficulty,block:null},A=y.hardforks.findIndex(R=>{var N;return((N=w[R.name])===null||N===void 0?void 0:N.postMerge)===!0});A!==-1?y.hardforks.splice(A,0,E):y.hardforks.push(E)}const k=y.hardforks.length>0?y.hardforks.slice(-1)[0]:void 0;return y.hardfork=k?.name,y.hardforks.unshift({name:pn.Chainstart,block:0}),y}function Yfe(t,e,n){try{if(["config","difficulty","gasLimit","alloc"].some(r=>!(r in t)))throw new Error("Invalid format, expected geth genesis fields missing");return e!==void 0&&(t.name=e),Qfe(t,n)}catch(r){throw new Error(`Error parsing parameters file: ${r.message}`)}}function qj(t){let e=t;if(typeof e!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof e}`);return e.length%2&&(e=`0${e}`),e}const Zfe=function(t){const e=Gj(t);return $o(`0x${qj(e.slice(2))}`)},kn=function(t){var e;if(t==null)return new Uint8Array;if(t instanceof Uint8Array)return t;if(((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||Array.isArray(t))return Uint8Array.from(t);if(typeof t=="string"){if(!g1(t))throw new Error(`Cannot convert string to Uint8Array. only supports 0x-prefixed hex strings and this string was given: ${t}`);return $o(qj(Wj(t)))}if(typeof t=="number")return kn(Qs(t));if(typeof t=="bigint"){if(t<BigInt(0))throw new Error(`Cannot convert negative bigint to Uint8Array. Given: ${t}`);let n=t.toString(16);return n.length%2&&(n=`0${n}`),kn(`0x${n}`)}if(t.toArray)return Uint8Array.from(t.toArray());throw new Error("invalid type")};function un(t){const e=On(t);return BigInt(e==="0x"?0:e)}function Jfe(t){return kn(`0x${t.toString(16)}`)}const Kj=function(t){return new Uint8Array(t).fill(0)},ehe=function(t,e,n){const r=Kj(e);return t.length<e?(r.set(t,e-t.length),r):t.subarray(-e)};function kN(t){if(!Mh(t)){const e=`This method only supports Uint8Array but input was: ${t}`;throw new Error(e)}}const HL=function(t,e){return kN(t),ehe(t,e)};function the(t){let e=t[0];for(;t.length>0&&e.toString()==="0";)t=t.slice(1),e=t[0];return t}const Pw=function(t){return kN(t),the(t)},Tn=t=>`0x${t.toString(16)}`;function Ut(t){return Pw(Jfe(t))}function nhe(t,e){return t===BigInt(0)||t===BigInt(1)?t:e===void 0?t-BigInt(27):t-(e*BigInt(2)+BigInt(35))}function rhe(t){return t===BigInt(0)||t===BigInt(1)}const EN=function(t,e,n,r,s){const i=nhe(e,s);if(!rhe(i))throw new Error("Invalid signature v value");return new o0.Signature(un(n),un(r)).addRecoveryBit(Number(i)).recoverPublicKey(t).toRawBytes(!1).slice(1)};function cf(t,e){if(t===null)return null;if(t===void 0)return;if(typeof t=="string"&&!g1(t))throw new Error(`A string must be provided with a 0x-prefix, given: ${t}`);if(typeof t=="number"&&!Number.isSafeInteger(t))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const n=kn(t);switch(e){case Gi.Uint8Array:return n;case Gi.BigInt:return un(n);case Gi.Number:{const r=un(n);if(r>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(r)}case Gi.PrefixedHexString:return On(n);default:throw new Error("unknown outputType")}}const she={name:"goerli",chainId:5,networkId:5,defaultHardfork:"merge",consensus:{type:"poa",algorithm:"clique",clique:{period:15,epoch:3e4}},comment:"Cross-client PoA test network",url:"https://github.com/goerli/testnet",genesis:{timestamp:"0x5c51a607",gasLimit:10485760,difficulty:1,nonce:"0x0000000000000000",extraData:"0x22466c6578692069732061207468696e6722202d204166726900000000000000e0a2bd4258d2768837baa26a28fe71dc079f84c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},hardforks:[{name:"chainstart",block:0,forkHash:"0xa3f5ab08"},{name:"homestead",block:0,forkHash:"0xa3f5ab08"},{name:"tangerineWhistle",block:0,forkHash:"0xa3f5ab08"},{name:"spuriousDragon",block:0,forkHash:"0xa3f5ab08"},{name:"byzantium",block:0,forkHash:"0xa3f5ab08"},{name:"constantinople",block:0,forkHash:"0xa3f5ab08"},{name:"petersburg",block:0,forkHash:"0xa3f5ab08"},{name:"istanbul",block:1561651,forkHash:"0xc25efa5c"},{name:"berlin",block:4460644,forkHash:"0x757a1c47"},{name:"london",block:5062605,forkHash:"0xb8c6299d"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://goerli.etherscan.io/block/7382818",name:"merge",ttd:"10790000",block:7382819,forkHash:"0xb8c6299d"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.goerli.ethdisco.net"]},ihe={name:"mainnet",chainId:1,networkId:1,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"The Ethereum main chain",url:"https://ethstats.net/",genesis:{gasLimit:5e3,difficulty:17179869184,nonce:"0x0000000000000042",extraData:"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfc64ec04"},{name:"homestead",block:115e4,forkHash:"0x97c2c34c"},{name:"dao",block:192e4,forkHash:"0x91d1f948"},{name:"tangerineWhistle",block:2463e3,forkHash:"0x7a64da13"},{name:"spuriousDragon",block:2675e3,forkHash:"0x3edd5b10"},{name:"byzantium",block:437e4,forkHash:"0xa00bc324"},{name:"constantinople",block:728e4,forkHash:"0x668db0af"},{name:"petersburg",block:728e4,forkHash:"0x668db0af"},{name:"istanbul",block:9069e3,forkHash:"0x879d6e30"},{name:"muirGlacier",block:92e5,forkHash:"0xe029e991"},{name:"berlin",block:12244e3,forkHash:"0x0eb440f6"},{name:"london",block:12965e3,forkHash:"0xb715077d"},{name:"arrowGlacier",block:13773e3,forkHash:"0x20c327fc"},{name:"grayGlacier",block:1505e4,forkHash:"0xf0afd0e3"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://etherscan.io/block/15537393",name:"merge",ttd:"58750000000000000000000",block:15537394,forkHash:"0xf0afd0e3"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.mainnet.ethdisco.net"]},ohe={name:"sepolia",chainId:11155111,networkId:11155111,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"PoW test network to replace Ropsten",url:"https://github.com/ethereum/go-ethereum/pull/23730",genesis:{timestamp:"0x6159af19",gasLimit:3e7,difficulty:131072,nonce:"0x0000000000000000",extraData:"0x5365706f6c69612c20417468656e732c204174746963612c2047726565636521"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfe3366e7"},{name:"homestead",block:0,forkHash:"0xfe3366e7"},{name:"tangerineWhistle",block:0,forkHash:"0xfe3366e7"},{name:"spuriousDragon",block:0,forkHash:"0xfe3366e7"},{name:"byzantium",block:0,forkHash:"0xfe3366e7"},{name:"constantinople",block:0,forkHash:"0xfe3366e7"},{name:"petersburg",block:0,forkHash:"0xfe3366e7"},{name:"istanbul",block:0,forkHash:"0xfe3366e7"},{name:"muirGlacier",block:0,forkHash:"0xfe3366e7"},{name:"berlin",block:0,forkHash:"0xfe3366e7"},{name:"london",block:0,forkHash:"0xfe3366e7"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://sepolia.etherscan.io/block/1450408",name:"merge",ttd:"17000000000000000",block:1450409,forkHash:"0xfe3366e7"},{name:"mergeForkIdTransition",block:1735371,forkHash:"0xb96cbd13"},{name:"shanghai",block:null,timestamp:"1677557088",forkHash:"0xf7f9bc08"}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.sepolia.ethdisco.net"]},ahe={name:"EIP-1153",number:1153,comment:"Transient Storage",url:"https://eips.ethereum.org/EIPS/eip-1153",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{tstore:{v:100,d:"Base fee of the TSTORE opcode"},tload:{v:100,d:"Base fee of the TLOAD opcode"}},vm:{},pow:{}},che={name:"EIP-1559",number:1559,comment:"Fee market change for ETH 1.0 chain",url:"https://eips.ethereum.org/EIPS/eip-1559",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2930],gasConfig:{baseFeeMaxChangeDenominator:{v:8,d:"Maximum base fee change denominator"},elasticityMultiplier:{v:2,d:"Maximum block gas target elasticity"},initialBaseFee:{v:1e9,d:"Initial base fee on first EIP1559 block"}},gasPrices:{},vm:{},pow:{}},lhe={name:"EIP-2315",number:2315,comment:"Simple subroutines for the EVM",url:"https://eips.ethereum.org/EIPS/eip-2315",status:"Draft",minimumHardfork:"istanbul",gasConfig:{},gasPrices:{beginsub:{v:2,d:"Base fee of the BEGINSUB opcode"},returnsub:{v:5,d:"Base fee of the RETURNSUB opcode"},jumpsub:{v:10,d:"Base fee of the JUMPSUB opcode"}},vm:{},pow:{}},uhe={name:"EIP-2537",number:2537,comment:"BLS12-381 precompiles",url:"https://eips.ethereum.org/EIPS/eip-2537",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{Bls12381G1AddGas:{v:600,d:"Gas cost of a single BLS12-381 G1 addition precompile-call"},Bls12381G1MulGas:{v:12e3,d:"Gas cost of a single BLS12-381 G1 multiplication precompile-call"},Bls12381G2AddGas:{v:4500,d:"Gas cost of a single BLS12-381 G2 addition precompile-call"},Bls12381G2MulGas:{v:55e3,d:"Gas cost of a single BLS12-381 G2 multiplication precompile-call"},Bls12381PairingBaseGas:{v:115e3,d:"Base gas cost of BLS12-381 pairing check"},Bls12381PairingPerPairGas:{v:23e3,d:"Per-pair gas cost of BLS12-381 pairing check"},Bls12381MapG1Gas:{v:5500,d:"Gas cost of BLS12-381 map field element to G1"},Bls12381MapG2Gas:{v:11e4,d:"Gas cost of BLS12-381 map field element to G2"},Bls12381MultiExpGasDiscount:{v:[[1,1200],[2,888],[3,764],[4,641],[5,594],[6,547],[7,500],[8,453],[9,438],[10,423],[11,408],[12,394],[13,379],[14,364],[15,349],[16,334],[17,330],[18,326],[19,322],[20,318],[21,314],[22,310],[23,306],[24,302],[25,298],[26,294],[27,289],[28,285],[29,281],[30,277],[31,273],[32,269],[33,268],[34,266],[35,265],[36,263],[37,262],[38,260],[39,259],[40,257],[41,256],[42,254],[43,253],[44,251],[45,250],[46,248],[47,247],[48,245],[49,244],[50,242],[51,241],[52,239],[53,238],[54,236],[55,235],[56,233],[57,232],[58,231],[59,229],[60,228],[61,226],[62,225],[63,223],[64,222],[65,221],[66,220],[67,219],[68,219],[69,218],[70,217],[71,216],[72,216],[73,215],[74,214],[75,213],[76,213],[77,212],[78,211],[79,211],[80,210],[81,209],[82,208],[83,208],[84,207],[85,206],[86,205],[87,205],[88,204],[89,203],[90,202],[91,202],[92,201],[93,200],[94,199],[95,199],[96,198],[97,197],[98,196],[99,196],[100,195],[101,194],[102,193],[103,193],[104,192],[105,191],[106,191],[107,190],[108,189],[109,188],[110,188],[111,187],[112,186],[113,185],[114,185],[115,184],[116,183],[117,182],[118,182],[119,181],[120,180],[121,179],[122,179],[123,178],[124,177],[125,176],[126,176],[127,175],[128,174]],d:"Discount gas costs of calls to the MultiExp precompiles with `k` (point, scalar) pair"}},vm:{},pow:{}},dhe={name:"EIP-2565",number:2565,comment:"ModExp gas cost",url:"https://eips.ethereum.org/EIPS/eip-2565",status:"Final",minimumHardfork:"byzantium",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:3,d:"Gquaddivisor from modexp precompile for gas calculation"}},vm:{},pow:{}},fhe={name:"EIP-2718",comment:"Typed Transaction Envelope",url:"https://eips.ethereum.org/EIPS/eip-2718",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{},vm:{},pow:{}},hhe={name:"EIP-2929",comment:"Gas cost increases for state access opcodes",url:"https://eips.ethereum.org/EIPS/eip-2929",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{coldsload:{v:2100,d:"Gas cost of the first read of storage from a given location (per transaction)"},coldaccountaccess:{v:2600,d:"Gas cost of the first read of a given address (per transaction)"},warmstorageread:{v:100,d:"Gas cost of reading storage locations which have already loaded 'cold'"},sstoreCleanGasEIP2200:{v:2900,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreNoopGasEIP2200:{v:100,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:100,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitRefundEIP2200:{v:19900,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanRefundEIP2200:{v:4900,d:"Once per SSTORE operation for resetting to the original non-zero value"},call:{v:0,d:"Base fee of the CALL opcode"},callcode:{v:0,d:"Base fee of the CALLCODE opcode"},delegatecall:{v:0,d:"Base fee of the DELEGATECALL opcode"},staticcall:{v:0,d:"Base fee of the STATICCALL opcode"},balance:{v:0,d:"Base fee of the BALANCE opcode"},extcodesize:{v:0,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:0,d:"Base fee of the EXTCODECOPY opcode"},extcodehash:{v:0,d:"Base fee of the EXTCODEHASH opcode"},sload:{v:0,d:"Base fee of the SLOAD opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"}},vm:{},pow:{}},phe={name:"EIP-2930",comment:"Optional access lists",url:"https://eips.ethereum.org/EIPS/eip-2930",status:"Final",minimumHardfork:"istanbul",requiredEIPs:[2718,2929],gasConfig:{},gasPrices:{accessListStorageKeyCost:{v:1900,d:"Gas cost per storage key in an Access List transaction"},accessListAddressCost:{v:2400,d:"Gas cost per storage key in an Access List transaction"}},vm:{},pow:{}},mhe={name:"EIP-3198",number:3198,comment:"BASEFEE opcode",url:"https://eips.ethereum.org/EIPS/eip-3198",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{basefee:{v:2,d:"Gas cost of the BASEFEE opcode"}},vm:{},pow:{}},ghe={name:"EIP-3529",comment:"Reduction in refunds",url:"https://eips.ethereum.org/EIPS/eip-3529",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2929],gasConfig:{maxRefundQuotient:{v:5,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{selfdestructRefund:{v:0,d:"Refunded following a selfdestruct operation"},sstoreClearRefundEIP2200:{v:4800,d:"Once per SSTORE operation for clearing an originally existing storage slot"}},vm:{},pow:{}},yhe={name:"EIP-3540",number:3540,comment:"EVM Object Format (EOF) v1",url:"https://eips.ethereum.org/EIPS/eip-3540",status:"Review",minimumHardfork:"london",requiredEIPs:[3541],gasConfig:{},gasPrices:{},vm:{},pow:{}},vhe={name:"EIP-3541",comment:"Reject new contracts starting with the 0xEF byte",url:"https://eips.ethereum.org/EIPS/eip-3541",status:"Final",minimumHardfork:"berlin",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},bhe={name:"EIP-3554",comment:"Reduction in refunds",url:"Difficulty Bomb Delay to December 1st 2021",status:"Final",minimumHardfork:"muirGlacier",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:95e5,d:"the amount of blocks to delay the difficulty bomb with"}}},whe={name:"EIP-3607",number:3607,comment:"Reject transactions from senders with deployed code",url:"https://eips.ethereum.org/EIPS/eip-3607",status:"Final",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},xhe={name:"EIP-3651",number:3198,comment:"Warm COINBASE",url:"https://eips.ethereum.org/EIPS/eip-3651",status:"Review",minimumHardfork:"london",requiredEIPs:[2929],gasConfig:{},gasPrices:{},vm:{},pow:{}},Ihe={name:"EIP-3670",number:3670,comment:"EOF - Code Validation",url:"https://eips.ethereum.org/EIPS/eip-3670",status:"Review",minimumHardfork:"london",requiredEIPs:[3540],gasConfig:{},gasPrices:{},vm:{},pow:{}},She={name:"EIP-3675",number:3675,comment:"Upgrade consensus to Proof-of-Stake",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Final",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},khe={name:"EIP-3855",number:3855,comment:"PUSH0 instruction",url:"https://eips.ethereum.org/EIPS/eip-3855",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{push0:{v:2,d:"Base fee of the PUSH0 opcode"}},vm:{},pow:{}},Ehe={name:"EIP-3860",number:3860,comment:"Limit and meter initcode",url:"https://eips.ethereum.org/EIPS/eip-3860",status:"Review",minimumHardfork:"spuriousDragon",requiredEIPs:[],gasConfig:{},gasPrices:{initCodeWordCost:{v:2,d:"Gas to pay for each word (32 bytes) of initcode when creating a contract"}},vm:{maxInitCodeSize:{v:49152,d:"Maximum length of initialization code when creating a contract"}},pow:{}},Che={name:"EIP-4345",number:4345,comment:"Difficulty Bomb Delay to June 2022",url:"https://eips.ethereum.org/EIPS/eip-4345",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:107e5,d:"the amount of blocks to delay the difficulty bomb with"}}},The={name:"EIP-4399",number:4399,comment:"Supplant DIFFICULTY opcode with PREVRANDAO",url:"https://eips.ethereum.org/EIPS/eip-4399",status:"Review",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},Ahe={name:"EIP-5133",number:5133,comment:"Delaying Difficulty Bomb to mid-September 2022",url:"https://eips.ethereum.org/EIPS/eip-5133",status:"Draft",minimumHardfork:"grayGlacier",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:114e5,d:"the amount of blocks to delay the difficulty bomb with"}}},lf={1153:ahe,1559:che,2315:lhe,2537:uhe,2565:dhe,2718:fhe,2929:hhe,2930:phe,3198:mhe,3529:ghe,3540:yhe,3541:vhe,3554:bhe,3607:whe,3651:xhe,3670:Ihe,3675:She,3855:khe,3860:Ehe,4345:Che,4399:The,5133:Ahe},Nhe={name:"chainstart",comment:"Start of the Ethereum main chain",url:"",status:"",gasConfig:{minGasLimit:{v:5e3,d:"Minimum the gas limit may ever be"},gasLimitBoundDivisor:{v:1024,d:"The bound divisor of the gas limit, used in update calculations"},maxRefundQuotient:{v:2,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{base:{v:2,d:"Gas base cost, used e.g. for ChainID opcode (Istanbul)"},tierStep:{v:[0,2,3,5,8,10,20],d:"Once per operation, for a selection of them"},exp:{v:10,d:"Base fee of the EXP opcode"},expByte:{v:10,d:"Times ceil(log256(exponent)) for the EXP instruction"},sha3:{v:30,d:"Base fee of the SHA3 opcode"},sha3Word:{v:6,d:"Once per word of the SHA3 operation's data"},sload:{v:50,d:"Base fee of the SLOAD opcode"},sstoreSet:{v:2e4,d:"Once per SSTORE operation if the zeroness changes from zero"},sstoreReset:{v:5e3,d:"Once per SSTORE operation if the zeroness does not change from zero"},sstoreRefund:{v:15e3,d:"Once per SSTORE operation if the zeroness changes to zero"},jumpdest:{v:1,d:"Base fee of the JUMPDEST opcode"},log:{v:375,d:"Base fee of the LOG opcode"},logData:{v:8,d:"Per byte in a LOG* operation's data"},logTopic:{v:375,d:"Multiplied by the * of the LOG*, per LOG transaction. e.g. LOG0 incurs 0 * c_txLogTopicGas, LOG4 incurs 4 * c_txLogTopicGas"},create:{v:32e3,d:"Base fee of the CREATE opcode"},call:{v:40,d:"Base fee of the CALL opcode"},callStipend:{v:2300,d:"Free gas given at beginning of call"},callValueTransfer:{v:9e3,d:"Paid for CALL when the value transfor is non-zero"},callNewAccount:{v:25e3,d:"Paid for CALL when the destination address didn't exist prior"},selfdestructRefund:{v:24e3,d:"Refunded following a selfdestruct operation"},memory:{v:3,d:"Times the address of the (highest referenced byte in memory + 1). NOTE: referencing happens on read, write and in instructions such as RETURN and CALL"},quadCoeffDiv:{v:512,d:"Divisor for the quadratic particle of the memory cost equation"},createData:{v:200,d:""},tx:{v:21e3,d:"Per transaction. NOTE: Not payable on data of calls between transactions"},txCreation:{v:32e3,d:"The cost of creating a contract via tx"},txDataZero:{v:4,d:"Per byte of data attached to a transaction that equals zero. NOTE: Not payable on data of calls between transactions"},txDataNonZero:{v:68,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},copy:{v:3,d:"Multiplied by the number of 32-byte words that are copied (round up) for any *COPY operation and added"},ecRecover:{v:3e3,d:""},sha256:{v:60,d:""},sha256Word:{v:12,d:""},ripemd160:{v:600,d:""},ripemd160Word:{v:120,d:""},identity:{v:15,d:""},identityWord:{v:3,d:""},stop:{v:0,d:"Base fee of the STOP opcode"},add:{v:3,d:"Base fee of the ADD opcode"},mul:{v:5,d:"Base fee of the MUL opcode"},sub:{v:3,d:"Base fee of the SUB opcode"},div:{v:5,d:"Base fee of the DIV opcode"},sdiv:{v:5,d:"Base fee of the SDIV opcode"},mod:{v:5,d:"Base fee of the MOD opcode"},smod:{v:5,d:"Base fee of the SMOD opcode"},addmod:{v:8,d:"Base fee of the ADDMOD opcode"},mulmod:{v:8,d:"Base fee of the MULMOD opcode"},signextend:{v:5,d:"Base fee of the SIGNEXTEND opcode"},lt:{v:3,d:"Base fee of the LT opcode"},gt:{v:3,d:"Base fee of the GT opcode"},slt:{v:3,d:"Base fee of the SLT opcode"},sgt:{v:3,d:"Base fee of the SGT opcode"},eq:{v:3,d:"Base fee of the EQ opcode"},iszero:{v:3,d:"Base fee of the ISZERO opcode"},and:{v:3,d:"Base fee of the AND opcode"},or:{v:3,d:"Base fee of the OR opcode"},xor:{v:3,d:"Base fee of the XOR opcode"},not:{v:3,d:"Base fee of the NOT opcode"},byte:{v:3,d:"Base fee of the BYTE opcode"},address:{v:2,d:"Base fee of the ADDRESS opcode"},balance:{v:20,d:"Base fee of the BALANCE opcode"},origin:{v:2,d:"Base fee of the ORIGIN opcode"},caller:{v:2,d:"Base fee of the CALLER opcode"},callvalue:{v:2,d:"Base fee of the CALLVALUE opcode"},calldataload:{v:3,d:"Base fee of the CALLDATALOAD opcode"},calldatasize:{v:2,d:"Base fee of the CALLDATASIZE opcode"},calldatacopy:{v:3,d:"Base fee of the CALLDATACOPY opcode"},codesize:{v:2,d:"Base fee of the CODESIZE opcode"},codecopy:{v:3,d:"Base fee of the CODECOPY opcode"},gasprice:{v:2,d:"Base fee of the GASPRICE opcode"},extcodesize:{v:20,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:20,d:"Base fee of the EXTCODECOPY opcode"},blockhash:{v:20,d:"Base fee of the BLOCKHASH opcode"},coinbase:{v:2,d:"Base fee of the COINBASE opcode"},timestamp:{v:2,d:"Base fee of the TIMESTAMP opcode"},number:{v:2,d:"Base fee of the NUMBER opcode"},difficulty:{v:2,d:"Base fee of the DIFFICULTY opcode"},gaslimit:{v:2,d:"Base fee of the GASLIMIT opcode"},pop:{v:2,d:"Base fee of the POP opcode"},mload:{v:3,d:"Base fee of the MLOAD opcode"},mstore:{v:3,d:"Base fee of the MSTORE opcode"},mstore8:{v:3,d:"Base fee of the MSTORE8 opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"},jump:{v:8,d:"Base fee of the JUMP opcode"},jumpi:{v:10,d:"Base fee of the JUMPI opcode"},pc:{v:2,d:"Base fee of the PC opcode"},msize:{v:2,d:"Base fee of the MSIZE opcode"},gas:{v:2,d:"Base fee of the GAS opcode"},push:{v:3,d:"Base fee of the PUSH opcode"},dup:{v:3,d:"Base fee of the DUP opcode"},swap:{v:3,d:"Base fee of the SWAP opcode"},callcode:{v:40,d:"Base fee of the CALLCODE opcode"},return:{v:0,d:"Base fee of the RETURN opcode"},invalid:{v:0,d:"Base fee of the INVALID opcode"},selfdestruct:{v:0,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{stackLimit:{v:1024,d:"Maximum size of VM stack allowed"},callCreateDepth:{v:1024,d:"Maximum depth of call/create stack"},maxExtraDataSize:{v:32,d:"Maximum size extra data may be after Genesis"}},pow:{minimumDifficulty:{v:131072,d:"The minimum that the difficulty may ever be"},difficultyBoundDivisor:{v:2048,d:"The bound divisor of the difficulty, used in the update calculations"},durationLimit:{v:13,d:"The decision boundary on the blocktime duration used to determine whether difficulty should go up or not"},epochDuration:{v:3e4,d:"Duration between proof-of-work epochs"},timebombPeriod:{v:1e5,d:"Exponential difficulty timebomb period"},minerReward:{v:"5000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:0,d:"the amount of blocks to delay the difficulty bomb with"}}},_he={name:"dao",comment:"DAO rescue hardfork",url:"https://eips.ethereum.org/EIPS/eip-779",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{}},$he={name:"homestead",comment:"Homestead hardfork with protocol and network changes",url:"https://eips.ethereum.org/EIPS/eip-606",status:"Final",gasConfig:{},gasPrices:{delegatecall:{v:40,d:"Base fee of the DELEGATECALL opcode"}},vm:{},pow:{}},Rhe={name:"tangerineWhistle",comment:"Hardfork with gas cost changes for IO-heavy operations",url:"https://eips.ethereum.org/EIPS/eip-608",status:"Final",gasConfig:{},gasPrices:{sload:{v:200,d:"Once per SLOAD operation"},call:{v:700,d:"Once per CALL operation & message call transaction"},extcodesize:{v:700,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:700,d:"Base fee of the EXTCODECOPY opcode"},balance:{v:400,d:"Base fee of the BALANCE opcode"},delegatecall:{v:700,d:"Base fee of the DELEGATECALL opcode"},callcode:{v:700,d:"Base fee of the CALLCODE opcode"},selfdestruct:{v:5e3,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{},pow:{}},Ohe={name:"spuriousDragon",comment:"HF with EIPs for simple replay attack protection, EXP cost increase, state trie clearing, contract code size limit",url:"https://eips.ethereum.org/EIPS/eip-607",status:"Final",gasConfig:{},gasPrices:{expByte:{v:50,d:"Times ceil(log256(exponent)) for the EXP instruction"}},vm:{maxCodeSize:{v:24576,d:"Maximum length of contract code"}},pow:{}},Phe={name:"byzantium",comment:"Hardfork with new precompiles, instructions and other protocol changes",url:"https://eips.ethereum.org/EIPS/eip-609",status:"Final",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:20,d:"Gquaddivisor from modexp precompile for gas calculation"},ecAdd:{v:500,d:"Gas costs for curve addition precompile"},ecMul:{v:4e4,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:1e5,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:8e4,d:"Gas costs regarding curve pairing precompile input length"},revert:{v:0,d:"Base fee of the REVERT opcode"},staticcall:{v:700,d:"Base fee of the STATICCALL opcode"},returndatasize:{v:2,d:"Base fee of the RETURNDATASIZE opcode"},returndatacopy:{v:3,d:"Base fee of the RETURNDATACOPY opcode"}},vm:{},pow:{minerReward:{v:"3000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:3e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Dhe={name:"constantinople",comment:"Postponed hardfork including EIP-1283 (SSTORE gas metering changes)",url:"https://eips.ethereum.org/EIPS/eip-1013",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:200,d:"Once per SSTORE operation if the value doesn't change"},netSstoreInitGas:{v:2e4,d:"Once per SSTORE operation from clean zero"},netSstoreCleanGas:{v:5e3,d:"Once per SSTORE operation from clean non-zero"},netSstoreDirtyGas:{v:200,d:"Once per SSTORE operation from dirty"},netSstoreClearRefund:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},netSstoreResetRefund:{v:4800,d:"Once per SSTORE operation for resetting to the original non-zero value"},netSstoreResetClearRefund:{v:19800,d:"Once per SSTORE operation for resetting to the original zero value"},shl:{v:3,d:"Base fee of the SHL opcode"},shr:{v:3,d:"Base fee of the SHR opcode"},sar:{v:3,d:"Base fee of the SAR opcode"},extcodehash:{v:400,d:"Base fee of the EXTCODEHASH opcode"},create2:{v:32e3,d:"Base fee of the CREATE2 opcode"}},vm:{},pow:{minerReward:{v:"2000000000000000000",d:"The amount a miner gets rewarded for mining a block"},difficultyBombDelay:{v:5e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Fhe={name:"petersburg",comment:"Aka constantinopleFix, removes EIP-1283, activate together with or after constantinople",url:"https://eips.ethereum.org/EIPS/eip-1716",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:null,d:"Removed along EIP-1283"},netSstoreInitGas:{v:null,d:"Removed along EIP-1283"},netSstoreCleanGas:{v:null,d:"Removed along EIP-1283"},netSstoreDirtyGas:{v:null,d:"Removed along EIP-1283"},netSstoreClearRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetClearRefund:{v:null,d:"Removed along EIP-1283"}},vm:{},pow:{}},Lhe={name:"istanbul",comment:"HF targeted for December 2019 following the Constantinople/Petersburg HF",url:"https://eips.ethereum.org/EIPS/eip-1679",status:"Final",gasConfig:{},gasPrices:{blake2Round:{v:1,d:"Gas cost per round for the Blake2 F precompile"},ecAdd:{v:150,d:"Gas costs for curve addition precompile"},ecMul:{v:6e3,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:45e3,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:34e3,d:"Gas costs regarding curve pairing precompile input length"},txDataNonZero:{v:16,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},sstoreSentryGasEIP2200:{v:2300,d:"Minimum gas required to be present for an SSTORE call, not consumed"},sstoreNoopGasEIP2200:{v:800,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:800,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitGasEIP2200:{v:2e4,d:"Once per SSTORE operation from clean zero to non-zero"},sstoreInitRefundEIP2200:{v:19200,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanGasEIP2200:{v:5e3,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreCleanRefundEIP2200:{v:4200,d:"Once per SSTORE operation for resetting to the original non-zero value"},sstoreClearRefundEIP2200:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},balance:{v:700,d:"Base fee of the BALANCE opcode"},extcodehash:{v:700,d:"Base fee of the EXTCODEHASH opcode"},chainid:{v:2,d:"Base fee of the CHAINID opcode"},selfbalance:{v:5,d:"Base fee of the SELFBALANCE opcode"},sload:{v:800,d:"Base fee of the SLOAD opcode"}},vm:{},pow:{}},Bhe={name:"muirGlacier",comment:"HF to delay the difficulty bomb",url:"https://eips.ethereum.org/EIPS/eip-2384",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:9e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Mhe={name:"berlin",comment:"HF targeted for July 2020 following the Muir Glacier HF",url:"https://eips.ethereum.org/EIPS/eip-2070",status:"Final",eips:[2565,2929,2718,2930]},zhe={name:"london",comment:"HF targeted for July 2021 following the Berlin fork",url:"https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/london.md",status:"Final",eips:[1559,3198,3529,3541]},Uhe={name:"shanghai",comment:"Next feature hardfork after the merge hardfork having withdrawals, warm coinbase, push0, limit/meter initcode",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/shanghai.md",status:"Final",eips:[3651,3855,3860,4895]},Vhe={name:"arrowGlacier",comment:"HF to delay the difficulty bomb",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/arrow-glacier.md",status:"Final",eips:[4345],gasConfig:{},gasPrices:{},vm:{},pow:{}},jhe={name:"grayGlacier",comment:"Delaying the difficulty bomb to Mid September 2022",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/gray-glacier.md",status:"Draft",eips:[5133],gasConfig:{},gasPrices:{},vm:{},pow:{}},Hhe={name:"mergeForkIdTransition",comment:"Pre-merge hardfork to fork off non-upgraded clients",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Draft",eips:[]},Whe={name:"merge",comment:"Hardfork to upgrade the consensus mechanism to Proof-of-Stake",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/merge.md",status:"Final",consensus:{type:"pos",algorithm:"casper",casper:{}},eips:[3675,4399]},Ghe={chainstart:Nhe,homestead:$he,dao:_he,tangerineWhistle:Rhe,spuriousDragon:Ohe,byzantium:Phe,constantinople:Dhe,petersburg:Fhe,istanbul:Lhe,muirGlacier:Bhe,berlin:Mhe,london:zhe,shanghai:Uhe,arrowGlacier:Vhe,grayGlacier:jhe,mergeForkIdTransition:Hhe,merge:Whe},{buf:qhe}=yN;let yu=class Ui extends Dde{static custom(e,n={}){var r;const s=(r=n.baseChain)!==null&&r!==void 0?r:"mainnet",i=Object.assign({},Ui._getChainParams(s));if(i.name="custom-chain",typeof e!="string")return new Ui(Object.assign({chain:Object.assign(Object.assign({},i),e)},n));if(e===as.PolygonMainnet)return Ui.custom({name:as.PolygonMainnet,chainId:137,networkId:137},n);if(e===as.PolygonMumbai)return Ui.custom({name:as.PolygonMumbai,chainId:80001,networkId:80001},n);if(e===as.ArbitrumRinkebyTestnet)return Ui.custom({name:as.ArbitrumRinkebyTestnet,chainId:421611,networkId:421611},n);if(e===as.ArbitrumOne)return Ui.custom({name:as.ArbitrumOne,chainId:42161,networkId:42161},n);if(e===as.xDaiChain)return Ui.custom({name:as.xDaiChain,chainId:100,networkId:100},n);if(e===as.OptimisticKovan)return Ui.custom({name:as.OptimisticKovan,chainId:69,networkId:69},Object.assign({hardfork:pn.Berlin},n));if(e===as.OptimisticEthereum)return Ui.custom({name:as.OptimisticEthereum,chainId:10,networkId:10},Object.assign({hardfork:pn.Berlin},n));throw new Error(`Custom chain ${e} not supported`)}static fromGethGenesis(e,{chain:n,eips:r,genesisHash:s,hardfork:i,mergeForkIdPostMerge:o}){var a;const c=Yfe(e,n,o),l=new Ui({chain:(a=c.name)!==null&&a!==void 0?a:"custom",customChains:[c],eips:r,hardfork:i??c.hardfork});return s!==void 0&&l.setForkHashes(s),l}static isSupportedChainId(e){return!!this._getInitializedChains().names[e.toString()]}static _getChainParams(e,n){let r=e;const s=this._getInitializedChains(n);if(typeof r=="number"||typeof r=="bigint"){if(r=r.toString(),s.names[r]){const i=s.names[r];return s[i]}throw new Error(`Chain with ID ${r} not supported`)}if(s[r]!==void 0)return s[r];throw new Error(`Chain with name ${r} not supported`)}constructor(e){var n,r;super(),this._eips=[],this._customChains=(n=e.customChains)!==null&&n!==void 0?n:[],this._chainParams=this.setChain(e.chain),this.DEFAULT_HARDFORK=(r=this._chainParams.defaultHardfork)!==null&&r!==void 0?r:pn.Merge,this.HARDFORK_CHANGES=this.hardforks().map(s=>[s.name,Ghe[s.name]]),this._hardfork=this.DEFAULT_HARDFORK,e.hardfork!==void 0&&this.setHardfork(e.hardfork),e.eips&&this.setEIPs(e.eips)}setChain(e){if(typeof e=="number"||typeof e=="bigint"||typeof e=="string")this._chainParams=Ui._getChainParams(e,this._customChains);else if(typeof e=="object"){if(this._customChains.length>0)throw new Error("Chain must be a string, number, or bigint when initialized with customChains passed in");const n=["networkId","genesis","hardforks","bootstrapNodes"];for(const r of n)if(!(r in e))throw new Error(`Missing required chain parameter: ${r}`);this._chainParams=e}else throw new Error("Wrong input format");for(const n of this.hardforks())if(n.block===void 0)throw new Error("Hardfork cannot have undefined block number");return this._chainParams}setHardfork(e){let n=!1;for(const r of this.HARDFORK_CHANGES)r[0]===e&&(this._hardfork!==e&&(this._hardfork=e,this.emit("hardforkChanged",e)),n=!0);if(!n)throw new Error(`Hardfork with name ${e} not supported`)}getHardforkByBlockNumber(e,n,r){const s=cf(e,Gi.BigInt),i=cf(n,Gi.BigInt),o=cf(r,Gi.Number),a=this.hardforks().filter(m=>m.block!==null||m.ttd!==null&&m.ttd!==void 0||m.timestamp!==void 0),c=a.findIndex(m=>m.ttd!==null&&m.ttd!==void 0);if(a.slice(c+1).findIndex(m=>m.ttd!==null&&m.ttd!==void 0)>=0)throw Error("More than one merge hardforks found with ttd specified");let u=a.findIndex(m=>m.block!==null&&m.block>s||o!==void 0&&Number(m.timestamp)>o);if(u===-1)u=a.length;else if(u===0)throw Error("Must have at least one hardfork at block 0");if(o===void 0){const m=a.slice(0,u).reverse().findIndex(g=>g.block!==null||g.ttd!==void 0);u-=m}if(u-=1,a[u].block===null&&a[u].timestamp===void 0)(i==null||BigInt(a[u].ttd)>i)&&(u-=1);else if(c>=0&&i!==void 0&&i!==null){if(u>=c&&BigInt(a[c].ttd)>i)throw Error("Maximum HF determined by total difficulty is lower than the block number HF");if(u<c&&BigInt(a[c].ttd)<=i)throw Error("HF determined by block number is lower than the minimum total difficulty HF")}const d=u;for(;u<a.length-1&&!(a[u].block!==a[u+1].block||a[u].timestamp!==a[u+1].timestamp);u+=1);if(o){if(a.slice(0,d).reduce((v,y)=>{var w;return Math.max(Number((w=y.timestamp)!==null&&w!==void 0?w:"0"),v)},0)>o)throw Error("Maximum HF determined by timestamp is lower than the block number/ttd HF");if(a.slice(u+1).reduce((v,y)=>{var w;return Math.min(Number((w=y.timestamp)!==null&&w!==void 0?w:o),v)},o)<o)throw Error("Maximum HF determined by block number/ttd is lower than timestamp HF")}return a[u].name}setHardforkByBlockNumber(e,n,r){const s=this.getHardforkByBlockNumber(e,n,r);return this.setHardfork(s),s}_getHardfork(e){const n=this.hardforks();for(const r of n)if(r.name===e)return r;return null}setEIPs(e=[]){for(const n of e){if(!(n in lf))throw new Error(`${n} not supported`);const r=this.gteHardfork(lf[n].minimumHardfork);if(!r)throw new Error(`${n} cannot be activated on hardfork ${this.hardfork()}, minimumHardfork: ${r}`);if(lf[n].requiredEIPs!==void 0){for(const s of lf[n].requiredEIPs)if(!(e.includes(s)||this.isActivatedEIP(s)))throw new Error(`${n} requires EIP ${s}, but is not included in the EIP list`)}}this._eips=e}param(e,n){let r;for(const s of this._eips)if(r=this.paramByEIP(e,n,s),r!==void 0)return r;return this.paramByHardfork(e,n,this._hardfork)}paramByHardfork(e,n,r){let s=null;for(const i of this.HARDFORK_CHANGES){if("eips"in i[1]){const o=i[1].eips;for(const a of o){const c=this.paramByEIP(e,n,a);s=typeof c=="bigint"?c:s}}else{if(i[1][e]===void 0)throw new Error(`Topic ${e} not defined`);i[1][e][n]!==void 0&&(s=i[1][e][n].v)}if(i[0]===r)break}return BigInt(s??0)}paramByEIP(e,n,r){if(!(r in lf))throw new Error(`${r} not supported`);const s=lf[r];if(!(e in s))throw new Error(`Topic ${e} not defined`);if(s[e][n]===void 0)return;const i=s[e][n].v;return BigInt(i)}paramByBlock(e,n,r,s,i){const o=this.getHardforkByBlockNumber(r,s,i);return this.paramByHardfork(e,n,o)}isActivatedEIP(e){if(this.eips().includes(e))return!0;for(const n of this.HARDFORK_CHANGES){const r=n[1];if(this.gteHardfork(r.name)&&"eips"in r&&r.eips.includes(e))return!0}return!1}hardforkIsActiveOnBlock(e,n){const r=cf(n,Gi.BigInt),s=e??this._hardfork,i=this.hardforkBlock(s);return typeof i=="bigint"&&i!==BigInt(0)&&r>=i}activeOnBlock(e){return this.hardforkIsActiveOnBlock(null,e)}hardforkGteHardfork(e,n){const r=e??this._hardfork,s=this.hardforks();let i=-1,o=-1,a=0;for(const c of s)c.name===r&&(i=a),c.name===n&&(o=a),a+=1;return i>=o&&o!==-1}gteHardfork(e){return this.hardforkGteHardfork(null,e)}hardforkBlock(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.block;return s==null?null:BigInt(s)}hardforkTimestamp(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.timestamp;return s==null?null:BigInt(s)}eipBlock(e){for(const n of this.HARDFORK_CHANGES){const r=n[1];if("eips"in r&&r.eips.includes(e))return this.hardforkBlock(typeof n[0]=="number"?String(n[0]):n[0])}return null}hardforkTTD(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.ttd;return s==null?null:BigInt(s)}isHardforkBlock(e,n){const r=cf(e,Gi.BigInt),s=n??this._hardfork,i=this.hardforkBlock(s);return typeof i=="bigint"&&i!==BigInt(0)?i===r:!1}nextHardforkBlockOrTimestamp(e){var n,r,s;const i=(n=e)!==null&&n!==void 0?n:this._hardfork,o=this.hardforks();let a=o.findIndex(d=>d.name===i);if(i===pn.Merge&&(a-=1),a<0)return null;let c=(r=o[a].timestamp)!==null&&r!==void 0?r:o[a].block;c=c!=null?Number(c):null;const l=o.slice(a+1).find(d=>{var h;let m=(h=d.timestamp)!==null&&h!==void 0?h:d.block;return m=m!=null?Number(m):null,d.name!==pn.Merge&&m!==null&&m!==void 0&&m!==c});if(l===void 0)return null;const u=(s=l.timestamp)!==null&&s!==void 0?s:l.block;return u==null?null:BigInt(u)}nextHardforkBlock(e){var n;const r=(n=e)!==null&&n!==void 0?n:this._hardfork;let s=this.hardforkBlock(r);if(s===null&&r===pn.Merge){const o=this.hardforks(),a=o.findIndex(c=>c.ttd!==null&&c.ttd!==void 0);if(a<0)throw Error("Merge hardfork should have been found");s=this.hardforkBlock(o[a-1].name)}return s===null?null:this.hardforks().reduce((o,a)=>{const c=BigInt(a.block===null||a.ttd!==void 0&&a.ttd!==null?0:a.block);return c>s&&o===null?c:o},null)}isNextHardforkBlock(e,n){const r=cf(e,Gi.BigInt),s=n??this._hardfork,i=this.nextHardforkBlock(s);return i===null?!1:i===r}_calcForkHash(e,n){let r=new Uint8Array,s=0;for(const a of this.hardforks()){const{block:c,timestamp:l,name:u}=a;let d=l??c;if(d=d!==null?Number(d):null,typeof d=="number"&&d!==0&&d!==s&&u!==pn.Merge){const h=$o(d.toString(16).padStart(16,"0"));r=Qu(r,h),s=d}if(a.name===e)break}const i=Qu(n,r);return On(Zfe(qhe(i)>>>0))}forkHash(e,n){const r=e??this._hardfork,s=this._getHardfork(r);if(s===null||s?.block===null&&s?.timestamp===void 0&&s?.ttd===void 0){const i="No fork hash calculation possible for future hardfork";throw new Error(i)}if(s?.forkHash!==null&&s?.forkHash!==void 0)return s.forkHash;if(!n)throw new Error("genesisHash required for forkHash calculation");return this._calcForkHash(r,n)}hardforkForForkHash(e){const n=this.hardforks().filter(r=>r.forkHash===e);return n.length>=1?n[n.length-1]:null}setForkHashes(e){var n;for(const r of this.hardforks()){const s=(n=r.timestamp)!==null&&n!==void 0?n:r.block;(r.forkHash===null||r.forkHash===void 0)&&(s!=null||typeof r.ttd<"u")&&(r.forkHash=this.forkHash(r.name,e))}}genesis(){return this._chainParams.genesis}hardforks(){return this._chainParams.hardforks}bootstrapNodes(){return this._chainParams.bootstrapNodes}dnsNetworks(){return this._chainParams.dnsNetworks}hardfork(){return this._hardfork}chainId(){return BigInt(this._chainParams.chainId)}chainName(){return this._chainParams.name}networkId(){return BigInt(this._chainParams.networkId)}eips(){return this._eips}consensusType(){const e=this.hardfork();let n;for(const r of this.HARDFORK_CHANGES)if("consensus"in r[1]&&(n=r[1].consensus.type),r[0]===e)break;return n??this._chainParams.consensus.type}consensusAlgorithm(){const e=this.hardfork();let n;for(const r of this.HARDFORK_CHANGES)if("consensus"in r[1]&&(n=r[1].consensus.algorithm),r[0]===e)break;return n??this._chainParams.consensus.algorithm}consensusConfig(){var e;const n=this.hardfork();let r;for(const s of this.HARDFORK_CHANGES)if("consensus"in s[1]&&(r=s[1].consensus[s[1].consensus.algorithm]),s[0]===n)break;return(e=r??this._chainParams.consensus[this.consensusAlgorithm()])!==null&&e!==void 0?e:{}}copy(){const e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.removeAllListeners(),e}static _getInitializedChains(e){const n={};for(const[s,i]of Object.entries(Ow))n[i]=s.toLowerCase();const r={mainnet:ihe,goerli:she,sepolia:ohe};if(e)for(const s of e){const{name:i}=s;n[s.chainId.toString()]=i,r[i]=s}return r.names=n,r}};var la;(function(t){t[t.EIP155ReplayProtection=155]="EIP155ReplayProtection",t[t.EIP1559FeeMarket=1559]="EIP1559FeeMarket",t[t.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",t[t.EIP2930AccessLists=2930]="EIP2930AccessLists"})(la||(la={}));function Khe(t){if(t.length===0)return!0;const e=t[0];return!!Array.isArray(e)}function Xhe(t){return!Khe(t)}let i2=class VC{constructor(e){if(e.length!==20)throw new Error("Invalid address length");this.buf=e}static zero(){return new VC(Kj(20))}equals(e){return vN(this.buf,e.buf)}isZero(){return this.equals(VC.zero())}toString(){return On(this.buf)}toArray(){return this.buf}static publicToAddress(e,n=!1){let r=e;if(kN(r),n&&r.length!==64&&(r=o0.ProjectivePoint.fromHex(r).toRawBytes(!1).slice(1)),r.length!==64)throw new Error("Expected pubKey to be of length 64");return yi(r).slice(-20)}};const Qhe=(t,e)=>{const n=t.param("vm","maxInitCodeSize");if(n&&BigInt(e)>n)throw new Error(`the initcode size of this transaction is too large: it is ${e} while the max is ${t.param("vm","maxInitCodeSize")}`)},Xj=t=>{let e,n;if(Xhe(t)){e=t;const r=[];for(let s=0;s<t.length;s+=1){const i=t[s],o=kn(i.address),a=[];for(let c=0;c<i.storageKeys.length;c+=1)a.push(kn(i.storageKeys[c]));r.push([o,a])}n=r}else{n=t??[];const r=[];for(let s=0;s<n.length;s+=1){const i=n[s],o=On(i[0]),a=[];for(let l=0;l<i[1].length;l+=1)a.push(On(i[1][l]));const c={address:o,storageKeys:a};r.push(c)}e=r}return{AccessListJSON:e,accessList:n}},Qj=t=>{for(let e=0;e<t.length;e+=1){const n=t[e],r=n[0],s=n[1];if(n[2]!==void 0)throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(r.length!==20)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(let i=0;i<s.length;i+=1)if(s[i].length!==32)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}},Yj=t=>{const e=[];for(let n=0;n<t.length;n+=1){const r=t[n],s={address:On(HL(r[0],20)),storageKeys:[]},i=r&&r[1];for(let o=0;o<i.length;o+=1){const a=i[o];s.storageKeys.push(On(HL(a,32)))}e.push(s)}return e},Zj=(t,e)=>{const n=e.param("gasPrices","accessListStorageKeyCost"),r=e.param("gasPrices","accessListAddressCost");let s=0;for(let o=0;o<t.length;o+=1){const c=t[o][1];s+=c.length}return t.length*Number(r)+s*Number(n)};let lh=class{constructor(e,n){var r,s;this.cache={hash:void 0,dataFee:void 0},this.activeCapabilities=[],this.DEFAULT_CHAIN=Ow.Mainnet,this.DEFAULT_HARDFORK=pn.Merge;const{nonce:i,gasLimit:o,to:a,value:c,data:l,v:u,r:d,s:h,type:m}=e;this._type=Number(un(kn(m))),this.txOptions=n;const g=kn(a===""?"0x":a),v=kn(u===""?"0x":u),y=kn(d===""?"0x":d),w=kn(h===""?"0x":h);this.nonce=un(kn(i===""?"0x":i)),this.gasLimit=un(kn(o===""?"0x":o)),this.to=g.length>0?new i2(g):void 0,this.value=un(kn(c===""?"0x":c)),this.data=kn(l===""?"0x":l),this.v=v.length>0?un(v):void 0,this.r=y.length>0?un(y):void 0,this.s=w.length>0?un(w):void 0,this._validateCannotExceedMaxInteger({value:this.value,r:this.r,s:this.s}),this._validateCannotExceedMaxInteger({gasLimit:this.gasLimit},64),this._validateCannotExceedMaxInteger({nonce:this.nonce},64,!0);const x=this.to===void 0||this.to===null,S=(r=n.allowUnlimitedInitCodeSize)!==null&&r!==void 0?r:!1,k=(s=n.common)!==null&&s!==void 0?s:this._getCommon();x&&k.isActivatedEIP(3860)&&!S&&Qhe(k,this.data.length)}get type(){return this._type}supports(e){return this.activeCapabilities.includes(e)}validate(e=!1){const n=[];return this.getBaseFee()>this.gasLimit&&n.push(`gasLimit is too low. given ${this.gasLimit}, need at least ${this.getBaseFee()}`),this.isSigned()&&!this.verifySignature()&&n.push("Invalid Signature"),e?n:n.length===0}_validateYParity(){const{v:e}=this;if(e!==void 0&&e!==BigInt(0)&&e!==BigInt(1)){const n=this._errorMsg("The y-parity of the transaction should either be 0 or 1");throw new Error(n)}}_validateHighS(){const{s:e}=this;if(this.common.gteHardfork("homestead")&&e!==void 0&&e>Kfe){const n=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");throw new Error(n)}}getBaseFee(){const e=this.common.param("gasPrices","tx");let n=this.getDataFee();if(e&&(n+=e),this.common.gteHardfork("homestead")&&this.toCreationAddress()){const r=this.common.param("gasPrices","txCreation");r&&(n+=r)}return n}getDataFee(){const e=this.common.param("gasPrices","txDataZero"),n=this.common.param("gasPrices","txDataNonZero");let r=BigInt(0);for(let s=0;s<this.data.length;s+=1)this.data[s]===0?r+=e:r+=n;if((this.to===void 0||this.to===null)&&this.common.isActivatedEIP(3860)){const s=BigInt(Math.ceil(this.data.length/32)),i=this.common.param("gasPrices","initCodeWordCost")*s;r+=i}return r}toCreationAddress(){return this.to===void 0||this.to.buf.length===0}isSigned(){const{v:e,r:n,s:r}=this;return!(e===void 0||n===void 0||r===void 0)}verifySignature(){try{const e=this.getSenderPublicKey();return Pw(e).length!==0}catch{return!1}}getSenderAddress(){return new i2(i2.publicToAddress(this.getSenderPublicKey()))}sign(e){if(e.length!==32){const c=this._errorMsg("Private key must be 32 bytes in length.");throw new Error(c)}let n=!1;this.type===0&&this.common.gteHardfork("spuriousDragon")&&!this.supports(la.EIP155ReplayProtection)&&(this.activeCapabilities.push(la.EIP155ReplayProtection),n=!0);const r=this.getMessageToSign(!0),{v:s,r:i,s:o}=this._ecsign(r,e),a=this._processSignature(s,i,o);if(n){const c=this.activeCapabilities.indexOf(la.EIP155ReplayProtection);c>-1&&this.activeCapabilities.splice(c,1)}return a}_getCommon(e,n){var r,s,i,o;if(n!==void 0){const a=un(kn(n));if(e){if(e.chainId()!==a){const c=this._errorMsg("The chain ID does not match the chain ID of Common");throw new Error(c)}return e.copy()}return yu.isSupportedChainId(a)?new yu({chain:a,hardfork:this.DEFAULT_HARDFORK}):yu.custom({name:"custom-chain",networkId:a,chainId:a},{baseChain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}if(e?.copy&&typeof e?.copy=="function")return e.copy();if(e){const a=typeof e.hardfork=="function"?e.hardfork():e.hardfork;return yu.custom({name:"custom-chain",networkId:e.networkId?e.networkId():(s=BigInt((r=e.customChain)===null||r===void 0?void 0:r.networkId))!==null&&s!==void 0?s:void 0,chainId:e.chainId?e.chainId():(o=BigInt((i=e.customChain)===null||i===void 0?void 0:i.chainId))!==null&&o!==void 0?o:void 0},{baseChain:this.DEFAULT_CHAIN,hardfork:a||this.DEFAULT_HARDFORK})}return new yu({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}_validateCannotExceedMaxInteger(e,n=256,r=!1){for(const[s,i]of Object.entries(e))switch(n){case 64:if(r){if(i!==void 0&&i>=UL){const o=this._errorMsg(`${s} cannot equal or exceed MAX_UINT64 (2^64-1), given ${i}`);throw new Error(o)}}else if(i!==void 0&&i>UL){const o=this._errorMsg(`${s} cannot exceed MAX_UINT64 (2^64-1), given ${i}`);throw new Error(o)}break;case 256:if(r){if(i!==void 0&&i>=mg){const o=this._errorMsg(`${s} cannot equal or exceed MAX_INTEGER (2^256-1), given ${i}`);throw new Error(o)}}else if(i!==void 0&&i>mg){const o=this._errorMsg(`${s} cannot exceed MAX_INTEGER (2^256-1), given ${i}`);throw new Error(o)}break;default:{const o=this._errorMsg("unimplemented bits value");throw new Error(o)}}}static _validateNotArray(e){const n=["nonce","gasPrice","gasLimit","to","value","data","v","r","s","type","baseFee","maxFeePerGas","chainId"];for(const[r,s]of Object.entries(e))if(n.includes(r)&&Array.isArray(s))throw new Error(`${r} cannot be an array`)}_getSharedErrorPostfix(){let e="";try{e=this.isSigned()?On(this.hash()):"not available (unsigned)"}catch{e="error"}let n="";try{n=this.isSigned().toString()}catch{e="error"}let r="";try{r=this.common.hardfork()}catch{r="error"}let s=`tx type=${this.type} hash=${e} nonce=${this.nonce} value=${this.value} `;return s+=`signed=${n} hf=${r}`,s}_ecsign(e,n,r){const s=o0.sign(e,n),i=s.toCompactRawBytes(),o=i.subarray(0,32),a=i.subarray(32,64),c=r===void 0?BigInt(s.recovery+27):BigInt(s.recovery+35)+BigInt(r)*BigInt(2);return{r:o,s:a,v:c}}static fromSerializedTx(e,n={}){}static fromTxData(e,n={}){}};const jC=2,o2=$o(jC.toString(16).padStart(2,"0"));let WL=class vm extends lh{static fromTxData(e,n={}){return new vm(e,n)}static fromSerializedTx(e,n={}){if(!vN(e.subarray(0,1),o2))throw new Error(`Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: ${jC}, received: ${On(e.subarray(0,1))}`);const r=Nn.RLP.decode(e.subarray(1));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return vm.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==9&&e.length!==12)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");const[r,s,i,o,a,c,l,u,d,h,m,g]=e;return this._validateNotArray({chainId:r,v:h}),Fh({nonce:s,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:a,value:l,v:h,r:m,s:g}),new vm({chainId:un(r),nonce:s,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:a,to:c,value:l,data:u,accessList:d??[],v:h!==void 0?un(h):void 0,r:m,s:g},n)}constructor(e,n={}){var r;super(Object.assign(Object.assign({},e),{type:jC}),n),this.DEFAULT_HARDFORK="london";const{chainId:s,accessList:i,maxFeePerGas:o,maxPriorityFeePerGas:a}=e;if(this.common=this._getCommon(n.common,s),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([1559,2718,2930]);const c=Xj(i??[]);if(this.accessList=c.accessList,this.AccessListJSON=c.AccessListJSON,Qj(this.accessList),this.maxFeePerGas=un(kn(o===""?"0x":o)),this.maxPriorityFeePerGas=un(kn(a===""?"0x":a)),this._validateCannotExceedMaxInteger({maxFeePerGas:this.maxFeePerGas,maxPriorityFeePerGas:this.maxPriorityFeePerGas}),lh._validateNotArray(e),this.gasLimit*this.maxFeePerGas>mg){const u=this._errorMsg("gasLimit * maxFeePerGas cannot exceed MAX_INTEGER (2^256-1)");throw new Error(u)}if(this.maxFeePerGas<this.maxPriorityFeePerGas){const u=this._errorMsg("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");throw new Error(u)}this._validateYParity(),this._validateHighS(),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(Zj(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(e=BigInt(0)){const n=this.maxPriorityFeePerGas,r=this.maxFeePerGas-e,i=(n<r?n:r)+e;return this.gasLimit*i+this.value}raw(){return[Ut(this.chainId),Ut(this.nonce),Ut(this.maxPriorityFeePerGas),Ut(this.maxFeePerGas),Ut(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Ut(this.value),this.data,this.accessList,this.v!==void 0?Ut(this.v):Uint8Array.from([]),this.r!==void 0?Ut(this.r):Uint8Array.from([]),this.s!==void 0?Ut(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return Qu(o2,Nn.RLP.encode(e))}getMessageToSign(e=!0){const n=this.raw().slice(0,9),r=Qu(o2,Nn.RLP.encode(n));return e?yi(r):r}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=yi(this.serialize())),this.cache.hash):yi(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const i=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(i)}const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return EN(e,n+BigInt(27),Ut(r),Ut(s))}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){const s=Object.assign(Object.assign({},this.txOptions),{common:this.common});return vm.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:un(n),s:un(r)},s)}toJSON(){const e=Yj(this.accessList);return{chainId:Tn(this.chainId),nonce:Tn(this.nonce),maxPriorityFeePerGas:Tn(this.maxPriorityFeePerGas),maxFeePerGas:Tn(this.maxFeePerGas),gasLimit:Tn(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:Tn(this.value),data:On(this.data),accessList:e,v:this.v!==void 0?Tn(this.v):void 0,r:this.r!==void 0?Tn(this.r):void 0,s:this.s!==void 0?Tn(this.s):void 0}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` maxFeePerGas=${this.maxFeePerGas} maxPriorityFeePerGas=${this.maxPriorityFeePerGas}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}};const HC=1,a2=$o(HC.toString(16).padStart(2,"0"));let GL=class bm extends lh{static fromTxData(e,n={}){return new bm(e,n)}static fromSerializedTx(e,n={}){if(!vN(e.subarray(0,1),a2))throw new Error(`Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: ${HC}, received: ${On(e.subarray(0,1))}`);const r=Nn.RLP.decode(Uint8Array.from(e.subarray(1)));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return bm.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==8&&e.length!==11)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");const[r,s,i,o,a,c,l,u,d,h,m]=e;this._validateNotArray({chainId:r,v:d}),Fh({nonce:s,gasPrice:i,gasLimit:o,value:c,v:d,r:h,s:m});const g=[];return new bm({chainId:un(r),nonce:s,gasPrice:i,gasLimit:o,to:a,value:c,data:l,accessList:u??g,v:d!==void 0?un(d):void 0,r:h,s:m},n)}constructor(e,n={}){var r;super(Object.assign(Object.assign({},e),{type:HC}),n),this.DEFAULT_HARDFORK="berlin";const{chainId:s,accessList:i,gasPrice:o}=e;if(this.common=this._getCommon(n.common,s),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([2718,2930]);const a=Xj(i??[]);if(this.accessList=a.accessList,this.AccessListJSON=a.AccessListJSON,Qj(this.accessList),this.gasPrice=un(kn(o===""?"0x":o)),this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),lh._validateNotArray(e),this.gasPrice*this.gasLimit>mg){const l=this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER");throw new Error(l)}this._validateYParity(),this._validateHighS(),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(Zj(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}raw(){return[Ut(this.chainId),Ut(this.nonce),Ut(this.gasPrice),Ut(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Ut(this.value),this.data,this.accessList,this.v!==void 0?Ut(this.v):Uint8Array.from([]),this.r!==void 0?Ut(this.r):Uint8Array.from([]),this.s!==void 0?Ut(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return Qu(a2,Nn.RLP.encode(e))}getMessageToSign(e=!0){const n=this.raw().slice(0,8),r=Qu(a2,Nn.RLP.encode(n));return e?yi(r):r}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=yi(this.serialize())),this.cache.hash):yi(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const i=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(i)}const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return EN(e,n+BigInt(27),Ut(r),Ut(s))}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){const s=Object.assign(Object.assign({},this.txOptions),{common:this.common});return bm.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:un(n),s:un(r)},s)}toJSON(){const e=Yj(this.accessList);return{chainId:Tn(this.chainId),nonce:Tn(this.nonce),gasPrice:Tn(this.gasPrice),gasLimit:Tn(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:Tn(this.value),data:On(this.data),accessList:e,v:this.v!==void 0?Tn(this.v):void 0,r:this.r!==void 0?Tn(this.r):void 0,s:this.s!==void 0?Tn(this.s):void 0}}errorStr(){var e,n;let r=this._getSharedErrorPostfix();return r+=` gasPrice=${this.gasPrice} accessListCount=${(n=(e=this.accessList)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}`,r}_errorMsg(e){return`${e} (${this.errorStr()})`}};const Yhe=0;function qL(t,e){const n=Number(t),r=Number(e)*2;return n===r+35||n===r+36}let eb=class Pb extends lh{static fromTxData(e,n={}){return new Pb(e,n)}static fromSerializedTx(e,n={}){const r=Nn.RLP.decode(e);if(!Array.isArray(r))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==6&&e.length!==9)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");const[r,s,i,o,a,c,l,u,d]=e;return Fh({nonce:r,gasPrice:s,gasLimit:i,value:a,v:l,r:u,s:d}),new Pb({nonce:r,gasPrice:s,gasLimit:i,to:o,value:a,data:c,v:l,r:u,s:d},n)}constructor(e,n={}){var r;if(super(Object.assign(Object.assign({},e),{type:Yhe}),n),this.common=this._validateTxV(this.v,n.common),this.gasPrice=un(kn(e.gasPrice===""?"0x":e.gasPrice)),this.gasPrice*this.gasLimit>mg){const i=this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)");throw new Error(i)}this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),lh._validateNotArray(e),this.common.gteHardfork("spuriousDragon")&&(this.isSigned()?qL(this.v,this.common.chainId())&&this.activeCapabilities.push(la.EIP155ReplayProtection):this.activeCapabilities.push(la.EIP155ReplayProtection)),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}raw(){return[Ut(this.nonce),Ut(this.gasPrice),Ut(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Ut(this.value),this.data,this.v!==void 0?Ut(this.v):Uint8Array.from([]),this.r!==void 0?Ut(this.r):Uint8Array.from([]),this.s!==void 0?Ut(this.s):Uint8Array.from([])]}serialize(){return Nn.RLP.encode(this.raw())}_getMessageToSign(){const e=[Ut(this.nonce),Ut(this.gasPrice),Ut(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Ut(this.value),this.data];return this.supports(la.EIP155ReplayProtection)&&(e.push(kn(this.common.chainId())),e.push(Pw(kn(0))),e.push(Pw(kn(0)))),e}getMessageToSign(e=!0){const n=this._getMessageToSign();return e?yi(Nn.RLP.encode(n)):n}getDataFee(){return this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork()?this.cache.dataFee.value:(Object.isFrozen(this)&&(this.cache.dataFee={value:super.getDataFee(),hardfork:this.common.hardfork()}),super.getDataFee())}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=yi(Nn.RLP.encode(this.raw()))),this.cache.hash):yi(Nn.RLP.encode(this.raw()))}getMessageToVerifySignature(){if(!this.isSigned()){const n=this._errorMsg("This transaction is not signed");throw new Error(n)}const e=this._getMessageToSign();return yi(Nn.RLP.encode(e))}getSenderPublicKey(){const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return EN(e,n,Ut(r),Ut(s),this.supports(la.EIP155ReplayProtection)?this.common.chainId():void 0)}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){let s=e;this.supports(la.EIP155ReplayProtection)&&(s+=this.common.chainId()*BigInt(2)+BigInt(8));const i=Object.assign(Object.assign({},this.txOptions),{common:this.common});return Pb.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:s,r:un(n),s:un(r)},i)}toJSON(){return{nonce:Tn(this.nonce),gasPrice:Tn(this.gasPrice),gasLimit:Tn(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:Tn(this.value),data:On(this.data),v:this.v!==void 0?Tn(this.v):void 0,r:this.r!==void 0?Tn(this.r):void 0,s:this.s!==void 0?Tn(this.s):void 0}}_validateTxV(e,n){let r;const s=e!==void 0?Number(e):void 0;if(s!==void 0&&s<37&&s!==27&&s!==28)throw new Error(`Legacy txs need either v = 27/28 or v >= 37 (EIP-155 replay protection), got v = ${s}`);if(s!==void 0&&s!==0&&(!n||n.gteHardfork("spuriousDragon"))&&s!==27&&s!==28)if(n){if(!qL(BigInt(s),n.chainId()))throw new Error(`Incompatible EIP155-based V ${s} and chain id ${n.chainId()}. See the Common parameter of the Transaction constructor to set the chain id.`)}else{let i;(s-35)%2===0?i=35:i=36,r=BigInt(s-i)/BigInt(2)}return this._getCommon(n,r)}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}};const c2=new Map;let CN=class WC{constructor(){}static typeToInt(e){return Number(un(kn(e)))}static registerTransactionType(e,n){const r=WC.typeToInt(e);c2.set(r,n)}static fromTxData(e,n={}){if(!("type"in e)||e.type===void 0)return eb.fromTxData(e,n);const r=WC.typeToInt(e.type);if(r===0)return eb.fromTxData(e,n);if(r===1)return GL.fromTxData(e,n);if(r===2)return WL.fromTxData(e,n);const s=c2.get(r);if(s?.fromTxData)return s.fromTxData(e,n);throw new Error(`Tx instantiation with type ${r} not supported`)}static fromSerializedData(e,n={}){if(e[0]<=127)switch(e[0]){case 1:return GL.fromSerializedTx(e,n);case 2:return WL.fromSerializedTx(e,n);default:{const r=c2.get(Number(e[0]));if(r?.fromSerializedTx)return r.fromSerializedTx(e,n);throw new Error(`TypedTransaction with ID ${e[0]} unknown`)}}else return eb.fromSerializedTx(e,n)}static fromBlockBodyData(e,n={}){if(Mh(e))return this.fromSerializedData(e,n);if(Array.isArray(e))return eb.fromValuesArray(e,n);throw new Error("Cannot decode transaction: unknown type input")}};const Zhe=(t,e)=>{let n;if(typeof t=="string"&&pt(t)&&t.length!==66)throw new bw;try{n=Mh(t)?t:wl(t)}catch{throw new hV}if(n.byteLength!==32)throw new bw;return n},Jhe=t=>{const e=Zhe(t),n=o0.getPublicKey(e,!1),s=zj(n.slice(1)).slice(-40);return bN(`0x${s}`)},KL={type:"object",properties:{accessList:{type:"null"},maxFeePerGas:{type:"null"},maxPriorityFeePerGas:{type:"null"}}},XL={type:"object",properties:{maxFeePerGas:{type:"null"},maxPriorityFeePerGas:{type:"null"}}},QL={type:"object",properties:{gasPrice:{type:"null"}}},tb=(t,e,n)=>{try{Me.validateJSONSchema(t,e)}catch(r){throw r instanceof sh?new Eoe(r.errors,n):r}},epe=t=>{var e,n;const r=t;if(!oe(r.type)){let i;switch(r.type){case"0x0":i=KL;break;case"0x1":i=XL;break;case"0x2":i=QL;break;default:return Re({format:"uint"},r.type,vt)}return tb(i,r,r.type),Re({format:"uint"},r.type,vt)}if(!oe(r.maxFeePerGas)||!oe(r.maxPriorityFeePerGas))return tb(QL,r,"0x2"),"0x2";if(!oe(r.accessList))return tb(XL,r,"0x1"),"0x1";const s=(e=r.hardfork)!==null&&e!==void 0?e:(n=r.common)===null||n===void 0?void 0:n.hardfork;if(!oe(s)){const i=Object.keys(Rm).indexOf(s);if(i>=Object.keys(Rm).indexOf("london"))return oe(r.gasPrice)?"0x2":"0x0";if(i===Object.keys(Rm).indexOf("berlin"))return"0x0"}if(!oe(r.gasPrice))return tb(KL,r,"0x0"),"0x0"},tpe=(t,e)=>{var n;return((n=e?.transactionTypeParser)!==null&&n!==void 0?n:epe)(t)},npe=t=>t[0]>127?"0x0":UC(t[0]),rpe={type:"object",properties:{address:{format:"address"},storageKeys:{type:"array",items:{format:"bytes32"}}}},TN={type:"array",items:Object.assign({},rpe)},spe={type:"object",properties:{accessList:Object.assign({},TN),gasUsed:{type:"string"}}},YL={type:"string",enum:["goerli","kovan","mainnet","rinkeby","ropsten","sepolia"]},ZL={type:"string",enum:["arrowGlacier","berlin","byzantium","chainstart","constantinople","dao","homestead","istanbul","london","merge","muirGlacier","petersburg","shanghai","spuriousDragon","tangerineWhistle"]},ipe={type:"object",properties:{name:{format:"string"},networkId:{format:"uint"},chainId:{format:"uint"}}},Jj={type:"object",properties:{from:{format:"address"},to:{oneOf:[{format:"address"},{type:"null"}]},value:{format:"uint"},gas:{format:"uint"},gasPrice:{format:"uint"},effectiveGasPrice:{format:"uint"},type:{format:"uint"},maxFeePerGas:{format:"uint"},maxPriorityFeePerGas:{format:"uint"},accessList:Object.assign({},TN),data:{format:"bytes"},input:{format:"bytes"},nonce:{format:"uint"},chain:Object.assign({},YL),hardfork:Object.assign({},ZL),chainId:{format:"uint"},networkId:{format:"uint"},common:{type:"object",properties:{customChain:Object.assign({},ipe),baseChain:Object.assign({},YL),hardfork:Object.assign({},ZL)}},gasLimit:{format:"uint"},v:{format:"uint"},r:{format:"bytes32"},s:{format:"bytes32"}}},GC={type:"object",properties:Object.assign(Object.assign({},Jj.properties),{blockHash:{format:"bytes32"},blockNumber:{format:"uint"},hash:{format:"bytes32"},transactionIndex:{format:"uint"},from:{format:"address"},to:{oneOf:[{format:"address"},{type:"null"}]},value:{format:"uint"},gas:{format:"uint"},gasPrice:{format:"uint"},effectiveGasPrice:{format:"uint"},type:{format:"uint"},maxFeePerGas:{format:"uint"},maxPriorityFeePerGas:{format:"uint"},accessList:Object.assign({},TN),data:{format:"bytes"},input:{format:"bytes"},nonce:{format:"uint"},gasLimit:{format:"uint"},v:{format:"uint"},r:{format:"bytes32"},s:{format:"bytes32"}})},e6={type:"object",properties:{index:{format:"uint"},validatorIndex:{format:"uint"},address:{format:"address"},amount:{format:"uint"}}},Dw={type:"object",properties:{baseFeePerGas:{format:"uint"},blobGasUsed:{format:"uint"},difficulty:{format:"uint"},excessBlobGas:{format:"uint"},extraData:{format:"bytes"},gasLimit:{format:"uint"},gasUsed:{format:"uint"},hash:{format:"bytes32"},logsBloom:{format:"bytes256"},miner:{format:"bytes"},mixHash:{format:"bytes32"},nonce:{format:"uint"},number:{format:"uint"},parentBeaconBlockRoot:{format:"bytes32"},parentHash:{format:"bytes32"},receiptsRoot:{format:"bytes32"},sha3Uncles:{format:"bytes32"},size:{format:"uint"},stateRoot:{format:"bytes32"},timestamp:{format:"uint"},totalDifficulty:{format:"uint"},transactions:{oneOf:[{type:"array",items:Object.assign({},GC)},{type:"array",items:{format:"bytes32"}}]},transactionsRoot:{format:"bytes32"},uncles:{type:"array",items:{format:"bytes32"}},withdrawals:{type:"array",items:Object.assign({},e6)},withdrawalsRoot:{format:"bytes32"}}},ope={type:"object",properties:{author:{format:"bytes32"},excessDataGas:{format:"uint"},baseFeePerGas:{format:"uint"},blobGasUsed:{format:"uint"},difficulty:{format:"uint"},excessBlobGas:{format:"uint"},extraData:{format:"bytes"},gasLimit:{format:"uint"},gasUsed:{format:"uint"},hash:{format:"bytes32"},logsBloom:{format:"bytes256"},miner:{format:"bytes"},mixHash:{format:"bytes32"},nonce:{format:"uint"},number:{format:"uint"},parentBeaconBlockRoot:{format:"bytes32"},parentHash:{format:"bytes32"},receiptsRoot:{format:"bytes32"},sha3Uncles:{format:"bytes32"},size:{format:"uint"},stateRoot:{format:"bytes32"},timestamp:{format:"uint"},totalDifficulty:{format:"uint"},transactions:{type:"array",items:{format:"bytes32"}},transactionsRoot:{format:"bytes32"},uncles:{type:"array",items:{format:"bytes32"}},withdrawals:{type:"array",items:Object.assign({},e6)},withdrawalsRoot:{format:"bytes32"}}},zh={type:"object",properties:{removed:{format:"bool"},logIndex:{format:"uint"},transactionIndex:{format:"uint"},transactionHash:{format:"bytes32"},blockHash:{format:"bytes32"},blockNumber:{format:"uint"},address:{format:"address"},data:{format:"bytes"},topics:{type:"array",items:{format:"bytes32"}}}},ape={type:"object",properties:{startingBlock:{format:"string"},currentBlock:{format:"string"},highestBlock:{format:"string"},knownStates:{format:"string"},pulledStates:{format:"string"}}},Uh={type:"object",properties:{transactionHash:{format:"bytes32"},transactionIndex:{format:"uint"},blockHash:{format:"bytes32"},blockNumber:{format:"uint"},from:{format:"address"},to:{format:"address"},cumulativeGasUsed:{format:"uint"},gasUsed:{format:"uint"},effectiveGasPrice:{format:"uint"},contractAddress:{format:"address"},logs:{type:"array",items:Object.assign({},zh)},logsBloom:{format:"bytes"},root:{format:"bytes"},status:{format:"uint"},type:{format:"uint"}}},cpe={type:"object",properties:{messageHash:{format:"bytes"},r:{format:"bytes32"},s:{format:"bytes32"},v:{format:"bytes"},message:{format:"bytes"},signature:{format:"bytes"}}},lpe={type:"object",properties:{oldestBlock:{format:"uint"},baseFeePerGas:{type:"array",items:{format:"uint"}},reward:{type:"array",items:{type:"array",items:{format:"uint"}}},gasUsedRatio:{type:"array",items:{type:"number"}}}},upe={type:"object",properties:{key:{format:"bytes32"},value:{format:"uint"},proof:{type:"array",items:{format:"bytes32"}}}},dpe={type:"object",properties:{balance:{format:"uint"},codeHash:{format:"bytes32"},nonce:{format:"uint"},storageHash:{format:"bytes32"},accountProof:{type:"array",items:{format:"bytes32"}},storageProof:{type:"array",items:Object.assign({},upe)}}};function ti(t,e=Fr,n={transactionSchema:GC,fillInputAndData:!1}){var r,s;let i=wN({},t);if(oe(t?.common)||(i.common=Object.assign({},t.common),oe((r=t.common)===null||r===void 0?void 0:r.customChain)||(i.common.customChain=Object.assign({},t.common.customChain))),i=Re((s=n.transactionSchema)!==null&&s!==void 0?s:GC,i,e),!oe(i.data)&&!oe(i.input)&&UC(i.data)!==UC(i.input))throw new IV({data:On(i.data),input:On(i.input)});return n.fillInputAndData&&(oe(i.data)?oe(i.input)||(i.data=i.input):i.input=i.data),oe(i.gasLimit)||(i.gas=i.gasLimit,delete i.gasLimit),i}function fpe(t,e,n={fillInputAndData:!1}){return{raw:Re({format:"bytes"},t,e),tx:ti(Object.assign(Object.assign({},CN.fromSerializedData($o(t)).toJSON()),{hash:On(Mj($o(t))),type:npe($o(t))}),e,{fillInputAndData:n.fillInputAndData,transactionSchema:n.transactionSchema})}}function t6(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}function hpe(...t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const qC=t=>{if(Me.validate(["bytes"],[t]),t6(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:ppe}=Ai,mpe=t=>ppe(qC(t)),gpe=(t,e)=>{typeof t!="bigint"&&Me.validate(["int"],[t]);let n=Dl(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},nb=t=>{if(typeof t=="number")return BigInt(t);if(typeof t=="bigint")return t;if(typeof t=="string"&&zo(t))return t.startsWith("-")?-BigInt(t.substring(1)):BigInt(t);throw new Pl(t)},JL=t=>typeof t=="object"&&!oe(t)&&!Array.isArray(t)&&!(t instanceof wc),n6=(t,...e)=>{if(!JL(t))return t;const n=Object.assign({},t);for(const r of e)for(const s in r)JL(r[s])?(n[s]||(n[s]={}),n[s]=n6(n[s],r[s])):!oe(r[s])&&Object.hasOwnProperty.call(r,s)&&(Array.isArray(r[s])||r[s]instanceof wc?n[s]=r[s].slice(0):n[s]=r[s]);return n},ype=(t,e,n="0")=>typeof t=="string"?pt(t)?so(t,e,n):t.padStart(e,n):(Me.validate(["int"],[t]),so(t,e,n)),{parseBaseType:vpe}=Ai,bpe=(t,e,n=[])=>{let r=Object.assign({},t),s;for(const i of e){if(r.oneOf&&s){const o=s,a=n.find(([c])=>c===o);a&&a[0]===s&&(r=r.oneOf[a[1]])}if(!r.properties&&!r.items)return;r.properties?r=r.properties[i]:r.items&&r.items.properties?r=r.items.properties[i]:r.items&&Rn(r.items)?r=r.items:r.items&&Array.isArray(r.items)&&(r=r.items[parseInt(i,10)]),r&&i&&(s=i)}return r},Fw=(t,e,n)=>{try{const{baseType:r,baseTypeSize:s}=vpe(e);if(r==="int"||r==="uint")switch(n.number){case _n.NUMBER:return Number(nb(t));case _n.HEX:return gpe(nb(t));case _n.STR:return nb(t).toString();case _n.BIGINT:return nb(t);default:throw new ro(`Invalid format: ${String(n.number)}`)}if(r==="bytes"){let i;switch(s?typeof t=="string"?i=ype(t,s*2):t6(t)&&(i=hpe(new Uint8Array(s-t.length),t)):i=t,n.bytes){case Es.HEX:return mpe(qC(i));case Es.UINT8ARRAY:return qC(i);default:throw new ro(`Invalid format: ${String(n.bytes)}`)}}if(r==="string")return String(t)}catch{return t}return t},eB=({value:t,schemaProp:e,schema:n,object:r,key:s,dataPath:i,format:o,oneOfPath:a=[]})=>{var c,l;if(Array.isArray(t)){let u=e;if(e?.oneOf!==void 0&&e.oneOf.forEach((d,h)=>{var m,g;!Array.isArray(e?.items)&&(typeof t[0]=="object"&&((m=d?.items)===null||m===void 0?void 0:m.type)==="object"||typeof t[0]=="string"&&((g=d?.items)===null||g===void 0?void 0:g.type)!=="object")&&(u=d,a.push([s,h]))}),oe(u?.items))return delete r[s],i.pop(),!0;if(Rn(u.items)&&!oe(u.items.format)){for(let d=0;d<t.length;d+=1)r[s][d]=Fw(t[d],(c=u?.items)===null||c===void 0?void 0:c.format,o);return i.pop(),!0}if(!Array.isArray(u?.items)&&((l=u?.items)===null||l===void 0?void 0:l.type)==="object"){for(const d of t)AN(d,n,i,o,a);return i.pop(),!0}if(Array.isArray(u?.items)){for(let d=0;d<t.length;d+=1)r[s][d]=Fw(t[d],u.items[d].format,o);return i.pop(),!0}}return!1},AN=(t,e,n,r,s=[])=>{var i;if(!Rn(t)&&!Array.isArray(t))return Fw(t,e?.format,r);const o=t;if(Array.isArray(o)&&e?.type==="array"&&((i=e?.items)===null||i===void 0?void 0:i.type)==="object")eB({value:o,schemaProp:e,schema:e,object:o,key:"",dataPath:n,format:r,oneOfPath:s});else for(const[a,c]of Object.entries(o)){n.push(a);let l=bpe(e,n,s);if(oe(l)){delete o[a],n.pop();continue}if(Rn(c)){AN(c,e,n,r,s),n.pop();continue}if(!eB({value:c,schemaProp:l,schema:e,object:o,key:a,dataPath:n,format:r,oneOfPath:s})){if(l?.format===void 0&&l?.oneOf!==void 0){for(const[u,d]of l.oneOf.entries())if(d?.format!==void 0){l=d;break}}o[a]=Fw(c,l.format,r),n.pop()}}return o},r6=(t,e,n=Fr)=>{let r;Rn(e)?r=n6({},e):Array.isArray(e)?r=[...e]:r=e;const s=Rn(t)?t:Lh(t);if(!s.properties&&!s.items&&!s.format)throw new ro("Invalid json schema for formatting");return AN(r,s,[],n)};var NN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function _N(t,e){return NN(this,void 0,void 0,function*(){const n=yield Pfe(t.requestManager);return r6({format:"uint"},n,e)})}function wpe(t,e){return NN(this,void 0,void 0,function*(){const n=yield Dfe(t.requestManager);return r6({format:"uint"},n,e)})}const xpe=t=>NN(void 0,void 0,void 0,function*(){return Ffe(t.requestManager)});var l2=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class s6 extends Xi{getId(e=this.defaultReturnFormat){return l2(this,void 0,void 0,function*(){return _N(this,e)})}getPeerCount(e=this.defaultReturnFormat){return l2(this,void 0,void 0,function*(){return wpe(this,e)})}isListening(){return l2(this,void 0,void 0,function*(){return xpe(this)})}}const uh="ALLEVENTS",KC={name:uh,signature:"",type:"event",inputs:[]},k1={bytes:Es.HEX,number:_n.NUMBER};var i6=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function Ipe(t,e,n){return i6(this,void 0,void 0,function*(){var r,s,i,o;const a=yield A6(e,e.defaultBlock,!1,vt);if(oe(a.baseFeePerGas))throw new xoe;let c;if(oe(t.gasPrice)&&BigInt(a.baseFeePerGas)===BigInt(0)&&(c=yield FN(e,n)),!oe(t.gasPrice)||!oe(c)){const l=Re({format:"uint"},(r=t.gasPrice)!==null&&r!==void 0?r:c,n);return{maxPriorityFeePerGas:l,maxFeePerGas:l}}return{maxPriorityFeePerGas:Re({format:"uint"},(s=t.maxPriorityFeePerGas)!==null&&s!==void 0?s:e.defaultMaxPriorityFeePerGas,n),maxFeePerGas:Re({format:"uint"},(i=t.maxFeePerGas)!==null&&i!==void 0?i:BigInt(a.baseFeePerGas)*BigInt(2)+BigInt((o=t.maxPriorityFeePerGas)!==null&&o!==void 0?o:e.defaultMaxPriorityFeePerGas),n)}})}function o6(t,e,n){return i6(this,void 0,void 0,function*(){const r=a6(t,e);if(!oe(r)){if(r.startsWith("-"))throw new $3(r);if(Number(r)<0||Number(r)>127)throw new $3(r);if(oe(t.gasPrice)&&(r==="0x0"||r==="0x1"))return{gasPrice:yield FN(e,n),maxPriorityFeePerGas:void 0,maxFeePerGas:void 0};if(r==="0x2")return Object.assign({gasPrice:void 0},yield Ipe(t,e,n))}})}var $N=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const XC=(t,e,n,r)=>{if(n!==void 0&&t in n&&n[t]!==void 0){if(typeof n[t]=="string"&&mr(n[t]))return n[t];if(!pt(n[t])&&ZV(n[t])){if(e.wallet){const s=e.wallet.get(Re({format:"uint"},n[t],k1));if(!oe(s))return s.address;throw new R3}throw new R3}else throw t==="from"?new noe(n.from):new roe(n.to)}if(t==="from"){if(!oe(r))return Jhe(r);if(!oe(e.defaultAccount))return e.defaultAccount}},Spe=(t,e,...n)=>$N(void 0,[t,e,...n],void 0,function*(r,s,i=r.defaultReturnFormat){if(oe(s))throw new woe;return _6(r,s,r.defaultBlock,i)}),a6=(t,e)=>{const n=tpe(t,e);if(!oe(n))return n;if(!oe(e.defaultTransactionType))return Re({format:"uint"},e.defaultTransactionType,vt)};function kpe(t){return $N(this,void 0,void 0,function*(){var e,n;let r=Re(Jj,t.transaction,t.web3Context.defaultReturnFormat);if(oe(r.from)&&(r.from=XC("from",t.web3Context,void 0,t.privateKey)),oe(r.nonce)&&(r.nonce=yield Spe(t.web3Context,r.from,vt)),oe(r.value)&&(r.value="0x0"),oe(r.data))oe(r.input)?r.input="0x":r.input.startsWith("0x")||(r.input=`0x${r.input}`);else{if(!oe(r.input)&&r.data!==r.input)throw new IV({data:On(r.data),input:On(r.input)});r.data.startsWith("0x")||(r.data=`0x${r.data}`)}if(oe(r.common)){if(t.web3Context.defaultCommon){const s=t.web3Context.defaultCommon,i=s.customChain.chainId,o=s.customChain.networkId,a=s.customChain.name;r.common=Object.assign(Object.assign({},s),{customChain:{chainId:i,networkId:o,name:a}})}oe(r.chain)&&(r.chain=t.web3Context.defaultChain),oe(r.hardfork)&&(r.hardfork=t.web3Context.defaultHardfork)}if(oe(r.chainId)&&oe((e=r.common)===null||e===void 0?void 0:e.customChain.chainId)&&(r.chainId=yield R6(t.web3Context,vt)),oe(r.networkId)&&(r.networkId=(n=t.web3Context.defaultNetworkId)!==null&&n!==void 0?n:yield _N(t.web3Context,vt)),oe(r.gasLimit)&&!oe(r.gas)&&(r.gasLimit=r.gas),r.type=a6(r,t.web3Context),oe(r.accessList)&&(r.type==="0x1"||r.type==="0x2")&&(r.accessList=[]),t.fillGasPrice&&(r=Object.assign(Object.assign({},r),yield o6(r,t.web3Context,vt))),oe(r.gas)&&oe(r.gasLimit)&&t.fillGasLimit){const s=yield MN(t.web3Context,r,"latest",vt);r=Object.assign(Object.assign({},r),{gas:Re({format:"uint"},s,vt)})}return r})}const Epe=t=>$N(void 0,void 0,void 0,function*(){var e;return((e=t.web3Context.transactionBuilder)!==null&&e!==void 0?e:kpe)(Object.assign(Object.assign({},t),{transaction:t.transaction}))});var RN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function QC(t,e,n){const r=t.transactionPollingInterval,[s,i]=Vde(()=>RN(this,void 0,void 0,function*(){let a;try{a=yield LN(t,k1)}catch(l){console.warn("An error happen while trying to get the block number",l);return}const c=a-e;if(c>=t.transactionBlockTimeout)return new EV({starterBlockNumber:e,numberOfBlocks:c,transactionHash:n})}),r);return[i,{clean:()=>{clearInterval(s)}}]}function Cpe(t,e,n){return RN(this,void 0,void 0,function*(){var r;let s=!0,i,o;function a(l,u){u&&console.warn("error happened at subscription. So revert to polling...",u),o.clean(),s=!1;const[d,h]=QC(t,e,n);o.clean=h.clean,d.catch(m=>l(m))}try{i=yield(r=t.subscriptionManager)===null||r===void 0?void 0:r.subscribe("newHeads"),o={clean:()=>{var l;i.id&&((l=t.subscriptionManager)===null||l===void 0||l.removeSubscription(i).then(()=>{}).catch(()=>{}))}}}catch{return QC(t,e,n)}return[new Promise((l,u)=>{try{i.on("data",d=>{if(s=!1,!d?.number)return;const h=Number(BigInt(d.number)-BigInt(e));h>=t.transactionBlockTimeout&&u(new EV({starterBlockNumber:e,numberOfBlocks:h,transactionHash:n}))}),i.on("error",d=>{a(u,d)})}catch(d){a(u,d)}setTimeout(()=>{s&&a(u)},t.blockHeaderTimeout*1e3)}),o]})}function c6(t,e){return RN(this,void 0,void 0,function*(){var n,r;const{provider:s}=t.requestManager;let i;const o=yield LN(t,k1);return!((r=(n=s).supportsSubscriptions)===null||r===void 0)&&r.call(n)&&t.enableExperimentalFeatures.useSubscriptionWhenCheckingBlockTimeout?i=yield Cpe(t,o,e):i=QC(t,o,e),i})}var Tpe=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function YC(t,e,n){return Tpe(this,void 0,void 0,function*(){const[r,s]=Uj(t.transactionSendTimeout,new Ioe({numberOfSeconds:t.transactionSendTimeout/1e3,transactionHash:n})),[i,o]=yield c6(t,n);try{return yield Promise.race([e(),s,i])}finally{clearTimeout(r),o.clean()}})}var tB=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function l6(t,e,n,r){return tB(this,void 0,void 0,function*(){var s;const i=(s=t.transactionReceiptPollingInterval)!==null&&s!==void 0?s:t.transactionPollingInterval,[o,a]=Ude(()=>tB(this,void 0,void 0,function*(){try{return(r??N6)(t,e,n)}catch(h){console.warn("An error happen while trying to get the transaction receipt",h);return}}),i),[c,l]=Uj(t.transactionPollingTimeout,new kV({numberOfSeconds:t.transactionPollingTimeout/1e3,transactionHash:e})),[u,d]=yield c6(t,e);try{return yield Promise.race([o,l,u])}finally{c&&clearTimeout(c),a&&clearInterval(a),d.clean()}})}var Ape=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const Db=({web3Context:t,transactionReceipt:e,transactionPromiEvent:n,customTransactionReceiptSchema:r,returnFormat:s})=>{var i;let o=1;const a=setInterval(()=>{Ape(void 0,void 0,void 0,function*(){if(o>=t.transactionConfirmationBlocks){clearInterval(a);return}const c=yield Hj(t.requestManager,Qs(BigInt(e.blockNumber)+BigInt(o)),!1);c?.hash&&(o+=1,n.emit("confirmation",{confirmations:Re({format:"uint"},o,s),receipt:Re(r??Uh,e,s),latestBlockHash:Re({format:"bytes32"},c.hash,s)}))})},(i=t.transactionReceiptPollingInterval)!==null&&i!==void 0?i:t.transactionPollingInterval)};var nB=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const Npe=({web3Context:t,transactionReceipt:e,transactionPromiEvent:n,customTransactionReceiptSchema:r,returnFormat:s})=>{let i=!0,o;setImmediate(()=>{var a;(a=t.subscriptionManager)===null||a===void 0||a.subscribe("newHeads").then(c=>{c.on("data",l=>nB(void 0,void 0,void 0,function*(){var u;if(i=!1,!l?.number||o===l?.parentHash)return;o=l?.parentHash;const d=BigInt(l.number)-BigInt(e.blockNumber)+BigInt(1);n.emit("confirmation",{confirmations:Re({format:"uint"},d,s),receipt:Re(r??Uh,e,s),latestBlockHash:Re({format:"bytes32"},l.parentHash,s)}),d>=t.transactionConfirmationBlocks&&(yield(u=t.subscriptionManager)===null||u===void 0?void 0:u.removeSubscription(c))})),c.on("error",()=>nB(void 0,void 0,void 0,function*(){var l;yield(l=t.subscriptionManager)===null||l===void 0?void 0:l.removeSubscription(c),i=!1,Db({web3Context:t,transactionReceipt:e,transactionPromiEvent:n,customTransactionReceiptSchema:r,returnFormat:s})}))}).catch(()=>{i=!1,Db({web3Context:t,transactionReceipt:e,customTransactionReceiptSchema:r,transactionPromiEvent:n,returnFormat:s})})}),setTimeout(()=>{i&&Db({web3Context:t,transactionReceipt:e,transactionPromiEvent:n,returnFormat:s})},t.blockHeaderTimeout*1e3)};function _pe(t,e,n,r,s,i){if(oe(n)||oe(n.blockHash))throw new Soe({receipt:n,blockHash:Re({format:"bytes32"},n?.blockHash,s),transactionHash:Re({format:"bytes32"},r,s)});if(!n.blockNumber)throw new koe({receipt:n});e.emit("confirmation",{confirmations:Re({format:"uint"},1,s),receipt:Re(i??Uh,n,s),latestBlockHash:Re({format:"bytes32"},n.blockHash,s)});const o=t.requestManager.provider;o&&"supportsSubscriptions"in o&&o.supportsSubscriptions()?Npe({web3Context:t,transactionReceipt:n,transactionPromiEvent:e,customTransactionReceiptSchema:i,returnFormat:s}):Db({web3Context:t,transactionReceipt:n,transactionPromiEvent:e,customTransactionReceiptSchema:i,returnFormat:s})}const ON=t=>!hc(t)&&typeof t=="object"&&!hc(t.type)&&t.type==="error",$pe=t=>!hc(t)&&typeof t=="object"&&!hc(t.type)&&t.type==="event",Rpe=t=>!hc(t)&&typeof t=="object"&&!hc(t.type)&&t.type==="function",Ope=t=>typeof t=="object"&&typeof t.components>"u"&&typeof t.name>"u",u6=t=>t.includes("[]")?{type:"tuple[]",name:t.slice(0,-2)}:{type:"tuple",name:t},d6=t=>{const e=[];for(const n of Object.keys(t)){const r=t[n];typeof r=="object"?e.push(Object.assign(Object.assign({},u6(n)),{components:d6(r)})):e.push({name:n,type:t[n]})}return e},ZC=(t,e)=>{const n=[];return e.forEach(r=>{if(typeof r.components=="object"){if(!r.type.startsWith("tuple"))throw new Oe(`Invalid value given "${r.type}". Error: components found but type is not tuple.`);const s=r.type.indexOf("["),i=s>=0?r.type.substring(s):"",o=ZC(t,r.components);n.push(`(${o.join(",")})${i}`)}else n.push(r.type)}),n},f6=t=>{var e,n,r,s;return ON(t)||$pe(t)||Rpe(t)?!((e=t.name)===null||e===void 0)&&e.includes("(")?t.name:`${(n=t.name)!==null&&n!==void 0?n:""}(${ZC(!1,(r=t.inputs)!==null&&r!==void 0?r:[]).join(",")})`:`(${ZC(!1,(s=t.inputs)!==null&&s!==void 0?s:[]).join(",")})`},Ppe=t=>{if(typeof t!="string"&&!ON(t))throw new Oe("Invalid parameter value in encodeErrorSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=f6(t):e=t,zj(e)};function PN(t,e){return t.exec(e)?.groups}var h6=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,p6=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,m6=/^\(.+?\).*?$/,Dpe=Object.defineProperty,Fpe=(t,e,n)=>e in t?Dpe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rm=(t,e,n)=>(Fpe(t,typeof e!="symbol"?e+"":e,n),n),Lpe="abitype",Bpe="0.7.1",Gs=class extends Error{constructor(e,n={}){const r=n.cause instanceof Gs?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof Gs&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: ${Lpe}@${Bpe}`].join(`
`);super(i),rm(this,"details"),rm(this,"docsPath"),rm(this,"metaMessages"),rm(this,"shortMessage"),rm(this,"name","AbiTypeError"),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}},g6=/^struct (?<name>[a-zA-Z0-9_]+) \{(?<properties>.*?)\}$/;function y6(t){return g6.test(t)}function Mpe(t){return PN(g6,t)}var rB=new Set(["memory","indexed","storage","calldata"]),zpe=new Set(["calldata","memory","storage"]);function Upe(t,e){return e?`${e}:${t}`:t}var u2=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]),Vpe=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,jpe=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,Hpe=/^u?int$/;function Lw(t,e){const n=Upe(t,e?.type);if(u2.has(n))return u2.get(n);const r=m6.test(t),s=PN(r?jpe:Vpe,t);if(!s)throw new Gs("Invalid ABI parameter.",{details:t});if(s.name&&Gpe(s.name))throw new Gs("Invalid ABI parameter.",{details:t,metaMessages:[`"${s.name}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,l={};if(r){c="tuple";const d=kf(s.type),h=[],m=d.length;for(let g=0;g<m;g++)h.push(Lw(d[g],{structs:a}));l={components:h}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(Hpe.test(s.type))c=`${s.type}256`;else if(c=s.type,e?.type!=="struct"&&!v6(c))throw new Gs("Unknown type.",{metaMessages:[`Type "${c}" is not a valid ABI type.`]});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new Gs("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`]});if(zpe.has(s.modifier)&&!qpe(c,!!s.array))throw new Gs("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${s.modifier}" was given.`]})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return u2.set(n,u),u}function kf(t,e=[],n="",r=0){if(t===""){if(n==="")return e;if(r!==0)throw new Gs("Unbalanced parentheses.",{metaMessages:[`"${n.trim()}" has too many ${r>0?"opening":"closing"} parentheses.`],details:`Depth "${r}"`});return[...e,n.trim()]}const s=t.length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?kf(a,[...e,n.trim()]):kf(a,e,`${n}${o}`,r);case"(":return kf(a,e,`${n}${o}`,r+1);case")":return kf(a,e,`${n}${o}`,r-1);default:return kf(a,e,`${n}${o}`,r)}}return[]}function v6(t){return t==="address"||t==="bool"||t==="function"||t==="string"||h6.test(t)||p6.test(t)}var Wpe=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function Gpe(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||h6.test(t)||p6.test(t)||Wpe.test(t)}function qpe(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function Kpe(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!y6(a))continue;const c=Mpe(a);if(!c)throw new Gs("Invalid struct signature.",{details:a});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const g=l[h].trim();if(!g)continue;const v=Lw(g,{type:"struct"});u.push(v)}if(!u.length)throw new Gs("Invalid struct signature.",{details:a,metaMessages:["No properties exist."]});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=b6(c,e)}return r}var Xpe=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?$/;function b6(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(m6.test(o.type))r.push(o);else{const c=PN(Xpe,o.type);if(!c?.type)throw new Gs("Invalid ABI parameter.",{details:JSON.stringify(o,null,2),metaMessages:["ABI parameter type is invalid."]});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new Gs("Circular reference detected.",{metaMessages:[`Struct "${u}" is a circular reference.`]});r.push({...o,type:`tuple${l??""}`,components:b6(e[u]??[],e,new Set([...n,u]))})}else if(v6(u))r.push(o);else throw new Gs("Unknown type.",{metaMessages:[`Type "${u}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]})}}return r}function Qpe(t){let e;if(typeof t=="string")e=Lw(t,{modifiers:rB});else{const n=Kpe(t),r=t.length;for(let s=0;s<r;s++){const i=t[s];if(!y6(i)){e=Lw(i,{modifiers:rB,structs:n});break}}}if(!e)throw new Gs("Failed to parse ABI parameter.",{details:`parseAbiParameter(${JSON.stringify(t,null,2)})`,docsPath:"/api/human.html#parseabiparameter-1"});return e}const Ys=32;function w6(t){var e,n;return Object.assign(Object.assign({},t),{name:(e=t.name)!==null&&e!==void 0?e:"",components:(n=t.components)===null||n===void 0?void 0:n.map(r=>w6(r))})}function Ype(t){return!hc(t)&&typeof t=="object"&&!hc(t.type)&&typeof t.type=="string"}function Zpe(t){return t.map(e=>{var n;if(Ype(e))return e;if(typeof e=="string")return w6(Qpe(e.replace(/tuple/,"")));if(Ope(e)){const r=Object.keys(e)[0],s=u6(r);return s.name=(n=s.name)!==null&&n!==void 0?n:"",Object.assign(Object.assign({},s),{components:d6(e[r])})}throw new Oe("Invalid abi")})}function x6(t){const e=t.type.lastIndexOf("["),n=t.type.substring(0,e),r=t.type.substring(e);let s=-1;if(r!=="[]"&&(s=Number(r.slice(1,-1)),isNaN(s)))throw new Oe("Invalid fixed array size",{size:r});return{param:{type:n,name:"",components:t.components},size:s}}function Bw(t){var e,n;return t.type==="string"||t.type==="bytes"||t.type.endsWith("[]")?!0:t.type==="tuple"?(n=(e=t.components)===null||e===void 0?void 0:e.some(Bw))!==null&&n!==void 0?n:!1:t.type.endsWith("]")?Bw(x6(t).param):!1}const I6=20,Jpe=Ys-I6;function eme(t,e){const n=e.subarray(Jpe,Ys);if(n.length!==I6)throw new Oe("Invalid decoding input, not enough bytes to decode address",{bytes:e});const r=Ur(n);return{result:bN(r),encoded:e.subarray(Ys),consumed:Ys}}const Yu=new Map;let rb=BigInt(256);for(let t=8;t<=256;t+=8)Yu.set(`uint${t}`,{min:BigInt(0),max:rb-BigInt(1)}),Yu.set(`int${t}`,{min:-rb/BigInt(2),max:rb/BigInt(2)-BigInt(1)}),rb*=BigInt(256);Yu.set("int",Yu.get("int256"));Yu.set("uint",Yu.get("uint256"));const tme=BigInt(1)<<BigInt(256);function nme(t,e){const n=Ur(t),r=BigInt(n);return r<=e?r:r-tme}function dh(t,e){if(e.length<Ys)throw new Oe("Not enough bytes left to decode",{param:t,bytesLeft:e.length});const n=e.subarray(0,Ys),r=Yu.get(t.type);if(!r)throw new Oe("provided abi contains invalid number datatype",{type:t.type});const s=nme(n,r.max);if(s<r.min)throw new Oe("decoded value is less then minimum for given type",{type:t.type,value:s,name:t.name,minimum:r.min.toString()});if(s>r.max)throw new Oe("decoded value is greater then maximum for given type",{type:t.type,value:s,name:t.name,maximum:r.max.toString()});return{result:s,encoded:e.subarray(Ys),consumed:Ys}}function rme(t,e){const n=dh({type:"uint8",name:""},e);if(n.result>1||n.result<0)throw new Oe("Invalid boolean value encoded",{boolBytes:e.subarray(0,Ys),numberResult:n});return{result:n.result===BigInt(1),encoded:n.encoded,consumed:Ys}}function S6(t,e){const[,n]=t.type.split("bytes");let r=Number(n),s=e,i=1,o=0;if(!r){const a=dh({type:"uint32",name:""},s);r=Number(a.result),o+=a.consumed,s=a.encoded,i=Math.ceil(r/Ys)}if(r>e.length)throw new Oe("there is not enough data to decode",{type:t.type,encoded:e,size:r});return{result:On(s.subarray(0,r)),encoded:s.subarray(i*Ys),consumed:o+i*Ys}}function sme(t,e){const n=S6({type:"bytes"},e);return{result:_de(n.result),encoded:n.encoded,consumed:n.consumed}}function ime(t,e){let{size:n,param:r}=x6(t);const s=n===-1;let i=0;const o=[];let a=e;if(s){const l=dh({type:"uint32",name:""},e);n=Number(l.result),i=l.consumed,a=l.encoded}if(Bw(r)){for(let l=0;l<n;l+=1){const u=dh({type:"uint32",name:""},a.subarray(l*Ys));i+=u.consumed;const d=Mw(r,a.subarray(Number(u.result)));i+=d.consumed,o.push(d.result)}return{result:o,encoded:a.subarray(i),consumed:i}}for(let l=0;l<n;l+=1){const u=Mw(r,e.subarray(i));i+=u.consumed,o.push(u.result)}return{result:o,encoded:e.subarray(i),consumed:i}}function Mw(t,e){if(t.type==="string")return sme(t,e);if(t.type==="bool")return rme(t,e);if(t.type==="address")return eme(t,e);if(t.type==="tuple")return k6(t,e);if(t.type.endsWith("]"))return ime(t,e);if(t.type.startsWith("bytes"))return S6(t,e);if(t.type.startsWith("uint")||t.type.startsWith("int"))return dh(t,e);throw new Oe("Unsupported",{param:t,bytes:e})}function k6(t,e){const n={__length__:0};let r=0;if(!t.components)return{result:n,encoded:e,consumed:r};let s=0;for(const[i,o]of t.components.entries()){let a;if(Bw(o)){const c=dh({type:"uint32",name:""},e.subarray(r));a=Mw(o,e.subarray(Number(c.result))),r+=c.consumed,s+=a.consumed}else a=Mw(o,e.subarray(r)),r+=a.consumed;n.__length__+=1,n[i]=a.result,o.name&&o.name!==""&&(n[o.name]=a.result)}return{encoded:e.subarray(r+s),result:n,consumed:r+s}}function ome(t,e,n){const r=Zpe(t),s=kr(e);return k6({components:r},s).result}const E6=(t,e,n)=>{try{if(t.length>0&&(!e||e==="0x"||e==="0X"))throw new Oe("Returned values aren't valid, did it run Out of Gas? You might also see this error if you are not using the correct ABI for the contract you are retrieving data from, requesting data from a block number that does not exist, or querying a node which is not fully synced.");return ome(t,`0x${e.replace(/0x/i,"")}`,n)}catch(r){throw new Oe(`Parameter decoding error: ${r.message}`,{internalErr:r})}},Fb=(t,e)=>E6(t,e,!1),ame=(t,e)=>Fb([t],e)[0],cme=["bool","string","int","uint","address","fixed","ufixed"],lme=(t,e)=>t==="string"?e:ame(t,e),ume=(t,e,n)=>{const r=Array.isArray(n)?n:[n],s={},i={};for(const[h,m]of t.entries())m.indexed?s[h]=m:i[h]=m;const o=e?E6(Object.values(i),e,!0):{__length__:0},a=r.length-Object.keys(s).length,c=Object.values(s).map((h,m)=>cme.some(g=>h.type.startsWith(g))?lme(h.type,r[m+a]):r[m+a]),l={__length__:0};let u=0,d=0;for(const[h,m]of t.entries())l[h]=m.type==="string"?"":void 0,s[h]&&(l[h]=c[u],u+=1),i[h]&&(l[h]=o[String(d)],d+=1),m.name&&(l[m.name]=l[h]),l.__length__+=1;return l},dme=(t,e)=>{if(e?.data){let n,r,s;try{const i=e.data.slice(0,10),o=t.find(a=>Ppe(a).startsWith(i));o?.inputs?(n=o.name,r=f6(o),s=Fb([...o.inputs],e.data.substring(10))):e.data.startsWith("0x08c379a0")?(n="Error",r="Error(string)",s=Fb([{name:"message",type:"string"}],e.data.substring(10))):e.data.startsWith("0x4e487b71")?(n="Panic",r="Panic(uint256)",s=Fb([{name:"code",type:"uint256"}],e.data.substring(10))):console.error("No matching error abi found for error data",e.data)}catch(i){console.error(i)}n&&e.setDecodedProperties(n,r,s)}};var fme=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const hme=(t,e)=>{var n,r,s,i,o;if(t instanceof Ou&&t.cause instanceof f1){if(e!==void 0){const a=e.filter(c=>ON(c));return dme(a,t.cause),{reason:t.cause.message,signature:(n=t.cause.data)===null||n===void 0?void 0:n.slice(0,10),data:(r=t.cause.data)===null||r===void 0?void 0:r.substring(10),customErrorName:t.cause.errorName,customErrorDecodedSignature:t.cause.errorSignature,customErrorArguments:t.cause.errorArgs}}return{reason:t.cause.message,signature:(s=t.cause.data)===null||s===void 0?void 0:s.slice(0,10),data:(i=t.cause.data)===null||i===void 0?void 0:i.substring(10)}}if(t instanceof t0&&!Array.isArray((o=t.cause)===null||o===void 0?void 0:o.errors)&&t.cause!==void 0)return t.cause.message;throw t};function C6(t,e,n){return fme(this,arguments,void 0,function*(r,s,i,o=r.defaultReturnFormat){try{yield BN(r,s,r.defaultBlock,o);return}catch(a){return hme(a,i)}})}var pme=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function d2(t,e,n,r,s,i){return pme(this,void 0,void 0,function*(){let o=i;o===void 0&&t.handleRevert&&e!==void 0&&(o=yield C6(t,e,s));let a;if(o===void 0)a=new wV(n);else if(typeof o=="string")a=new ww(o,void 0,n);else if(o.customErrorName!==void 0&&o.customErrorDecodedSignature!==void 0&&o.customErrorArguments!==void 0){const c=o;a=new bV(c.reason,c.customErrorName,c.customErrorDecodedSignature,c.customErrorArguments,c.signature,n,c.data)}else a=new ww(o.reason,o.signature,n,o.data);return a})}const DN=(t,e,n,r=Fr)=>{var s,i,o,a,c,l;let u=Object.assign({},t);const d=Re(zh,e,r);if([uh,"allEvents"].includes(u.name)){const m=n.find(g=>g.signature===e.topics[0]);m?u=m:u={anonymous:!0}}if(u.inputs=(i=(s=u.inputs)!==null&&s!==void 0?s:t.inputs)!==null&&i!==void 0?i:[],!u.anonymous){let m=0;((o=u.inputs)!==null&&o!==void 0?o:[]).forEach(g=>{g.indexed&&(m+=1)}),m>0&&e?.topics&&e?.topics.length!==m+1&&(u=Object.assign(Object.assign({},u),{anonymous:!0,inputs:[]}))}const h=u.anonymous?e.topics:((a=e.topics)!==null&&a!==void 0?a:[]).slice(1);return Object.assign(Object.assign({},d),{returnValues:ume([...(c=u.inputs)!==null&&c!==void 0?c:[]],e.data,h),event:u.name,signature:!u.anonymous&&((l=e.topics)===null||l===void 0?void 0:l.length)>0&&e.topics[0]?e.topics[0]:void 0,raw:{data:e.data,topics:e.topics}})};var lu=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class T6{constructor({options:e,web3Context:n,promiEvent:r,returnFormat:s}){this.options={checkRevertBeforeSending:!0},this.options=e,this.web3Context=n,this.promiEvent=r,this.returnFormat=s}getReceiptWithEvents(e){var n,r;const s=Object.assign({},e??{});if(!((n=this.options)===null||n===void 0)&&n.contractAbi&&s.logs&&s.logs.length>0){s.events={};for(const i of s.logs){const o=DN(KC,i,(r=this.options)===null||r===void 0?void 0:r.contractAbi,this.returnFormat);o.event&&(s.events[o.event]=o)}}return s}checkRevertBeforeSending(e){return lu(this,void 0,void 0,function*(){if(this.options.checkRevertBeforeSending!==!1){let n=e;oe(e.data)&&oe(e.input)&&oe(e.gas)&&(n=Object.assign(Object.assign({},e),{gas:21e3}));const r=yield C6(this.web3Context,n,this.options.contractAbi);if(r!==void 0)throw yield d2(this.web3Context,e,void 0,void 0,this.options.contractAbi,r)}})}emitSending(e){this.promiEvent.listenerCount("sending")>0&&this.promiEvent.emit("sending",e)}populateGasPrice(e){return lu(this,arguments,void 0,function*({transactionFormatted:n,transaction:r}){var s;let i=n;return!this.web3Context.config.ignoreGasPricing&&!(!((s=this.options)===null||s===void 0)&&s.ignoreGasPricing)&&oe(n.gasPrice)&&(oe(r.maxPriorityFeePerGas)||oe(r.maxFeePerGas))&&(i=Object.assign(Object.assign({},n),yield o6(n,this.web3Context,vt))),i})}signAndSend(e){return lu(this,arguments,void 0,function*({wallet:n,tx:r}){if(n){const s=yield n.signTransaction(r);return YC(this.web3Context,()=>lu(this,void 0,void 0,function*(){return jj(this.web3Context.requestManager,s.rawTransaction)}),s.transactionHash)}return YC(this.web3Context,()=>lu(this,void 0,void 0,function*(){return afe(this.web3Context.requestManager,r)}))})}emitSent(e){this.promiEvent.listenerCount("sent")>0&&this.promiEvent.emit("sent",e)}emitTransactionHash(e){this.promiEvent.listenerCount("transactionHash")>0&&this.promiEvent.emit("transactionHash",e)}emitReceipt(e){this.promiEvent.listenerCount("receipt")>0&&this.promiEvent.emit("receipt",e)}handleError(e){return lu(this,arguments,void 0,function*({error:n,tx:r}){var s;let i=n;return i instanceof Ou&&this.web3Context.handleRevert&&(i=yield d2(this.web3Context,r,void 0,void 0,(s=this.options)===null||s===void 0?void 0:s.contractAbi)),(i instanceof t0||i instanceof Ou||i instanceof bV||i instanceof wV||i instanceof ww||i instanceof kV)&&this.promiEvent.listenerCount("error")>0&&this.promiEvent.emit("error",i),i})}emitConfirmation({receipt:e,transactionHash:n,customTransactionReceiptSchema:r}){this.promiEvent.listenerCount("confirmation")>0&&_pe(this.web3Context,this.promiEvent,e,n,this.returnFormat,r)}handleResolve(e){return lu(this,arguments,void 0,function*({receipt:n,tx:r}){var s,i,o;if(!((s=this.options)===null||s===void 0)&&s.transactionResolver)return(i=this.options)===null||i===void 0?void 0:i.transactionResolver(n);if(n.status===BigInt(0)){const a=yield d2(this.web3Context,r,n,void 0,(o=this.options)===null||o===void 0?void 0:o.contractAbi);throw this.promiEvent.listenerCount("error")>0&&this.promiEvent.emit("error",a),a}else return n})}}var Zt=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},mme=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const gme=t=>Zt(void 0,void 0,void 0,function*(){return Vj(t.requestManager)});function yme(t,e){return Zt(this,void 0,void 0,function*(){const n=yield Gde(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function FN(t,e){return Zt(this,void 0,void 0,function*(){const n=yield qde(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function vme(t,e){return Zt(this,void 0,void 0,function*(){const n=yield Kde(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function LN(t,e){return Zt(this,void 0,void 0,function*(){const n=yield Qde(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function bme(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i){const o=Br(s)?s:Re({format:"uint"},s,vt),a=yield Yde(n.requestManager,r,o);return Re({format:"uint"},a,i??n.defaultReturnFormat)})}function wme(t,e,n){return Zt(this,arguments,void 0,function*(r,s,i,o=r.defaultBlock,a){const c=Re({format:"uint"},i,vt),l=Br(o)?o:Re({format:"uint"},o,vt),u=yield Zde(r.requestManager,s,c,l);return Re({format:"bytes"},u,a??r.defaultReturnFormat)})}function xme(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i){const o=Br(s)?s:Re({format:"uint"},s,vt),a=yield sfe(n.requestManager,r,o);return Re({format:"bytes"},a,i??n.defaultReturnFormat)})}function A6(t){return Zt(this,arguments,void 0,function*(e,n=e.defaultBlock,r=!1,s){var i;let o;if(xc(n)){const c=Re({format:"bytes32"},n,vt);o=yield ufe(e.requestManager,c,r)}else{const c=Br(n)?n:Re({format:"uint"},n,vt);o=yield Hj(e.requestManager,c,r)}const a=Re(Dw,o,s??e.defaultReturnFormat);return oe(a)?a:Object.assign(Object.assign({},a),{transactions:(i=a.transactions)!==null&&i!==void 0?i:[]})})}function Ime(t){return Zt(this,arguments,void 0,function*(e,n=e.defaultBlock,r){let s;if(xc(n)){const i=Re({format:"bytes32"},n,vt);s=yield efe(e.requestManager,i)}else{const i=Br(n)?n:Re({format:"uint"},n,vt);s=yield tfe(e.requestManager,i)}return Re({format:"uint"},s,r??e.defaultReturnFormat)})}function Sme(t){return Zt(this,arguments,void 0,function*(e,n=e.defaultBlock,r){let s;if(xc(n)){const i=Re({format:"bytes32"},n,vt);s=yield nfe(e.requestManager,i)}else{const i=Br(n)?n:Re({format:"uint"},n,vt);s=yield rfe(e.requestManager,i)}return Re({format:"uint"},s,r??e.defaultReturnFormat)})}function kme(t){return Zt(this,arguments,void 0,function*(e,n=e.defaultBlock,r,s){const i=Re({format:"uint"},r,vt);let o;if(xc(n)){const a=Re({format:"bytes32"},n,vt);o=yield mfe(e.requestManager,a,i)}else{const a=Br(n)?n:Re({format:"uint"},n,vt);o=yield gfe(e.requestManager,a,i)}return Re(Dw,o,s??e.defaultReturnFormat)})}function Eme(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultReturnFormat){const i=Re({format:"bytes32"},r,Fr),o=yield dfe(n.requestManager,i);return oe(o)?o:ti(o,s,{transactionSchema:n.config.customTransactionSchema,fillInputAndData:!0})})}function Cme(t,e){return Zt(this,void 0,void 0,function*(){return(yield Tfe(t.requestManager)).map(r=>ti(r,e??t.defaultReturnFormat,{transactionSchema:t.config.customTransactionSchema,fillInputAndData:!0}))})}function Tme(t){return Zt(this,arguments,void 0,function*(e,n=e.defaultBlock,r,s){const i=Re({format:"uint"},r,vt);let o;if(xc(n)){const a=Re({format:"bytes32"},n,vt);o=yield ffe(e.requestManager,a,i)}else{const a=Br(n)?n:Re({format:"uint"},n,vt);o=yield hfe(e.requestManager,a,i)}return oe(o)?o:ti(o,s??e.defaultReturnFormat,{transactionSchema:e.config.customTransactionSchema,fillInputAndData:!0})})}function N6(t,e,n){return Zt(this,void 0,void 0,function*(){const r=Re({format:"bytes32"},e,Fr);let s;try{s=yield pfe(t.requestManager,r)}catch(i){if(typeof i=="object"&&!oe(i)&&"message"in i&&i.message==="transaction indexing is in progress")console.warn("Transaction indexing is in progress.");else throw i}return oe(s)?s:Re(Uh,s,n??t.defaultReturnFormat)})}function _6(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i){const o=Br(s)?s:Re({format:"uint"},s,vt),a=yield Jde(n.requestManager,r,o);return Re({format:"uint"},a,i??n.defaultReturnFormat)})}function gg(t,e,n,r={checkRevertBeforeSending:!0},s){const i=new $j((o,a)=>{setImmediate(()=>{Zt(this,void 0,void 0,function*(){const c=new T6({web3Context:t,promiEvent:i,options:r,returnFormat:n});let l=Object.assign({},e);oe(s)||(l=yield s.processTransaction(l));let u=ti(Object.assign(Object.assign({},l),{from:XC("from",t,l),to:XC("to",t,l)}),vt,{transactionSchema:t.config.customTransactionSchema});try{u=yield c.populateGasPrice({transaction:l,transactionFormatted:u}),yield c.checkRevertBeforeSending(u),c.emitSending(u);let d;t.wallet&&!oe(u.from)&&(d=t.wallet.get(u.from));const h=yield c.signAndSend({wallet:d,tx:u}),m=Re({format:"bytes32"},h,n??t.defaultReturnFormat);c.emitSent(u),c.emitTransactionHash(m);const g=yield l6(t,h,n??t.defaultReturnFormat),v=c.getReceiptWithEvents(Re(Uh,g,n??t.defaultReturnFormat));c.emitReceipt(v),o(yield c.handleResolve({receipt:v,tx:u})),c.emitConfirmation({receipt:v,transactionHash:h})}catch(d){a(yield c.handleError({error:d,tx:u}))}})})});return i}function Ame(t,e,n,r={checkRevertBeforeSending:!0}){const s=new $j((i,o)=>{setImmediate(()=>{Zt(this,void 0,void 0,function*(){const a=new T6({web3Context:t,promiEvent:s,options:r,returnFormat:n}),c=Re({format:"bytes"},e,vt),l=CN.fromSerializedData(wl($o(c))),u=Object.assign(Object.assign({},l.toJSON()),{from:l.getSenderAddress().toString()});try{const{v:d,r:h,s:m}=u,g=mme(u,["v","r","s"]);yield a.checkRevertBeforeSending(g),a.emitSending(c);const v=yield YC(t,()=>Zt(this,void 0,void 0,function*(){return jj(t.requestManager,c)}));a.emitSent(c);const y=Re({format:"bytes32"},v,n??t.defaultReturnFormat);a.emitTransactionHash(y);const w=yield l6(t,v,n??t.defaultReturnFormat),x=a.getReceiptWithEvents(Re(Uh,w,n??t.defaultReturnFormat));a.emitReceipt(x),i(yield a.handleResolve({receipt:x,tx:u})),a.emitConfirmation({receipt:x,transactionHash:v})}catch(d){o(yield a.handleError({error:d,tx:u}))}})})});return s}function Nme(t,e,n){return Zt(this,arguments,void 0,function*(r,s,i,o=r.defaultReturnFormat){var a;const c=Re({format:"bytes"},s,Fr);if(!((a=r.wallet)===null||a===void 0)&&a.get(i)){const d=r.wallet.get(i).sign(c);return Re(cpe,d,o)}if(typeof i=="number")throw new eoe(s,'RPC method "eth_sign" does not support index signatures');const l=yield ife(r.requestManager,i,c);return Re({format:"bytes"},l,o)})}function _me(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultReturnFormat){const i=yield ofe(n.requestManager,ti(r,vt,{transactionSchema:n.config.customTransactionSchema}));return lN(i)?fpe(i,s,{fillInputAndData:!0}):{raw:Re({format:"bytes"},i.raw,s),tx:ti(i.tx,s,{transactionSchema:n.config.customTransactionSchema,fillInputAndData:!0})}})}function BN(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i=n.defaultReturnFormat){const o=Br(s)?s:Re({format:"uint"},s,vt),a=yield cfe(n.requestManager,ti(r,vt,{transactionSchema:n.config.customTransactionSchema}),o);return Re({format:"bytes"},a,i)})}function MN(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i){const o=ti(r,vt,{transactionSchema:n.config.customTransactionSchema}),a=Br(s)?s:Re({format:"uint"},s,vt),c=yield lfe(n.requestManager,o,a);return Re({format:"uint"},c,i??n.defaultReturnFormat)})}function $6(t,e,n){return Zt(this,void 0,void 0,function*(){let{toBlock:r,fromBlock:s}=e;oe(r)||(typeof r=="number"||typeof r=="bigint")&&(r=Qs(r)),oe(s)||(typeof s=="number"||typeof s=="bigint")&&(s=Qs(s));const i=Object.assign(Object.assign({},e),{fromBlock:s,toBlock:r});return(yield Sfe(t.requestManager,i)).map(c=>typeof c=="string"?c:Re(zh,c,n??t.defaultReturnFormat))})}function R6(t,e){return Zt(this,void 0,void 0,function*(){const n=yield Nfe(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function $me(t,e,n){return Zt(this,arguments,void 0,function*(r,s,i,o=r.defaultBlock,a){const c=i.map(d=>Re({format:"bytes"},d,vt)),l=Br(o)?o:Re({format:"uint"},o,vt),u=yield _fe(r.requestManager,s,c,l);return Re(dpe,u,a??r.defaultReturnFormat)})}function Rme(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i,o){const a=Re({format:"uint"},r,vt),c=Br(s)?s:Re({format:"uint"},s,vt),l=Re({type:"array",items:{format:"uint"}},i,k1),u=yield Cfe(n.requestManager,a,c,l);return Re(lpe,u,o??n.defaultReturnFormat)})}function O6(t,e){return Zt(this,arguments,void 0,function*(n,r,s=n.defaultBlock,i){const o=Br(s)?s:Re({format:"uint"},s,vt),a=yield Rfe(n.requestManager,ti(r,vt,{transactionSchema:n.config.customTransactionSchema}),o);return Re(spe,a,i??n.defaultReturnFormat)})}function Ome(t,e,n,r,s){return Zt(this,void 0,void 0,function*(){const i=yield Ofe(t.requestManager,e,n,r);return Re({format:"bytes"},i,s??t.defaultReturnFormat)})}var Vh=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function Pme(t,e){return Vh(this,void 0,void 0,function*(){const n=yield bfe(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function Dme(t,e,n){return Vh(this,void 0,void 0,function*(){let{toBlock:r,fromBlock:s}=e;oe(r)||(typeof r=="number"||typeof r=="bigint")&&(r=Qs(r)),oe(s)||(typeof s=="number"||typeof s=="bigint")&&(s=Qs(s));const i=Object.assign(Object.assign({},e),{fromBlock:s,toBlock:r}),o=yield yfe(t.requestManager,i);return Re({format:"uint"},o,n??t.defaultReturnFormat)})}function Fme(t,e){return Vh(this,void 0,void 0,function*(){const n=yield vfe(t.requestManager);return Re({format:"uint"},n,e??t.defaultReturnFormat)})}function Lme(t,e){return Vh(this,void 0,void 0,function*(){return yield wfe(t.requestManager,Qs(e))})}function Bme(t,e,n){return Vh(this,void 0,void 0,function*(){return(yield xfe(t.requestManager,Qs(e))).map(i=>typeof i=="string"?i:Re(zh,i,n??t.defaultReturnFormat))})}function Mme(t,e,n){return Vh(this,void 0,void 0,function*(){return(yield Ife(t.requestManager,Qs(e))).map(i=>typeof i=="string"?i:Re(zh,i,n??t.defaultReturnFormat))})}class P6 extends r0{_buildSubscriptionParams(){return["logs",this.args]}formatSubscriptionResult(e){return Re(zh,e,super.returnFormat)}}class sB extends r0{_buildSubscriptionParams(){return["newPendingTransactions"]}formatSubscriptionResult(e){return Re({format:"string"},e,super.returnFormat)}}class zw extends r0{_buildSubscriptionParams(){return["newHeads"]}formatSubscriptionResult(e){return Re(ope,e,super.returnFormat)}}class D6 extends r0{_buildSubscriptionParams(){return["syncing"]}_processSubscriptionResult(e){if(typeof e=="boolean")this.emit("changed",e);else{const n=Object.fromEntries(Object.entries(e?.status||e).map(([r,s])=>[r.charAt(0).toLowerCase()+r.substring(1),s]));this.emit("changed",e.syncing),this.emit("data",Re(ape,n,super.returnFormat))}}}var wt=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const JC={logs:P6,newPendingTransactions:sB,newHeads:zw,syncing:D6,pendingTransactions:sB,newBlockHeaders:zw};class E1 extends Xi{constructor(e){if(typeof e=="string"||Nw(e)){super({provider:e,registeredSubscriptions:JC});return}if(e.registeredSubscriptions){super(e);return}super(Object.assign(Object.assign({},e),{registeredSubscriptions:JC})),this.getFeeData=this.calculateFeeData}setTransactionMiddleware(e){this.transactionMiddleware=e}getTransactionMiddleware(){return this.transactionMiddleware}getProtocolVersion(){return wt(this,void 0,void 0,function*(){return jde(this.requestManager)})}isSyncing(){return wt(this,void 0,void 0,function*(){return Vj(this.requestManager)})}getCoinbase(){return wt(this,void 0,void 0,function*(){return Hde(this.requestManager)})}isMining(){return wt(this,void 0,void 0,function*(){return Wde(this.requestManager)})}getHashrate(e){return wt(this,void 0,void 0,function*(){var n;return e===void 0&&(e=(n=this.defaultReturnFormat)!==null&&n!==void 0?n:Fr),this.getHashRate(e)})}getHashRate(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return yme(this,e)})}getGasPrice(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return FN(this,e)})}getMaxPriorityFeePerGas(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return vme(this,e)})}calculateFeeData(){return wt(this,arguments,void 0,function*(e=BigInt(2),n=Cde.Gwei){var r;const s=yield this.getBlock(void 0,!1),i=(r=s?.baseFeePerGas)!==null&&r!==void 0?r:void 0;let o;try{o=yield this.getGasPrice()}catch{}let a;try{a=yield this.getMaxPriorityFeePerGas()}catch{}let c;if(i){a=a??n;let l;typeof e=="number"?l=BigInt(Math.floor(e*1e3))/BigInt(1e3):l=e,c=i*l+a}return{gasPrice:o,maxFeePerGas:c,maxPriorityFeePerGas:a,baseFeePerGas:i}})}getAccounts(){return wt(this,void 0,void 0,function*(){var e;return((e=yield Xde(this.requestManager))!==null&&e!==void 0?e:[]).map(r=>bN(r))})}getBlockNumber(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return LN(this,e)})}getBalance(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return bme(this,n,r,s)})}getStorageAt(e,n){return wt(this,arguments,void 0,function*(r,s,i=this.defaultBlock,o=this.defaultReturnFormat){return wme(this,r,s,i,o)})}getCode(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return xme(this,n,r,s)})}getBlock(){return wt(this,arguments,void 0,function*(e=this.defaultBlock,n=!1,r=this.defaultReturnFormat){return A6(this,e,n,r)})}getBlockTransactionCount(){return wt(this,arguments,void 0,function*(e=this.defaultBlock,n=this.defaultReturnFormat){return Ime(this,e,n)})}getBlockUncleCount(){return wt(this,arguments,void 0,function*(e=this.defaultBlock,n=this.defaultReturnFormat){return Sme(this,e,n)})}getUncle(){return wt(this,arguments,void 0,function*(e=this.defaultBlock,n,r=this.defaultReturnFormat){return kme(this,e,n,r)})}getTransaction(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){const s=yield Eme(this,n,r);if(!s)throw new _3;return s})}getPendingTransactions(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return Cme(this,e)})}getTransactionFromBlock(){return wt(this,arguments,void 0,function*(e=this.defaultBlock,n,r=this.defaultReturnFormat){return Tme(this,e,n,r)})}getTransactionReceipt(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){const s=yield N6(this,n,r);if(!s)throw new _3;return s})}getTransactionCount(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return _6(this,n,r,s)})}sendTransaction(e,n=this.defaultReturnFormat,r){return gg(this,e,n,r,this.transactionMiddleware)}sendSignedTransaction(e,n=this.defaultReturnFormat,r){return Ame(this,e,n,r)}sign(e,n){return wt(this,arguments,void 0,function*(r,s,i=this.defaultReturnFormat){return Nme(this,r,s,i)})}signTransaction(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){return _me(this,n,r)})}call(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return BN(this,n,r,s)})}estimateGas(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return MN(this,n,r,s)})}getPastLogs(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){return $6(this,n,r)})}getWork(){return wt(this,void 0,void 0,function*(){return kfe(this.requestManager)})}submitWork(e,n,r){return wt(this,void 0,void 0,function*(){return Efe(this.requestManager,e,n,r)})}requestAccounts(){return wt(this,void 0,void 0,function*(){return Afe(this.requestManager)})}getChainId(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return R6(this,e)})}getNodeInfo(){return wt(this,void 0,void 0,function*(){return $fe(this.requestManager)})}getProof(e,n){return wt(this,arguments,void 0,function*(r,s,i=this.defaultBlock,o=this.defaultReturnFormat){return $me(this,r,s,i,o)})}getFeeHistory(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s,i=this.defaultReturnFormat){return Rme(this,n,r,s,i)})}createAccessList(e){return wt(this,arguments,void 0,function*(n,r=this.defaultBlock,s=this.defaultReturnFormat){return O6(this,n,r,s)})}signTypedData(e,n,r,s){return wt(this,void 0,void 0,function*(){var i;return r===void 0&&(r=!1),s===void 0&&(s=(i=this.defaultReturnFormat)!==null&&i!==void 0?i:Fr),Ome(this,e,n,r,s)})}subscribe(e,n,r){return wt(this,void 0,void 0,function*(){var s,i;r===void 0&&(r=(s=this.defaultReturnFormat)!==null&&s!==void 0?s:Fr);const o=yield(i=this.subscriptionManager)===null||i===void 0?void 0:i.subscribe(e,n,r);return o instanceof P6&&e==="logs"&&typeof n=="object"&&!hc(n.fromBlock)&&Number.isFinite(Number(n.fromBlock))&&setImmediate(()=>{this.getPastLogs(n).then(a=>{for(const c of a)o._processSubscriptionResult(c)}).catch(a=>{o._processSubscriptionError(a)})}),o})}static shouldClearSubscription({sub:e}){return!(e instanceof D6)}clearSubscriptions(e=!1){var n;return(n=this.subscriptionManager)===null||n===void 0?void 0:n.unsubscribe(e?E1.shouldClearSubscription:void 0)}createNewPendingTransactionFilter(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return Pme(this,e)})}createNewFilter(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){return Dme(this,n,r)})}createNewBlockFilter(){return wt(this,arguments,void 0,function*(e=this.defaultReturnFormat){return Fme(this,e)})}uninstallFilter(e){return wt(this,void 0,void 0,function*(){return Lme(this,e)})}getFilterChanges(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){return Bme(this,n,r)})}getFilterLogs(e){return wt(this,arguments,void 0,function*(n,r=this.defaultReturnFormat){return Mme(this,n,r)})}}const zme=t=>{if(!oe(t.common)){if(oe(t.common.customChain))throw new soe;if(oe(t.common.customChain.chainId))throw new ioe;if(!oe(t.chainId)&&t.chainId!==t.common.customChain.chainId)throw new ooe({txChainId:t.chainId,customChainId:t.common.customChain.chainId})}},Ume=t=>{if(!oe(t.common)&&!oe(t.chain)&&!oe(t.hardfork))throw new loe;if(!oe(t.chain)&&oe(t.hardfork)||!oe(t.hardfork)&&oe(t.chain))throw new uoe({chain:t.chain,hardfork:t.hardfork})},Vme=t=>{if(!oe(t.common)&&!oe(t.common.baseChain)&&!oe(t.chain)&&t.chain!==t.common.baseChain)throw new aoe({txChain:t.chain,baseChain:t.common.baseChain})},jme=t=>{if(!oe(t.common)&&!oe(t.common.hardfork)&&!oe(t.hardfork)&&t.hardfork!==t.common.hardfork)throw new coe({txHardfork:t.hardfork,commonHardfork:t.common.hardfork})},iB=t=>{if(oe(t.gas)||!ki(t.gas)||oe(t.gasPrice)||!ki(t.gasPrice))throw new moe({gas:t.gas,gasPrice:t.gasPrice});if(!oe(t.maxFeePerGas)||!oe(t.maxPriorityFeePerGas))throw new xV({maxFeePerGas:t.maxFeePerGas,maxPriorityFeePerGas:t.maxPriorityFeePerGas})},oB=t=>{if(!oe(t.gasPrice)&&t.type==="0x2")throw new yoe(t.gasPrice);if(t.type==="0x0"||t.type==="0x1")throw new xV({maxFeePerGas:t.maxFeePerGas,maxPriorityFeePerGas:t.maxPriorityFeePerGas});if(oe(t.maxFeePerGas)||!ki(t.maxFeePerGas)||oe(t.maxPriorityFeePerGas)||!ki(t.maxPriorityFeePerGas))throw new goe({maxPriorityFeePerGas:t.maxPriorityFeePerGas,maxFeePerGas:t.maxFeePerGas})},Hme=t=>{const e=!oe(t.gas)||!oe(t.gasLimit),n=e&&!oe(t.gasPrice),r=e&&!oe(t.maxPriorityFeePerGas)&&!oe(t.maxFeePerGas);if(!n&&!r)throw new foe({gas:t.gas,gasPrice:t.gasPrice,maxPriorityFeePerGas:t.maxPriorityFeePerGas,maxFeePerGas:t.maxFeePerGas});if(n&&r)throw new poe({gas:t.gas,gasPrice:t.gasPrice,maxPriorityFeePerGas:t.maxPriorityFeePerGas,maxFeePerGas:t.maxFeePerGas});(n?iB:oB)(t),(!oe(t.type)&&t.type>"0x1"?oB:iB)(t)},Wme=(t,e,n={transactionSchema:void 0})=>{if(!oe(e)){e(t);return}if(typeof t!="object"||oe(t))throw new voe(t);zme(t),Ume(t),Vme(t),jme(t);const r=ti(t,vt,{transactionSchema:n.transactionSchema});if(Hme(r),oe(r.nonce)||oe(r.chainId)||r.nonce.startsWith("-")||r.chainId.startsWith("-"))throw new boe({nonce:t.nonce,chainId:t.chainId})};var Gme=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const qme=t=>{var e,n;return Object.assign(Object.assign({},t),{nonce:t.nonce,gasPrice:t.gasPrice,gasLimit:(e=t.gasLimit)!==null&&e!==void 0?e:t.gas,to:t.to,value:t.value,data:(n=t.data)!==null&&n!==void 0?n:t.input,type:t.type,chainId:t.chainId,accessList:t.accessList,maxPriorityFeePerGas:t.maxPriorityFeePerGas,maxFeePerGas:t.maxFeePerGas})},Kme=(t,e)=>{var n,r,s,i,o,a,c,l,u,d,h,m,g,v,y,w,x,S;const k=!oe(t.chain)&&!oe(t.hardfork)||!oe(t.common);let E;if(!k)e.defaultCommon?(E=Object.assign({},e.defaultCommon),oe(E.hardfork)&&(E.hardfork=(n=t.hardfork)!==null&&n!==void 0?n:e.defaultHardfork),oe(E.baseChain)&&(E.baseChain=e.defaultChain)):E=yu.custom({name:"custom-network",chainId:ym(t.chainId),networkId:oe(t.networkId)?void 0:ym(t.networkId),defaultHardfork:(r=t.hardfork)!==null&&r!==void 0?r:e.defaultHardfork},{baseChain:e.defaultChain});else{const A=(a=(o=(i=(s=t?.common)===null||s===void 0?void 0:s.customChain)===null||i===void 0?void 0:i.name)!==null&&o!==void 0?o:t.chain)!==null&&a!==void 0?a:"custom-network",R=ym((u=(l=(c=t?.common)===null||c===void 0?void 0:c.customChain)===null||l===void 0?void 0:l.chainId)!==null&&u!==void 0?u:t?.chainId),N=ym((m=(h=(d=t?.common)===null||d===void 0?void 0:d.customChain)===null||h===void 0?void 0:h.networkId)!==null&&m!==void 0?m:t?.networkId),P=(y=(v=(g=t?.common)===null||g===void 0?void 0:g.hardfork)!==null&&v!==void 0?v:t?.hardfork)!==null&&y!==void 0?y:e.defaultHardfork,O=(S=(x=(w=t.common)===null||w===void 0?void 0:w.baseChain)!==null&&x!==void 0?x:t.chain)!==null&&S!==void 0?S:e.defaultChain;R&&N&&A&&(E=yu.custom({name:A,chainId:R,networkId:N,defaultHardfork:P},{baseChain:O}))}return{common:E}},Xme=(t,e,n,...r)=>Gme(void 0,[t,e,n,...r],void 0,function*(s,i,o,a=!1,c=!0){const l=yield Epe({transaction:s,web3Context:i,privateKey:o,fillGasPrice:a,fillGasLimit:c}),u=ti(l,vt,{transactionSchema:i.config.customTransactionSchema});return Wme(u,void 0,{transactionSchema:i.config.customTransactionSchema}),CN.fromTxData(qme(u),Kme(u,i))});function yg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Qme(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Yme(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function C1(t,...e){if(!Yme(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Zme(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yg(t.outputLen),yg(t.blockLen)}function eT(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function F6(t,e){C1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Jme={number:yg,bool:Qme,bytes:C1,hash:Zme,exists:eT,output:F6},sb=BigInt(2**32-1),aB=BigInt(32);function ege(t,e=!1){return e?{h:Number(t&sb),l:Number(t>>aB&sb)}:{h:Number(t>>aB&sb)|0,l:Number(t&sb)|0}}function tge(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=ege(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const nge=(t,e,n)=>t<<n|e>>>32-n,rge=(t,e,n)=>e<<n|t>>>32-n,sge=(t,e,n)=>e<<n-32|t>>>64-n,ige=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const oge=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),cB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,age=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function lB(t){for(let e=0;e<t.length;e++)t[e]=age(t[e])}function vg(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function L6(t){return typeof t=="string"&&(t=vg(t)),C1(t),t}let cge=class{clone(){return this._cloneInto()}};function lge(t){const e=r=>t().update(L6(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const B6=[],M6=[],z6=[],uge=BigInt(0),sm=BigInt(1),dge=BigInt(2),fge=BigInt(7),hge=BigInt(256),pge=BigInt(113);for(let t=0,e=sm,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],B6.push(2*(5*r+n)),M6.push((t+1)*(t+2)/2%64);let s=uge;for(let i=0;i<7;i++)e=(e<<sm^(e>>fge)*pge)%hge,e&dge&&(s^=sm<<(sm<<BigInt(i))-sm);z6.push(s)}const[mge,gge]=tge(z6,!0),uB=(t,e,n)=>n>32?sge(t,e,n):nge(t,e,n),dB=(t,e,n)=>n>32?ige(t,e,n):rge(t,e,n);function yge(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=uB(l,u,1)^n[a],h=dB(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=M6[o],c=uB(s,i,a),l=dB(s,i,a),u=B6[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=mge[r],t[1]^=gge[r]}n.fill(0)}let vge=class U6 extends cge{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,yg(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=oge(this.state)}keccak(){cB||lB(this.state32),yge(this.state32,this.rounds),cB||lB(this.state32),this.posOut=0,this.pos=0}update(e){eT(this);const{blockLen:n,state:r}=this;e=L6(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){eT(this,!1),C1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return yg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(F6(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new U6(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const bge=(t,e,n)=>lge(()=>new vge(e,t,n)),fB=bge(1,136,256/8);function wge(t){if(!(t instanceof Uint8Array))throw new TypeError(`bytesToUtf8 expected Uint8Array, got ${typeof t}`);return new TextDecoder().decode(t)}function xge(t){return e=>(Jme.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const V6=(()=>{const t=xge(fB);return t.create=fB.create,t})();function zN(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}function bg(...t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const Ige="Warning: Using type `number` with values that are large or contain many decimals may cause loss of precision, it is recommended to use type `string` or `BigInt` when using conversion methods",Zu=t=>{if(Me.validate(["bytes"],[t]),zN(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Sge}=Ai,a0=t=>Sge(Zu(t)),j6=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?Zu(`0x${t}`):Zu(t),kge=t=>(Me.validate(["hex"],[t]),wd(t)),wm=(t,e)=>{typeof t!="bigint"&&Me.validate(["int"],[t]);let n=Dl(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},hB=t=>{Me.validate(["string"],[t]);let e=t.replace(/^(?:\u0000)/,"");return e=e.replace(/(?:\u0000)$/,""),a0(new TextEncoder().encode(e))},Ege=t=>wge(j6(t)),H6=vg,Cge=(t,e)=>{if(typeof t=="string"&&mr(t))return e?"address":`0x${t.toLowerCase().replace(/^0x/i,"")}`;if(typeof t=="boolean")return e?"bool":t?"0x01":"0x00";if(typeof t=="number")return e?t<0?"int256":"uint256":wm(t);if(typeof t=="bigint")return e?"bigint":wm(t);if(zN(t))return e?"bytes":a0(t);if(typeof t=="object"&&t)return e?"string":hB(JSON.stringify(t));if(typeof t=="string"){if(t.startsWith("-0x")||t.startsWith("-0X"))return e?"int256":wm(t);if(pt(t))return e?"bytes":t;if(zo(t)&&!fc(t)&&!ki(t))return e?"bytes":`0x${t}`;if(zo(t)&&!fc(t)&&ki(t))return e?"uint":wm(t);if(!Number.isFinite(t))return e?"string":hB(t)}throw new iN(t)},W6=t=>{if(typeof t=="number")return t>1e20?(console.warn(Ige),BigInt(t)):t;if(typeof t=="bigint")return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?Number(t):t;if(typeof t=="string"&&pt(t))return kge(t);try{return W6(BigInt(t))}catch{throw new Pl(t)}},xm=t=>{if(typeof t=="number")return BigInt(t);if(typeof t=="bigint")return t;if(typeof t=="string"&&zo(t))return t.startsWith("-")?-BigInt(t.substring(1)):BigInt(t);throw new Pl(t)},G6=t=>{if(!mr(t,!1))throw new vd(t);const e=t.toLowerCase().replace(/^0x/i,""),n=Ur(V6(Go(H6(e))));if(oe(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let r="0x";const s=n.replace(/^0x/i,"");for(let i=0;i<e.length;i+=1)parseInt(s[i],16)>7?r+=e[i].toUpperCase():r+=e[i];return r},Tge=t=>{if(typeof t=="boolean")return t;if(typeof t=="number"&&(t===0||t===1)||typeof t=="bigint"&&(t===BigInt(0)||t===BigInt(1)))return!!t;if(typeof t=="string"&&!pt(t)&&(t==="1"||t==="0"||t==="false"||t==="true"))return t==="true"?!0:t==="false"?!1:!!Number(t);if(typeof t=="string"&&pt(t)&&(t==="0x1"||t==="0x0"))return!!W6(t);throw new e0(t)},tT=t=>typeof t=="object"&&!oe(t)&&Object.keys(t).length!==0&&["input","data","from","gas","gasPrice","gasLimit","address","jsonInterface","syncWithContext","dataInputFill"].some(e=>e in t),Yr=oe,pB=t=>typeof t=="object"&&!oe(t)&&!Array.isArray(t)&&!(t instanceof wc),jh=(t,...e)=>{if(!pB(t))return t;const n=Object.assign({},t);for(const r of e)for(const s in r)pB(r[s])?(n[s]||(n[s]={}),n[s]=jh(n[s],r[s])):!oe(r[s])&&Object.hasOwnProperty.call(r,s)&&(Array.isArray(r[s])||r[s]instanceof wc?n[s]=r[s].slice(0):n[s]=r[s]);return n},q6=(t,e,n="0")=>typeof t=="string"?pt(t)?so(t,e,n):t.padStart(e,n):(Me.validate(["int"],[t]),so(t,e,n)),{parseBaseType:Age}=Ai,uf=t=>typeof t=="object"&&!oe(t)&&"number"in t&&"bytes"in t,Nge=(t,e,n=[])=>{let r=Object.assign({},t),s;for(const i of e){if(r.oneOf&&s){const o=s,a=n.find(([c])=>c===o);a&&a[0]===s&&(r=r.oneOf[a[1]])}if(!r.properties&&!r.items)return;r.properties?r=r.properties[i]:r.items&&r.items.properties?r=r.items.properties[i]:r.items&&Rn(r.items)?r=r.items:r.items&&Array.isArray(r.items)&&(r=r.items[parseInt(i,10)]),r&&i&&(s=i)}return r},Uw=(t,e,n)=>{try{const{baseType:r,baseTypeSize:s}=Age(e);if(r==="int"||r==="uint")switch(n.number){case _n.NUMBER:return Number(xm(t));case _n.HEX:return wm(xm(t));case _n.STR:return xm(t).toString();case _n.BIGINT:return xm(t);default:throw new ro(`Invalid format: ${String(n.number)}`)}if(r==="bytes"){let i;switch(s?typeof t=="string"?i=q6(t,s*2):zN(t)&&(i=bg(new Uint8Array(s-t.length),t)):i=t,n.bytes){case Es.HEX:return a0(Zu(i));case Es.UINT8ARRAY:return Zu(i);default:throw new ro(`Invalid format: ${String(n.bytes)}`)}}if(r==="string")return String(t)}catch{return t}return t},mB=({value:t,schemaProp:e,schema:n,object:r,key:s,dataPath:i,format:o,oneOfPath:a=[]})=>{var c,l;if(Array.isArray(t)){let u=e;if(e?.oneOf!==void 0&&e.oneOf.forEach((d,h)=>{var m,g;!Array.isArray(e?.items)&&(typeof t[0]=="object"&&((m=d?.items)===null||m===void 0?void 0:m.type)==="object"||typeof t[0]=="string"&&((g=d?.items)===null||g===void 0?void 0:g.type)!=="object")&&(u=d,a.push([s,h]))}),oe(u?.items))return delete r[s],i.pop(),!0;if(Rn(u.items)&&!oe(u.items.format)){for(let d=0;d<t.length;d+=1)r[s][d]=Uw(t[d],(c=u?.items)===null||c===void 0?void 0:c.format,o);return i.pop(),!0}if(!Array.isArray(u?.items)&&((l=u?.items)===null||l===void 0?void 0:l.type)==="object"){for(const d of t)UN(d,n,i,o,a);return i.pop(),!0}if(Array.isArray(u?.items)){for(let d=0;d<t.length;d+=1)r[s][d]=Uw(t[d],u.items[d].format,o);return i.pop(),!0}}return!1},UN=(t,e,n,r,s=[])=>{var i;if(!Rn(t)&&!Array.isArray(t))return Uw(t,e?.format,r);const o=t;if(Array.isArray(o)&&e?.type==="array"&&((i=e?.items)===null||i===void 0?void 0:i.type)==="object")mB({value:o,schemaProp:e,schema:e,object:o,key:"",dataPath:n,format:r,oneOfPath:s});else for(const[a,c]of Object.entries(o)){n.push(a);let l=Nge(e,n,s);if(oe(l)){delete o[a],n.pop();continue}if(Rn(c)){UN(c,e,n,r,s),n.pop();continue}if(!mB({value:c,schemaProp:l,schema:e,object:o,key:a,dataPath:n,format:r,oneOfPath:s})){if(l?.format===void 0&&l?.oneOf!==void 0){for(const[u,d]of l.oneOf.entries())if(d?.format!==void 0){l=d;break}}o[a]=Uw(c,l.format,r),n.pop()}}return o},Vf=(t,e,n=Fr)=>{let r;Rn(e)?r=jh({},e):Array.isArray(e)?r=[...e]:r=e;const s=Rn(t)?t:Lh(t);if(!s.properties&&!s.items&&!s.format)throw new ro("Invalid json schema for formatting");return UN(r,s,[],n)},K6="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",VN=t=>{let e;return typeof t=="bigint"||typeof t=="number"?e=vg(t.toString()):Array.isArray(t)?e=new Uint8Array(t):typeof t=="string"&&!pt(t)?e=vg(t):e=Zu(t),a0(V6(Go(e)))},_ge=t=>{let e;typeof t=="string"?t.startsWith("0x")&&pt(t)?e=j6(t):e=vg(t):e=t;const n=VN(e);return n===K6?void 0:n},jN=t=>{const e=_ge(t);return oe(e)?K6:e},HN=t=>!Yr(t)&&typeof t=="object"&&!Yr(t.type)&&t.type==="error",WN=t=>!Yr(t)&&typeof t=="object"&&!Yr(t.type)&&t.type==="event",GN=t=>!Yr(t)&&typeof t=="object"&&!Yr(t.type)&&t.type==="function",$ge=t=>!Yr(t)&&typeof t=="object"&&!Yr(t.type)&&t.type==="constructor",Rge=t=>typeof t=="object"&&typeof t.components>"u"&&typeof t.name>"u",X6=t=>t.includes("[]")?{type:"tuple[]",name:t.slice(0,-2)}:{type:"tuple",name:t},Q6=t=>{const e=[];for(const n of Object.keys(t)){const r=t[n];typeof r=="object"?e.push(Object.assign(Object.assign({},X6(n)),{components:Q6(r)})):e.push({name:n,type:t[n]})}return e},nT=(t,e)=>{const n=[];return e.forEach(r=>{if(typeof r.components=="object"){if(!r.type.startsWith("tuple"))throw new Oe(`Invalid value given "${r.type}". Error: components found but type is not tuple.`);const s=r.type.indexOf("["),i=s>=0?r.type.substring(s):"",o=nT(t,r.components);n.push(`(${o.join(",")})${i}`)}else n.push(r.type)}),n},sc=t=>{var e,n,r,s;return HN(t)||WN(t)||GN(t)?!((e=t.name)===null||e===void 0)&&e.includes("(")?t.name:`${(n=t.name)!==null&&n!==void 0?n:""}(${nT(!1,(r=t.inputs)!==null&&r!==void 0?r:[]).join(",")})`:`(${nT(!1,(s=t.inputs)!==null&&s!==void 0?s:[]).join(",")})`},Oge=t=>{if(typeof t!="string"&&!HN(t))throw new Oe("Invalid parameter value in encodeErrorSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=sc(t):e=t,jN(e)},Y6=t=>{if(typeof t!="string"&&!WN(t))throw new Oe("Invalid parameter value in encodeEventSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=sc(t):e=t,jN(e)};function qN(t,e){return t.exec(e)?.groups}var Z6=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,J6=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,e5=/^\(.+?\).*?$/,Pge=Object.defineProperty,Dge=(t,e,n)=>e in t?Pge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,im=(t,e,n)=>(Dge(t,typeof e!="symbol"?e+"":e,n),n),Fge="abitype",Lge="0.7.1",qs=class extends Error{constructor(e,n={}){const r=n.cause instanceof qs?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof qs&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: ${Fge}@${Lge}`].join(`
`);super(i),im(this,"details"),im(this,"docsPath"),im(this,"metaMessages"),im(this,"shortMessage"),im(this,"name","AbiTypeError"),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}},t5=/^struct (?<name>[a-zA-Z0-9_]+) \{(?<properties>.*?)\}$/;function n5(t){return t5.test(t)}function Bge(t){return qN(t5,t)}var gB=new Set(["memory","indexed","storage","calldata"]),Mge=new Set(["calldata","memory","storage"]);function zge(t,e){return e?`${e}:${t}`:t}var f2=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]),Uge=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,Vge=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,jge=/^u?int$/;function Vw(t,e){const n=zge(t,e?.type);if(f2.has(n))return f2.get(n);const r=e5.test(t),s=qN(r?Vge:Uge,t);if(!s)throw new qs("Invalid ABI parameter.",{details:t});if(s.name&&Wge(s.name))throw new qs("Invalid ABI parameter.",{details:t,metaMessages:[`"${s.name}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,l={};if(r){c="tuple";const d=Ef(s.type),h=[],m=d.length;for(let g=0;g<m;g++)h.push(Vw(d[g],{structs:a}));l={components:h}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(jge.test(s.type))c=`${s.type}256`;else if(c=s.type,e?.type!=="struct"&&!r5(c))throw new qs("Unknown type.",{metaMessages:[`Type "${c}" is not a valid ABI type.`]});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new qs("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`]});if(Mge.has(s.modifier)&&!Gge(c,!!s.array))throw new qs("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${s.modifier}" was given.`]})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return f2.set(n,u),u}function Ef(t,e=[],n="",r=0){if(t===""){if(n==="")return e;if(r!==0)throw new qs("Unbalanced parentheses.",{metaMessages:[`"${n.trim()}" has too many ${r>0?"opening":"closing"} parentheses.`],details:`Depth "${r}"`});return[...e,n.trim()]}const s=t.length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?Ef(a,[...e,n.trim()]):Ef(a,e,`${n}${o}`,r);case"(":return Ef(a,e,`${n}${o}`,r+1);case")":return Ef(a,e,`${n}${o}`,r-1);default:return Ef(a,e,`${n}${o}`,r)}}return[]}function r5(t){return t==="address"||t==="bool"||t==="function"||t==="string"||Z6.test(t)||J6.test(t)}var Hge=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function Wge(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||Z6.test(t)||J6.test(t)||Hge.test(t)}function Gge(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function qge(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!n5(a))continue;const c=Bge(a);if(!c)throw new qs("Invalid struct signature.",{details:a});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const g=l[h].trim();if(!g)continue;const v=Vw(g,{type:"struct"});u.push(v)}if(!u.length)throw new qs("Invalid struct signature.",{details:a,metaMessages:["No properties exist."]});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=s5(c,e)}return r}var Kge=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?$/;function s5(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(e5.test(o.type))r.push(o);else{const c=qN(Kge,o.type);if(!c?.type)throw new qs("Invalid ABI parameter.",{details:JSON.stringify(o,null,2),metaMessages:["ABI parameter type is invalid."]});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new qs("Circular reference detected.",{metaMessages:[`Struct "${u}" is a circular reference.`]});r.push({...o,type:`tuple${l??""}`,components:s5(e[u]??[],e,new Set([...n,u]))})}else if(r5(u))r.push(o);else throw new qs("Unknown type.",{metaMessages:[`Type "${u}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]})}}return r}function Xge(t){let e;if(typeof t=="string")e=Vw(t,{modifiers:gB});else{const n=qge(t),r=t.length;for(let s=0;s<r;s++){const i=t[s];if(!n5(i)){e=Vw(i,{modifiers:gB,structs:n});break}}}if(!e)throw new qs("Failed to parse ABI parameter.",{details:`parseAbiParameter(${JSON.stringify(t,null,2)})`,docsPath:"/api/human.html#parseabiparameter-1"});return e}const Wn=32;function rT(t=0){var e;if(((e=globalThis.Buffer)===null||e===void 0?void 0:e.alloc)!==void 0){const n=globalThis.Buffer.alloc(t);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}return new Uint8Array(t)}function i5(t){var e,n;return Object.assign(Object.assign({},t),{name:(e=t.name)!==null&&e!==void 0?e:"",components:(n=t.components)===null||n===void 0?void 0:n.map(r=>i5(r))})}function Qge(t){return!Yr(t)&&typeof t=="object"&&!Yr(t.type)&&typeof t.type=="string"}function o5(t){return t.map(e=>{var n;if(Qge(e))return e;if(typeof e=="string")return i5(Xge(e.replace(/tuple/,"")));if(Rge(e)){const r=Object.keys(e)[0],s=X6(r);return s.name=(n=s.name)!==null&&n!==void 0?n:"",Object.assign(Object.assign({},s),{components:Q6(e[r])})}throw new Oe("Invalid abi")})}function KN(t){const e=t.type.lastIndexOf("["),n=t.type.substring(0,e),r=t.type.substring(e);let s=-1;if(r!=="[]"&&(s=Number(r.slice(1,-1)),isNaN(s)))throw new Oe("Invalid fixed array size",{size:r});return{param:{type:n,name:"",components:t.components},size:s}}function jw(t){var e,n;return t.type==="string"||t.type==="bytes"||t.type.endsWith("[]")?!0:t.type==="tuple"?(n=(e=t.components)===null||e===void 0?void 0:e.some(jw))!==null&&n!==void 0?n:!1:t.type.endsWith("]")?jw(KN(t).param):!1}const a5=20,c5=Wn-a5;function Yge(t,e){if(typeof e!="string")throw new Oe("address type expects string as input type",{value:e,name:t.name,type:t.type});let n=e.toLowerCase();if(n.startsWith("0x")||(n=`0x${n}`),!mr(n))throw new Oe("provided input is not valid address",{value:e,name:t.name,type:t.type});const r=kr(n),s=rT(Wn);return s.set(r,c5),{dynamic:!1,encoded:s}}function Zge(t,e){const n=e.subarray(c5,Wn);if(n.length!==a5)throw new Oe("Invalid decoding input, not enough bytes to decode address",{bytes:e});const r=Ur(n);return{result:G6(r),encoded:e.subarray(Wn),consumed:Wn}}const xl=new Map;let ib=BigInt(256);for(let t=8;t<=256;t+=8)xl.set(`uint${t}`,{min:BigInt(0),max:ib-BigInt(1)}),xl.set(`int${t}`,{min:-ib/BigInt(2),max:ib/BigInt(2)-BigInt(1)}),ib*=BigInt(256);xl.set("int",xl.get("int256"));xl.set("uint",xl.get("uint256"));const l5=BigInt(1)<<BigInt(256);function Jge(t,e=Wn){let n;return t<0?n=(l5+t).toString(16):n=t.toString(16),n=q6(n,e*2),kr(n)}function e0e(t,e){const n=Ur(t),r=BigInt(n);return r<=e?r:r-l5}function c0(t,e){let n;try{n=xm(e)}catch{throw new Oe("provided input is not number value",{type:t.type,value:e,name:t.name})}const r=xl.get(t.type);if(!r)throw new Oe("provided abi contains invalid number datatype",{type:t.type});if(n<r.min)throw new Oe("provided input is less then minimum for given type",{type:t.type,value:e,name:t.name,minimum:r.min.toString()});if(n>r.max)throw new Oe("provided input is greater then maximum for given type",{type:t.type,value:e,name:t.name,maximum:r.max.toString()});return{dynamic:!1,encoded:Jge(n)}}function fh(t,e){if(e.length<Wn)throw new Oe("Not enough bytes left to decode",{param:t,bytesLeft:e.length});const n=e.subarray(0,Wn),r=xl.get(t.type);if(!r)throw new Oe("provided abi contains invalid number datatype",{type:t.type});const s=e0e(n,r.max);if(s<r.min)throw new Oe("decoded value is less then minimum for given type",{type:t.type,value:s,name:t.name,minimum:r.min.toString()});if(s>r.max)throw new Oe("decoded value is greater then maximum for given type",{type:t.type,value:s,name:t.name,maximum:r.max.toString()});return{result:s,encoded:e.subarray(Wn),consumed:Wn}}function t0e(t,e){let n;try{n=Tge(e)}catch(r){if(r instanceof e0)throw new Oe("provided input is not valid boolean value",{type:t.type,value:e,name:t.name})}return c0({type:"uint8",name:""},Number(n))}function n0e(t,e){const n=fh({type:"uint8",name:""},e);if(n.result>1||n.result<0)throw new Oe("Invalid boolean value encoded",{boolBytes:e.subarray(0,Wn),numberResult:n});return{result:n.result===BigInt(1),encoded:n.encoded,consumed:Wn}}const r0e=32;function u5(t,e){if(typeof e=="string"&&e.length%2!==0&&(e+="0"),!xc(e))throw new Oe("provided input is not valid bytes value",{type:t.type,value:e,name:t.name});const n=Zu(e),[,r]=t.type.split("bytes");if(r){if(Number(r)>r0e||Number(r)<1)throw new Oe("invalid bytes type. Static byte type can have between 1 and 32 bytes",{type:t.type});if(Number(r)<n.length)throw new Oe("provided input size is different than type size",{type:t.type,value:e,name:t.name});const o=rT(Wn);return o.set(n),{dynamic:!1,encoded:o}}const s=Math.ceil(n.length/Wn),i=rT(Wn+s*Wn);return i.set(c0({type:"uint32",name:""},n.length).encoded),i.set(n,Wn),{dynamic:!0,encoded:i}}function d5(t,e){const[,n]=t.type.split("bytes");let r=Number(n),s=e,i=1,o=0;if(!r){const a=fh({type:"uint32",name:""},s);r=Number(a.result),o+=a.consumed,s=a.encoded,i=Math.ceil(r/Wn)}if(r>e.length)throw new Oe("there is not enough data to decode",{type:t.type,encoded:e,size:r});return{result:a0(s.subarray(0,r)),encoded:s.subarray(i*Wn),consumed:o+i*Wn}}function s0e(t,e){if(typeof e!="string")throw new Oe("invalid input, should be string",{input:e});const n=H6(e);return u5({type:"bytes",name:""},n)}function i0e(t,e){const n=d5({type:"bytes"},e);return{result:Ege(n.result),encoded:n.encoded,consumed:n.consumed}}function f5(t){let e=0,n=0;const r=[],s=[];for(const i of t)i.dynamic?e+=Wn:e+=i.encoded.length;for(const i of t)i.dynamic?(r.push(c0({type:"uint256",name:""},e+n)),s.push(i),n+=i.encoded.length):r.push(i);return bg(...r.map(i=>i.encoded),...s.map(i=>i.encoded))}function o0e(t,e){if(!Array.isArray(e))throw new Oe("Expected value to be array",{abi:t,values:e});const{size:n,param:r}=KN(t),s=e.map(a=>sT(r,a)),i=n===-1,o=s.length>0&&s[0].dynamic;if(!i&&e.length!==n)throw new Oe("Given arguments count doesn't match array length",{arrayLength:n,argumentsLength:e.length});if(i||o){const a=f5(s);if(i){const c=c0({type:"uint256",name:""},s.length).encoded;return{dynamic:!0,encoded:s.length>0?bg(c,a):c}}return{dynamic:!0,encoded:a}}return{dynamic:!1,encoded:bg(...s.map(a=>a.encoded))}}function a0e(t,e){let{size:n,param:r}=KN(t);const s=n===-1;let i=0;const o=[];let a=e;if(s){const l=fh({type:"uint32",name:""},e);n=Number(l.result),i=l.consumed,a=l.encoded}if(jw(r)){for(let l=0;l<n;l+=1){const u=fh({type:"uint32",name:""},a.subarray(l*Wn));i+=u.consumed;const d=Hw(r,a.subarray(Number(u.result)));i+=d.consumed,o.push(d.result)}return{result:o,encoded:a.subarray(i),consumed:i}}for(let l=0;l<n;l+=1){const u=Hw(r,e.subarray(i));i+=u.consumed,o.push(u.result)}return{result:o,encoded:e.subarray(i),consumed:i}}function sT(t,e){if(t.type==="string")return s0e(t,e);if(t.type==="bool")return t0e(t,e);if(t.type==="address")return Yge(t,e);if(t.type==="tuple")return XN(t,e);if(t.type.endsWith("]"))return o0e(t,e);if(t.type.startsWith("bytes"))return u5(t,e);if(t.type.startsWith("uint")||t.type.startsWith("int"))return c0(t,e);throw new Oe("Unsupported",{param:t,value:e})}function Hw(t,e){if(t.type==="string")return i0e(t,e);if(t.type==="bool")return n0e(t,e);if(t.type==="address")return Zge(t,e);if(t.type==="tuple")return h5(t,e);if(t.type.endsWith("]"))return a0e(t,e);if(t.type.startsWith("bytes"))return d5(t,e);if(t.type.startsWith("uint")||t.type.startsWith("int"))return fh(t,e);throw new Oe("Unsupported",{param:t,bytes:e})}function XN(t,e){var n,r,s;let i=!1;if(!Array.isArray(e)&&typeof e!="object")throw new Oe("param must be either Array or Object",{param:t,input:e});const o=e,a=[];for(let c=0;c<((r=(n=t.components)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0);c+=1){const l=t.components[c];let u;if(Array.isArray(o)){if(c>=o.length)throw new Oe("input param length missmatch",{param:t,input:e});u=sT(l,o[c])}else{const d=o[(s=l.name)!==null&&s!==void 0?s:""];if(d==null)throw new Oe("missing input defined in abi",{param:t,input:e,paramName:l.name});u=sT(l,d)}u.dynamic&&(i=!0),a.push(u)}return i?{dynamic:!0,encoded:f5(a)}:{dynamic:!1,encoded:bg(...a.map(c=>c.encoded))}}function h5(t,e){const n={__length__:0};let r=0;if(!t.components)return{result:n,encoded:e,consumed:r};let s=0;for(const[i,o]of t.components.entries()){let a;if(jw(o)){const c=fh({type:"uint32",name:""},e.subarray(r));a=Hw(o,e.subarray(Number(c.result))),r+=c.consumed,s+=a.consumed}else a=Hw(o,e.subarray(r)),r+=a.consumed;n.__length__+=1,n[i]=a.result,o.name&&o.name!==""&&(n[o.name]=a.result)}return{encoded:e.subarray(r+s),result:n,consumed:r+s}}function c0e(t,e,n){const r=o5(t),s=kr(e);return h5({components:r},s).result}function p5(t){const e=[];return t.forEach(n=>{if(Array.isArray(n)){const r=p5(n);e.push({type:"tuple",components:r,name:""})}else e.push({type:Cge(n,!0)})}),e}function m5(t,e){if(t?.length!==e.length)throw new Oe("Invalid number of values received for given ABI",{expected:t?.length,received:e.length});const n=o5(t);return Ur(XN({type:"tuple",name:"",components:n},e).encoded)}function l0e(t){try{const e=p5(t);return Ur(XN({type:"tuple",name:"",components:e},t).encoded)}catch{throw new Oe("Could not infer types from given params",{params:t})}}const yB=(t,e)=>m5([t],[e]),u0e=(t,e,n)=>{try{if(t.length>0&&(!e||e==="0x"||e==="0X"))throw new Oe("Returned values aren't valid, did it run Out of Gas? You might also see this error if you are not using the correct ABI for the contract you are retrieving data from, requesting data from a block number that does not exist, or querying a node which is not fully synced.");return c0e(t,`0x${e.replace(/0x/i,"")}`,n)}catch(r){throw new Oe(`Parameter decoding error: ${r.message}`,{internalErr:r})}},Bm=(t,e)=>u0e(t,e,!1),iT=t=>{if(typeof t!="string"&&!GN(t))throw new Oe("Invalid parameter value in encodeFunctionSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=sc(t):e=t,jN(e).slice(0,10)},oT=(t,e,n=!0)=>{const r=n&&e&&e.length>=10&&e.startsWith("0x")?e.slice(10):e;if(!t.inputs)throw new ks("No inputs found in the ABI");const s=Bm([...t.inputs],r);return Object.assign(Object.assign({},s),{__method__:sc(t)})},d0e=(t,e)=>{if(t.type==="constructor")return e;if(!e)return null;const n=e.length>=2?e.slice(2):e;if(!t.outputs)return null;const r=Bm([...t.outputs],n);return r.__length__===1?r[0]:r},h2=(t,e)=>{if(e?.data){let n,r,s;try{const i=e.data.slice(0,10),o=t.find(a=>Oge(a).startsWith(i));o?.inputs?(n=o.name,r=sc(o),s=Bm([...o.inputs],e.data.substring(10))):e.data.startsWith("0x08c379a0")?(n="Error",r="Error(string)",s=Bm([{name:"message",type:"string"}],e.data.substring(10))):e.data.startsWith("0x4e487b71")?(n="Panic",r="Panic(uint256)",s=Bm([{name:"code",type:"uint256"}],e.data.substring(10))):console.error("No matching error abi found for error data",e.data)}catch(i){console.error(i)}n&&e.setDecodedProperties(n,r,s)}},vB=({address:t},e,n)=>{var r,s;const i=n?.topics,o=(r=n?.filter)!==null&&r!==void 0?r:{},a={};if(Yr(n?.fromBlock)||(a.fromBlock=Vf(Dw.properties.number,n?.fromBlock,{number:_n.HEX,bytes:Es.HEX})),Yr(n?.toBlock)||(a.toBlock=Vf(Dw.properties.number,n?.toBlock,{number:_n.HEX,bytes:Es.HEX})),i&&Array.isArray(i))a.topics=[...i];else if(a.topics=[],e&&!e.anonymous&&![uh,"allEvents"].includes(e.name)&&a.topics.push((s=e.signature)!==null&&s!==void 0?s:Y6(sc(e))),![uh,"allEvents"].includes(e.name)&&e.inputs)for(const c of e.inputs){if(!c.indexed)continue;const l=o[c.name];if(!l){a.topics.push(null);continue}Array.isArray(l)?a.topics.push(l.map(u=>yB(c.type,u))):c.type==="string"?a.topics.push(VN(l)):a.topics.push(yB(c.type,l))}return a.topics.length||delete a.topics,t&&(a.address=t.toLowerCase()),a},Mm=(t,e,n)=>{const r=Array.isArray(t.inputs)?t.inputs.length:0;if(t.inputs&&r!==e.length)throw new ks(`The number of arguments is not matching the methods required number. You need to pass ${r} arguments.`);let s;if(t.inputs?s=m5(Array.isArray(t.inputs)?t.inputs:[],e).replace("0x",""):s=l0e(e).replace("0x",""),$ge(t)){if(!n)throw new ks("The contract has no contract data option set. This is necessary to append the constructor parameters.");return n.startsWith("0x")?`${n}${s}`:`0x${n}${s}`}return`${iT(t)}${s}`};class g5 extends r0{constructor(e,n){super(e,n),this.address=e.address,this.topics=e.topics,this.abi=e.abi,this.jsonInterface=e.jsonInterface}_buildSubscriptionParams(){return["logs",{address:this.address,topics:this.topics}]}formatSubscriptionResult(e){return DN(this.abi,e,this.jsonInterface,super.returnFormat)}}Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));const T1=(t,e,n,r)=>{var s,i;const o={};return(!Yr(t.data)||r==="both")&&(o.data=Mm(e,n,(s=t.data)!==null&&s!==void 0?s:t.input)),(!Yr(t.input)||r==="both")&&(o.input=Mm(e,n,(i=t.input)!==null&&i!==void 0?i:t.data)),Yr(o.input)&&Yr(o.data)&&(o[r]=Mm(e,n)),{data:o.data,input:o.input}},aT=({abi:t,params:e,options:n,contractOptions:r})=>{var s,i,o;if(!((o=(i=(s=n?.input)!==null&&s!==void 0?s:n?.data)!==null&&i!==void 0?i:r.input)!==null&&o!==void 0?o:r.data)&&!n?.to&&!r.address)throw new ks("Contract address not specified");if(!n?.from&&!r.from)throw new ks('Contract "from" address not specified');let c=jh({to:r.address,gas:r.gas,gasPrice:r.gasPrice,from:r.from,input:r.input,maxPriorityFeePerGas:r.maxPriorityFeePerGas,maxFeePerGas:r.maxFeePerGas,data:r.data},n);const l=T1(c,t,e,n?.dataInputFill);return c=Object.assign(Object.assign({},c),{data:l.data,input:l.input}),c},f0e=({abi:t,params:e,options:n,contractOptions:r})=>{if(!n?.to&&!r.address)throw new ks("Contract address not specified");let s=jh({to:r.address,gas:r.gas,gasPrice:r.gasPrice,from:r.from,input:r.input,maxPriorityFeePerGas:r.maxPriorityFeePerGas,maxFeePerGas:r.maxFeePerGas,data:r.data},n);const i=T1(s,t,e,n?.dataInputFill);return s=Object.assign(Object.assign({},s),{data:i.data,input:i.input}),s},h0e=({abi:t,params:e,options:n,contractOptions:r})=>{let s=jh({to:r.address,gas:r.gas,gasPrice:r.gasPrice,from:r.from,input:r.input,data:r.data},n);const i=T1(s,t,e,n?.dataInputFill);return s=Object.assign(Object.assign({},s),{data:i.data,input:i.input}),s},bB=t=>typeof t=="object"&&!Yr(t)&&Object.keys(t).length!==0&&!tT(t),p0e=({abi:t,params:e,options:n,contractOptions:r})=>{if(!n?.to&&!r.address)throw new ks("Contract address not specified");if(!n?.from&&!r.from)throw new ks('Contract "from" address not specified');let s=jh({to:r.address,gas:r.gas,gasPrice:r.gasPrice,from:r.from,input:r.input,maxPriorityFeePerGas:r.maxPriorityFeePerGas,maxFeePerGas:r.maxFeePerGas,data:r.data},n);const i=T1(s,t,e,n?.dataInputFill);return s=Object.assign(Object.assign({},s),{data:i.data,input:i.input}),s};var m0e=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class g0e{_contractMethodDeploySend(e){const n={transactionResolver:r=>{if(r.status===BigInt(0))throw new ks("code couldn't be stored",r);const s=this.parent.clone();return s.options.address=r.contractAddress,s},contractAbi:this.parent.options.jsonInterface,checkRevertBeforeSending:!1};return oe(this.parent.getTransactionMiddleware())?gg(this.parent,e,this.parent.defaultReturnFormat,n):gg(this.parent,e,this.parent.defaultReturnFormat,n,this.parent.getTransactionMiddleware())}constructor(e,n){this.parent=e,this.deployOptions=n;const{args:r,abi:s,contractOptions:i,deployData:o}=this.calculateDeployParams();this.args=r,this.constructorAbi=s,this.contractOptions=i,this.deployData=o}send(e){const n=Object.assign({},e),r=this.populateTransaction(n);return this._contractMethodDeploySend(r)}populateTransaction(e){var n,r;const s=Object.assign(Object.assign({},this.contractOptions),{from:(r=(n=this.contractOptions.from)!==null&&n!==void 0?n:this.parent.defaultAccount)!==null&&r!==void 0?r:void 0}),i=aT({abi:this.constructorAbi,params:this.args,options:Object.assign(Object.assign({},e),{dataInputFill:this.parent.contractDataInputFill}),contractOptions:s});return i.dataInputFill&&delete i.dataInputFill,i}calculateDeployParams(){var e,n,r,s,i,o;let a=this.parent.options.jsonInterface.find(m=>m.type==="constructor");a||(a={type:"constructor",stateMutability:""});const c=Vf({format:"bytes"},(n=(e=this.deployOptions)===null||e===void 0?void 0:e.input)!==null&&n!==void 0?n:this.parent.options.input,Fr),l=Vf({format:"bytes"},(s=(r=this.deployOptions)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:this.parent.options.data,Fr);if((!c||c.trim()==="0x")&&(!l||l.trim()==="0x"))throw new ks("contract creation without any data provided.");const u=(o=(i=this.deployOptions)===null||i===void 0?void 0:i.arguments)!==null&&o!==void 0?o:[],d=Object.assign(Object.assign({},this.parent.options),{input:c,data:l});return{args:u,abi:a,contractOptions:d,deployData:c??l}}estimateGas(e){return m0e(this,arguments,void 0,function*(n,r=this.parent.defaultReturnFormat){const s=Object.assign({},n);return this.parent.contractMethodEstimateGas({abi:this.constructorAbi,params:this.args,returnFormat:r,options:s,contractOptions:this.contractOptions})})}encodeABI(){return Mm(this.constructorAbi,this.args,Vf({format:"bytes"},this.deployData,this.parent.defaultReturnFormat))}decodeData(e){return Object.assign(Object.assign({},oT(this.constructorAbi,e.replace(this.deployData,""),!1)),{__method__:this.constructorAbi.type})}}var y0e=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class v0e extends _w{constructor(e,n){super(e.requestManager,e.registeredSubscriptions),this.parentContract=n}subscribe(e,n){const r=Object.create(null,{subscribe:{get:()=>super.subscribe}});return y0e(this,arguments,void 0,function*(s,i,o=Fr){return r.subscribe.call(this,s,i??this.parentContract.options,o)})}}var uu=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const b0e={logs:g5,newHeads:zw,newBlockHeaders:zw};class Lu extends Xi{get subscriptionManager(){return this._subscriptionManager}constructor(e,n,r,s,i){var o,a,c;const l=tT(n)?n:tT(r)?r:void 0;let u;bB(n)?u=n:bB(r)?u=r:u=s;let d;if(typeof n=="object"&&"provider"in n?d=n.provider:typeof r=="object"&&"provider"in r?d=r.provider:typeof s=="object"&&"provider"in s?d=s.provider:d=Lu.givenProvider,super(Object.assign(Object.assign({},u),{provider:d,registeredSubscriptions:b0e})),this.syncWithContext=!1,this._functions={},this._subscriptionManager=new v0e(super.subscriptionManager,this),u?.wallet&&(this._wallet=u.wallet),u?.accountProvider&&(this._accountProvider=u.accountProvider),!oe(l)&&!oe(l.data)&&!oe(l.input)&&this.config.contractDataInputFill!=="both")throw new Xie({data:l.data,input:l.input});this._overloadedMethodAbis=new Map;const h=uf(s)?s:uf(r)?r:i??this.defaultReturnFormat,m=typeof n=="string"?n:void 0;this.config.contractDataInputFill=(o=l?.dataInputFill)!==null&&o!==void 0?o:this.config.contractDataInputFill,this._parseAndSetJsonInterface(e,h),this.defaultReturnFormat!==h&&(this.defaultReturnFormat=h),oe(m)||this._parseAndSetAddress(m,h),this.options={address:m,jsonInterface:this._jsonInterface,gas:(a=l?.gas)!==null&&a!==void 0?a:l?.gasLimit,gasPrice:l?.gasPrice,from:l?.from,input:l?.input,data:l?.data},this.syncWithContext=(c=l?.syncWithContext)!==null&&c!==void 0?c:!1,u instanceof Xi&&this.subscribeToContextEvents(u),Object.defineProperty(this.options,"address",{set:g=>this._parseAndSetAddress(g,h),get:()=>this._address}),Object.defineProperty(this.options,"jsonInterface",{set:g=>this._parseAndSetJsonInterface(g,h),get:()=>this._jsonInterface}),u instanceof Xi&&u.on(Ku.CONFIG_CHANGE,g=>{this.setConfig({[g.name]:g.newValue})})}setTransactionMiddleware(e){this.transactionMiddleware=e}getTransactionMiddleware(){return this.transactionMiddleware}get events(){return this._events}get methods(){return this._methods}clone(){let e;return this.options.address?e=new Lu([...this._jsonInterface,...this._errorsInterface],this.options.address,{gas:this.options.gas,gasPrice:this.options.gasPrice,from:this.options.from,input:this.options.input,data:this.options.data,provider:this.currentProvider,syncWithContext:this.syncWithContext,dataInputFill:this.config.contractDataInputFill},this.getContextObject()):e=new Lu([...this._jsonInterface,...this._errorsInterface],{gas:this.options.gas,gasPrice:this.options.gasPrice,from:this.options.from,input:this.options.input,data:this.options.data,provider:this.currentProvider,syncWithContext:this.syncWithContext,dataInputFill:this.config.contractDataInputFill},this.getContextObject()),this.context&&e.subscribeToContextEvents(this.context),e}deploy(e){return new g0e(this,e)}getPastEvents(e,n,r){return uu(this,void 0,void 0,function*(){var s;const i=typeof e=="string"?e:uh,o=typeof e!="string"&&!uf(e)?e:uf(n)?{}:n,a=uf(e)?e:uf(n)?n:r??this.defaultReturnFormat,c=i==="allEvents"||i===uh?KC:this._jsonInterface.find(w=>"name"in w&&w.name===i);if(!c)throw new ks(`Event ${String(i)} not found.`);const{fromBlock:l,toBlock:u,topics:d,address:h}=vB(this.options,c,o??{}),m=yield $6(this,{fromBlock:l,toBlock:u,topics:d,address:h},a),g=m?m.map(w=>typeof w=="string"?w:DN(c,w,this._jsonInterface,a)):[],v=(s=o?.filter)!==null&&s!==void 0?s:{},y=Object.keys(v);return y.length>0?g.filter(w=>typeof w=="string"?!0:y.every(x=>{var S;if(Array.isArray(v[x]))return v[x].some(E=>String(w.returnValues[x]).toUpperCase()===String(E).toUpperCase());const k=(S=c.inputs)===null||S===void 0?void 0:S.filter(E=>E.name===x)[0];return k?.indexed&&k.type==="string"&&VN(v[x])===String(w.returnValues[x])?!0:String(w.returnValues[x]).toUpperCase()===String(v[x]).toUpperCase()})):g})}_parseAndSetAddress(e,n=this.defaultReturnFormat){this._address=e&&G6(Vf({format:"address"},e,n))}decodeMethodData(e){const n=e.slice(0,10),s=this._jsonInterface.filter(i=>i.type!=="error").find(i=>n===iT(sc(i)));if(!s)throw new ks(`The ABI for the provided method signature ${n} was not found.`);return oT(s,e)}_parseAndSetJsonInterface(e,n=this.defaultReturnFormat){var r,s;this._functions={},this._methods={},this._events={};let i=[];const o=e.filter(c=>c.type!=="error"),a=e.filter(c=>HN(c));for(const c of o){const l=Object.assign(Object.assign({},c),{signature:""});if(GN(l)){const u=sc(l),d=iT(u);l.methodNameWithInputs=u,l.signature=d,l.constant=l.stateMutability==="view"||l.stateMutability==="pure"||l.constant,l.payable=l.stateMutability==="payable"||l.payable,this._overloadedMethodAbis.set(l.name,[...(r=this._overloadedMethodAbis.get(l.name))!==null&&r!==void 0?r:[],l]);const h=(s=this._overloadedMethodAbis.get(l.name))!==null&&s!==void 0?s:[],m=this._createContractMethod(h,a),g=this._createContractMethod(h,a,!0);this._functions[u]={signature:d,method:g},this._methods[l.name]=m,this._methods[u]=g,this._methods[d]=g}else if(WN(l)){const u=sc(l),d=Y6(u),h=this._createContractEvent(l,n);l.signature=d,(!(u in this._events)||l.name==="bound")&&(this._events[u]=h),this._events[l.name]=h,this._events[d]=h}i=[...i,l]}this._events.allEvents=this._createContractEvent(KC,n),this._jsonInterface=[...i],this._errorsInterface=a}_getAbiParams(e,n){var r;try{return Dm((r=e.inputs)!==null&&r!==void 0?r:[],n)}catch(s){throw new ks(`Invalid parameters for method ${e.name}: ${s.message}`)}}_createContractMethod(e,n,r=!1){const s=e[e.length-1];return(...i)=>{var o,a,c;let l;const u=(a=r?(o=this._overloadedMethodAbis.get(s.name))===null||o===void 0?void 0:o.filter(v=>v.signature===s.signature):this._overloadedMethodAbis.get(s.name))!==null&&a!==void 0?a:[];let d=u[0];const h=n,m=u.filter(v=>{var y;return((y=v.inputs)!==null&&y!==void 0?y:[]).length===i.length});if(u.length===1||m.length===0)l=this._getAbiParams(d,i),Me.validate((c=s.inputs)!==null&&c!==void 0?c:[],l);else{const v=[],y=[];for(const w of m)try{l=this._getAbiParams(w,i),Me.validate(w.inputs,l),y.push(w)}catch(x){v.push(x)}if(y.length===1?[d]=y:y.length>1&&([d]=y,console.warn(`Multiple methods found that is compatible with the given inputs.
	Found ${y.length} compatible methods: ${JSON.stringify(y.map(w=>`${w.methodNameWithInputs} (signature: ${w.signature})`))} 
	The first one will be used: ${d.methodNameWithInputs}`)),v.length===m.length)throw new sh(v)}const g={arguments:l,call:(v,y)=>uu(this,void 0,void 0,function*(){return this._contractMethodCall(d,l,h,v,y)}),send:v=>this._contractMethodSend(d,l,h,v),populateTransaction:(v,y)=>{var w,x;let S=y??this.options;S=Object.assign(Object.assign({},S),{input:void 0,from:(x=(w=S?.from)!==null&&w!==void 0?w:this.defaultAccount)!==null&&x!==void 0?x:void 0});const k=aT({abi:s,params:i,options:Object.assign(Object.assign({},v),{dataInputFill:this.config.contractDataInputFill}),contractOptions:S});return k.dataInputFill&&delete k.dataInputFill,k},estimateGas:(v,...y)=>uu(this,[v,...y],void 0,function*(w,x=this.defaultReturnFormat){return this.contractMethodEstimateGas({abi:d,params:l,returnFormat:x,options:w})}),encodeABI:()=>Mm(d,l),decodeData:v=>oT(d,v),createAccessList:(v,y)=>uu(this,void 0,void 0,function*(){return this._contractMethodCreateAccessList(d,l,h,v,y)})};return d.stateMutability==="payable",g}}_contractMethodCall(e,n,r,s,i){return uu(this,void 0,void 0,function*(){var o;const a=f0e({abi:e,params:n,options:Object.assign(Object.assign({},s),{dataInputFill:this.config.contractDataInputFill}),contractOptions:Object.assign(Object.assign({},this.options),{from:(o=this.options.from)!==null&&o!==void 0?o:this.config.defaultAccount})});try{const c=yield BN(this,a,i,this.defaultReturnFormat);return d0e(e,c)}catch(c){throw c instanceof Ou&&h2(r,c.cause),c}})}_contractMethodCreateAccessList(e,n,r,s,i){return uu(this,void 0,void 0,function*(){var o;const a=p0e({abi:e,params:n,options:Object.assign(Object.assign({},s),{dataInputFill:this.config.contractDataInputFill}),contractOptions:Object.assign(Object.assign({},this.options),{from:(o=this.options.from)!==null&&o!==void 0?o:this.config.defaultAccount})});try{return O6(this,a,i,this.defaultReturnFormat)}catch(c){throw c instanceof Ou&&h2(r,c.cause),c}})}_contractMethodSend(e,n,r,s,i){var o,a;let c=i??this.options;c=Object.assign(Object.assign({},c),{input:void 0,from:(a=(o=c.from)!==null&&o!==void 0?o:this.defaultAccount)!==null&&a!==void 0?a:void 0});const l=aT({abi:e,params:n,options:Object.assign(Object.assign({},s),{dataInputFill:this.config.contractDataInputFill}),contractOptions:c}),u=oe(this.transactionMiddleware)?gg(this,l,this.defaultReturnFormat,{checkRevertBeforeSending:!1,contractAbi:this._jsonInterface}):gg(this,l,this.defaultReturnFormat,{checkRevertBeforeSending:!1,contractAbi:this._jsonInterface},this.transactionMiddleware);return u.on("error",d=>{d instanceof Ou&&h2(r,d.cause)}),u}contractMethodEstimateGas(e){return uu(this,arguments,void 0,function*({abi:n,params:r,returnFormat:s,options:i,contractOptions:o}){const a=h0e({abi:n,params:r,options:Object.assign(Object.assign({},i),{dataInputFill:this.config.contractDataInputFill}),contractOptions:o??this.options});return MN(this,a,tc.LATEST,s??this.defaultReturnFormat)})}_createContractEvent(e,n=this.defaultReturnFormat){return(...r)=>{var s;const{topics:i,fromBlock:o}=vB(this.options,e,r[0]),a=new g5({address:this.options.address,topics:i,abi:e,jsonInterface:this._jsonInterface},{subscriptionManager:this.subscriptionManager,returnFormat:n});return oe(o)||this.getPastEvents(e.name,{fromBlock:o,topics:i},n).then(c=>{c&&c.forEach(l=>a.emit("data",l))}).catch(c=>{a.emit("error",new Qa("Failed to get past events.",c))}),(s=this.subscriptionManager)===null||s===void 0||s.addSubscription(a).catch(c=>{a.emit("error",new Qa("Failed to subscribe.",c))}),a}}subscribeToContextEvents(e){const n=this;this.context=e,n.syncWithContext&&e.on(Ku.CONFIG_CHANGE,r=>{n.setConfig({[r.name]:r.newValue})})}}const wB={addr:"0x3b3b57de",name:"0x691f3431",abi:"0x2203ab56",pubkey:"0xc8690233",text:"0x59d1d43c",contenthash:"0xbc1c58d1"},df={setAddr:"addr",addr:"addr",pubkey:"pubkey",contenthash:"contenthash",text:"text",name:"name"},Ww={main:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",goerli:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},w0e={"0x1":"main","0x5":"goerli"},x0e=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"label",type:"bytes32"},{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"recordExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"resolver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"ttl",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"}],I0e=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"coinType",type:"uint256"},{indexed:!1,internalType:"bytes",name:"newAddress",type:"bytes"}],name:"AddressChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"name",type:"bytes"},{indexed:!1,internalType:"uint16",name:"resource",type:"uint16"},{indexed:!1,internalType:"bytes",name:"record",type:"bytes"}],name:"DNSRecordChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"name",type:"bytes"},{indexed:!1,internalType:"uint16",name:"resource",type:"uint16"}],name:"DNSRecordDeleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"}],name:"DNSZoneCleared",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"lastzonehash",type:"bytes"},{indexed:!1,internalType:"bytes",name:"zonehash",type:"bytes"}],name:"DNSZonehashChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"bytes4",name:"interfaceID",type:"bytes4"},{indexed:!1,internalType:"address",name:"implementer",type:"address"}],name:"InterfaceChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"x",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"string",name:"indexedKey",type:"string"},{indexed:!1,internalType:"string",name:"key",type:"string"}],name:"TextChanged",type:"event"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"uint256",name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"addr",outputs:[{internalType:"address payable",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"uint256",name:"coinType",type:"uint256"}],name:"addr",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"contenthash",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes32",name:"name",type:"bytes32"},{internalType:"uint16",name:"resource",type:"uint16"}],name:"dnsRecord",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes32",name:"name",type:"bytes32"}],name:"hasDNSRecords",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes4",name:"interfaceID",type:"bytes4"}],name:"interfaceImplementer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"pubkey",outputs:[{internalType:"bytes32",name:"x",type:"bytes32"},{internalType:"bytes32",name:"y",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"string",name:"key",type:"string"}],name:"text",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"zonehash",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"address",name:"a",type:"address"}],name:"setAddr",outputs:[],stateMutability:"nonpayable",type:"function"}];function wg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function S0e(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function k0e(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function A1(t,...e){if(!k0e(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function E0e(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");wg(t.outputLen),wg(t.blockLen)}function cT(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function y5(t,e){A1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const C0e={number:wg,bool:S0e,bytes:A1,hash:E0e,exists:cT,output:y5},ob=BigInt(2**32-1),xB=BigInt(32);function T0e(t,e=!1){return e?{h:Number(t&ob),l:Number(t>>xB&ob)}:{h:Number(t>>xB&ob)|0,l:Number(t&ob)|0}}function A0e(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=T0e(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const N0e=(t,e,n)=>t<<n|e>>>32-n,_0e=(t,e,n)=>e<<n|t>>>32-n,$0e=(t,e,n)=>e<<n-32|t>>>64-n,R0e=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const O0e=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),IB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,P0e=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function SB(t){for(let e=0;e<t.length;e++)t[e]=P0e(t[e])}function Gw(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function v5(t){return typeof t=="string"&&(t=Gw(t)),A1(t),t}let D0e=class{clone(){return this._cloneInto()}};function F0e(t){const e=r=>t().update(v5(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const b5=[],w5=[],x5=[],L0e=BigInt(0),om=BigInt(1),B0e=BigInt(2),M0e=BigInt(7),z0e=BigInt(256),U0e=BigInt(113);for(let t=0,e=om,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],b5.push(2*(5*r+n)),w5.push((t+1)*(t+2)/2%64);let s=L0e;for(let i=0;i<7;i++)e=(e<<om^(e>>M0e)*U0e)%z0e,e&B0e&&(s^=om<<(om<<BigInt(i))-om);x5.push(s)}const[V0e,j0e]=A0e(x5,!0),kB=(t,e,n)=>n>32?$0e(t,e,n):N0e(t,e,n),EB=(t,e,n)=>n>32?R0e(t,e,n):_0e(t,e,n);function H0e(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=kB(l,u,1)^n[a],h=EB(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=w5[o],c=kB(s,i,a),l=EB(s,i,a),u=b5[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=V0e[r],t[1]^=j0e[r]}n.fill(0)}let W0e=class I5 extends D0e{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,wg(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=O0e(this.state)}keccak(){IB||SB(this.state32),H0e(this.state32,this.rounds),IB||SB(this.state32),this.posOut=0,this.pos=0}update(e){cT(this);const{blockLen:n,state:r}=this;e=v5(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){cT(this,!1),A1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return wg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(y5(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new I5(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const G0e=(t,e,n)=>F0e(()=>new W0e(e,t,n)),CB=G0e(1,136,256/8);function q0e(t){return e=>(C0e.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const K0e=(()=>{const t=q0e(CB);return t.create=CB.create,t})();function X0e(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const qw=t=>{if(Me.validate(["bytes"],[t]),X0e(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Q0e}=Ai,Y0e=t=>Q0e(qw(t)),Z0e=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?qw(`0x${t}`):qw(t),J0e=oe,S5="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",eye=t=>{let e;return typeof t=="bigint"||typeof t=="number"?e=Gw(t.toString()):Array.isArray(t)?e=new Uint8Array(t):typeof t=="string"&&!pt(t)?e=Gw(t):e=qw(t),Y0e(K0e(Go(e)))},k5=t=>{let e;typeof t=="string"?t.startsWith("0x")&&pt(t)?e=Z0e(t):e=Gw(t):e=t;const n=eye(e);return n===S5?void 0:n},TB=t=>{const e=k5(t);return oe(e)?S5:e};var tye="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const AB=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),NB=4;function nye(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),s=1,i=[0,1];for(let E=1;E<r;E++)i.push(s+=n());let o=n(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|t[e++],c=8),l>>--c&1}const d=31,h=2**d,m=h>>>1,g=m>>1,v=h-1;let y=0;for(let E=0;E<d;E++)y=y<<1|u();let w=[],x=0,S=h;for(;;){let E=Math.floor(((y-x+1)*s-1)/S),A=0,R=r;for(;R-A>1;){let O=A+R>>>1;E<i[O]?R=O:A=O}if(A==0)break;w.push(A);let N=x+Math.floor(S*i[A]/s),P=x+Math.floor(S*i[A+1]/s)-1;for(;((N^P)&m)==0;)y=y<<1&v|u(),N=N<<1&v,P=P<<1&v|1;for(;N&~P&g;)y=y&m|y<<1&v>>>1|u(),N=N<<1^m,P=(P^m)<<1|m|1;x=N,S=1+P-N}let k=r-4;return w.map(E=>{switch(E-k){case 3:return k+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return k+256+(t[a++]<<8|t[a++]);case 1:return k+t[a++];default:return E-1}})}function rye(t){let e=0;return()=>t[e++]}function E5(t){return rye(nye(sye(t)))}function sye(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let n=t.length,r=new Uint8Array(6*n>>3);for(let s=0,i=0,o=0,a=0;s<n;s++)a=a<<6|e[t.charCodeAt(s)],o+=6,o>=8&&(r[i++]=a>>(o-=8));return r}function iye(t){return t&1?~t>>1:t>>1}function oye(t,e){let n=Array(t);for(let r=0,s=0;r<t;r++)n[r]=s+=iye(e());return n}function xg(t,e=0){let n=[];for(;;){let r=t(),s=t();if(!s)break;e+=r;for(let i=0;i<s;i++)n.push(e+i);e+=s+1}return n}function C5(t){return Ig(()=>{let e=xg(t);if(e.length)return e})}function T5(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(aye(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(cye(n,t))}return e.flat()}function Ig(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function A5(t,e,n){let r=Array(t).fill().map(()=>[]);for(let s=0;s<e;s++)oye(t,n).forEach((i,o)=>r[o].push(i));return r}function aye(t,e){let n=1+e(),r=e(),s=Ig(e);return A5(s.length,1+t,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,d)=>{let h=d*r;return[c+d*n,l.map(m=>m+h)]})})}function cye(t,e){let n=1+e();return A5(n,1+t,e).map(s=>[s[0],s.slice(1)])}function lye(t){let e=[],n=xg(t);return s(r([]),[]),e;function r(i){let o=t(),a=Ig(()=>{let c=xg(t).map(l=>n[l]);if(c.length)return r(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function uye(t){return t.toString(16).toUpperCase().padStart(2,"0")}function N5(t){return`{${uye(t)}}`}function dye(t){let e=[];for(let n=0,r=t.length;n<r;){let s=t.codePointAt(n);n+=s<65536?1:2,e.push(s)}return e}function hh(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let s=0;s<n;)r.push(String.fromCodePoint(...t.slice(s,s+=4096)));return r.join("")}function fye(t,e){let n=t.length,r=n-e.length;for(let s=0;r==0&&s<n;s++)r=t[s]-e[s];return r}var hye="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Sg=44032,Kw=4352,Xw=4449,Qw=4519,_5=19,$5=21,ph=28,Yw=$5*ph,pye=_5*Yw,mye=Sg+pye,gye=Kw+_5,yye=Xw+$5,vye=Qw+ph;function Im(t){return t>>24&255}function R5(t){return t&16777215}let lT,_B,uT,Lb;function bye(){let t=E5(hye);lT=new Map(C5(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),_B=new Set(xg(t)),uT=new Map,Lb=new Map;for(let[e,n]of T5(t)){if(!_B.has(e)&&n.length==2){let[r,s]=n,i=Lb.get(r);i||(i=new Map,Lb.set(r,i)),i.set(s,e)}uT.set(e,n.reverse())}}function O5(t){return t>=Sg&&t<mye}function wye(t,e){if(t>=Kw&&t<gye&&e>=Xw&&e<yye)return Sg+(t-Kw)*Yw+(e-Xw)*ph;if(O5(t)&&e>Qw&&e<vye&&(t-Sg)%ph==0)return t+(e-Qw);{let n=Lb.get(t);return n&&(n=n.get(e),n)?n:-1}}function P5(t){lT||bye();let e=[],n=[],r=!1;function s(i){let o=lT.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(O5(i)){let o=i-Sg,a=o/Yw|0,c=o%Yw/ph|0,l=o%ph;s(Kw+a),s(Xw+c),l>0&&s(Qw+l)}else{let o=uT.get(i);o?n.push(...o):s(i)}if(!n.length)break;i=n.pop()}if(r&&e.length>1){let i=Im(e[0]);for(let o=1;o<e.length;o++){let a=Im(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=Im(e[--c]),i<=a))break}i=Im(e[o])}}return e}function xye(t){let e=[],n=[],r=-1,s=0;for(let i of t){let o=Im(i),a=R5(i);if(r==-1)o==0?r=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(r,...n),n.length=0,r=a):n.push(a),s=o;else{let c=wye(r,a);c>=0?r=c:s==0&&o==0?(e.push(r),r=a):(n.push(a),s=o)}}return r>=0&&e.push(r,...n),e}function D5(t){return P5(t).map(R5)}function Iye(t){return xye(P5(t))}const $B=45,F5=".",L5=65039,B5=1,Zw=t=>Array.from(t);function kg(t,e){return t.P.has(e)||t.Q.has(e)}class Sye extends Array{get is_emoji(){return!0}}let dT,M5,Cu,fT,z5,jf,p2,Cf,pu,RB,hT;function QN(){if(dT)return;let t=E5(tye);const e=()=>xg(t),n=()=>new Set(e()),r=(u,d)=>d.forEach(h=>u.add(h));dT=new Map(T5(t)),M5=n(),Cu=e(),fT=new Set(e().map(u=>Cu[u])),Cu=new Set(Cu),z5=n(),n();let s=C5(t),i=t();const o=()=>{let u=new Set;return e().forEach(d=>r(u,s[d])),r(u,e()),u};jf=Ig(u=>{let d=Ig(t).map(h=>h+96);if(d.length){let h=u>=i;d[0]-=32,d=hh(d),h&&(d=`Restricted[${d}]`);let m=o(),g=o(),v=!t();return{N:d,P:m,Q:g,M:v,R:h}}}),p2=n(),Cf=new Map;let a=e().concat(Zw(p2)).sort((u,d)=>u-d);a.forEach((u,d)=>{let h=t(),m=a[d]=h?a[d-h]:{V:[],M:new Map};m.V.push(u),p2.has(u)||Cf.set(u,m)});for(let{V:u,M:d}of new Set(Cf.values())){let h=[];for(let g of u){let v=jf.filter(w=>kg(w,g)),y=h.find(({G:w})=>v.some(x=>w.has(x)));y||(y={G:new Set,V:[]},h.push(y)),y.V.push(g),r(y.G,v)}let m=h.flatMap(g=>Zw(g.G));for(let{G:g,V:v}of h){let y=new Set(m.filter(w=>!g.has(w)));for(let w of v)d.set(w,y)}}pu=new Set;let c=new Set;const l=u=>pu.has(u)?c.add(u):pu.add(u);for(let u of jf){for(let d of u.P)l(d);for(let d of u.Q)l(d)}for(let u of pu)!Cf.has(u)&&!c.has(u)&&Cf.set(u,B5);r(pu,D5(pu)),RB=lye(t).map(u=>Sye.from(u)).sort(fye),hT=new Map;for(let u of RB){let d=[hT];for(let h of u){let m=d.map(g=>{let v=g.get(h);return v||(v=new Map,g.set(h,v)),v});h===L5?d.push(...m):d=m}for(let h of d)h.V=u}}function YN(t){return(U5(t)?"":`${ZN(N1([t]))} `)+N5(t)}function ZN(t){return`"${t}"‎`}function kye(t){if(t.length>=4&&t[2]==$B&&t[3]==$B)throw new Error(`invalid label extension: "${hh(t.slice(0,4))}"`)}function Eye(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function Cye(t){let e=t[0],n=AB.get(e);if(n)throw zm(`leading ${n}`);let r=t.length,s=-1;for(let i=1;i<r;i++){e=t[i];let o=AB.get(e);if(o){if(s==i)throw zm(`${n} + ${o}`);s=i+1,n=o}}if(s==r)throw zm(`trailing ${n}`)}function N1(t,e=1/0,n=N5){let r=[];Tye(t[0])&&r.push("◌"),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,i=t.length;for(let o=0;o<i;o++){let a=t[o];U5(a)&&(r.push(hh(t.slice(s,o))),r.push(n(a)),s=o+1)}return r.push(hh(t.slice(s,i))),r.join("")}function Tye(t){return QN(),Cu.has(t)}function U5(t){return QN(),z5.has(t)}function Aye(t){return Rye(Nye(t,Iye,Dye))}function Nye(t,e,n){if(!t)return[];QN();let r=0;return t.split(F5).map(s=>{let i=dye(s),o={input:i,offset:r};r+=i.length+1;try{let a=o.tokens=Pye(i,e,n),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(Eye(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(h=>h<128))kye(u),l="ASCII";else{let h=a.flatMap(m=>m.is_emoji?[]:m);if(!h.length)l="Emoji";else{if(Cu.has(u[0]))throw zm("leading combining mark");for(let v=1;v<c;v++){let y=a[v];if(!y.is_emoji&&Cu.has(y[0]))throw zm(`emoji + combining mark: "${hh(a[v-1])} + ${N1([y[0]])}"`)}Cye(u);let m=Zw(new Set(h)),[g]=$ye(m);Oye(g,h),_ye(g,m),l=g.N}}o.type=l}catch(a){o.error=a}return o})}function _ye(t,e){let n,r=[];for(let s of e){let i=Cf.get(s);if(i===B5)return;if(i){let o=i.M.get(s);if(n=n?n.filter(a=>o.has(a)):Zw(o),!n.length)return}else r.push(s)}if(n){for(let s of n)if(r.every(i=>kg(s,i)))throw new Error(`whole-script confusable: ${t.N}/${s.N}`)}}function $ye(t){let e=jf;for(let n of t){let r=e.filter(s=>kg(s,n));if(!r.length)throw jf.some(s=>kg(s,n))?j5(e[0],n):V5(n);if(e=r,r.length==1)break}return e}function Rye(t){return t.map(({input:e,error:n,output:r})=>{if(n){let s=n.message;throw new Error(t.length==1?s:`Invalid label ${ZN(N1(e,63))}: ${s}`)}return hh(r)}).join(F5)}function V5(t){return new Error(`disallowed character: ${YN(t)}`)}function j5(t,e){let n=YN(e),r=jf.find(s=>s.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function zm(t){return new Error(`illegal placement: ${t}`)}function Oye(t,e){for(let n of e)if(!kg(t,n))throw j5(t,n);if(t.M){let n=D5(e);for(let r=1,s=n.length;r<s;r++)if(fT.has(n[r])){let i=r+1;for(let o;i<s&&fT.has(o=n[i]);i++)for(let a=r;a<i;a++)if(n[a]==o)throw new Error(`duplicate non-spacing marks: ${YN(o)}`);if(i-r>NB)throw new Error(`excessive non-spacing marks: ${ZN(N1(n.slice(r-1,i)))} (${i-r}/${NB})`);r=i}}}function Pye(t,e,n){let r=[],s=[];for(t=t.slice().reverse();t.length;){let i=Fye(t);if(i)s.length&&(r.push(e(s)),s=[]),r.push(n(i));else{let o=t.pop();if(pu.has(o))s.push(o);else{let a=dT.get(o);if(a)s.push(...a);else if(!M5.has(o))throw V5(o)}}}return s.length&&r.push(e(s)),r}function Dye(t){return t.filter(e=>e!=L5)}function Fye(t,e){let n=hT,r,s=t.length;for(;s&&(n=n.get(t[--s]),!!n);){let{V:i}=n;i&&(r=i,t.length=s)}return r}const Lye=t=>Aye(t),sa=t=>{let e="";for(let n=0;n<32;n+=1)e+="00";if(t){const r=Lye(t).split(".");for(let s=r.length-1;s>=0;s-=1){const i=TB(r[s]).slice(2);e=TB(`0x${e}${i}`).slice(2)}}return`0x${e}`};var ab=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class Bye{constructor(e,n){this.contract=new Lu(x0e,n??Ww.main,e),this.context=e}getOwner(e){return ab(this,void 0,void 0,function*(){try{return this.contract.methods.owner(sa(e)).call()}catch{throw new Error}})}getTTL(e){return ab(this,void 0,void 0,function*(){try{return this.contract.methods.ttl(sa(e)).call()}catch{throw new Error}})}recordExists(e){return ab(this,void 0,void 0,function*(){try{return this.contract.methods.recordExists(sa(e)).call()}catch{throw new Error}})}getResolver(e){return ab(this,void 0,void 0,function*(){try{return this.contract.methods.resolver(sa(e)).call().then(n=>{if(typeof n=="string")return new Lu(I0e,n,this.context);throw new Error})}catch{throw new Error}})}get events(){return this.contract.events}}var Ga=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class Mye{constructor(e){this.registry=e}getResolverContractAdapter(e){return Ga(this,void 0,void 0,function*(){return this.registry.getResolver(e)})}checkInterfaceSupport(e,n){var r,s;return Ga(this,void 0,void 0,function*(){if(J0e(wB[n]))throw new A3((r=e.options.address)!==null&&r!==void 0?r:"",n);if(!(yield e.methods.supportsInterface(wB[n]).call()))throw new A3((s=e.options.address)!==null&&s!==void 0?s:"",n)})}supportsInterface(e,n){var r;return Ga(this,void 0,void 0,function*(){const s=yield this.getResolverContractAdapter(e);let i=n;if(!pt(i)){if(i=(r=k5(n))!==null&&r!==void 0?r:"",n==="")throw new Error("Invalid interface Id");i=i.slice(0,10)}return s.methods.supportsInterface(i).call()})}getAddress(e,n=60){return Ga(this,void 0,void 0,function*(){const r=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(r,df.addr),r.methods.addr(sa(e),n).call()})}getPubkey(e){return Ga(this,void 0,void 0,function*(){const n=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(n,df.pubkey),n.methods.pubkey(sa(e)).call()})}getContenthash(e){return Ga(this,void 0,void 0,function*(){const n=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(n,df.contenthash),n.methods.contenthash(sa(e)).call()})}setAddress(e,n,r){return Ga(this,void 0,void 0,function*(){const s=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(s,df.setAddr),s.methods.setAddr(sa(e),n).send(r)})}getText(e,n){return Ga(this,void 0,void 0,function*(){const r=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(r,df.text),r.methods.text(sa(e),n).call()})}getName(e,n=!0){return Ga(this,void 0,void 0,function*(){const r=`${e.toLowerCase().substring(2)}.addr.reverse`,s=yield this.getResolverContractAdapter(r);return n&&(yield this.checkInterfaceSupport(s,df.name)),s.methods.name(sa(r)).call()})}}var Bi=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class H5 extends Xi{constructor(e,n){super(n??""),this.registryAddress=e??Ww.main,this._registry=new Bye(this.getContextObject(),e),this._resolver=new Mye(this._registry)}getResolver(e){return Bi(this,void 0,void 0,function*(){return this._registry.getResolver(e)})}recordExists(e){return Bi(this,void 0,void 0,function*(){return this._registry.recordExists(e)})}getTTL(e){return Bi(this,void 0,void 0,function*(){return this._registry.getTTL(e)})}getOwner(e){return Bi(this,void 0,void 0,function*(){return this._registry.getOwner(e)})}getAddress(e,n=60){return Bi(this,void 0,void 0,function*(){return this._resolver.getAddress(e,n)})}getText(e,n){return Bi(this,void 0,void 0,function*(){return mr(e)?this._resolver.getText(yield this._resolver.getName(e,!1),n):this._resolver.getText(e,n)})}getName(e,n=!0){return Bi(this,void 0,void 0,function*(){return this._resolver.getName(e,n)})}getPubkey(e){return Bi(this,void 0,void 0,function*(){return this._resolver.getPubkey(e)})}getContenthash(e){return Bi(this,void 0,void 0,function*(){return this._resolver.getContenthash(e)})}checkNetwork(){return Bi(this,void 0,void 0,function*(){const e=Date.now()/1e3;if(!this._lastSyncCheck||e-this._lastSyncCheck>3600){const s=yield gme(this);if(!(typeof s=="boolean"&&!s))throw new Yie;this._lastSyncCheck=e}if(this._detectedAddress)return this._detectedAddress;const n=yield _N(this,Object.assign(Object.assign({},this.defaultReturnFormat),{number:_n.HEX})),r=Ww[w0e[n]];if(typeof r>"u")throw new Qie(n);return this._detectedAddress=r,this._detectedAddress})}supportsInterface(e,n){return Bi(this,void 0,void 0,function*(){return this._resolver.supportsInterface(e,n)})}get events(){return this._registry.events}setAddress(e,n,r){return Bi(this,void 0,void 0,function*(){return this._resolver.setAddress(e,n,r)})}}function Eg(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function zye(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Uye(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function _1(t,...e){if(!Uye(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Vye(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Eg(t.outputLen),Eg(t.blockLen)}function pT(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function W5(t,e){_1(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const jye={number:Eg,bool:zye,bytes:_1,hash:Vye,exists:pT,output:W5},cb=BigInt(2**32-1),OB=BigInt(32);function Hye(t,e=!1){return e?{h:Number(t&cb),l:Number(t>>OB&cb)}:{h:Number(t>>OB&cb)|0,l:Number(t&cb)|0}}function Wye(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Hye(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const Gye=(t,e,n)=>t<<n|e>>>32-n,qye=(t,e,n)=>e<<n|t>>>32-n,Kye=(t,e,n)=>e<<n-32|t>>>64-n,Xye=(t,e,n)=>t<<n-32|e>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qye=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),PB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Yye=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function DB(t){for(let e=0;e<t.length;e++)t[e]=Yye(t[e])}function G5(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function q5(t){return typeof t=="string"&&(t=G5(t)),_1(t),t}let Zye=class{clone(){return this._cloneInto()}};function Jye(t){const e=r=>t().update(q5(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}const K5=[],X5=[],Q5=[],eve=BigInt(0),am=BigInt(1),tve=BigInt(2),nve=BigInt(7),rve=BigInt(256),sve=BigInt(113);for(let t=0,e=am,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],K5.push(2*(5*r+n)),X5.push((t+1)*(t+2)/2%64);let s=eve;for(let i=0;i<7;i++)e=(e<<am^(e>>nve)*sve)%rve,e&tve&&(s^=am<<(am<<BigInt(i))-am);Q5.push(s)}const[ive,ove]=Wye(Q5,!0),FB=(t,e,n)=>n>32?Kye(t,e,n):Gye(t,e,n),LB=(t,e,n)=>n>32?Xye(t,e,n):qye(t,e,n);function ave(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=FB(l,u,1)^n[a],h=LB(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=X5[o],c=FB(s,i,a),l=LB(s,i,a),u=K5[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=ive[r],t[1]^=ove[r]}n.fill(0)}let cve=class Y5 extends Zye{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Eg(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Qye(this.state)}keccak(){PB||DB(this.state32),ave(this.state32,this.rounds),PB||DB(this.state32),this.posOut=0,this.pos=0}update(e){pT(this);const{blockLen:n,state:r}=this;e=q5(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){pT(this,!1),_1(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Eg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(W5(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Y5(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const lve=(t,e,n)=>Jye(()=>new cve(e,t,n)),BB=lve(1,136,256/8);function uve(t){return e=>(jye.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const dve=(()=>{const t=uve(BB);return t.create=BB.create,t})();function fve(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const hve=t=>{if(Me.validate(["bytes"],[t]),fve(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:pve}=Ai,mve=t=>pve(hve(t)),Z5=t=>{Me.validate(["string"],[t]);let e=t.replace(/^(?:\u0000)/,"");return e=e.replace(/(?:\u0000)$/,""),mve(new TextEncoder().encode(e))},gve=G5,J5=t=>{if(!mr(t,!1))throw new vd(t);const e=t.toLowerCase().replace(/^0x/i,""),n=Ur(dve(Go(gve(e))));if(oe(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let r="0x";const s=n.replace(/^0x/i,"");for(let i=0;i<e.length;i+=1)parseInt(s[i],16)>7?r+=e[i].toUpperCase():r+=e[i];return r};var Sc=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const yve=t=>Sc(void 0,void 0,void 0,function*(){return(yield Lfe(t)).map(J5)}),vve=(t,e)=>Sc(void 0,void 0,void 0,function*(){Me.validate(["string"],[e]);const n=yield Bfe(t,e);return J5(n)}),bve=(t,e,n,r)=>Sc(void 0,void 0,void 0,function*(){return Me.validate(["address","string","uint"],[e,n,r]),Mfe(t,e,n,r)}),wve=(t,e)=>Sc(void 0,void 0,void 0,function*(){return Me.validate(["address"],[e]),zfe(t,e)}),xve=(t,e,n)=>Sc(void 0,void 0,void 0,function*(){return Me.validate(["string","string"],[e,n]),Ufe(t,e,n)}),Ive=(t,e,n,r)=>Sc(void 0,void 0,void 0,function*(){const s=ti(e,vt,{transactionSchema:r?.customTransactionSchema});return Vfe(t,s,n)}),Sve=(t,e,n,r)=>Sc(void 0,void 0,void 0,function*(){const s=ti(e,vt,{transactionSchema:r?.customTransactionSchema});return jfe(t,s,n)}),kve=(t,e,n,r)=>Sc(void 0,void 0,void 0,function*(){Me.validate(["string","address","string"],[e,n,r]);const s=pt(e)?e:Z5(e);return Hfe(t,s,n,r)}),Eve=(t,e,n)=>Sc(void 0,void 0,void 0,function*(){Me.validate(["string","string"],[e,n]);const r=pt(e)?e:Z5(e);return Wfe(t,r,n)});var qa=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class eH extends Xi{getAccounts(){return qa(this,void 0,void 0,function*(){return yve(this.requestManager)})}newAccount(e){return qa(this,void 0,void 0,function*(){return vve(this.requestManager,e)})}unlockAccount(e,n,r){return qa(this,void 0,void 0,function*(){return bve(this.requestManager,e,n,r)})}lockAccount(e){return qa(this,void 0,void 0,function*(){return wve(this.requestManager,e)})}importRawKey(e,n){return qa(this,void 0,void 0,function*(){return xve(this.requestManager,e,n)})}sendTransaction(e,n){return qa(this,void 0,void 0,function*(){return Ive(this.requestManager,e,n,this.config)})}signTransaction(e,n){return qa(this,void 0,void 0,function*(){return Sve(this.requestManager,e,n,this.config)})}sign(e,n,r){return qa(this,void 0,void 0,function*(){return kve(this.requestManager,e,n,r)})}ecRecover(e,n){return qa(this,void 0,void 0,function*(){return Eve(this.requestManager,e,n)})}}function Ws(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Cve(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Tve(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Hh(t,...e){if(!Tve(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function JN(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ws(t.outputLen),Ws(t.blockLen)}function Ju(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function e_(t,e){Hh(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const tH={number:Ws,bool:Cve,bytes:Hh,hash:JN,exists:Ju,output:e_},lb=BigInt(2**32-1),MB=BigInt(32);function Ave(t,e=!1){return e?{h:Number(t&lb),l:Number(t>>MB&lb)}:{h:Number(t>>MB&lb)|0,l:Number(t&lb)|0}}function Nve(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Ave(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const _ve=(t,e,n)=>t<<n|e>>>32-n,$ve=(t,e,n)=>e<<n|t>>>32-n,Rve=(t,e,n)=>e<<n-32|t>>>64-n,Ove=(t,e,n)=>t<<n-32|e>>>64-n,Bb=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mb=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),zb=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ta=(t,e)=>t<<32-e|t>>>e,Kt=(t,e)=>t<<e|t>>>32-e>>>0,Jw=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Pve=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function ex(t){for(let e=0;e<t.length;e++)t[e]=Pve(t[e])}function Cg(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function mh(t){return typeof t=="string"&&(t=Cg(t)),Hh(t),t}function mT(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Hh(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class t_{clone(){return this._cloneInto()}}const Dve={}.toString;function nH(t,e){if(e!==void 0&&Dve.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}function rH(t){const e=r=>t().update(mh(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Fve(t=32){if(Bb&&typeof Bb.getRandomValues=="function")return Bb.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}const sH=[],iH=[],oH=[],Lve=BigInt(0),cm=BigInt(1),Bve=BigInt(2),Mve=BigInt(7),zve=BigInt(256),Uve=BigInt(113);for(let t=0,e=cm,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],sH.push(2*(5*r+n)),iH.push((t+1)*(t+2)/2%64);let s=Lve;for(let i=0;i<7;i++)e=(e<<cm^(e>>Mve)*Uve)%zve,e&Bve&&(s^=cm<<(cm<<BigInt(i))-cm);oH.push(s)}const[Vve,jve]=Nve(oH,!0),zB=(t,e,n)=>n>32?Rve(t,e,n):_ve(t,e,n),UB=(t,e,n)=>n>32?Ove(t,e,n):$ve(t,e,n);function Hve(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=zB(l,u,1)^n[a],h=UB(l,u,1)^n[a+1];for(let m=0;m<50;m+=10)t[o+m]^=d,t[o+m+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=iH[o],c=zB(s,i,a),l=UB(s,i,a),u=sH[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Vve[r],t[1]^=jve[r]}n.fill(0)}class n_ extends t_{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ws(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Mb(this.state)}keccak(){Jw||ex(this.state32),Hve(this.state32,this.rounds),Jw||ex(this.state32),this.posOut=0,this.pos=0}update(e){Ju(this);const{blockLen:n,state:r}=this;e=mh(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ju(this,!1),Hh(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ws(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(e_(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new n_(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Wve=(t,e,n)=>rH(()=>new n_(e,t,n)),VB=Wve(1,136,256/8),tx=tH.bytes;function aH(t){if(!(t instanceof Uint8Array))throw new TypeError(`bytesToUtf8 expected Uint8Array, got ${typeof t}`);return new TextDecoder().decode(t)}function Gve(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function qve(t){return e=>(tH.bytes(e),t(e))}(()=>{const t=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,e=typeof nn<"u"&&typeof nn.require=="function"&&nn.require.bind(nn);return{node:e&&!t?e("crypto"):void 0,web:t}})();const vi=(()=>{const t=qve(VB);return t.create=VB.create,t})();function Fl(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}function Ts(...t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function $1(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n+=1)if(t[n]!==e[n])return!1;return!0}const r_={noether:BigInt(0),wei:BigInt(1),kwei:BigInt(1e3),Kwei:BigInt(1e3),babbage:BigInt(1e3),femtoether:BigInt(1e3),mwei:BigInt(1e6),Mwei:BigInt(1e6),lovelace:BigInt(1e6),picoether:BigInt(1e6),gwei:BigInt(1e9),Gwei:BigInt(1e9),shannon:BigInt(1e9),nanoether:BigInt(1e9),nano:BigInt(1e9),szabo:BigInt(1e12),microether:BigInt(1e12),micro:BigInt(1e12),finney:BigInt(1e15),milliether:BigInt(1e15),milli:BigInt(1e15),ether:BigInt("1000000000000000000"),kether:BigInt("1000000000000000000000"),grand:BigInt("1000000000000000000000"),mether:BigInt("1000000000000000000000000"),gether:BigInt("1000000000000000000000000000"),tether:BigInt("1000000000000000000000000000000")},gT="Warning: Using type `number` with values that are large or contain many decimals may cause loss of precision, it is recommended to use type `string` or `BigInt` when using conversion methods",pc=t=>{if(Me.validate(["bytes"],[t]),Fl(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Kve}=Ai,Gt=t=>Kve(pc(t)),Hn=t=>typeof t=="string"&&t.slice(0,2).toLowerCase()!=="0x"?pc(`0x${t}`):pc(t),R1=t=>(Me.validate(["hex"],[t]),wd(t)),Xve=R1,No=(t,e)=>{typeof t!="bigint"&&Me.validate(["int"],[t]);let n=Dl(t);return e&&(!n.startsWith("-")&&n.length%2===1?n="0x0".concat(n.slice(2)):n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3)))),n},Qve=No,Yve=t=>R1(t).toString(),mc=t=>{Me.validate(["string"],[t]);let e=t.replace(/^(?:\u0000)/,"");return e=e.replace(/(?:\u0000)$/,""),Gt(new TextEncoder().encode(e))},cH=mc,Zve=mc,O1=t=>aH(Hn(t)),Jve=t=>typeof t=="string"?O1(t):(Me.validate(["bytes"],[t]),aH(t)),s_=Cg,ebe=O1,lH=t=>{Me.validate(["string"],[t]);let e="";for(let n=0;n<t.length;n+=1){const r=t.charCodeAt(n).toString(16);e+=r.length%2!==0?`0${r}`:r}return`0x${e}`},tbe=lH,uH=t=>new TextDecoder("ascii").decode(Hn(t)),nbe=uH,nx=(t,e)=>{if(typeof t=="string"&&mr(t))return e?"address":`0x${t.toLowerCase().replace(/^0x/i,"")}`;if(typeof t=="boolean")return e?"bool":t?"0x01":"0x00";if(typeof t=="number")return e?t<0?"int256":"uint256":No(t);if(typeof t=="bigint")return e?"bigint":No(t);if(Fl(t))return e?"bytes":Gt(t);if(typeof t=="object"&&t)return e?"string":mc(JSON.stringify(t));if(typeof t=="string"){if(t.startsWith("-0x")||t.startsWith("-0X"))return e?"int256":No(t);if(pt(t))return e?"bytes":t;if(zo(t)&&!fc(t)&&!ki(t))return e?"bytes":`0x${t}`;if(zo(t)&&!fc(t)&&ki(t))return e?"uint":No(t);if(!Number.isFinite(t))return e?"string":mc(t)}throw new iN(t)},Ea=t=>{if(typeof t=="number")return t>1e20?(console.warn(gT),BigInt(t)):t;if(typeof t=="bigint")return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?Number(t):t;if(typeof t=="string"&&pt(t))return R1(t);try{return Ea(BigInt(t))}catch{throw new Pl(t)}},Tu=t=>{if(typeof t=="number")return BigInt(t);if(typeof t=="bigint")return t;if(typeof t=="string"&&zo(t))return t.startsWith("-")?-BigInt(t.substring(1)):BigInt(t);throw new Pl(t)},rbe=(t,e)=>{let n;if(typeof e=="string"){if(n=r_[e],!n)throw new CV(e)}else{if(e<0||!Number.isInteger(e))throw new TV(e);n=Gu(BigInt(10),BigInt(e))}const r=String(Ea(t)),s=n.toString().length-1;if(s<=0)return r.toString();const i=r.padStart(s,"0"),o=i.slice(0,-s),a=i.slice(-s).replace(/\.?0+$/,"");return o===""?a?`0.${a}`:"0":a===""?o:`${o}.${a}`.slice(0,o.length+s+1)},sbe=(t,e)=>{Me.validate(["number"],[t]);let n;if(typeof e=="string"){if(n=r_[e],!n)throw new CV(e)}else{if(e<0||!Number.isInteger(e))throw new TV(e);n=Gu(BigInt(10),BigInt(e))}let r=t;typeof r=="number"&&(r<1e-15&&console.warn(gT),r>1e20?(console.warn(gT),r=BigInt(r)):r=r.toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}));const[s,i]=String(typeof r=="string"&&!pt(r)?r:Ea(r)).split(".").concat(""),a=BigInt(`${s}${i}`)*n,c=i.length;return c===0?a.toString():a.toString().slice(0,-c)},l0=t=>{if(!mr(t,!1))throw new vd(t);const e=t.toLowerCase().replace(/^0x/i,""),n=Ur(vi(Go(s_(e))));if(oe(n)||n==="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470")return"";let r="0x";const s=n.replace(/^0x/i,"");for(let i=0;i<e.length;i+=1)parseInt(s[i],16)>7?r+=e[i].toUpperCase():r+=e[i];return r},dH=t=>{if(typeof t=="boolean")return t;if(typeof t=="number"&&(t===0||t===1)||typeof t=="bigint"&&(t===BigInt(0)||t===BigInt(1)))return!!t;if(typeof t=="string"&&!pt(t)&&(t==="1"||t==="0"||t==="false"||t==="true"))return t==="true"?!0:t==="false"?!1:!!Number(t);if(typeof t=="string"&&pt(t)&&(t==="0x1"||t==="0x0"))return!!Ea(t);throw new e0(t)};var m2={exports:{}},jB;function ibe(){return jB||(jB=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||c,h),g=n?n+l:l;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,g=new Array(m);h<m;h++)g[h]=d[h].fn;return g},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,m,g){var v=n?n+l:l;if(!this._events[v])return!1;var y=this._events[v],w=arguments.length,x,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,m),!0;case 6:return y.fn.call(y.context,u,d,h,m,g),!0}for(S=1,x=new Array(w-1);S<w;S++)x[S-1]=arguments[S];y.fn.apply(y.context,x)}else{var k=y.length,E;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,h);break;default:if(!x)for(E=1,x=new Array(w-1);E<w;E++)x[E-1]=arguments[E];y[S].fn.apply(y[S].context,x)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,y=[],w=g.length;v<w;v++)(g[v].fn!==u||h&&!g[v].once||d&&g[v].context!==d)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(m2)),m2.exports}var obe=ibe();const fH=Wo(obe);let hH=class extends fH{constructor(){super(...arguments),this.maxListeners=Number.MAX_SAFE_INTEGER}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}};const abe=pt,cbe=zo,lbe=YV,ube=mr,dbe=Bh,fbe=y1,hbe=xce,pbe=Ice,mbe=Aw,gbe=kce,ybe=(t,e)=>{const n=typeof t=="string"&&Br(t),r=typeof e=="string"&&Br(e);if(t===e||(t==="earliest"||t===0)&&(e==="earliest"||e===0))return 0;if(t==="earliest")return-1;if(e==="earliest")return 1;if(n&&r){const o={[tc.EARLIEST]:1,[tc.FINALIZED]:2,[tc.SAFE]:3,[tc.LATEST]:4,[tc.PENDING]:5};return o[t]<o[e]?-1:1}if(n&&!r||!n&&r)throw new Aoe("Cannot compare blocktag with provided non-blocktag input.");const s=BigInt(t),i=BigInt(e);return s<i?-1:s===i?0:1},Sm=t=>typeof t=="object"&&!oe(t)&&Object.keys(t).length!==0&&["input","data","from","gas","gasPrice","gasLimit","address","jsonInterface","syncWithContext","dataInputFill"].some(e=>e in t),Ss=oe,HB=t=>typeof t=="object"&&!oe(t)&&!Array.isArray(t)&&!(t instanceof wc),i_=(t,...e)=>{if(!HB(t))return t;const n=Object.assign({},t);for(const r of e)for(const s in r)HB(r[s])?(n[s]||(n[s]={}),n[s]=i_(n[s],r[s])):!oe(r[s])&&Object.hasOwnProperty.call(r,s)&&(Array.isArray(r[s])||r[s]instanceof wc?n[s]=r[s].slice(0):n[s]=r[s]);return n},gh=(t,e,n="0")=>typeof t=="string"?pt(t)?so(t,e,n):t.padStart(e,n):(Me.validate(["int"],[t]),so(t,e,n)),pH=(t,e,n="0")=>{if(typeof t=="string"&&!pt(t))return t.padEnd(e,n);const r=typeof t=="string"&&pt(t)?t:No(t),s=r.startsWith("-")?3:2;return Me.validate([r.startsWith("-")?"int":"uint"],[t]),r.padEnd(e+s,n)},mH=pH,yT=gh,gH=(t,e=64)=>{Me.validate(["int"],[t]);const n=Ea(t);if(n>=0)return gh(nx(n),e);const r=Gu(BigInt(2),BigInt(e*4));if(-n>=r)throw new AV(`value: ${t}, nibbleWidth: ${e}`);const i=BigInt(n)+r;return gh(No(i),e)},vbe=(t,e=64)=>{Me.validate(["int"],[t]);const n=Ea(t);if(n<0)return n;const r=Math.ceil(Math.log(Number(n))/Math.log(2));if(r>e*4)throw new AV(`value: "${t}", nibbleWidth: "${e}"`);if(e*4!==r)return n;const s=Gu(BigInt(2),BigInt(e)*BigInt(4));return Ea(BigInt(n)-s)},{parseBaseType:bbe}=Ai,vT=t=>typeof t=="object"&&!oe(t)&&"number"in t&&"bytes"in t,wbe=(t,e,n=[])=>{let r=Object.assign({},t),s;for(const i of e){if(r.oneOf&&s){const o=s,a=n.find(([c])=>c===o);a&&a[0]===s&&(r=r.oneOf[a[1]])}if(!r.properties&&!r.items)return;r.properties?r=r.properties[i]:r.items&&r.items.properties?r=r.items.properties[i]:r.items&&Rn(r.items)?r=r.items:r.items&&Array.isArray(r.items)&&(r=r.items[parseInt(i,10)]),r&&i&&(s=i)}return r},Tg=(t,e,n)=>{try{const{baseType:r,baseTypeSize:s}=bbe(e);if(r==="int"||r==="uint")switch(n.number){case _n.NUMBER:return Number(Tu(t));case _n.HEX:return No(Tu(t));case _n.STR:return Tu(t).toString();case _n.BIGINT:return Tu(t);default:throw new ro(`Invalid format: ${String(n.number)}`)}if(r==="bytes"){let i;switch(s?typeof t=="string"?i=gh(t,s*2):Fl(t)&&(i=Ts(new Uint8Array(s-t.length),t)):i=t,n.bytes){case Es.HEX:return Gt(pc(i));case Es.UINT8ARRAY:return pc(i);default:throw new ro(`Invalid format: ${String(n.bytes)}`)}}if(r==="string")return String(t)}catch{return t}return t},WB=({value:t,schemaProp:e,schema:n,object:r,key:s,dataPath:i,format:o,oneOfPath:a=[]})=>{var c,l;if(Array.isArray(t)){let u=e;if(e?.oneOf!==void 0&&e.oneOf.forEach((d,h)=>{var m,g;!Array.isArray(e?.items)&&(typeof t[0]=="object"&&((m=d?.items)===null||m===void 0?void 0:m.type)==="object"||typeof t[0]=="string"&&((g=d?.items)===null||g===void 0?void 0:g.type)!=="object")&&(u=d,a.push([s,h]))}),oe(u?.items))return delete r[s],i.pop(),!0;if(Rn(u.items)&&!oe(u.items.format)){for(let d=0;d<t.length;d+=1)r[s][d]=Tg(t[d],(c=u?.items)===null||c===void 0?void 0:c.format,o);return i.pop(),!0}if(!Array.isArray(u?.items)&&((l=u?.items)===null||l===void 0?void 0:l.type)==="object"){for(const d of t)P1(d,n,i,o,a);return i.pop(),!0}if(Array.isArray(u?.items)){for(let d=0;d<t.length;d+=1)r[s][d]=Tg(t[d],u.items[d].format,o);return i.pop(),!0}}return!1},P1=(t,e,n,r,s=[])=>{var i;if(!Rn(t)&&!Array.isArray(t))return Tg(t,e?.format,r);const o=t;if(Array.isArray(o)&&e?.type==="array"&&((i=e?.items)===null||i===void 0?void 0:i.type)==="object")WB({value:o,schemaProp:e,schema:e,object:o,key:"",dataPath:n,format:r,oneOfPath:s});else for(const[a,c]of Object.entries(o)){n.push(a);let l=wbe(e,n,s);if(oe(l)){delete o[a],n.pop();continue}if(Rn(c)){P1(c,e,n,r,s),n.pop();continue}if(!WB({value:c,schemaProp:l,schema:e,object:o,key:a,dataPath:n,format:r,oneOfPath:s})){if(l?.format===void 0&&l?.oneOf!==void 0){for(const[u,d]of l.oneOf.entries())if(d?.format!==void 0){l=d;break}}o[a]=Tg(c,l.format,r),n.pop()}}return o},yH=(t,e,n=Fr)=>{let r;Rn(e)?r=i_({},e):Array.isArray(e)?r=[...e]:r=e;const s=Rn(t)?t:Lh(t);if(!s.properties&&!s.items&&!s.format)throw new ro("Invalid json schema for formatting");return P1(r,s,[],n)},vH="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",bT=t=>{let e;return typeof t=="bigint"||typeof t=="number"?e=Cg(t.toString()):Array.isArray(t)?e=new Uint8Array(t):typeof t=="string"&&!pt(t)?e=Cg(t):e=pc(t),Gt(vi(Go(e)))},D1=t=>{let e;typeof t=="string"?t.startsWith("0x")&&pt(t)?e=Hn(t):e=Cg(t):e=t;const n=bT(e);return n===vH?void 0:n},$a=t=>{const e=D1(t);return oe(e)?vH:e},xbe=t=>{if(Array.isArray(t))throw new Error("Autodetection of array types is not supported.");let e,n;if(typeof t=="object"&&("t"in t||"type"in t)&&("v"in t||"value"in t))e="t"in t?t.t:t.type,n="v"in t?t.v:t.value,e=e.toLowerCase()==="bigint"?"int":e;else{if(typeof t=="bigint")return["int",t];e=nx(t,!0),n=nx(t),!e.startsWith("int")&&!e.startsWith("uint")&&(e="bytes")}return(e.startsWith("int")||e.startsWith("uint"))&&typeof n=="string"&&!/^(-)?0x/i.test(n)&&(n=Tu(n)),[e,n]},Ibe=t=>t.startsWith("int[")?`int256${t.slice(3)}`:t==="int"?"int256":t.startsWith("uint[")?`uint256'${t.slice(4)}`:t==="uint"?"uint256":t,g2=(t,e)=>{const n=/^(\d+).*$/.exec(t.slice(e));return n?parseInt(n[1],10):0},GB=t=>t.toString(2).length,qB=(t,e)=>{const n=e.toString();if(t==="string"){if(typeof e=="string")return mc(e);throw new Coe(e)}if(t==="bool"||t==="boolean"){if(typeof e=="boolean")return e?"01":"00";throw new e0(e)}if(t==="address"){if(!mr(n))throw new vd(n);return n}const r=Ibe(t);if(t.startsWith("uint")){const s=g2(r,4);if(s%8||s<8||s>256)throw new O3(n);const i=Ea(n);if(GB(i)>s)throw new P3(n);if(i<BigInt(0))throw new Toe(n);return s?yT(i.toString(16),s/8*2):i.toString(16)}if(t.startsWith("int")){const s=g2(r,3);if(s%8||s<8||s>256)throw new O3(t);const i=Ea(n);if(GB(i)>s)throw new P3(n);return i<BigInt(0)?gH(i.toString(),s/8*2):s?yT(i.toString(16),s/4):i.toString(16)}if(r==="bytes"){if(n.replace(/^0x/i,"").length%2!==0)throw new Js(n);return n}if(t.startsWith("bytes")){if(n.replace(/^0x/i,"").length%2!==0)throw new Js(n);const s=g2(t,5);if(!s||s<1||s>64||s<n.replace(/^0x/i,"").length/2)throw new Js(n);return mH(n,s*2)}return""},bH=t=>{const[e,n]=xbe(t);return Array.isArray(n)?n.map(i=>qB(e,i).replace("0x","")).join(""):qB(e,n).replace("0x","")},o_=(...t)=>`0x${t.map(bH).join("").toLowerCase()}`,Sbe=(...t)=>D1(o_(...t)),kbe=(...t)=>$a(o_(...t)),Ebe=t=>D1(`0x${(typeof t=="number"?t.toString():t).padStart(64,"0")}`);function Cbe(t){return Fve(t)}const Ag=t=>Cbe(t),Tbe=t=>Gt(Ag(t));var F1=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};function Abe(t){return(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function wH(t,e,n){return F1(this,void 0,void 0,function*(){let r;const s=yield Promise.race([t instanceof Promise?t:t(),new Promise((i,o)=>{r=setTimeout(()=>n?o(n):i(void 0),e)})]);if(r&&clearTimeout(r),s instanceof Error)throw s;return s})}function xH(t,e){let n;return[new Promise((s,i)=>{n=setInterval((function o(){return F1(this,void 0,void 0,function*(){try{const a=yield wH(t,e);oe(a)||(clearInterval(n),s(a))}catch(a){clearInterval(n),i(a)}}),o})(),e)}),n]}function Nbe(t,e){return F1(this,void 0,void 0,function*(){return xH(t,e)[0]})}function _be(t,e){let n;const r=new Promise((s,i)=>{n=setTimeout(()=>{i(e)},t)});return[n,r]}function $be(t,e){let n;const r=new Promise((s,i)=>{n=setInterval(()=>{F1(this,void 0,void 0,function*(){const o=yield t();o&&(clearInterval(n),i(o))})},e)});return[n,r]}const a_=()=>{const t=Ag(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;const e=Gt(t);return[e.substring(2,10),e.substring(10,14),e.substring(14,18),e.substring(18,22),e.substring(22,34)].join("-")},IH=t=>{const e=t.error.code;return hs.has(e)||e>=-32099&&e<=-32e3},L1=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"result"in t&&oe(t.error)&&(typeof t.id=="number"||typeof t.id=="string"),B1=t=>!Array.isArray(t)&&t.jsonrpc==="2.0"&&!!t&&oe(t.result)&&"error"in t&&(typeof t.id=="number"||typeof t.id=="string"),c_=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&!oe(t.params)&&!oe(t.method),SH=t=>!Array.isArray(t)&&!!t&&t.jsonrpc==="2.0"&&"id"in t&&"result"in t,rx=t=>L1(t)||B1(t),l_=t=>Array.isArray(t)?t.every(rx):rx(t),sx=t=>Array.isArray(t)&&t.length>0&&l_(t);let Ub;const kH=t=>{Ub=t},Ng=t=>{var e,n,r,s;return typeof Ub<"u"&&(Ub+=1),{jsonrpc:(e=t.jsonrpc)!==null&&e!==void 0?e:"2.0",id:(r=(n=t.id)!==null&&n!==void 0?n:Ub)!==null&&r!==void 0?r:a_(),method:t.method,params:(s=t.params)!==null&&s!==void 0?s:void 0}},EH=t=>t.map(e=>Ng(e)),u_=t=>Array.isArray(t)&&t.length>0,Rbe=Object.freeze(Object.defineProperty({__proto__:null,isBatchRequest:u_,isBatchResponse:sx,isResponseRpcError:IH,isResponseWithError:B1,isResponseWithNotification:c_,isResponseWithResult:L1,isSubscriptionResult:SH,isValidResponse:l_,setRequestIdStart:kH,toBatchPayload:EH,toPayload:Ng,validateResponse:rx},Symbol.toStringTag,{value:"Module"}));var y2=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},CH;class TH{constructor({timeout:e,eagerStart:n,timeoutMessage:r}={timeout:0,eagerStart:!1,timeoutMessage:"DeferredPromise timed out"}){this[CH]="Promise",this._state="pending",this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i}),this._timeoutMessage=r,this._timeoutInterval=e,n&&this.startTimer()}get state(){return this._state}then(e,n){return y2(this,void 0,void 0,function*(){return this._promise.then(e,n)})}catch(e){return y2(this,void 0,void 0,function*(){return this._promise.catch(e)})}finally(e){return y2(this,void 0,void 0,function*(){return this._promise.finally(e)})}resolve(e){this._resolve(e),this._state="fulfilled",this._clearTimeout()}reject(e){this._reject(e),this._state="rejected",this._clearTimeout()}startTimer(){this._timeoutInterval&&this._timeoutInterval>0&&(this._timeoutId=setTimeout(this._checkTimeout.bind(this),this._timeoutInterval))}_checkTimeout(){this._state==="pending"&&this._timeoutId&&this.reject(new h1(this._timeoutMessage))}_clearTimeout(){this._timeoutId&&clearTimeout(this._timeoutId)}}CH=Symbol.toStringTag;class AH{constructor(e,n){this.eventEmitter=e,this.autoReconnect=n,this.chunkTimeout=1e3*15}clearQueues(){typeof this._clearQueues=="function"&&this._clearQueues()}onError(e){this._clearQueues=e}parseResponse(e){const n=[];return e.replace(/\}[\n\r]?\{/g,"}|--|{").replace(/\}\][\n\r]?\[\{/g,"}]|--|[{").replace(/\}[\n\r]?\[\{/g,"}|--|[{").replace(/\}\][\n\r]?\{/g,"}]|--|{").split("|--|").forEach(s=>{let i=s;this.lastChunk&&(i=this.lastChunk+i);let o;try{o=JSON.parse(i)}catch{this.lastChunk=i,this.lastChunkTimeout&&clearTimeout(this.lastChunkTimeout),this.lastChunkTimeout=setTimeout(()=>{this.autoReconnect||(this.clearQueues(),this.eventEmitter.emit("error",new t0({id:1,jsonrpc:"2.0",error:{code:2,message:"Chunk timeout"}})))},this.chunkTimeout);return}clearTimeout(this.lastChunkTimeout),this.lastChunk=void 0,o&&n.push(o)}),n}}var KB=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};let NH=class extends yd{constructor(){super(...arguments),this._eventEmitter=new fH,this._chainId="",this._accounts=[]}_getChainId(){return KB(this,void 0,void 0,function*(){var e;const n=yield this.request(Ng({method:"eth_chainId",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:""})}_getAccounts(){return KB(this,void 0,void 0,function*(){var e;const n=yield this.request(Ng({method:"eth_accounts",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:[]})}_onConnect(){Promise.all([this._getChainId().then(e=>{e!==this._chainId&&(this._chainId=e,this._eventEmitter.emit("chainChanged",this._chainId))}).catch(e=>{console.error(e)}),this._getAccounts().then(e=>{this._accounts.length===e.length&&e.every(n=>e.includes(n))||(this._accounts=e,this._onAccountsChanged())}).catch(e=>{console.error(e)})]).then(()=>this._eventEmitter.emit("connect",{chainId:this._chainId})).catch(e=>{console.error(e)})}_onDisconnect(e,n){this._eventEmitter.emit("disconnect",new oN(e,n))}_onAccountsChanged(){this._eventEmitter.emit("accountsChanged",this._accounts)}};var v2=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const Obe={autoReconnect:!0,delay:5e3,maxAttempts:5},Pbe=1e3;class Dbe extends NH{get SocketConnection(){return this._socketConnection}constructor(e,n,r){if(super(),this._connectionStatus="connecting",this._onMessageHandler=this._onMessage.bind(this),this._onOpenHandler=this._onConnect.bind(this),this._onCloseHandler=this._onCloseEvent.bind(this),this._onErrorHandler=this._onError.bind(this),!this._validateProviderPath(e))throw new Qm(e);this._socketPath=e,this._socketOptions=n,this._reconnectOptions=Object.assign(Object.assign({},Obe),r??{}),this._pendingRequestsQueue=new Map,this._sentRequestsQueue=new Map,this._init(),this.connect(),this.chunkResponseParser=new AH(this._eventEmitter,this._reconnectOptions.autoReconnect),this.chunkResponseParser.onError(()=>{this._clearQueues()}),this.isReconnecting=!1}_init(){this._reconnectAttempts=0}connect(){try{this._openSocketConnection(),this._connectionStatus="connecting",this._addSocketListeners()}catch(e){if(this.isReconnecting)setImmediate(()=>{this._reconnect()});else throw this._connectionStatus="disconnected",e&&e.message?new Ph(`Error while connecting to ${this._socketPath}. Reason: ${e.message}`):new Qm(this._socketPath)}}_validateProviderPath(e){return!!e}getPendingRequestQueueSize(){return this._pendingRequestsQueue.size}getSentRequestsQueueSize(){return this._sentRequestsQueue.size}supportsSubscriptions(){return!0}on(e,n){this._eventEmitter.on(e,n)}once(e,n){this._eventEmitter.once(e,n)}removeListener(e,n){this._eventEmitter.removeListener(e,n)}_onDisconnect(e,n){this._connectionStatus="disconnected",super._onDisconnect(e,n)}disconnect(e,n){const r=e??Pbe;this._removeSocketListeners(),this.getStatus()!=="disconnected"&&this._closeSocketConnection(r,n),this._onDisconnect(r,n)}safeDisconnect(e,n){return v2(this,arguments,void 0,function*(r,s,i=!1,o=1e3){let a=0;yield v2(this,void 0,void 0,function*(){return new Promise(l=>{const u=setInterval(()=>{i&&a>=5&&this.clearQueues(),this.getPendingRequestQueueSize()===0&&this.getSentRequestsQueueSize()===0&&(clearInterval(u),l(!0)),a+=1},o)})}),this.disconnect(r,s)})}removeAllListeners(e){this._eventEmitter.removeAllListeners(e)}_onError(e){this.isReconnecting?this._reconnect():this._eventEmitter.emit("error",e)}reset(){this._sentRequestsQueue.clear(),this._pendingRequestsQueue.clear(),this._init(),this._removeSocketListeners(),this._addSocketListeners()}_reconnect(){this.isReconnecting||(this.isReconnecting=!0,this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((e,n)=>{e.deferredPromise.reject(new gV),this._sentRequestsQueue.delete(n)}),this._reconnectAttempts<this._reconnectOptions.maxAttempts?(this._reconnectAttempts+=1,setTimeout(()=>{this._removeSocketListeners(),this.connect(),this.isReconnecting=!1},this._reconnectOptions.delay)):(this.isReconnecting=!1,this._clearQueues(),this._removeSocketListeners(),this._eventEmitter.emit("error",new mV(this._reconnectOptions.maxAttempts))))}request(e){return v2(this,void 0,void 0,function*(){if(Ss(this._socketConnection))throw new Error("Connection is undefined");this.getStatus()==="disconnected"&&this.connect();const n=u_(e)?e[0].id:e.id;if(!n)throw new vV("Request Id not defined");if(this._sentRequestsQueue.has(n))throw new yV(n);const r=new TH;r.catch(i=>{this._eventEmitter.emit("error",i)});const s={payload:e,deferredPromise:r};if(this.getStatus()==="connecting")return this._pendingRequestsQueue.set(n,s),s.deferredPromise;this._sentRequestsQueue.set(n,s);try{this._sendToSocket(s.payload)}catch(i){this._sentRequestsQueue.delete(n),this._eventEmitter.emit("error",i)}return r})}_onConnect(){this._connectionStatus="connected",this._reconnectAttempts=0,super._onConnect(),this._sendPendingRequests()}_sendPendingRequests(){for(const[e,n]of this._pendingRequestsQueue.entries())try{this._sendToSocket(n.payload),this._pendingRequestsQueue.delete(e),this._sentRequestsQueue.set(e,n)}catch(r){this._pendingRequestsQueue.delete(e),this._eventEmitter.emit("error",r)}}_onMessage(e){const n=this._parseResponses(e);if(!(Ss(n)||n.length===0))for(const r of n){if(c_(r)&&r.method.endsWith("_subscription")){this._eventEmitter.emit("message",r);return}const s=sx(r)?r[0].id:r.id,i=this._sentRequestsQueue.get(s);if(!i)return;(sx(r)||L1(r)||B1(r))&&(this._eventEmitter.emit("message",r),i.deferredPromise.resolve(r)),this._sentRequestsQueue.delete(s)}}clearQueues(e){this._clearQueues(e)}_clearQueues(e){this._pendingRequestsQueue.size>0&&this._pendingRequestsQueue.forEach((n,r)=>{n.deferredPromise.reject(new Xm(e)),this._pendingRequestsQueue.delete(r)}),this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach((n,r)=>{n.deferredPromise.reject(new Xm(e)),this._sentRequestsQueue.delete(r)}),this._removeSocketListeners()}}const _H=Object.freeze(Object.defineProperty({__proto__:null,ChunkResponseParser:AH,Eip1193Provider:NH,EventEmitter:hH,SocketProvider:Dbe,Web3DeferredPromise:TH,asciiToHex:lH,bytesToHex:Gt,bytesToUint8Array:pc,checkAddressCheckSum:lbe,compareBlockNumbers:ybe,convert:P1,convertScalarValue:Tg,encodePacked:o_,ethUnitMap:r_,format:yH,fromAscii:tbe,fromDecimal:Qve,fromTwosComplement:vbe,fromUtf8:cH,fromWei:rbe,getStorageSlotNumForLongString:Ebe,hexToAscii:uH,hexToBytes:Hn,hexToNumber:R1,hexToNumberString:Yve,hexToString:ebe,hexToUtf8:O1,isAddress:ube,isBatchRequest:u_,isBatchResponse:sx,isBloom:dbe,isContractAddressInBloom:pbe,isContractInitOptions:Sm,isDataFormat:vT,isHex:cbe,isHexStrict:abe,isInBloom:fbe,isNullish:Ss,isPromise:Abe,isResponseRpcError:IH,isResponseWithError:B1,isResponseWithNotification:c_,isResponseWithResult:L1,isSubscriptionResult:SH,isTopic:mbe,isTopicInBloom:gbe,isUint8Array:Fl,isUserEthereumAddressInBloom:hbe,isValidResponse:l_,jsonRpc:Rbe,keccak256:bT,keccak256Wrapper:bT,leftPad:yT,mergeDeep:i_,numberToHex:No,padLeft:gh,padRight:pH,pollTillDefined:Nbe,pollTillDefinedAndReturnIntervalId:xH,processSolidityEncodePackedArgs:bH,randomBytes:Ag,randomHex:Tbe,rejectIfConditionAtInterval:$be,rejectIfTimeout:_be,rightPad:mH,setRequestIdStart:kH,sha3:D1,sha3Raw:$a,soliditySha3:Sbe,soliditySha3Raw:kbe,stringToHex:Zve,toAscii:nbe,toBatchPayload:EH,toBigInt:Tu,toBool:dH,toChecksumAddress:l0,toDecimal:Xve,toHex:nx,toNumber:Ea,toPayload:Ng,toTwosComplement:gH,toUtf8:Jve,toWei:sbe,uint8ArrayConcat:Ts,uint8ArrayEquals:$1,utf8ToBytes:s_,utf8ToHex:mc,uuidV4:a_,validateResponse:rx,waitWithTimeout:wH},Symbol.toStringTag,{value:"Module"}));var ua;(function(t){t.HTTPS="https",t.WebSocket="wss"})(ua||(ua={}));var Ve;(function(t){t.ETH_MAINNET="eth_mainnet",t.ETH_SEPOLIA="eth_sepolia",t.ETH_HOLESKY="eth_holesky",t.POLYGON_MAINNET="polygon_mainnet",t.POLYGON_AMOY="polygon_amoy",t.AVALANCHE_C_MAINNET="avalanche_c_mainnet",t.AVALANCHE_P_MAINNET="avalanche_p_mainnet",t.AVALANCHE_X_MAINNET="avalanche_x_mainnet",t.ARBITRUM_MAINNET="arbitrum_mainnet",t.ARBITRUM_SEPOLIA="arbitrum_sepolia",t.BASE_MAINNET="base_mainnet",t.BASE_SEPOLIA="base_sepolia",t.OPTIMISM_MAINNET="optimism_mainnet",t.OPTIMISM_SEPOLIA="optimism_sepolia",t.FANTOM_MAINNET="fantom_mainnet",t.FANTOM_TESTNET="fantom_testnet",t.DYMENSION_MAINNET="dymension_mainnet",t.DYMENSION_TESTNET="dymension_testnet",t.BNB_MAINNET="bnb_mainnet",t.BNB_TESTNET="bnb_testnet",t.BSC_MAINNET="bsc_mainnet",t.BSC_TESTNET="bsc_testnet",t.ARBITRUM_ONE="arbitrum_one",t.ARBITRUM_NOVA="arbitrum_nova",t.AVALANCHE_FUJI_C="avalanche_fuji_c",t.AVALANCHE_FUJI_P="avalanche_fuji_p",t.AVALANCHE_FUJI_X="avalanche_fuji_x",t.BLAST_MAINNET="blast_mainnet",t.OPBNB_MAINNET="opbnb_mainnet",t.OPBNB_TESTNET="opbnb_testnet",t.GNOSIS_MAINNET="gnosis_mainnet",t.GNOSIS_CHIADO="gnosis_chiado",t.PULSECHAIN_MAINNET="pulsechain_mainnet",t.PULSECHAIN_TESTNET="pulsechain_testnet",t.KAVA_MAINNET="kava_mainnet",t.CRONOS_MAINNET="cronos_mainnet",t.MANTLE_MAINNET="mantle_mainnet",t.CHILIZ_MAINNET="chiliz_mainnet",t.CHILIZ_SPICY="chiliz_spicy",t.MOONBEAM_MAINNET="moonbeam_mainnet",t.TAIKO_MAINNET="taiko_mainnet",t.TAIKO_HEKLA="taiko_hekla",t.LINEA_MAINNET="linea_mainnet",t.LINEA_SEPOLIA="linea_sepolia",t.BAHAMUT_MAINNET="bahamut_mainnet",t.SCROLL_MAINNET="scroll_mainnet",t.SCROLL_SEPOLIA="scroll_sepolia",t.TRON_MAINNET="tron_mainnet",t.SYSCOIN_MAINNET="syscoin_mainnet",t.SYSCOIN_TANENBAUM="syscoin_tanenbaum",t.MOONRIVER_MAINNET="moonriver_mainnet",t.HAQQ_MAINNET="haqq_mainnet",t.EVMOS_MAINNET="evmos_mainnet",t.EVMOS_TESTNET="evmos_testnet",t.BERACHAIN_TESTNET="berachain_testnet"})(Ve||(Ve={}));const b2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Fbe(t=32){if(b2&&typeof b2.getRandomValues=="function")return b2.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Lbe(t){var e,n;return t instanceof Uint8Array||((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||((n=t?.constructor)===null||n===void 0?void 0:n.name)==="Buffer"}BigInt(0),BigInt(1),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e3),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e6),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e9),BigInt(1e12),BigInt(1e12),BigInt(1e12),BigInt(1e15),BigInt(1e15),BigInt(1e15),BigInt("1000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000"),BigInt("1000000000000000000000000"),BigInt("1000000000000000000000000000"),BigInt("1000000000000000000000000000000");const Bbe=t=>{if(Me.validate(["bytes"],[t]),Lbe(t))return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="string")return kr(t);throw new Js(t)},{uint8ArrayToHexString:Mbe}=Ai,zbe=t=>Mbe(Bbe(t));var w2={exports:{}},XB;function Ube(){return XB||(XB=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||c,h),g=n?n+l:l;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,g=new Array(m);h<m;h++)g[h]=d[h].fn;return g},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,m,g){var v=n?n+l:l;if(!this._events[v])return!1;var y=this._events[v],w=arguments.length,x,S;if(y.fn){switch(y.once&&this.removeListener(l,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,d),!0;case 4:return y.fn.call(y.context,u,d,h),!0;case 5:return y.fn.call(y.context,u,d,h,m),!0;case 6:return y.fn.call(y.context,u,d,h,m,g),!0}for(S=1,x=new Array(w-1);S<w;S++)x[S-1]=arguments[S];y.fn.apply(y.context,x)}else{var k=y.length,E;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(l,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,d);break;case 4:y[S].fn.call(y[S].context,u,d,h);break;default:if(!x)for(E=1,x=new Array(w-1);E<w;E++)x[E-1]=arguments[E];y[S].fn.apply(y[S].context,x)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var m=n?n+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,y=[],w=g.length;v<w;v++)(g[v].fn!==u||h&&!g[v].once||d&&g[v].context!==d)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(w2)),w2.exports}var Vbe=Ube();const jbe=Wo(Vbe);function Hbe(t){return Fbe(t)}const Wbe=t=>Hbe(t),Gbe=()=>{const t=Wbe(16);t[6]=t[6]&15|64,t[8]=t[8]&63|128;const e=zbe(t);return[e.substring(2,10),e.substring(10,14),e.substring(14,18),e.substring(18,22),e.substring(22,34)].join("-")};let qbe;const QB=t=>{var e,n,r,s;return{jsonrpc:(e=t.jsonrpc)!==null&&e!==void 0?e:"2.0",id:(r=(n=t.id)!==null&&n!==void 0?n:qbe)!==null&&r!==void 0?r:Gbe(),method:t.method,params:(s=t.params)!==null&&s!==void 0?s:void 0}};var YB=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class Kbe extends yd{constructor(){super(...arguments),this._eventEmitter=new jbe,this._chainId="",this._accounts=[]}_getChainId(){return YB(this,void 0,void 0,function*(){var e;const n=yield this.request(QB({method:"eth_chainId",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:""})}_getAccounts(){return YB(this,void 0,void 0,function*(){var e;const n=yield this.request(QB({method:"eth_accounts",params:[]}));return(e=n?.result)!==null&&e!==void 0?e:[]})}_onConnect(){Promise.all([this._getChainId().then(e=>{e!==this._chainId&&(this._chainId=e,this._eventEmitter.emit("chainChanged",this._chainId))}).catch(e=>{console.error(e)}),this._getAccounts().then(e=>{this._accounts.length===e.length&&e.every(n=>e.includes(n))||(this._accounts=e,this._onAccountsChanged())}).catch(e=>{console.error(e)})]).then(()=>this._eventEmitter.emit("connect",{chainId:this._chainId})).catch(e=>{console.error(e)})}_onDisconnect(e,n){this._eventEmitter.emit("disconnect",new oN(e,n))}_onAccountsChanged(){this._eventEmitter.emit("accountsChanged",this._accounts)}}const Xbe=1300;class Qbe extends ht{constructor(e){super("You've reach the rate limit of free RPC calls from our Partner Quick Nodes. There are two options you can either create a paid Quick Nodes account and get 20% off for 2 months using WEB3JS referral code, or use Free public RPC endpoint.",e),this.code=Xbe}}const Ybe=1301;class ZB extends ht{constructor(e){super(`Invalid provider config options given for ${e}`),this.code=Ybe}}var Zbe=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class $H extends Kbe{constructor(e,n,r,s,i){if(super(),i!==void 0&&n===ua.HTTPS&&!("providerOptions"in i))throw new ZB("HTTP Provider");if(i!==void 0&&n===ua.WebSocket&&!("socketOptions"in i||"reconnectOptions"in i))throw new ZB("Websocket Provider");this.transport=n,n===ua.HTTPS?this.provider=new b1(this.getRPCURL(e,n,r,s),i):n===ua.WebSocket&&(this.provider=new ij(this.getRPCURL(e,n,r,s),i?.socketOptions,i?.reconnectOptions))}request(e,n){return Zbe(this,void 0,void 0,function*(){return this.transport===ua.HTTPS?yield this.provider.request(e,n):this.provider.request(e)})}getStatus(){return this.provider.getStatus()}supportsSubscriptions(){return this.provider.supportsSubscriptions()}once(e,n){var r;!((r=this.provider)===null||r===void 0)&&r.once&&this.provider.once(e,n)}removeAllListeners(e){var n;!((n=this.provider)===null||n===void 0)&&n.removeAllListeners&&this.provider.removeAllListeners(e)}connect(){var e;!((e=this.provider)===null||e===void 0)&&e.connect&&this.provider.connect()}disconnect(e,n){var r;!((r=this.provider)===null||r===void 0)&&r.disconnect&&this.provider.disconnect(e,n)}reset(){var e;!((e=this.provider)===null||e===void 0)&&e.reset&&this.provider.reset()}on(e,n){this.provider&&this.provider.on(e,n)}removeListener(e,n){this.provider&&this.provider.removeListener(e,n)}}var Jbe=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const $r=t=>t!==void 0&&t.trim().length>0;class ewe extends $H{constructor(e=Ve.ETH_MAINNET,n=ua.HTTPS,r="",s="",i){super(e,n,r,s,i)}request(e,n){const r=Object.create(null,{request:{get:()=>super.request}});return Jbe(this,void 0,void 0,function*(){try{return yield r.request.call(this,e,n)}catch(s){throw s instanceof ca&&s.statusCode===429?new Qbe(s):s}})}getRPCURL(e,n,r,s){let i="",o="";switch(e){case Ve.ETH_MAINNET:i=$r(s)?s:"powerful-holy-bush.quiknode.pro",o=$r(r)?r:"3240624a343867035925ff7561eb60dfdba2a668";break;case Ve.ETH_SEPOLIA:i=$r(s)?s:"dimensional-fabled-glitter.ethereum-sepolia.quiknode.pro",o=$r(r)?r:"382a3b5a4b938f2d6e8686c19af4b22921fde2cd";break;case Ve.ETH_HOLESKY:i=$r(s)?s:"yolo-morning-card.ethereum-holesky.quiknode.pro",o=$r(r)?r:"481ebe70638c4dcf176af617a16d02ab866b9af9";break;case Ve.ARBITRUM_MAINNET:i=$r(s)?s:"autumn-divine-dinghy.arbitrum-mainnet.quiknode.pro",o=$r(r)?r:"a5d7bfbf60b5ae9ce3628e53d69ef50d529e9a8c";break;case Ve.ARBITRUM_SEPOLIA:i=$r(s)?s:"few-patient-pond.arbitrum-sepolia.quiknode.pro",o=$r(r)?r:"3be985450970628c860b959c65cd2642dcafe53c";break;case Ve.BNB_MAINNET:i=$r(s)?s:"purple-empty-reel.bsc.quiknode.pro",o=$r(r)?r:"ebf6c532961e21f092ff2facce1ec4c89c540158";break;case Ve.BNB_TESTNET:i=$r(s)?s:"floral-rough-scion.bsc-testnet.quiknode.pro",o=$r(r)?r:"5b297e5acff5f81f4c37ebf6f235f7299b6f9d28";break;case Ve.POLYGON_MAINNET:i=$r(s)?s:"small-chaotic-moon.matic.quiknode.pro",o=$r(r)?r:"847569f8a017e84d985e10d0f44365d965a951f1";break;case Ve.POLYGON_AMOY:i=$r(s)?s:"prettiest-side-shape.matic-amoy.quiknode.pro",o=$r(r)?r:"79a9476eea661d4f82de614db1d8a895b14b881c";break;default:throw new Error("Network info not avalible.")}return`${n}://${i}/${o}`}}const twe=t=>t!==void 0&&t.trim().length>0,nwe=[Ve.DYMENSION_MAINNET,Ve.DYMENSION_TESTNET,Ve.KAVA_MAINNET,Ve.CRONOS_MAINNET,Ve.POLYGON_MAINNET];class ix extends $H{constructor(e=Ve.ETH_MAINNET,n=ua.HTTPS,r="",s){super(e,n,"",r,s)}getRPCURL(e,n,r,s){if(!ix.networkHostMap[e])throw new Error("Network info not avalible.");const i=`${ix.networkHostMap[e]}.publicnode.com`,o=twe(s)?s:i;return nwe.includes(e)&&n===ua.WebSocket?`${n}://${o}/websocket`:`${n}://${o}`}}ix.networkHostMap={[Ve.POLYGON_AMOY]:"polygon-amoy-bor-rpc",[Ve.DYMENSION_MAINNET]:"dymension-evm-rpc",[Ve.DYMENSION_TESTNET]:"dymension-testnet-evm-rpc",[Ve.BLAST_MAINNET]:"blast-rpc",[Ve.GNOSIS_MAINNET]:"gnosis-rpc",[Ve.PULSECHAIN_MAINNET]:"pulsechain-rpc",[Ve.PULSECHAIN_TESTNET]:"pulsechain-testnet-rpc",[Ve.KAVA_MAINNET]:"kava-evm-rpc",[Ve.CRONOS_MAINNET]:"cronos-evm-rpc",[Ve.MANTLE_MAINNET]:"mantle-rpc",[Ve.TAIKO_MAINNET]:"taiko-rpc",[Ve.TAIKO_HEKLA]:"taiko-hekla-rpc",[Ve.LINEA_MAINNET]:"linea-rpc",[Ve.LINEA_SEPOLIA]:"linea-sepolia-rpc",[Ve.SCROLL_MAINNET]:"scroll-rpc",[Ve.SCROLL_SEPOLIA]:"scroll-sepolia-rpc",[Ve.SYSCOIN_MAINNET]:"syscoin-evm-rpc",[Ve.SYSCOIN_TANENBAUM]:"syscoin-tanenbaum-evm-rpc",[Ve.HAQQ_MAINNET]:"haqq-evm-rpc",[Ve.EVMOS_MAINNET]:"evmos-evm-rpc",[Ve.EVMOS_TESTNET]:"evmos-testnet-evm-rpc",[Ve.BERACHAIN_TESTNET]:"berachain-testnet-evm-rpc",[Ve.ETH_MAINNET]:"ethereum-rpc",[Ve.ETH_SEPOLIA]:"ethereum-sepolia-rpc",[Ve.ETH_HOLESKY]:"ethereum-holesky-rpc",[Ve.BSC_MAINNET]:"bsc-rpc",[Ve.BSC_TESTNET]:"bsc-testnet-rpc",[Ve.POLYGON_MAINNET]:"polygon-bor-rpc",[Ve.BASE_MAINNET]:"base-rpc",[Ve.BASE_SEPOLIA]:"base-sepolia-rpc",[Ve.ARBITRUM_ONE]:"arbitrum-one-rpc",[Ve.ARBITRUM_NOVA]:"arbitrum-nova-rpc",[Ve.ARBITRUM_SEPOLIA]:"arbitrum-sepolia-rpc",[Ve.AVALANCHE_C_MAINNET]:"avalanche-c-chain-rpc",[Ve.AVALANCHE_P_MAINNET]:"avalanche-p-chain-rpc",[Ve.AVALANCHE_X_MAINNET]:"avalanche-x-chain-rpc",[Ve.AVALANCHE_FUJI_C]:"avalanche-fuji-c-chain-rpc",[Ve.AVALANCHE_FUJI_P]:"avalanche-fuji-p-chain-rpc",[Ve.AVALANCHE_FUJI_X]:"avalanche-fuji-x-chain-rpc",[Ve.OPTIMISM_MAINNET]:"optimism-rpc",[Ve.OPTIMISM_SEPOLIA]:"optimism-sepolia-rpc",[Ve.FANTOM_MAINNET]:"fantom-rpc",[Ve.FANTOM_TESTNET]:"fantom-testnet-rpc",[Ve.OPBNB_MAINNET]:"opbnb-rpc",[Ve.OPBNB_TESTNET]:"opbnb-testnet-rpc",[Ve.GNOSIS_CHIADO]:"gnosis-chiado-rpc",[Ve.CHILIZ_MAINNET]:"chiliz-rpc",[Ve.CHILIZ_SPICY]:"chiliz-spicy-rpc",[Ve.MOONBEAM_MAINNET]:"moonbeam-rpc",[Ve.BAHAMUT_MAINNET]:"bahamut-rpc",[Ve.TRON_MAINNET]:"tron-evm-rpc",[Ve.MOONRIVER_MAINNET]:"moonriver-rpc"};const rwe=new ewe,swe=t=>!Ss(t)&&typeof t=="object"&&!Ss(t.type)&&t.type==="error",RH=t=>!Ss(t)&&typeof t=="object"&&!Ss(t.type)&&t.type==="event",d_=t=>!Ss(t)&&typeof t=="object"&&!Ss(t.type)&&t.type==="function",iwe=t=>typeof t=="object"&&typeof t.components>"u"&&typeof t.name>"u",OH=t=>t.includes("[]")?{type:"tuple[]",name:t.slice(0,-2)}:{type:"tuple",name:t},PH=t=>{const e=[];for(const n of Object.keys(t)){const r=t[n];typeof r=="object"?e.push(Object.assign(Object.assign({},OH(n)),{components:PH(r)})):e.push({name:n,type:t[n]})}return e},wT=(t,e)=>{const n=[];return e.forEach(r=>{if(typeof r.components=="object"){if(!r.type.startsWith("tuple"))throw new Oe(`Invalid value given "${r.type}". Error: components found but type is not tuple.`);const s=r.type.indexOf("["),i=s>=0?r.type.substring(s):"",o=wT(t,r.components);n.push(`(${o.join(",")})${i}`)}else n.push(r.type)}),n},DH=t=>{var e,n,r,s;return swe(t)||RH(t)||d_(t)?!((e=t.name)===null||e===void 0)&&e.includes("(")?t.name:`${(n=t.name)!==null&&n!==void 0?n:""}(${wT(!1,(r=t.inputs)!==null&&r!==void 0?r:[]).join(",")})`:`(${wT(!1,(s=t.inputs)!==null&&s!==void 0?s:[]).join(",")})`},owe=t=>{if(typeof t!="string"&&!RH(t))throw new Oe("Invalid parameter value in encodeEventSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=DH(t):e=t,$a(e)};function f_(t,e){return t.exec(e)?.groups}var FH=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,LH=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,BH=/^\(.+?\).*?$/,awe=Object.defineProperty,cwe=(t,e,n)=>e in t?awe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lm=(t,e,n)=>(cwe(t,typeof e!="symbol"?e+"":e,n),n),lwe="abitype",uwe="0.7.1",Ks=class extends Error{constructor(t,e={}){const n=e.cause instanceof Ks?e.cause.details:e.cause?.message?e.cause.message:e.details,r=e.cause instanceof Ks&&e.cause.docsPath||e.docsPath,s=[t||"An error occurred.","",...e.metaMessages?[...e.metaMessages,""]:[],...r?[`Docs: https://abitype.dev${r}`]:[],...n?[`Details: ${n}`]:[],`Version: ${lwe}@${uwe}`].join(`
`);super(s),lm(this,"details"),lm(this,"docsPath"),lm(this,"metaMessages"),lm(this,"shortMessage"),lm(this,"name","AbiTypeError"),e.cause&&(this.cause=e.cause),this.details=n,this.docsPath=r,this.metaMessages=e.metaMessages,this.shortMessage=t}},MH=/^struct (?<name>[a-zA-Z0-9_]+) \{(?<properties>.*?)\}$/;function zH(t){return MH.test(t)}function dwe(t){return f_(MH,t)}var JB=new Set(["memory","indexed","storage","calldata"]),fwe=new Set(["calldata","memory","storage"]);function hwe(t,e){return e?`${e}:${t}`:t}var x2=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]),pwe=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,mwe=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,gwe=/^u?int$/;function ox(t,e){const n=hwe(t,e?.type);if(x2.has(n))return x2.get(n);const r=BH.test(t),s=f_(r?mwe:pwe,t);if(!s)throw new Ks("Invalid ABI parameter.",{details:t});if(s.name&&vwe(s.name))throw new Ks("Invalid ABI parameter.",{details:t,metaMessages:[`"${s.name}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,l={};if(r){c="tuple";const d=Tf(s.type),h=[],m=d.length;for(let g=0;g<m;g++)h.push(ox(d[g],{structs:a}));l={components:h}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(gwe.test(s.type))c=`${s.type}256`;else if(c=s.type,e?.type!=="struct"&&!UH(c))throw new Ks("Unknown type.",{metaMessages:[`Type "${c}" is not a valid ABI type.`]});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new Ks("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`]});if(fwe.has(s.modifier)&&!bwe(c,!!s.array))throw new Ks("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${s.modifier}" not allowed${e?.type?` in "${e.type}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${s.modifier}" was given.`]})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return x2.set(n,u),u}function Tf(t,e=[],n="",r=0){if(t===""){if(n==="")return e;if(r!==0)throw new Ks("Unbalanced parentheses.",{metaMessages:[`"${n.trim()}" has too many ${r>0?"opening":"closing"} parentheses.`],details:`Depth "${r}"`});return[...e,n.trim()]}const s=t.length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?Tf(a,[...e,n.trim()]):Tf(a,e,`${n}${o}`,r);case"(":return Tf(a,e,`${n}${o}`,r+1);case")":return Tf(a,e,`${n}${o}`,r-1);default:return Tf(a,e,`${n}${o}`,r)}}return[]}function UH(t){return t==="address"||t==="bool"||t==="function"||t==="string"||FH.test(t)||LH.test(t)}var ywe=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function vwe(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||FH.test(t)||LH.test(t)||ywe.test(t)}function bwe(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function wwe(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!zH(a))continue;const c=dwe(a);if(!c)throw new Ks("Invalid struct signature.",{details:a});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const g=l[h].trim();if(!g)continue;const v=ox(g,{type:"struct"});u.push(v)}if(!u.length)throw new Ks("Invalid struct signature.",{details:a,metaMessages:["No properties exist."]});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=VH(c,e)}return r}var xwe=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?$/;function VH(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(BH.test(o.type))r.push(o);else{const c=f_(xwe,o.type);if(!c?.type)throw new Ks("Invalid ABI parameter.",{details:JSON.stringify(o,null,2),metaMessages:["ABI parameter type is invalid."]});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new Ks("Circular reference detected.",{metaMessages:[`Struct "${u}" is a circular reference.`]});r.push({...o,type:`tuple${l??""}`,components:VH(e[u]??[],e,new Set([...n,u]))})}else if(UH(u))r.push(o);else throw new Ks("Unknown type.",{metaMessages:[`Type "${u}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]})}}return r}function Iwe(t){let e;if(typeof t=="string")e=ox(t,{modifiers:JB});else{const n=wwe(t),r=t.length;for(let s=0;s<r;s++){const i=t[s];if(!zH(i)){e=ox(i,{modifiers:JB,structs:n});break}}}if(!e)throw new Ks("Failed to parse ABI parameter.",{details:`parseAbiParameter(${JSON.stringify(t,null,2)})`,docsPath:"/api/human.html#parseabiparameter-1"});return e}const Gn=32;function xT(t=0){var e;if(((e=globalThis.Buffer)===null||e===void 0?void 0:e.alloc)!==void 0){const n=globalThis.Buffer.alloc(t);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}return new Uint8Array(t)}function jH(t){var e,n;return Object.assign(Object.assign({},t),{name:(e=t.name)!==null&&e!==void 0?e:"",components:(n=t.components)===null||n===void 0?void 0:n.map(r=>jH(r))})}function Swe(t){return!Ss(t)&&typeof t=="object"&&!Ss(t.type)&&typeof t.type=="string"}function HH(t){return t.map(e=>{var n;if(Swe(e))return e;if(typeof e=="string")return jH(Iwe(e.replace(/tuple/,"")));if(iwe(e)){const r=Object.keys(e)[0],s=OH(r);return s.name=(n=s.name)!==null&&n!==void 0?n:"",Object.assign(Object.assign({},s),{components:PH(e[r])})}throw new Oe("Invalid abi")})}function h_(t){const e=t.type.lastIndexOf("["),n=t.type.substring(0,e),r=t.type.substring(e);let s=-1;if(r!=="[]"&&(s=Number(r.slice(1,-1)),isNaN(s)))throw new Oe("Invalid fixed array size",{size:r});return{param:{type:n,name:"",components:t.components},size:s}}function ax(t){var e,n;return t.type==="string"||t.type==="bytes"||t.type.endsWith("[]")?!0:t.type==="tuple"?(n=(e=t.components)===null||e===void 0?void 0:e.some(ax))!==null&&n!==void 0?n:!1:t.type.endsWith("]")?ax(h_(t).param):!1}const WH=20,GH=Gn-WH;function kwe(t,e){if(typeof e!="string")throw new Oe("address type expects string as input type",{value:e,name:t.name,type:t.type});let n=e.toLowerCase();if(n.startsWith("0x")||(n=`0x${n}`),!mr(n))throw new Oe("provided input is not valid address",{value:e,name:t.name,type:t.type});const r=kr(n),s=xT(Gn);return s.set(r,GH),{dynamic:!1,encoded:s}}function Ewe(t,e){const n=e.subarray(GH,Gn);if(n.length!==WH)throw new Oe("Invalid decoding input, not enough bytes to decode address",{bytes:e});const r=Ur(n);return{result:l0(r),encoded:e.subarray(Gn),consumed:Gn}}const Il=new Map;let ub=BigInt(256);for(let t=8;t<=256;t+=8)Il.set(`uint${t}`,{min:BigInt(0),max:ub-BigInt(1)}),Il.set(`int${t}`,{min:-ub/BigInt(2),max:ub/BigInt(2)-BigInt(1)}),ub*=BigInt(256);Il.set("int",Il.get("int256"));Il.set("uint",Il.get("uint256"));const qH=BigInt(1)<<BigInt(256);function Cwe(t,e=Gn){let n;return t<0?n=(qH+t).toString(16):n=t.toString(16),n=gh(n,e*2),kr(n)}function Twe(t,e){const n=Ur(t),r=BigInt(n);return r<=e?r:r-qH}function u0(t,e){let n;try{n=Tu(e)}catch{throw new Oe("provided input is not number value",{type:t.type,value:e,name:t.name})}const r=Il.get(t.type);if(!r)throw new Oe("provided abi contains invalid number datatype",{type:t.type});if(n<r.min)throw new Oe("provided input is less then minimum for given type",{type:t.type,value:e,name:t.name,minimum:r.min.toString()});if(n>r.max)throw new Oe("provided input is greater then maximum for given type",{type:t.type,value:e,name:t.name,maximum:r.max.toString()});return{dynamic:!1,encoded:Cwe(n)}}function yh(t,e){if(e.length<Gn)throw new Oe("Not enough bytes left to decode",{param:t,bytesLeft:e.length});const n=e.subarray(0,Gn),r=Il.get(t.type);if(!r)throw new Oe("provided abi contains invalid number datatype",{type:t.type});const s=Twe(n,r.max);if(s<r.min)throw new Oe("decoded value is less then minimum for given type",{type:t.type,value:s,name:t.name,minimum:r.min.toString()});if(s>r.max)throw new Oe("decoded value is greater then maximum for given type",{type:t.type,value:s,name:t.name,maximum:r.max.toString()});return{result:s,encoded:e.subarray(Gn),consumed:Gn}}function Awe(t,e){let n;try{n=dH(e)}catch(r){if(r instanceof e0)throw new Oe("provided input is not valid boolean value",{type:t.type,value:e,name:t.name})}return u0({type:"uint8",name:""},Number(n))}function Nwe(t,e){const n=yh({type:"uint8",name:""},e);if(n.result>1||n.result<0)throw new Oe("Invalid boolean value encoded",{boolBytes:e.subarray(0,Gn),numberResult:n});return{result:n.result===BigInt(1),encoded:n.encoded,consumed:Gn}}const _we=32;function KH(t,e){if(typeof e=="string"&&e.length%2!==0&&(e+="0"),!xc(e))throw new Oe("provided input is not valid bytes value",{type:t.type,value:e,name:t.name});const n=pc(e),[,r]=t.type.split("bytes");if(r){if(Number(r)>_we||Number(r)<1)throw new Oe("invalid bytes type. Static byte type can have between 1 and 32 bytes",{type:t.type});if(Number(r)<n.length)throw new Oe("provided input size is different than type size",{type:t.type,value:e,name:t.name});const o=xT(Gn);return o.set(n),{dynamic:!1,encoded:o}}const s=Math.ceil(n.length/Gn),i=xT(Gn+s*Gn);return i.set(u0({type:"uint32",name:""},n.length).encoded),i.set(n,Gn),{dynamic:!0,encoded:i}}function XH(t,e){const[,n]=t.type.split("bytes");let r=Number(n),s=e,i=1,o=0;if(!r){const a=yh({type:"uint32",name:""},s);r=Number(a.result),o+=a.consumed,s=a.encoded,i=Math.ceil(r/Gn)}if(r>e.length)throw new Oe("there is not enough data to decode",{type:t.type,encoded:e,size:r});return{result:Gt(s.subarray(0,r)),encoded:s.subarray(i*Gn),consumed:o+i*Gn}}function $we(t,e){if(typeof e!="string")throw new Oe("invalid input, should be string",{input:e});const n=s_(e);return KH({type:"bytes",name:""},n)}function Rwe(t,e){const n=XH({type:"bytes"},e);return{result:O1(n.result),encoded:n.encoded,consumed:n.consumed}}function QH(t){let e=0,n=0;const r=[],s=[];for(const i of t)i.dynamic?e+=Gn:e+=i.encoded.length;for(const i of t)i.dynamic?(r.push(u0({type:"uint256",name:""},e+n)),s.push(i),n+=i.encoded.length):r.push(i);return Ts(...r.map(i=>i.encoded),...s.map(i=>i.encoded))}function Owe(t,e){if(!Array.isArray(e))throw new Oe("Expected value to be array",{abi:t,values:e});const{size:n,param:r}=h_(t),s=e.map(a=>IT(r,a)),i=n===-1,o=s.length>0&&s[0].dynamic;if(!i&&e.length!==n)throw new Oe("Given arguments count doesn't match array length",{arrayLength:n,argumentsLength:e.length});if(i||o){const a=QH(s);if(i){const c=u0({type:"uint256",name:""},s.length).encoded;return{dynamic:!0,encoded:s.length>0?Ts(c,a):c}}return{dynamic:!0,encoded:a}}return{dynamic:!1,encoded:Ts(...s.map(a=>a.encoded))}}function Pwe(t,e){let{size:n,param:r}=h_(t);const s=n===-1;let i=0;const o=[];let a=e;if(s){const l=yh({type:"uint32",name:""},e);n=Number(l.result),i=l.consumed,a=l.encoded}if(ax(r)){for(let l=0;l<n;l+=1){const u=yh({type:"uint32",name:""},a.subarray(l*Gn));i+=u.consumed;const d=cx(r,a.subarray(Number(u.result)));i+=d.consumed,o.push(d.result)}return{result:o,encoded:a.subarray(i),consumed:i}}for(let l=0;l<n;l+=1){const u=cx(r,e.subarray(i));i+=u.consumed,o.push(u.result)}return{result:o,encoded:e.subarray(i),consumed:i}}function IT(t,e){if(t.type==="string")return $we(t,e);if(t.type==="bool")return Awe(t,e);if(t.type==="address")return kwe(t,e);if(t.type==="tuple")return YH(t,e);if(t.type.endsWith("]"))return Owe(t,e);if(t.type.startsWith("bytes"))return KH(t,e);if(t.type.startsWith("uint")||t.type.startsWith("int"))return u0(t,e);throw new Oe("Unsupported",{param:t,value:e})}function cx(t,e){if(t.type==="string")return Rwe(t,e);if(t.type==="bool")return Nwe(t,e);if(t.type==="address")return Ewe(t,e);if(t.type==="tuple")return ZH(t,e);if(t.type.endsWith("]"))return Pwe(t,e);if(t.type.startsWith("bytes"))return XH(t,e);if(t.type.startsWith("uint")||t.type.startsWith("int"))return yh(t,e);throw new Oe("Unsupported",{param:t,bytes:e})}function YH(t,e){var n,r,s;let i=!1;if(!Array.isArray(e)&&typeof e!="object")throw new Oe("param must be either Array or Object",{param:t,input:e});const o=e,a=[];for(let c=0;c<((r=(n=t.components)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0);c+=1){const l=t.components[c];let u;if(Array.isArray(o)){if(c>=o.length)throw new Oe("input param length missmatch",{param:t,input:e});u=IT(l,o[c])}else{const d=o[(s=l.name)!==null&&s!==void 0?s:""];if(d==null)throw new Oe("missing input defined in abi",{param:t,input:e,paramName:l.name});u=IT(l,d)}u.dynamic&&(i=!0),a.push(u)}return i?{dynamic:!0,encoded:QH(a)}:{dynamic:!1,encoded:Ts(...a.map(c=>c.encoded))}}function ZH(t,e){const n={__length__:0};let r=0;if(!t.components)return{result:n,encoded:e,consumed:r};let s=0;for(const[i,o]of t.components.entries()){let a;if(ax(o)){const c=yh({type:"uint32",name:""},e.subarray(r));a=cx(o,e.subarray(Number(c.result))),r+=c.consumed,s+=a.consumed}else a=cx(o,e.subarray(r)),r+=a.consumed;n.__length__+=1,n[i]=a.result,o.name&&o.name!==""&&(n[o.name]=a.result)}return{encoded:e.subarray(r+s),result:n,consumed:r+s}}function Dwe(t,e,n){const r=HH(t),s=kr(e);return ZH({components:r},s).result}function p_(t,e){if(t?.length!==e.length)throw new Oe("Invalid number of values received for given ABI",{expected:t?.length,received:e.length});const n=HH(t);return Ur(YH({type:"tuple",name:"",components:n},e).encoded)}const Fwe=(t,e)=>p_([t],[e]),JH=(t,e,n)=>{try{if(t.length>0&&(!e||e==="0x"||e==="0X"))throw new Oe("Returned values aren't valid, did it run Out of Gas? You might also see this error if you are not using the correct ABI for the contract you are retrieving data from, requesting data from a block number that does not exist, or querying a node which is not fully synced.");return Dwe(t,`0x${e.replace(/0x/i,"")}`,n)}catch(r){throw new Oe(`Parameter decoding error: ${r.message}`,{internalErr:r})}},eW=(t,e)=>JH(t,e,!1),tW=(t,e)=>eW([t],e)[0],nW=t=>{if(typeof t!="string"&&!d_(t))throw new Oe("Invalid parameter value in encodeFunctionSignature");let e;return t&&(typeof t=="function"||typeof t=="object")?e=DH(t):e=t,$a(e).slice(0,10)},Lwe=(t,e)=>{var n;if(!d_(t))throw new Oe("Invalid parameter value in encodeFunctionCall");return`${nW(t)}${p_((n=t.inputs)!==null&&n!==void 0?n:[],e??[]).replace("0x","")}`},Bwe=["bool","string","int","uint","address","fixed","ufixed"],Mwe=(t,e)=>t==="string"?e:tW(t,e),zwe=(t,e,n)=>{const r=Array.isArray(n)?n:[n],s={},i={};for(const[h,m]of t.entries())m.indexed?s[h]=m:i[h]=m;const o=e?JH(Object.values(i),e,!0):{__length__:0},a=r.length-Object.keys(s).length,c=Object.values(s).map((h,m)=>Bwe.some(g=>h.type.startsWith(g))?Mwe(h.type,r[m+a]):r[m+a]),l={__length__:0};let u=0,d=0;for(const[h,m]of t.entries())l[h]=m.type==="string"?"":void 0,s[h]&&(l[h]=c[u],u+=1),i[h]&&(l[h]=o[String(d)],d+=1),m.name&&(l[m.name]=l[h]),l.__length__+=1;return l},Uwe={encodeEventSignature:owe,encodeFunctionCall:Lwe,encodeFunctionSignature:nW,encodeParameter:Fwe,encodeParameters:p_,decodeParameter:tW,decodeParameters:eW,decodeLog:zwe};var ff=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};class lx extends sse{constructor(){super(...arguments),this._addressMap=new Map,this._defaultKeyName="web3js_wallet"}static getStorage(){let e;try{e=window.localStorage;const n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(n){return n&&(n.code===22||n.code===1014||n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&!oe(e)&&e.length!==0?e:void 0}}create(e){for(let n=0;n<e;n+=1)this.add(this._accountProvider.create());return this}add(e){var n;if(typeof e=="string")return this.add(this._accountProvider.privateKeyToAccount(e));let r=this.length;return this.get(e.address)&&(console.warn(`Account ${e.address.toLowerCase()} already exists.`),r=(n=this._addressMap.get(e.address.toLowerCase()))!==null&&n!==void 0?n:r),this._addressMap.set(e.address.toLowerCase(),r),this[r]=e,this}get(e){if(typeof e=="string"){const n=this._addressMap.get(e.toLowerCase());return oe(n)?void 0:this[n]}return this[e]}remove(e){if(typeof e=="string"){const n=this._addressMap.get(e.toLowerCase());return oe(n)?!1:(this._addressMap.delete(e.toLowerCase()),this.splice(n,1),!0)}return this[e]?(this.splice(e,1),!0):!1}clear(){return this._addressMap.clear(),this.length=0,this}encrypt(e,n){return ff(this,void 0,void 0,function*(){return Promise.all(this.map(r=>ff(this,void 0,void 0,function*(){return r.encrypt(e,n)})))})}decrypt(e,n,r){return ff(this,void 0,void 0,function*(){const s=yield Promise.all(e.map(i=>ff(this,void 0,void 0,function*(){return this._accountProvider.decrypt(i,n,r)})));for(const i of s)this.add(i);return this})}save(e,n){return ff(this,void 0,void 0,function*(){const r=lx.getStorage();if(!r)throw new Error("Local storage not available.");return r.setItem(n??this._defaultKeyName,JSON.stringify(yield this.encrypt(e))),!0})}load(e,n){return ff(this,void 0,void 0,function*(){const r=lx.getStorage();if(!r)throw new Error("Local storage not available.");const s=r.getItem(n??this._defaultKeyName);return s&&(yield this.decrypt(JSON.parse(s)||[],e)),this})}}const pa={web:Bb};function rW(t,e,n){if(!n.startsWith("aes-"))throw new Error(`AES submodule doesn't support mode ${n}`);if(e.length!==16)throw new Error("AES: wrong IV length");if(n.startsWith("aes-128")&&t.length!==16||n.startsWith("aes-256")&&t.length!==32)throw new Error("AES: wrong key length")}async function sW(t,e,n){if(!pa.web)throw new Error("Browser crypto not available.");let r;if(["aes-128-cbc","aes-256-cbc"].includes(t)&&(r="cbc"),["aes-128-ctr","aes-256-ctr"].includes(t)&&(r="ctr"),!r)throw new Error("AES: unsupported mode");return[await pa.web.subtle.importKey("raw",e,{name:`AES-${r.toUpperCase()}`,length:e.length*8},!0,["encrypt","decrypt"]),{name:`aes-${r}`,iv:n,counter:n,length:128}]}async function m_(t,e,n,r="aes-128-ctr",s=!0){if(rW(e,n,r),pa.web){const[i,o]=await sW(r,e,n),a=await pa.web.subtle.encrypt(o,i,t);let c=new Uint8Array(a);return!s&&o.name==="aes-cbc"&&!(t.length%16)&&(c=c.slice(0,-16)),c}else if(pa.node){const i=pa.node.createCipheriv(r,e,n);return i.setAutoPadding(s),mT(i.update(t),i.final())}else throw new Error("The environment doesn't have AES module")}async function Vwe(t,e,n,r){const s=t.slice(-16);for(let o=0;o<16;o++)s[o]^=n[o]^16;return(await m_(s,e,n,r)).slice(0,16)}async function jwe(t,e,n,r="aes-128-ctr",s=!0){if(rW(e,n,r),pa.web){const[i,o]=await sW(r,e,n);if(!s&&o.name==="aes-cbc"){const l=await Vwe(t,e,n,r);t=mT(t,l)}const a=await pa.web.subtle.decrypt(o,i,t),c=new Uint8Array(a);if(o.name==="aes-cbc"){const l=await m_(c,e,n,r);if(!Gve(l,t))throw new Error("AES: wrong padding")}return c}else if(pa.node){const i=pa.node.createDecipheriv(r,e,n);return i.setAutoPadding(s),mT(i.update(t),i.final())}else throw new Error("The environment doesn't have AES module")}class iW extends t_{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,JN(e);const r=mh(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Ju(this),this.iHash.update(e),this}digestInto(e){Ju(this),Hh(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const oW=(t,e,n)=>new iW(t,e).update(n).digest();oW.create=(t,e)=>new iW(t,e);function Hwe(t,e,n,r){JN(t);const s=nH({dkLen:32,asyncTick:10},r),{c:i,dkLen:o,asyncTick:a}=s;if(Ws(i),Ws(o),Ws(a),i<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=mh(e),l=mh(n),u=new Uint8Array(o),d=oW.create(t,c),h=d._cloneInto().update(l);return{c:i,dkLen:o,asyncTick:a,DK:u,PRF:d,PRFSalt:h}}function Wwe(t,e,n,r,s){return t.destroy(),e.destroy(),r&&r.destroy(),s.fill(0),n}function g_(t,e,n,r){const{c:s,dkLen:i,DK:o,PRF:a,PRFSalt:c}=Hwe(t,e,n,r);let l;const u=new Uint8Array(4),d=zb(u),h=new Uint8Array(a.outputLen);for(let m=1,g=0;g<i;m++,g+=a.outputLen){const v=o.subarray(g,g+a.outputLen);d.setInt32(0,m,!1),(l=c._cloneInto(l)).update(u).digestInto(h),v.set(h.subarray(0,v.length));for(let y=1;y<s;y++){a._cloneInto(l).update(h).digestInto(h);for(let w=0;w<v.length;w++)v[w]^=h[w]}}return Wwe(a,c,o,l,h)}function Gwe(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}const qwe=(t,e,n)=>t&e^~t&n,Kwe=(t,e,n)=>t&e^t&n^e&n;class Xwe extends t_{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zb(this.buffer)}update(e){Ju(this);const{view:n,buffer:r,blockLen:s}=this;e=mh(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=zb(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ju(this),e_(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;Gwe(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=zb(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}}const Qwe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),el=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tl=new Uint32Array(64);class Ywe extends Xwe{constructor(){super(64,32,8,!1),this.A=el[0]|0,this.B=el[1]|0,this.C=el[2]|0,this.D=el[3]|0,this.E=el[4]|0,this.F=el[5]|0,this.G=el[6]|0,this.H=el[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)tl[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=tl[d-15],m=tl[d-2],g=ta(h,7)^ta(h,18)^h>>>3,v=ta(m,17)^ta(m,19)^m>>>10;tl[d]=v+tl[d-7]+g+tl[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=ta(a,6)^ta(a,11)^ta(a,25),m=u+h+qwe(a,c,l)+Qwe[d]+tl[d]|0,v=(ta(r,2)^ta(r,13)^ta(r,22))+Kwe(r,s,i)|0;u=l,l=c,c=a,a=o+m|0,o=i,i=s,s=r,r=m+v|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){tl.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const y_=rH(()=>new Ywe);function aW(t,e,n,r,s){if(!["sha256","sha512"].includes(s))throw new Error("Only sha256 and sha512 are supported");return tx(t),tx(e),g_(y_,t,e,{c:n,dkLen:r})}function eM(t,e,n,r,s,i){let o=t[e++]^n[r++],a=t[e++]^n[r++],c=t[e++]^n[r++],l=t[e++]^n[r++],u=t[e++]^n[r++],d=t[e++]^n[r++],h=t[e++]^n[r++],m=t[e++]^n[r++],g=t[e++]^n[r++],v=t[e++]^n[r++],y=t[e++]^n[r++],w=t[e++]^n[r++],x=t[e++]^n[r++],S=t[e++]^n[r++],k=t[e++]^n[r++],E=t[e++]^n[r++],A=o,R=a,N=c,P=l,O=u,_=d,M=h,G=m,q=g,D=v,L=y,K=w,j=x,W=S,X=k,H=E;for(let Y=0;Y<8;Y+=2)O^=Kt(A+j|0,7),q^=Kt(O+A|0,9),j^=Kt(q+O|0,13),A^=Kt(j+q|0,18),D^=Kt(_+R|0,7),W^=Kt(D+_|0,9),R^=Kt(W+D|0,13),_^=Kt(R+W|0,18),X^=Kt(L+M|0,7),N^=Kt(X+L|0,9),M^=Kt(N+X|0,13),L^=Kt(M+N|0,18),P^=Kt(H+K|0,7),G^=Kt(P+H|0,9),K^=Kt(G+P|0,13),H^=Kt(K+G|0,18),R^=Kt(A+P|0,7),N^=Kt(R+A|0,9),P^=Kt(N+R|0,13),A^=Kt(P+N|0,18),M^=Kt(_+O|0,7),G^=Kt(M+_|0,9),O^=Kt(G+M|0,13),_^=Kt(O+G|0,18),K^=Kt(L+D|0,7),q^=Kt(K+L|0,9),D^=Kt(q+K|0,13),L^=Kt(D+q|0,18),j^=Kt(H+X|0,7),W^=Kt(j+H|0,9),X^=Kt(W+j|0,13),H^=Kt(X+W|0,18);s[i++]=o+A|0,s[i++]=a+R|0,s[i++]=c+N|0,s[i++]=l+P|0,s[i++]=u+O|0,s[i++]=d+_|0,s[i++]=h+M|0,s[i++]=m+G|0,s[i++]=g+q|0,s[i++]=v+D|0,s[i++]=y+L|0,s[i++]=w+K|0,s[i++]=x+j|0,s[i++]=S+W|0,s[i++]=k+X|0,s[i++]=E+H|0}function I2(t,e,n,r,s){let i=r+0,o=r+16*s;for(let a=0;a<16;a++)n[o+a]=t[e+(2*s-1)*16+a];for(let a=0;a<s;a++,i+=16,e+=16)eM(n,o,t,e,n,i),a>0&&(o+=16),eM(n,i,t,e+=16,n,o)}function Zwe(t,e,n){const r=nH({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:s,r:i,p:o,dkLen:a,asyncTick:c,maxmem:l,onProgress:u}=r;if(Ws(s),Ws(i),Ws(o),Ws(a),Ws(c),Ws(l),u!==void 0&&typeof u!="function")throw new Error("progressCb should be function");const d=128*i,h=d/4;if(s<=1||(s&s-1)!==0||s>=2**(d/8)||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(o<0||o>(2**32-1)*32/d)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const m=d*(s+o);if(m>l)throw new Error(`Scrypt: parameters too large, ${m} (128 * r * (N + p)) > ${l} (maxmem)`);const g=g_(y_,t,e,{c:1,dkLen:d*o}),v=Mb(g),y=Mb(new Uint8Array(d*s)),w=Mb(new Uint8Array(d));let x=()=>{};if(u){const S=2*s*o,k=Math.max(Math.floor(S/1e4),1);let E=0;x=()=>{E++,u&&(!(E%k)||E===S)&&u(E/S)}}return{N:s,r:i,p:o,dkLen:a,blockSize32:h,V:y,B32:v,B:g,tmp:w,blockMixCb:x,asyncTick:c}}function Jwe(t,e,n,r,s){const i=g_(y_,t,n,{c:1,dkLen:e});return n.fill(0),r.fill(0),s.fill(0),i}function exe(t,e,n){const{N:r,r:s,p:i,dkLen:o,blockSize32:a,V:c,B32:l,B:u,tmp:d,blockMixCb:h}=Zwe(t,e,n);Jw||ex(l);for(let m=0;m<i;m++){const g=a*m;for(let v=0;v<a;v++)c[v]=l[g+v];for(let v=0,y=0;v<r-1;v++)I2(c,y,c,y+=a,s),h();I2(c,(r-1)*a,l,g,s),h();for(let v=0;v<r;v++){const y=l[g+a-16]%r;for(let w=0;w<a;w++)d[w]=l[g+w]^c[y*a+w];I2(d,0,l,g,s),h()}}return Jw||ex(l),Jwe(t,o,u,c,d)}function cW(t,e,n,r,s,i,o){return tx(t),tx(e),exe(t,e,{N:n,r:s,p:r,dkLen:i,onProgress:o})}const txe=Object.freeze(Object.defineProperty({__proto__:null,secp256k1:xd},Symbol.toStringTag,{value:"Module"}));var S2;const kc=(S2=xd)!==null&&S2!==void 0?S2:txe,tM=BigInt("0xffffffffffffffff"),_g=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),nxe=kc.CURVE.n,rxe=nxe/BigInt(2),sxe={type:"object",required:["crypto","id","version","address"],properties:{crypto:{type:"object",required:["cipher","ciphertext","cipherparams","kdf","kdfparams","mac"],properties:{cipher:{type:"string"},ciphertext:{type:"string"},cipherparams:{type:"object"},kdf:{type:"string"},kdfparams:{type:"object"},salt:{type:"string"},mac:{type:"string"}}},id:{type:"string"},version:{type:"number"},address:{type:"string"}}};var ux;(function(t){t[t.Mainnet=1]="Mainnet",t[t.Goerli=5]="Goerli",t[t.Sepolia=11155111]="Sepolia"})(ux||(ux={}));var mn;(function(t){t.Chainstart="chainstart",t.Homestead="homestead",t.Dao="dao",t.TangerineWhistle="tangerineWhistle",t.SpuriousDragon="spuriousDragon",t.Byzantium="byzantium",t.Constantinople="constantinople",t.Petersburg="petersburg",t.Istanbul="istanbul",t.MuirGlacier="muirGlacier",t.Berlin="berlin",t.London="london",t.ArrowGlacier="arrowGlacier",t.GrayGlacier="grayGlacier",t.MergeForkIdTransition="mergeForkIdTransition",t.Merge="merge",t.Shanghai="shanghai",t.ShardingForkDev="shardingFork"})(mn||(mn={}));var nM;(function(t){t.ProofOfStake="pos",t.ProofOfWork="pow",t.ProofOfAuthority="poa"})(nM||(nM={}));var rM;(function(t){t.Ethash="ethash",t.Clique="clique",t.Casper="casper"})(rM||(rM={}));var cs;(function(t){t.PolygonMainnet="polygon-mainnet",t.PolygonMumbai="polygon-mumbai",t.ArbitrumRinkebyTestnet="arbitrum-rinkeby-testnet",t.ArbitrumOne="arbitrum-one",t.xDaiChain="x-dai-chain",t.OptimisticKovan="optimistic-kovan",t.OptimisticEthereum="optimistic-ethereum"})(cs||(cs={}));var qi;(function(t){t[t.Number=0]="Number",t[t.BigInt=1]="BigInt",t[t.Uint8Array=2]="Uint8Array",t[t.PrefixedHexString=3]="PrefixedHexString"})(qi||(qi={}));const lW=t=>{if(typeof t!="string")throw new Error(`[stripHexPrefix] input must be type 'string', received ${typeof t}`);return Dh(t)?t.slice(2):t};function ixe(t){return!t||t==="0x0"?"0x0000000000000000":Dh(t)?`0x${lW(t).padStart(16,"0")}`:`0x${t.padStart(16,"0")}`}const uW=function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Received an invalid integer type: ${t}`);return`0x${t.toString(16)}`};function oxe(t,e=!0){var n,r;const{name:s,config:i,difficulty:o,mixHash:a,gasLimit:c,coinbase:l,baseFeePerGas:u}=t;let{extraData:d,timestamp:h,nonce:m}=t;const g=Number(h),{chainId:v}=i;if(d===""&&(d="0x"),Dh(h)||(h=uW(parseInt(h))),m.length!==18&&(m=ixe(m)),i.eip155Block!==i.eip158Block)throw new Error("EIP155 block number must equal EIP 158 block number since both are part of SpuriousDragon hardfork and the client only supports activating the full hardfork");const y={name:s,chainId:v,networkId:v,genesis:{timestamp:h,gasLimit:parseInt(c),difficulty:parseInt(o),nonce:m,extraData:d,mixHash:a,coinbase:l,baseFeePerGas:u},hardfork:void 0,hardforks:[],bootstrapNodes:[],consensus:i.clique!==void 0?{type:"poa",algorithm:"clique",clique:{period:(n=i.clique.period)!==null&&n!==void 0?n:i.clique.blockperiodseconds,epoch:(r=i.clique.epoch)!==null&&r!==void 0?r:i.clique.epochlength}}:{type:"pow",algorithm:"ethash",ethash:{}}},w={[mn.Homestead]:{name:"homesteadBlock"},[mn.Dao]:{name:"daoForkBlock"},[mn.TangerineWhistle]:{name:"eip150Block"},[mn.SpuriousDragon]:{name:"eip155Block"},[mn.Byzantium]:{name:"byzantiumBlock"},[mn.Constantinople]:{name:"constantinopleBlock"},[mn.Petersburg]:{name:"petersburgBlock"},[mn.Istanbul]:{name:"istanbulBlock"},[mn.MuirGlacier]:{name:"muirGlacierBlock"},[mn.Berlin]:{name:"berlinBlock"},[mn.London]:{name:"londonBlock"},[mn.MergeForkIdTransition]:{name:"mergeForkBlock",postMerge:e},[mn.Shanghai]:{name:"shanghaiTime",postMerge:!0,isTimestamp:!0},[mn.ShardingForkDev]:{name:"shardingForkTime",postMerge:!0,isTimestamp:!0}},x=Object.keys(w).reduce((E,A)=>(E[w[A].name]=A,E),{}),S=Object.keys(i).filter(E=>x[E]!==void 0&&i[E]!==void 0&&i[E]!==null);if(y.hardforks=S.map(E=>({name:x[E],block:w[x[E]].isTimestamp===!0||typeof i[E]!="number"?null:i[E],timestamp:w[x[E]].isTimestamp===!0&&typeof i[E]=="number"?i[E]:void 0})).filter(E=>E.block!==null||E.timestamp!==void 0),y.hardforks.sort((E,A)=>{var R,N;return((R=E.block)!==null&&R!==void 0?R:1/0)-((N=A.block)!==null&&N!==void 0?N:1/0)}),y.hardforks.sort((E,A)=>{var R,N;return((R=E.timestamp)!==null&&R!==void 0?R:g)-((N=A.timestamp)!==null&&N!==void 0?N:g)}),i.terminalTotalDifficulty!==void 0){const E={name:mn.Merge,ttd:i.terminalTotalDifficulty,block:null},A=y.hardforks.findIndex(R=>{var N;return((N=w[R.name])===null||N===void 0?void 0:N.postMerge)===!0});A!==-1?y.hardforks.splice(A,0,E):y.hardforks.push(E)}const k=y.hardforks.length>0?y.hardforks.slice(-1)[0]:void 0;return y.hardfork=k?.name,y.hardforks.unshift({name:mn.Chainstart,block:0}),y}function axe(t,e,n){try{if(["config","difficulty","gasLimit","alloc"].some(r=>!(r in t)))throw new Error("Invalid format, expected geth genesis fields missing");return e!==void 0&&(t.name=e),oxe(t,n)}catch(r){throw new Error(`Error parsing parameters file: ${r.message}`)}}function dW(t){let e=t;if(typeof e!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof e}`);return e.length%2&&(e=`0${e}`),e}const cxe=function(t){const e=uW(t);return Hn(`0x${dW(e.slice(2))}`)},En=function(t){var e;if(t==null)return new Uint8Array;if(t instanceof Uint8Array)return t;if(((e=t?.constructor)===null||e===void 0?void 0:e.name)==="Uint8Array"||Array.isArray(t))return Uint8Array.from(t);if(typeof t=="string"){if(!g1(t))throw new Error(`Cannot convert string to Uint8Array. only supports 0x-prefixed hex strings and this string was given: ${t}`);return Hn(dW(lW(t)))}if(typeof t=="number")return En(No(t));if(typeof t=="bigint"){if(t<BigInt(0))throw new Error(`Cannot convert negative bigint to Uint8Array. Given: ${t}`);let n=t.toString(16);return n.length%2&&(n=`0${n}`),En(`0x${n}`)}if(t.toArray)return Uint8Array.from(t.toArray());throw new Error("invalid type")};function dn(t){const e=Gt(t);return BigInt(e==="0x"?0:e)}function lxe(t){return En(`0x${t.toString(16)}`)}const fW=function(t){return new Uint8Array(t).fill(0)},uxe=function(t,e,n){const r=fW(e);return t.length<e?(r.set(t,e-t.length),r):t.subarray(-e)};function v_(t){if(!Fl(t)){const e=`This method only supports Uint8Array but input was: ${t}`;throw new Error(e)}}const sM=function(t,e){return v_(t),uxe(t,e)};function dxe(t){let e=t[0];for(;t.length>0&&e.toString()==="0";)t=t.slice(1),e=t[0];return t}const dx=function(t){return v_(t),dxe(t)},An=t=>`0x${t.toString(16)}`;function Vt(t){return dx(lxe(t))}function fxe(t,e){return t===BigInt(0)||t===BigInt(1)?t:e===void 0?t-BigInt(27):t-(e*BigInt(2)+BigInt(35))}function hxe(t){return t===BigInt(0)||t===BigInt(1)}const b_=function(t,e,n,r,s){const i=fxe(e,s);if(!hxe(i))throw new Error("Invalid signature v value");return new kc.Signature(dn(n),dn(r)).addRecoveryBit(Number(i)).recoverPublicKey(t).toRawBytes(!1).slice(1)};function hf(t,e){if(t===null)return null;if(t===void 0)return;if(typeof t=="string"&&!g1(t))throw new Error(`A string must be provided with a 0x-prefix, given: ${t}`);if(typeof t=="number"&&!Number.isSafeInteger(t))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const n=En(t);switch(e){case qi.Uint8Array:return n;case qi.BigInt:return dn(n);case qi.Number:{const r=dn(n);if(r>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(r)}case qi.PrefixedHexString:return Gt(n);default:throw new Error("unknown outputType")}}const pxe={name:"goerli",chainId:5,networkId:5,defaultHardfork:"merge",consensus:{type:"poa",algorithm:"clique",clique:{period:15,epoch:3e4}},comment:"Cross-client PoA test network",url:"https://github.com/goerli/testnet",genesis:{timestamp:"0x5c51a607",gasLimit:10485760,difficulty:1,nonce:"0x0000000000000000",extraData:"0x22466c6578692069732061207468696e6722202d204166726900000000000000e0a2bd4258d2768837baa26a28fe71dc079f84c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},hardforks:[{name:"chainstart",block:0,forkHash:"0xa3f5ab08"},{name:"homestead",block:0,forkHash:"0xa3f5ab08"},{name:"tangerineWhistle",block:0,forkHash:"0xa3f5ab08"},{name:"spuriousDragon",block:0,forkHash:"0xa3f5ab08"},{name:"byzantium",block:0,forkHash:"0xa3f5ab08"},{name:"constantinople",block:0,forkHash:"0xa3f5ab08"},{name:"petersburg",block:0,forkHash:"0xa3f5ab08"},{name:"istanbul",block:1561651,forkHash:"0xc25efa5c"},{name:"berlin",block:4460644,forkHash:"0x757a1c47"},{name:"london",block:5062605,forkHash:"0xb8c6299d"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://goerli.etherscan.io/block/7382818",name:"merge",ttd:"10790000",block:7382819,forkHash:"0xb8c6299d"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.goerli.ethdisco.net"]},mxe={name:"mainnet",chainId:1,networkId:1,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"The Ethereum main chain",url:"https://ethstats.net/",genesis:{gasLimit:5e3,difficulty:17179869184,nonce:"0x0000000000000042",extraData:"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfc64ec04"},{name:"homestead",block:115e4,forkHash:"0x97c2c34c"},{name:"dao",block:192e4,forkHash:"0x91d1f948"},{name:"tangerineWhistle",block:2463e3,forkHash:"0x7a64da13"},{name:"spuriousDragon",block:2675e3,forkHash:"0x3edd5b10"},{name:"byzantium",block:437e4,forkHash:"0xa00bc324"},{name:"constantinople",block:728e4,forkHash:"0x668db0af"},{name:"petersburg",block:728e4,forkHash:"0x668db0af"},{name:"istanbul",block:9069e3,forkHash:"0x879d6e30"},{name:"muirGlacier",block:92e5,forkHash:"0xe029e991"},{name:"berlin",block:12244e3,forkHash:"0x0eb440f6"},{name:"london",block:12965e3,forkHash:"0xb715077d"},{name:"arrowGlacier",block:13773e3,forkHash:"0x20c327fc"},{name:"grayGlacier",block:1505e4,forkHash:"0xf0afd0e3"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://etherscan.io/block/15537393",name:"merge",ttd:"58750000000000000000000",block:15537394,forkHash:"0xf0afd0e3"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.mainnet.ethdisco.net"]},gxe={name:"sepolia",chainId:11155111,networkId:11155111,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"PoW test network to replace Ropsten",url:"https://github.com/ethereum/go-ethereum/pull/23730",genesis:{timestamp:"0x6159af19",gasLimit:3e7,difficulty:131072,nonce:"0x0000000000000000",extraData:"0x5365706f6c69612c20417468656e732c204174746963612c2047726565636521"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfe3366e7"},{name:"homestead",block:0,forkHash:"0xfe3366e7"},{name:"tangerineWhistle",block:0,forkHash:"0xfe3366e7"},{name:"spuriousDragon",block:0,forkHash:"0xfe3366e7"},{name:"byzantium",block:0,forkHash:"0xfe3366e7"},{name:"constantinople",block:0,forkHash:"0xfe3366e7"},{name:"petersburg",block:0,forkHash:"0xfe3366e7"},{name:"istanbul",block:0,forkHash:"0xfe3366e7"},{name:"muirGlacier",block:0,forkHash:"0xfe3366e7"},{name:"berlin",block:0,forkHash:"0xfe3366e7"},{name:"london",block:0,forkHash:"0xfe3366e7"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://sepolia.etherscan.io/block/1450408",name:"merge",ttd:"17000000000000000",block:1450409,forkHash:"0xfe3366e7"},{name:"mergeForkIdTransition",block:1735371,forkHash:"0xb96cbd13"},{name:"shanghai",block:null,timestamp:"1677557088",forkHash:"0xf7f9bc08"}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.sepolia.ethdisco.net"]},yxe={name:"EIP-1153",number:1153,comment:"Transient Storage",url:"https://eips.ethereum.org/EIPS/eip-1153",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{tstore:{v:100,d:"Base fee of the TSTORE opcode"},tload:{v:100,d:"Base fee of the TLOAD opcode"}},vm:{},pow:{}},vxe={name:"EIP-1559",number:1559,comment:"Fee market change for ETH 1.0 chain",url:"https://eips.ethereum.org/EIPS/eip-1559",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2930],gasConfig:{baseFeeMaxChangeDenominator:{v:8,d:"Maximum base fee change denominator"},elasticityMultiplier:{v:2,d:"Maximum block gas target elasticity"},initialBaseFee:{v:1e9,d:"Initial base fee on first EIP1559 block"}},gasPrices:{},vm:{},pow:{}},bxe={name:"EIP-2315",number:2315,comment:"Simple subroutines for the EVM",url:"https://eips.ethereum.org/EIPS/eip-2315",status:"Draft",minimumHardfork:"istanbul",gasConfig:{},gasPrices:{beginsub:{v:2,d:"Base fee of the BEGINSUB opcode"},returnsub:{v:5,d:"Base fee of the RETURNSUB opcode"},jumpsub:{v:10,d:"Base fee of the JUMPSUB opcode"}},vm:{},pow:{}},wxe={name:"EIP-2537",number:2537,comment:"BLS12-381 precompiles",url:"https://eips.ethereum.org/EIPS/eip-2537",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{Bls12381G1AddGas:{v:600,d:"Gas cost of a single BLS12-381 G1 addition precompile-call"},Bls12381G1MulGas:{v:12e3,d:"Gas cost of a single BLS12-381 G1 multiplication precompile-call"},Bls12381G2AddGas:{v:4500,d:"Gas cost of a single BLS12-381 G2 addition precompile-call"},Bls12381G2MulGas:{v:55e3,d:"Gas cost of a single BLS12-381 G2 multiplication precompile-call"},Bls12381PairingBaseGas:{v:115e3,d:"Base gas cost of BLS12-381 pairing check"},Bls12381PairingPerPairGas:{v:23e3,d:"Per-pair gas cost of BLS12-381 pairing check"},Bls12381MapG1Gas:{v:5500,d:"Gas cost of BLS12-381 map field element to G1"},Bls12381MapG2Gas:{v:11e4,d:"Gas cost of BLS12-381 map field element to G2"},Bls12381MultiExpGasDiscount:{v:[[1,1200],[2,888],[3,764],[4,641],[5,594],[6,547],[7,500],[8,453],[9,438],[10,423],[11,408],[12,394],[13,379],[14,364],[15,349],[16,334],[17,330],[18,326],[19,322],[20,318],[21,314],[22,310],[23,306],[24,302],[25,298],[26,294],[27,289],[28,285],[29,281],[30,277],[31,273],[32,269],[33,268],[34,266],[35,265],[36,263],[37,262],[38,260],[39,259],[40,257],[41,256],[42,254],[43,253],[44,251],[45,250],[46,248],[47,247],[48,245],[49,244],[50,242],[51,241],[52,239],[53,238],[54,236],[55,235],[56,233],[57,232],[58,231],[59,229],[60,228],[61,226],[62,225],[63,223],[64,222],[65,221],[66,220],[67,219],[68,219],[69,218],[70,217],[71,216],[72,216],[73,215],[74,214],[75,213],[76,213],[77,212],[78,211],[79,211],[80,210],[81,209],[82,208],[83,208],[84,207],[85,206],[86,205],[87,205],[88,204],[89,203],[90,202],[91,202],[92,201],[93,200],[94,199],[95,199],[96,198],[97,197],[98,196],[99,196],[100,195],[101,194],[102,193],[103,193],[104,192],[105,191],[106,191],[107,190],[108,189],[109,188],[110,188],[111,187],[112,186],[113,185],[114,185],[115,184],[116,183],[117,182],[118,182],[119,181],[120,180],[121,179],[122,179],[123,178],[124,177],[125,176],[126,176],[127,175],[128,174]],d:"Discount gas costs of calls to the MultiExp precompiles with `k` (point, scalar) pair"}},vm:{},pow:{}},xxe={name:"EIP-2565",number:2565,comment:"ModExp gas cost",url:"https://eips.ethereum.org/EIPS/eip-2565",status:"Final",minimumHardfork:"byzantium",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:3,d:"Gquaddivisor from modexp precompile for gas calculation"}},vm:{},pow:{}},Ixe={name:"EIP-2718",comment:"Typed Transaction Envelope",url:"https://eips.ethereum.org/EIPS/eip-2718",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{},vm:{},pow:{}},Sxe={name:"EIP-2929",comment:"Gas cost increases for state access opcodes",url:"https://eips.ethereum.org/EIPS/eip-2929",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{coldsload:{v:2100,d:"Gas cost of the first read of storage from a given location (per transaction)"},coldaccountaccess:{v:2600,d:"Gas cost of the first read of a given address (per transaction)"},warmstorageread:{v:100,d:"Gas cost of reading storage locations which have already loaded 'cold'"},sstoreCleanGasEIP2200:{v:2900,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreNoopGasEIP2200:{v:100,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:100,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitRefundEIP2200:{v:19900,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanRefundEIP2200:{v:4900,d:"Once per SSTORE operation for resetting to the original non-zero value"},call:{v:0,d:"Base fee of the CALL opcode"},callcode:{v:0,d:"Base fee of the CALLCODE opcode"},delegatecall:{v:0,d:"Base fee of the DELEGATECALL opcode"},staticcall:{v:0,d:"Base fee of the STATICCALL opcode"},balance:{v:0,d:"Base fee of the BALANCE opcode"},extcodesize:{v:0,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:0,d:"Base fee of the EXTCODECOPY opcode"},extcodehash:{v:0,d:"Base fee of the EXTCODEHASH opcode"},sload:{v:0,d:"Base fee of the SLOAD opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"}},vm:{},pow:{}},kxe={name:"EIP-2930",comment:"Optional access lists",url:"https://eips.ethereum.org/EIPS/eip-2930",status:"Final",minimumHardfork:"istanbul",requiredEIPs:[2718,2929],gasConfig:{},gasPrices:{accessListStorageKeyCost:{v:1900,d:"Gas cost per storage key in an Access List transaction"},accessListAddressCost:{v:2400,d:"Gas cost per storage key in an Access List transaction"}},vm:{},pow:{}},Exe={name:"EIP-3198",number:3198,comment:"BASEFEE opcode",url:"https://eips.ethereum.org/EIPS/eip-3198",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{basefee:{v:2,d:"Gas cost of the BASEFEE opcode"}},vm:{},pow:{}},Cxe={name:"EIP-3529",comment:"Reduction in refunds",url:"https://eips.ethereum.org/EIPS/eip-3529",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2929],gasConfig:{maxRefundQuotient:{v:5,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{selfdestructRefund:{v:0,d:"Refunded following a selfdestruct operation"},sstoreClearRefundEIP2200:{v:4800,d:"Once per SSTORE operation for clearing an originally existing storage slot"}},vm:{},pow:{}},Txe={name:"EIP-3540",number:3540,comment:"EVM Object Format (EOF) v1",url:"https://eips.ethereum.org/EIPS/eip-3540",status:"Review",minimumHardfork:"london",requiredEIPs:[3541],gasConfig:{},gasPrices:{},vm:{},pow:{}},Axe={name:"EIP-3541",comment:"Reject new contracts starting with the 0xEF byte",url:"https://eips.ethereum.org/EIPS/eip-3541",status:"Final",minimumHardfork:"berlin",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},Nxe={name:"EIP-3554",comment:"Reduction in refunds",url:"Difficulty Bomb Delay to December 1st 2021",status:"Final",minimumHardfork:"muirGlacier",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:95e5,d:"the amount of blocks to delay the difficulty bomb with"}}},_xe={name:"EIP-3607",number:3607,comment:"Reject transactions from senders with deployed code",url:"https://eips.ethereum.org/EIPS/eip-3607",status:"Final",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},$xe={name:"EIP-3651",number:3198,comment:"Warm COINBASE",url:"https://eips.ethereum.org/EIPS/eip-3651",status:"Review",minimumHardfork:"london",requiredEIPs:[2929],gasConfig:{},gasPrices:{},vm:{},pow:{}},Rxe={name:"EIP-3670",number:3670,comment:"EOF - Code Validation",url:"https://eips.ethereum.org/EIPS/eip-3670",status:"Review",minimumHardfork:"london",requiredEIPs:[3540],gasConfig:{},gasPrices:{},vm:{},pow:{}},Oxe={name:"EIP-3675",number:3675,comment:"Upgrade consensus to Proof-of-Stake",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Final",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},Pxe={name:"EIP-3855",number:3855,comment:"PUSH0 instruction",url:"https://eips.ethereum.org/EIPS/eip-3855",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{push0:{v:2,d:"Base fee of the PUSH0 opcode"}},vm:{},pow:{}},Dxe={name:"EIP-3860",number:3860,comment:"Limit and meter initcode",url:"https://eips.ethereum.org/EIPS/eip-3860",status:"Review",minimumHardfork:"spuriousDragon",requiredEIPs:[],gasConfig:{},gasPrices:{initCodeWordCost:{v:2,d:"Gas to pay for each word (32 bytes) of initcode when creating a contract"}},vm:{maxInitCodeSize:{v:49152,d:"Maximum length of initialization code when creating a contract"}},pow:{}},Fxe={name:"EIP-4345",number:4345,comment:"Difficulty Bomb Delay to June 2022",url:"https://eips.ethereum.org/EIPS/eip-4345",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:107e5,d:"the amount of blocks to delay the difficulty bomb with"}}},Lxe={name:"EIP-4399",number:4399,comment:"Supplant DIFFICULTY opcode with PREVRANDAO",url:"https://eips.ethereum.org/EIPS/eip-4399",status:"Review",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},Bxe={name:"EIP-5133",number:5133,comment:"Delaying Difficulty Bomb to mid-September 2022",url:"https://eips.ethereum.org/EIPS/eip-5133",status:"Draft",minimumHardfork:"grayGlacier",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:114e5,d:"the amount of blocks to delay the difficulty bomb with"}}},pf={1153:yxe,1559:vxe,2315:bxe,2537:wxe,2565:xxe,2718:Ixe,2929:Sxe,2930:kxe,3198:Exe,3529:Cxe,3540:Txe,3541:Axe,3554:Nxe,3607:_xe,3651:$xe,3670:Rxe,3675:Oxe,3855:Pxe,3860:Dxe,4345:Fxe,4399:Lxe,5133:Bxe},Mxe={name:"chainstart",comment:"Start of the Ethereum main chain",url:"",status:"",gasConfig:{minGasLimit:{v:5e3,d:"Minimum the gas limit may ever be"},gasLimitBoundDivisor:{v:1024,d:"The bound divisor of the gas limit, used in update calculations"},maxRefundQuotient:{v:2,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{base:{v:2,d:"Gas base cost, used e.g. for ChainID opcode (Istanbul)"},tierStep:{v:[0,2,3,5,8,10,20],d:"Once per operation, for a selection of them"},exp:{v:10,d:"Base fee of the EXP opcode"},expByte:{v:10,d:"Times ceil(log256(exponent)) for the EXP instruction"},sha3:{v:30,d:"Base fee of the SHA3 opcode"},sha3Word:{v:6,d:"Once per word of the SHA3 operation's data"},sload:{v:50,d:"Base fee of the SLOAD opcode"},sstoreSet:{v:2e4,d:"Once per SSTORE operation if the zeroness changes from zero"},sstoreReset:{v:5e3,d:"Once per SSTORE operation if the zeroness does not change from zero"},sstoreRefund:{v:15e3,d:"Once per SSTORE operation if the zeroness changes to zero"},jumpdest:{v:1,d:"Base fee of the JUMPDEST opcode"},log:{v:375,d:"Base fee of the LOG opcode"},logData:{v:8,d:"Per byte in a LOG* operation's data"},logTopic:{v:375,d:"Multiplied by the * of the LOG*, per LOG transaction. e.g. LOG0 incurs 0 * c_txLogTopicGas, LOG4 incurs 4 * c_txLogTopicGas"},create:{v:32e3,d:"Base fee of the CREATE opcode"},call:{v:40,d:"Base fee of the CALL opcode"},callStipend:{v:2300,d:"Free gas given at beginning of call"},callValueTransfer:{v:9e3,d:"Paid for CALL when the value transfor is non-zero"},callNewAccount:{v:25e3,d:"Paid for CALL when the destination address didn't exist prior"},selfdestructRefund:{v:24e3,d:"Refunded following a selfdestruct operation"},memory:{v:3,d:"Times the address of the (highest referenced byte in memory + 1). NOTE: referencing happens on read, write and in instructions such as RETURN and CALL"},quadCoeffDiv:{v:512,d:"Divisor for the quadratic particle of the memory cost equation"},createData:{v:200,d:""},tx:{v:21e3,d:"Per transaction. NOTE: Not payable on data of calls between transactions"},txCreation:{v:32e3,d:"The cost of creating a contract via tx"},txDataZero:{v:4,d:"Per byte of data attached to a transaction that equals zero. NOTE: Not payable on data of calls between transactions"},txDataNonZero:{v:68,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},copy:{v:3,d:"Multiplied by the number of 32-byte words that are copied (round up) for any *COPY operation and added"},ecRecover:{v:3e3,d:""},sha256:{v:60,d:""},sha256Word:{v:12,d:""},ripemd160:{v:600,d:""},ripemd160Word:{v:120,d:""},identity:{v:15,d:""},identityWord:{v:3,d:""},stop:{v:0,d:"Base fee of the STOP opcode"},add:{v:3,d:"Base fee of the ADD opcode"},mul:{v:5,d:"Base fee of the MUL opcode"},sub:{v:3,d:"Base fee of the SUB opcode"},div:{v:5,d:"Base fee of the DIV opcode"},sdiv:{v:5,d:"Base fee of the SDIV opcode"},mod:{v:5,d:"Base fee of the MOD opcode"},smod:{v:5,d:"Base fee of the SMOD opcode"},addmod:{v:8,d:"Base fee of the ADDMOD opcode"},mulmod:{v:8,d:"Base fee of the MULMOD opcode"},signextend:{v:5,d:"Base fee of the SIGNEXTEND opcode"},lt:{v:3,d:"Base fee of the LT opcode"},gt:{v:3,d:"Base fee of the GT opcode"},slt:{v:3,d:"Base fee of the SLT opcode"},sgt:{v:3,d:"Base fee of the SGT opcode"},eq:{v:3,d:"Base fee of the EQ opcode"},iszero:{v:3,d:"Base fee of the ISZERO opcode"},and:{v:3,d:"Base fee of the AND opcode"},or:{v:3,d:"Base fee of the OR opcode"},xor:{v:3,d:"Base fee of the XOR opcode"},not:{v:3,d:"Base fee of the NOT opcode"},byte:{v:3,d:"Base fee of the BYTE opcode"},address:{v:2,d:"Base fee of the ADDRESS opcode"},balance:{v:20,d:"Base fee of the BALANCE opcode"},origin:{v:2,d:"Base fee of the ORIGIN opcode"},caller:{v:2,d:"Base fee of the CALLER opcode"},callvalue:{v:2,d:"Base fee of the CALLVALUE opcode"},calldataload:{v:3,d:"Base fee of the CALLDATALOAD opcode"},calldatasize:{v:2,d:"Base fee of the CALLDATASIZE opcode"},calldatacopy:{v:3,d:"Base fee of the CALLDATACOPY opcode"},codesize:{v:2,d:"Base fee of the CODESIZE opcode"},codecopy:{v:3,d:"Base fee of the CODECOPY opcode"},gasprice:{v:2,d:"Base fee of the GASPRICE opcode"},extcodesize:{v:20,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:20,d:"Base fee of the EXTCODECOPY opcode"},blockhash:{v:20,d:"Base fee of the BLOCKHASH opcode"},coinbase:{v:2,d:"Base fee of the COINBASE opcode"},timestamp:{v:2,d:"Base fee of the TIMESTAMP opcode"},number:{v:2,d:"Base fee of the NUMBER opcode"},difficulty:{v:2,d:"Base fee of the DIFFICULTY opcode"},gaslimit:{v:2,d:"Base fee of the GASLIMIT opcode"},pop:{v:2,d:"Base fee of the POP opcode"},mload:{v:3,d:"Base fee of the MLOAD opcode"},mstore:{v:3,d:"Base fee of the MSTORE opcode"},mstore8:{v:3,d:"Base fee of the MSTORE8 opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"},jump:{v:8,d:"Base fee of the JUMP opcode"},jumpi:{v:10,d:"Base fee of the JUMPI opcode"},pc:{v:2,d:"Base fee of the PC opcode"},msize:{v:2,d:"Base fee of the MSIZE opcode"},gas:{v:2,d:"Base fee of the GAS opcode"},push:{v:3,d:"Base fee of the PUSH opcode"},dup:{v:3,d:"Base fee of the DUP opcode"},swap:{v:3,d:"Base fee of the SWAP opcode"},callcode:{v:40,d:"Base fee of the CALLCODE opcode"},return:{v:0,d:"Base fee of the RETURN opcode"},invalid:{v:0,d:"Base fee of the INVALID opcode"},selfdestruct:{v:0,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{stackLimit:{v:1024,d:"Maximum size of VM stack allowed"},callCreateDepth:{v:1024,d:"Maximum depth of call/create stack"},maxExtraDataSize:{v:32,d:"Maximum size extra data may be after Genesis"}},pow:{minimumDifficulty:{v:131072,d:"The minimum that the difficulty may ever be"},difficultyBoundDivisor:{v:2048,d:"The bound divisor of the difficulty, used in the update calculations"},durationLimit:{v:13,d:"The decision boundary on the blocktime duration used to determine whether difficulty should go up or not"},epochDuration:{v:3e4,d:"Duration between proof-of-work epochs"},timebombPeriod:{v:1e5,d:"Exponential difficulty timebomb period"},minerReward:{v:"5000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:0,d:"the amount of blocks to delay the difficulty bomb with"}}},zxe={name:"dao",comment:"DAO rescue hardfork",url:"https://eips.ethereum.org/EIPS/eip-779",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{}},Uxe={name:"homestead",comment:"Homestead hardfork with protocol and network changes",url:"https://eips.ethereum.org/EIPS/eip-606",status:"Final",gasConfig:{},gasPrices:{delegatecall:{v:40,d:"Base fee of the DELEGATECALL opcode"}},vm:{},pow:{}},Vxe={name:"tangerineWhistle",comment:"Hardfork with gas cost changes for IO-heavy operations",url:"https://eips.ethereum.org/EIPS/eip-608",status:"Final",gasConfig:{},gasPrices:{sload:{v:200,d:"Once per SLOAD operation"},call:{v:700,d:"Once per CALL operation & message call transaction"},extcodesize:{v:700,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:700,d:"Base fee of the EXTCODECOPY opcode"},balance:{v:400,d:"Base fee of the BALANCE opcode"},delegatecall:{v:700,d:"Base fee of the DELEGATECALL opcode"},callcode:{v:700,d:"Base fee of the CALLCODE opcode"},selfdestruct:{v:5e3,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{},pow:{}},jxe={name:"spuriousDragon",comment:"HF with EIPs for simple replay attack protection, EXP cost increase, state trie clearing, contract code size limit",url:"https://eips.ethereum.org/EIPS/eip-607",status:"Final",gasConfig:{},gasPrices:{expByte:{v:50,d:"Times ceil(log256(exponent)) for the EXP instruction"}},vm:{maxCodeSize:{v:24576,d:"Maximum length of contract code"}},pow:{}},Hxe={name:"byzantium",comment:"Hardfork with new precompiles, instructions and other protocol changes",url:"https://eips.ethereum.org/EIPS/eip-609",status:"Final",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:20,d:"Gquaddivisor from modexp precompile for gas calculation"},ecAdd:{v:500,d:"Gas costs for curve addition precompile"},ecMul:{v:4e4,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:1e5,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:8e4,d:"Gas costs regarding curve pairing precompile input length"},revert:{v:0,d:"Base fee of the REVERT opcode"},staticcall:{v:700,d:"Base fee of the STATICCALL opcode"},returndatasize:{v:2,d:"Base fee of the RETURNDATASIZE opcode"},returndatacopy:{v:3,d:"Base fee of the RETURNDATACOPY opcode"}},vm:{},pow:{minerReward:{v:"3000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:3e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Wxe={name:"constantinople",comment:"Postponed hardfork including EIP-1283 (SSTORE gas metering changes)",url:"https://eips.ethereum.org/EIPS/eip-1013",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:200,d:"Once per SSTORE operation if the value doesn't change"},netSstoreInitGas:{v:2e4,d:"Once per SSTORE operation from clean zero"},netSstoreCleanGas:{v:5e3,d:"Once per SSTORE operation from clean non-zero"},netSstoreDirtyGas:{v:200,d:"Once per SSTORE operation from dirty"},netSstoreClearRefund:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},netSstoreResetRefund:{v:4800,d:"Once per SSTORE operation for resetting to the original non-zero value"},netSstoreResetClearRefund:{v:19800,d:"Once per SSTORE operation for resetting to the original zero value"},shl:{v:3,d:"Base fee of the SHL opcode"},shr:{v:3,d:"Base fee of the SHR opcode"},sar:{v:3,d:"Base fee of the SAR opcode"},extcodehash:{v:400,d:"Base fee of the EXTCODEHASH opcode"},create2:{v:32e3,d:"Base fee of the CREATE2 opcode"}},vm:{},pow:{minerReward:{v:"2000000000000000000",d:"The amount a miner gets rewarded for mining a block"},difficultyBombDelay:{v:5e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Gxe={name:"petersburg",comment:"Aka constantinopleFix, removes EIP-1283, activate together with or after constantinople",url:"https://eips.ethereum.org/EIPS/eip-1716",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:null,d:"Removed along EIP-1283"},netSstoreInitGas:{v:null,d:"Removed along EIP-1283"},netSstoreCleanGas:{v:null,d:"Removed along EIP-1283"},netSstoreDirtyGas:{v:null,d:"Removed along EIP-1283"},netSstoreClearRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetClearRefund:{v:null,d:"Removed along EIP-1283"}},vm:{},pow:{}},qxe={name:"istanbul",comment:"HF targeted for December 2019 following the Constantinople/Petersburg HF",url:"https://eips.ethereum.org/EIPS/eip-1679",status:"Final",gasConfig:{},gasPrices:{blake2Round:{v:1,d:"Gas cost per round for the Blake2 F precompile"},ecAdd:{v:150,d:"Gas costs for curve addition precompile"},ecMul:{v:6e3,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:45e3,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:34e3,d:"Gas costs regarding curve pairing precompile input length"},txDataNonZero:{v:16,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},sstoreSentryGasEIP2200:{v:2300,d:"Minimum gas required to be present for an SSTORE call, not consumed"},sstoreNoopGasEIP2200:{v:800,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:800,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitGasEIP2200:{v:2e4,d:"Once per SSTORE operation from clean zero to non-zero"},sstoreInitRefundEIP2200:{v:19200,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanGasEIP2200:{v:5e3,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreCleanRefundEIP2200:{v:4200,d:"Once per SSTORE operation for resetting to the original non-zero value"},sstoreClearRefundEIP2200:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},balance:{v:700,d:"Base fee of the BALANCE opcode"},extcodehash:{v:700,d:"Base fee of the EXTCODEHASH opcode"},chainid:{v:2,d:"Base fee of the CHAINID opcode"},selfbalance:{v:5,d:"Base fee of the SELFBALANCE opcode"},sload:{v:800,d:"Base fee of the SLOAD opcode"}},vm:{},pow:{}},Kxe={name:"muirGlacier",comment:"HF to delay the difficulty bomb",url:"https://eips.ethereum.org/EIPS/eip-2384",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:9e6,d:"the amount of blocks to delay the difficulty bomb with"}}},Xxe={name:"berlin",comment:"HF targeted for July 2020 following the Muir Glacier HF",url:"https://eips.ethereum.org/EIPS/eip-2070",status:"Final",eips:[2565,2929,2718,2930]},Qxe={name:"london",comment:"HF targeted for July 2021 following the Berlin fork",url:"https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/london.md",status:"Final",eips:[1559,3198,3529,3541]},Yxe={name:"shanghai",comment:"Next feature hardfork after the merge hardfork having withdrawals, warm coinbase, push0, limit/meter initcode",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/shanghai.md",status:"Final",eips:[3651,3855,3860,4895]},Zxe={name:"arrowGlacier",comment:"HF to delay the difficulty bomb",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/arrow-glacier.md",status:"Final",eips:[4345],gasConfig:{},gasPrices:{},vm:{},pow:{}},Jxe={name:"grayGlacier",comment:"Delaying the difficulty bomb to Mid September 2022",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/gray-glacier.md",status:"Draft",eips:[5133],gasConfig:{},gasPrices:{},vm:{},pow:{}},e1e={name:"mergeForkIdTransition",comment:"Pre-merge hardfork to fork off non-upgraded clients",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Draft",eips:[]},t1e={name:"merge",comment:"Hardfork to upgrade the consensus mechanism to Proof-of-Stake",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/merge.md",status:"Final",consensus:{type:"pos",algorithm:"casper",casper:{}},eips:[3675,4399]},n1e={chainstart:Mxe,homestead:Uxe,dao:zxe,tangerineWhistle:Vxe,spuriousDragon:jxe,byzantium:Hxe,constantinople:Wxe,petersburg:Gxe,istanbul:qxe,muirGlacier:Kxe,berlin:Xxe,london:Qxe,shanghai:Yxe,arrowGlacier:Zxe,grayGlacier:Jxe,mergeForkIdTransition:e1e,merge:t1e},{buf:r1e}=yN;class Kr extends hH{static custom(e,n={}){var r;const s=(r=n.baseChain)!==null&&r!==void 0?r:"mainnet",i=Object.assign({},Kr._getChainParams(s));if(i.name="custom-chain",typeof e!="string")return new Kr(Object.assign({chain:Object.assign(Object.assign({},i),e)},n));if(e===cs.PolygonMainnet)return Kr.custom({name:cs.PolygonMainnet,chainId:137,networkId:137},n);if(e===cs.PolygonMumbai)return Kr.custom({name:cs.PolygonMumbai,chainId:80001,networkId:80001},n);if(e===cs.ArbitrumRinkebyTestnet)return Kr.custom({name:cs.ArbitrumRinkebyTestnet,chainId:421611,networkId:421611},n);if(e===cs.ArbitrumOne)return Kr.custom({name:cs.ArbitrumOne,chainId:42161,networkId:42161},n);if(e===cs.xDaiChain)return Kr.custom({name:cs.xDaiChain,chainId:100,networkId:100},n);if(e===cs.OptimisticKovan)return Kr.custom({name:cs.OptimisticKovan,chainId:69,networkId:69},Object.assign({hardfork:mn.Berlin},n));if(e===cs.OptimisticEthereum)return Kr.custom({name:cs.OptimisticEthereum,chainId:10,networkId:10},Object.assign({hardfork:mn.Berlin},n));throw new Error(`Custom chain ${e} not supported`)}static fromGethGenesis(e,{chain:n,eips:r,genesisHash:s,hardfork:i,mergeForkIdPostMerge:o}){var a;const c=axe(e,n,o),l=new Kr({chain:(a=c.name)!==null&&a!==void 0?a:"custom",customChains:[c],eips:r,hardfork:i??c.hardfork});return s!==void 0&&l.setForkHashes(s),l}static isSupportedChainId(e){return!!this._getInitializedChains().names[e.toString()]}static _getChainParams(e,n){let r=e;const s=this._getInitializedChains(n);if(typeof r=="number"||typeof r=="bigint"){if(r=r.toString(),s.names[r]){const i=s.names[r];return s[i]}throw new Error(`Chain with ID ${r} not supported`)}if(s[r]!==void 0)return s[r];throw new Error(`Chain with name ${r} not supported`)}constructor(e){var n,r;super(),this._eips=[],this._customChains=(n=e.customChains)!==null&&n!==void 0?n:[],this._chainParams=this.setChain(e.chain),this.DEFAULT_HARDFORK=(r=this._chainParams.defaultHardfork)!==null&&r!==void 0?r:mn.Merge,this.HARDFORK_CHANGES=this.hardforks().map(s=>[s.name,n1e[s.name]]),this._hardfork=this.DEFAULT_HARDFORK,e.hardfork!==void 0&&this.setHardfork(e.hardfork),e.eips&&this.setEIPs(e.eips)}setChain(e){if(typeof e=="number"||typeof e=="bigint"||typeof e=="string")this._chainParams=Kr._getChainParams(e,this._customChains);else if(typeof e=="object"){if(this._customChains.length>0)throw new Error("Chain must be a string, number, or bigint when initialized with customChains passed in");const n=["networkId","genesis","hardforks","bootstrapNodes"];for(const r of n)if(!(r in e))throw new Error(`Missing required chain parameter: ${r}`);this._chainParams=e}else throw new Error("Wrong input format");for(const n of this.hardforks())if(n.block===void 0)throw new Error("Hardfork cannot have undefined block number");return this._chainParams}setHardfork(e){let n=!1;for(const r of this.HARDFORK_CHANGES)r[0]===e&&(this._hardfork!==e&&(this._hardfork=e,this.emit("hardforkChanged",e)),n=!0);if(!n)throw new Error(`Hardfork with name ${e} not supported`)}getHardforkByBlockNumber(e,n,r){const s=hf(e,qi.BigInt),i=hf(n,qi.BigInt),o=hf(r,qi.Number),a=this.hardforks().filter(m=>m.block!==null||m.ttd!==null&&m.ttd!==void 0||m.timestamp!==void 0),c=a.findIndex(m=>m.ttd!==null&&m.ttd!==void 0);if(a.slice(c+1).findIndex(m=>m.ttd!==null&&m.ttd!==void 0)>=0)throw Error("More than one merge hardforks found with ttd specified");let u=a.findIndex(m=>m.block!==null&&m.block>s||o!==void 0&&Number(m.timestamp)>o);if(u===-1)u=a.length;else if(u===0)throw Error("Must have at least one hardfork at block 0");if(o===void 0){const m=a.slice(0,u).reverse().findIndex(g=>g.block!==null||g.ttd!==void 0);u-=m}if(u-=1,a[u].block===null&&a[u].timestamp===void 0)(i==null||BigInt(a[u].ttd)>i)&&(u-=1);else if(c>=0&&i!==void 0&&i!==null){if(u>=c&&BigInt(a[c].ttd)>i)throw Error("Maximum HF determined by total difficulty is lower than the block number HF");if(u<c&&BigInt(a[c].ttd)<=i)throw Error("HF determined by block number is lower than the minimum total difficulty HF")}const d=u;for(;u<a.length-1&&!(a[u].block!==a[u+1].block||a[u].timestamp!==a[u+1].timestamp);u+=1);if(o){if(a.slice(0,d).reduce((v,y)=>{var w;return Math.max(Number((w=y.timestamp)!==null&&w!==void 0?w:"0"),v)},0)>o)throw Error("Maximum HF determined by timestamp is lower than the block number/ttd HF");if(a.slice(u+1).reduce((v,y)=>{var w;return Math.min(Number((w=y.timestamp)!==null&&w!==void 0?w:o),v)},o)<o)throw Error("Maximum HF determined by block number/ttd is lower than timestamp HF")}return a[u].name}setHardforkByBlockNumber(e,n,r){const s=this.getHardforkByBlockNumber(e,n,r);return this.setHardfork(s),s}_getHardfork(e){const n=this.hardforks();for(const r of n)if(r.name===e)return r;return null}setEIPs(e=[]){for(const n of e){if(!(n in pf))throw new Error(`${n} not supported`);const r=this.gteHardfork(pf[n].minimumHardfork);if(!r)throw new Error(`${n} cannot be activated on hardfork ${this.hardfork()}, minimumHardfork: ${r}`);if(pf[n].requiredEIPs!==void 0){for(const s of pf[n].requiredEIPs)if(!(e.includes(s)||this.isActivatedEIP(s)))throw new Error(`${n} requires EIP ${s}, but is not included in the EIP list`)}}this._eips=e}param(e,n){let r;for(const s of this._eips)if(r=this.paramByEIP(e,n,s),r!==void 0)return r;return this.paramByHardfork(e,n,this._hardfork)}paramByHardfork(e,n,r){let s=null;for(const i of this.HARDFORK_CHANGES){if("eips"in i[1]){const o=i[1].eips;for(const a of o){const c=this.paramByEIP(e,n,a);s=typeof c=="bigint"?c:s}}else{if(i[1][e]===void 0)throw new Error(`Topic ${e} not defined`);i[1][e][n]!==void 0&&(s=i[1][e][n].v)}if(i[0]===r)break}return BigInt(s??0)}paramByEIP(e,n,r){if(!(r in pf))throw new Error(`${r} not supported`);const s=pf[r];if(!(e in s))throw new Error(`Topic ${e} not defined`);if(s[e][n]===void 0)return;const i=s[e][n].v;return BigInt(i)}paramByBlock(e,n,r,s,i){const o=this.getHardforkByBlockNumber(r,s,i);return this.paramByHardfork(e,n,o)}isActivatedEIP(e){if(this.eips().includes(e))return!0;for(const n of this.HARDFORK_CHANGES){const r=n[1];if(this.gteHardfork(r.name)&&"eips"in r&&r.eips.includes(e))return!0}return!1}hardforkIsActiveOnBlock(e,n){const r=hf(n,qi.BigInt),s=e??this._hardfork,i=this.hardforkBlock(s);return typeof i=="bigint"&&i!==BigInt(0)&&r>=i}activeOnBlock(e){return this.hardforkIsActiveOnBlock(null,e)}hardforkGteHardfork(e,n){const r=e??this._hardfork,s=this.hardforks();let i=-1,o=-1,a=0;for(const c of s)c.name===r&&(i=a),c.name===n&&(o=a),a+=1;return i>=o&&o!==-1}gteHardfork(e){return this.hardforkGteHardfork(null,e)}hardforkBlock(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.block;return s==null?null:BigInt(s)}hardforkTimestamp(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.timestamp;return s==null?null:BigInt(s)}eipBlock(e){for(const n of this.HARDFORK_CHANGES){const r=n[1];if("eips"in r&&r.eips.includes(e))return this.hardforkBlock(typeof n[0]=="number"?String(n[0]):n[0])}return null}hardforkTTD(e){var n;const r=e??this._hardfork,s=(n=this._getHardfork(r))===null||n===void 0?void 0:n.ttd;return s==null?null:BigInt(s)}isHardforkBlock(e,n){const r=hf(e,qi.BigInt),s=n??this._hardfork,i=this.hardforkBlock(s);return typeof i=="bigint"&&i!==BigInt(0)?i===r:!1}nextHardforkBlockOrTimestamp(e){var n,r,s;const i=(n=e)!==null&&n!==void 0?n:this._hardfork,o=this.hardforks();let a=o.findIndex(d=>d.name===i);if(i===mn.Merge&&(a-=1),a<0)return null;let c=(r=o[a].timestamp)!==null&&r!==void 0?r:o[a].block;c=c!=null?Number(c):null;const l=o.slice(a+1).find(d=>{var h;let m=(h=d.timestamp)!==null&&h!==void 0?h:d.block;return m=m!=null?Number(m):null,d.name!==mn.Merge&&m!==null&&m!==void 0&&m!==c});if(l===void 0)return null;const u=(s=l.timestamp)!==null&&s!==void 0?s:l.block;return u==null?null:BigInt(u)}nextHardforkBlock(e){var n;const r=(n=e)!==null&&n!==void 0?n:this._hardfork;let s=this.hardforkBlock(r);if(s===null&&r===mn.Merge){const o=this.hardforks(),a=o.findIndex(c=>c.ttd!==null&&c.ttd!==void 0);if(a<0)throw Error("Merge hardfork should have been found");s=this.hardforkBlock(o[a-1].name)}return s===null?null:this.hardforks().reduce((o,a)=>{const c=BigInt(a.block===null||a.ttd!==void 0&&a.ttd!==null?0:a.block);return c>s&&o===null?c:o},null)}isNextHardforkBlock(e,n){const r=hf(e,qi.BigInt),s=n??this._hardfork,i=this.nextHardforkBlock(s);return i===null?!1:i===r}_calcForkHash(e,n){let r=new Uint8Array,s=0;for(const a of this.hardforks()){const{block:c,timestamp:l,name:u}=a;let d=l??c;if(d=d!==null?Number(d):null,typeof d=="number"&&d!==0&&d!==s&&u!==mn.Merge){const h=Hn(d.toString(16).padStart(16,"0"));r=Ts(r,h),s=d}if(a.name===e)break}const i=Ts(n,r);return Gt(cxe(r1e(i)>>>0))}forkHash(e,n){const r=e??this._hardfork,s=this._getHardfork(r);if(s===null||s?.block===null&&s?.timestamp===void 0&&s?.ttd===void 0){const i="No fork hash calculation possible for future hardfork";throw new Error(i)}if(s?.forkHash!==null&&s?.forkHash!==void 0)return s.forkHash;if(!n)throw new Error("genesisHash required for forkHash calculation");return this._calcForkHash(r,n)}hardforkForForkHash(e){const n=this.hardforks().filter(r=>r.forkHash===e);return n.length>=1?n[n.length-1]:null}setForkHashes(e){var n;for(const r of this.hardforks()){const s=(n=r.timestamp)!==null&&n!==void 0?n:r.block;(r.forkHash===null||r.forkHash===void 0)&&(s!=null||typeof r.ttd<"u")&&(r.forkHash=this.forkHash(r.name,e))}}genesis(){return this._chainParams.genesis}hardforks(){return this._chainParams.hardforks}bootstrapNodes(){return this._chainParams.bootstrapNodes}dnsNetworks(){return this._chainParams.dnsNetworks}hardfork(){return this._hardfork}chainId(){return BigInt(this._chainParams.chainId)}chainName(){return this._chainParams.name}networkId(){return BigInt(this._chainParams.networkId)}eips(){return this._eips}consensusType(){const e=this.hardfork();let n;for(const r of this.HARDFORK_CHANGES)if("consensus"in r[1]&&(n=r[1].consensus.type),r[0]===e)break;return n??this._chainParams.consensus.type}consensusAlgorithm(){const e=this.hardfork();let n;for(const r of this.HARDFORK_CHANGES)if("consensus"in r[1]&&(n=r[1].consensus.algorithm),r[0]===e)break;return n??this._chainParams.consensus.algorithm}consensusConfig(){var e;const n=this.hardfork();let r;for(const s of this.HARDFORK_CHANGES)if("consensus"in s[1]&&(r=s[1].consensus[s[1].consensus.algorithm]),s[0]===n)break;return(e=r??this._chainParams.consensus[this.consensusAlgorithm()])!==null&&e!==void 0?e:{}}copy(){const e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.removeAllListeners(),e}static _getInitializedChains(e){const n={};for(const[s,i]of Object.entries(ux))n[i]=s.toLowerCase();const r={mainnet:mxe,goerli:pxe,sepolia:gxe};if(e)for(const s of e){const{name:i}=s;n[s.chainId.toString()]=i,r[i]=s}return r.names=n,r}}var da;(function(t){t[t.EIP155ReplayProtection=155]="EIP155ReplayProtection",t[t.EIP1559FeeMarket=1559]="EIP1559FeeMarket",t[t.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",t[t.EIP2930AccessLists=2930]="EIP2930AccessLists"})(da||(da={}));function s1e(t){if(t.length===0)return!0;const e=t[0];return!!Array.isArray(e)}function i1e(t){return!s1e(t)}class Hf{constructor(e){if(e.length!==20)throw new Error("Invalid address length");this.buf=e}static zero(){return new Hf(fW(20))}equals(e){return $1(this.buf,e.buf)}isZero(){return this.equals(Hf.zero())}toString(){return Gt(this.buf)}toArray(){return this.buf}static publicToAddress(e,n=!1){let r=e;if(v_(r),n&&r.length!==64&&(r=kc.ProjectivePoint.fromHex(r).toRawBytes(!1).slice(1)),r.length!==64)throw new Error("Expected pubKey to be of length 64");return vi(r).slice(-20)}}const o1e=(t,e)=>{const n=t.param("vm","maxInitCodeSize");if(n&&BigInt(e)>n)throw new Error(`the initcode size of this transaction is too large: it is ${e} while the max is ${t.param("vm","maxInitCodeSize")}`)},hW=t=>{let e,n;if(i1e(t)){e=t;const r=[];for(let s=0;s<t.length;s+=1){const i=t[s],o=En(i.address),a=[];for(let c=0;c<i.storageKeys.length;c+=1)a.push(En(i.storageKeys[c]));r.push([o,a])}n=r}else{n=t??[];const r=[];for(let s=0;s<n.length;s+=1){const i=n[s],o=Gt(i[0]),a=[];for(let l=0;l<i[1].length;l+=1)a.push(Gt(i[1][l]));const c={address:o,storageKeys:a};r.push(c)}e=r}return{AccessListJSON:e,accessList:n}},pW=t=>{for(let e=0;e<t.length;e+=1){const n=t[e],r=n[0],s=n[1];if(n[2]!==void 0)throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(r.length!==20)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(let i=0;i<s.length;i+=1)if(s[i].length!==32)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}},mW=t=>{const e=[];for(let n=0;n<t.length;n+=1){const r=t[n],s={address:Gt(sM(r[0],20)),storageKeys:[]},i=r&&r[1];for(let o=0;o<i.length;o+=1){const a=i[o];s.storageKeys.push(Gt(sM(a,32)))}e.push(s)}return e},gW=(t,e)=>{const n=e.param("gasPrices","accessListStorageKeyCost"),r=e.param("gasPrices","accessListAddressCost");let s=0;for(let o=0;o<t.length;o+=1){const c=t[o][1];s+=c.length}return t.length*Number(r)+s*Number(n)};class vh{constructor(e,n){var r,s;this.cache={hash:void 0,dataFee:void 0},this.activeCapabilities=[],this.DEFAULT_CHAIN=ux.Mainnet,this.DEFAULT_HARDFORK=mn.Merge;const{nonce:i,gasLimit:o,to:a,value:c,data:l,v:u,r:d,s:h,type:m}=e;this._type=Number(dn(En(m))),this.txOptions=n;const g=En(a===""?"0x":a),v=En(u===""?"0x":u),y=En(d===""?"0x":d),w=En(h===""?"0x":h);this.nonce=dn(En(i===""?"0x":i)),this.gasLimit=dn(En(o===""?"0x":o)),this.to=g.length>0?new Hf(g):void 0,this.value=dn(En(c===""?"0x":c)),this.data=En(l===""?"0x":l),this.v=v.length>0?dn(v):void 0,this.r=y.length>0?dn(y):void 0,this.s=w.length>0?dn(w):void 0,this._validateCannotExceedMaxInteger({value:this.value,r:this.r,s:this.s}),this._validateCannotExceedMaxInteger({gasLimit:this.gasLimit},64),this._validateCannotExceedMaxInteger({nonce:this.nonce},64,!0);const x=this.to===void 0||this.to===null,S=(r=n.allowUnlimitedInitCodeSize)!==null&&r!==void 0?r:!1,k=(s=n.common)!==null&&s!==void 0?s:this._getCommon();x&&k.isActivatedEIP(3860)&&!S&&o1e(k,this.data.length)}get type(){return this._type}supports(e){return this.activeCapabilities.includes(e)}validate(e=!1){const n=[];return this.getBaseFee()>this.gasLimit&&n.push(`gasLimit is too low. given ${this.gasLimit}, need at least ${this.getBaseFee()}`),this.isSigned()&&!this.verifySignature()&&n.push("Invalid Signature"),e?n:n.length===0}_validateYParity(){const{v:e}=this;if(e!==void 0&&e!==BigInt(0)&&e!==BigInt(1)){const n=this._errorMsg("The y-parity of the transaction should either be 0 or 1");throw new Error(n)}}_validateHighS(){const{s:e}=this;if(this.common.gteHardfork("homestead")&&e!==void 0&&e>rxe){const n=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");throw new Error(n)}}getBaseFee(){const e=this.common.param("gasPrices","tx");let n=this.getDataFee();if(e&&(n+=e),this.common.gteHardfork("homestead")&&this.toCreationAddress()){const r=this.common.param("gasPrices","txCreation");r&&(n+=r)}return n}getDataFee(){const e=this.common.param("gasPrices","txDataZero"),n=this.common.param("gasPrices","txDataNonZero");let r=BigInt(0);for(let s=0;s<this.data.length;s+=1)this.data[s]===0?r+=e:r+=n;if((this.to===void 0||this.to===null)&&this.common.isActivatedEIP(3860)){const s=BigInt(Math.ceil(this.data.length/32)),i=this.common.param("gasPrices","initCodeWordCost")*s;r+=i}return r}toCreationAddress(){return this.to===void 0||this.to.buf.length===0}isSigned(){const{v:e,r:n,s:r}=this;return!(e===void 0||n===void 0||r===void 0)}verifySignature(){try{const e=this.getSenderPublicKey();return dx(e).length!==0}catch{return!1}}getSenderAddress(){return new Hf(Hf.publicToAddress(this.getSenderPublicKey()))}sign(e){if(e.length!==32){const c=this._errorMsg("Private key must be 32 bytes in length.");throw new Error(c)}let n=!1;this.type===0&&this.common.gteHardfork("spuriousDragon")&&!this.supports(da.EIP155ReplayProtection)&&(this.activeCapabilities.push(da.EIP155ReplayProtection),n=!0);const r=this.getMessageToSign(!0),{v:s,r:i,s:o}=this._ecsign(r,e),a=this._processSignature(s,i,o);if(n){const c=this.activeCapabilities.indexOf(da.EIP155ReplayProtection);c>-1&&this.activeCapabilities.splice(c,1)}return a}_getCommon(e,n){var r,s,i,o;if(n!==void 0){const a=dn(En(n));if(e){if(e.chainId()!==a){const c=this._errorMsg("The chain ID does not match the chain ID of Common");throw new Error(c)}return e.copy()}return Kr.isSupportedChainId(a)?new Kr({chain:a,hardfork:this.DEFAULT_HARDFORK}):Kr.custom({name:"custom-chain",networkId:a,chainId:a},{baseChain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}if(e?.copy&&typeof e?.copy=="function")return e.copy();if(e){const a=typeof e.hardfork=="function"?e.hardfork():e.hardfork;return Kr.custom({name:"custom-chain",networkId:e.networkId?e.networkId():(s=BigInt((r=e.customChain)===null||r===void 0?void 0:r.networkId))!==null&&s!==void 0?s:void 0,chainId:e.chainId?e.chainId():(o=BigInt((i=e.customChain)===null||i===void 0?void 0:i.chainId))!==null&&o!==void 0?o:void 0},{baseChain:this.DEFAULT_CHAIN,hardfork:a||this.DEFAULT_HARDFORK})}return new Kr({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}_validateCannotExceedMaxInteger(e,n=256,r=!1){for(const[s,i]of Object.entries(e))switch(n){case 64:if(r){if(i!==void 0&&i>=tM){const o=this._errorMsg(`${s} cannot equal or exceed MAX_UINT64 (2^64-1), given ${i}`);throw new Error(o)}}else if(i!==void 0&&i>tM){const o=this._errorMsg(`${s} cannot exceed MAX_UINT64 (2^64-1), given ${i}`);throw new Error(o)}break;case 256:if(r){if(i!==void 0&&i>=_g){const o=this._errorMsg(`${s} cannot equal or exceed MAX_INTEGER (2^256-1), given ${i}`);throw new Error(o)}}else if(i!==void 0&&i>_g){const o=this._errorMsg(`${s} cannot exceed MAX_INTEGER (2^256-1), given ${i}`);throw new Error(o)}break;default:{const o=this._errorMsg("unimplemented bits value");throw new Error(o)}}}static _validateNotArray(e){const n=["nonce","gasPrice","gasLimit","to","value","data","v","r","s","type","baseFee","maxFeePerGas","chainId"];for(const[r,s]of Object.entries(e))if(n.includes(r)&&Array.isArray(s))throw new Error(`${r} cannot be an array`)}_getSharedErrorPostfix(){let e="";try{e=this.isSigned()?Gt(this.hash()):"not available (unsigned)"}catch{e="error"}let n="";try{n=this.isSigned().toString()}catch{e="error"}let r="";try{r=this.common.hardfork()}catch{r="error"}let s=`tx type=${this.type} hash=${e} nonce=${this.nonce} value=${this.value} `;return s+=`signed=${n} hf=${r}`,s}_ecsign(e,n,r){const s=kc.sign(e,n),i=s.toCompactRawBytes(),o=i.subarray(0,32),a=i.subarray(32,64),c=r===void 0?BigInt(s.recovery+27):BigInt(s.recovery+35)+BigInt(r)*BigInt(2);return{r:o,s:a,v:c}}static fromSerializedTx(e,n={}){}static fromTxData(e,n={}){}}const ST=2,k2=Hn(ST.toString(16).padStart(2,"0"));class Au extends vh{static fromTxData(e,n={}){return new Au(e,n)}static fromSerializedTx(e,n={}){if(!$1(e.subarray(0,1),k2))throw new Error(`Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: ${ST}, received: ${Gt(e.subarray(0,1))}`);const r=Nn.RLP.decode(e.subarray(1));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return Au.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==9&&e.length!==12)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");const[r,s,i,o,a,c,l,u,d,h,m,g]=e;return this._validateNotArray({chainId:r,v:h}),Fh({nonce:s,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:a,value:l,v:h,r:m,s:g}),new Au({chainId:dn(r),nonce:s,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:a,to:c,value:l,data:u,accessList:d??[],v:h!==void 0?dn(h):void 0,r:m,s:g},n)}constructor(e,n={}){var r;super(Object.assign(Object.assign({},e),{type:ST}),n),this.DEFAULT_HARDFORK="london";const{chainId:s,accessList:i,maxFeePerGas:o,maxPriorityFeePerGas:a}=e;if(this.common=this._getCommon(n.common,s),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([1559,2718,2930]);const c=hW(i??[]);if(this.accessList=c.accessList,this.AccessListJSON=c.AccessListJSON,pW(this.accessList),this.maxFeePerGas=dn(En(o===""?"0x":o)),this.maxPriorityFeePerGas=dn(En(a===""?"0x":a)),this._validateCannotExceedMaxInteger({maxFeePerGas:this.maxFeePerGas,maxPriorityFeePerGas:this.maxPriorityFeePerGas}),vh._validateNotArray(e),this.gasLimit*this.maxFeePerGas>_g){const u=this._errorMsg("gasLimit * maxFeePerGas cannot exceed MAX_INTEGER (2^256-1)");throw new Error(u)}if(this.maxFeePerGas<this.maxPriorityFeePerGas){const u=this._errorMsg("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");throw new Error(u)}this._validateYParity(),this._validateHighS(),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(gW(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(e=BigInt(0)){const n=this.maxPriorityFeePerGas,r=this.maxFeePerGas-e,i=(n<r?n:r)+e;return this.gasLimit*i+this.value}raw(){return[Vt(this.chainId),Vt(this.nonce),Vt(this.maxPriorityFeePerGas),Vt(this.maxFeePerGas),Vt(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Vt(this.value),this.data,this.accessList,this.v!==void 0?Vt(this.v):Uint8Array.from([]),this.r!==void 0?Vt(this.r):Uint8Array.from([]),this.s!==void 0?Vt(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return Ts(k2,Nn.RLP.encode(e))}getMessageToSign(e=!0){const n=this.raw().slice(0,9),r=Ts(k2,Nn.RLP.encode(n));return e?vi(r):r}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=vi(this.serialize())),this.cache.hash):vi(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const i=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(i)}const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return b_(e,n+BigInt(27),Vt(r),Vt(s))}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){const s=Object.assign(Object.assign({},this.txOptions),{common:this.common});return Au.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:dn(n),s:dn(r)},s)}toJSON(){const e=mW(this.accessList);return{chainId:An(this.chainId),nonce:An(this.nonce),maxPriorityFeePerGas:An(this.maxPriorityFeePerGas),maxFeePerGas:An(this.maxFeePerGas),gasLimit:An(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:An(this.value),data:Gt(this.data),accessList:e,v:this.v!==void 0?An(this.v):void 0,r:this.r!==void 0?An(this.r):void 0,s:this.s!==void 0?An(this.s):void 0}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` maxFeePerGas=${this.maxFeePerGas} maxPriorityFeePerGas=${this.maxPriorityFeePerGas}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}const kT=1,E2=Hn(kT.toString(16).padStart(2,"0"));class Nu extends vh{static fromTxData(e,n={}){return new Nu(e,n)}static fromSerializedTx(e,n={}){if(!$1(e.subarray(0,1),E2))throw new Error(`Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: ${kT}, received: ${Gt(e.subarray(0,1))}`);const r=Nn.RLP.decode(Uint8Array.from(e.subarray(1)));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return Nu.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==8&&e.length!==11)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");const[r,s,i,o,a,c,l,u,d,h,m]=e;this._validateNotArray({chainId:r,v:d}),Fh({nonce:s,gasPrice:i,gasLimit:o,value:c,v:d,r:h,s:m});const g=[];return new Nu({chainId:dn(r),nonce:s,gasPrice:i,gasLimit:o,to:a,value:c,data:l,accessList:u??g,v:d!==void 0?dn(d):void 0,r:h,s:m},n)}constructor(e,n={}){var r;super(Object.assign(Object.assign({},e),{type:kT}),n),this.DEFAULT_HARDFORK="berlin";const{chainId:s,accessList:i,gasPrice:o}=e;if(this.common=this._getCommon(n.common,s),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([2718,2930]);const a=hW(i??[]);if(this.accessList=a.accessList,this.AccessListJSON=a.AccessListJSON,pW(this.accessList),this.gasPrice=dn(En(o===""?"0x":o)),this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),vh._validateNotArray(e),this.gasPrice*this.gasLimit>_g){const l=this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER");throw new Error(l)}this._validateYParity(),this._validateHighS(),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(gW(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}raw(){return[Vt(this.chainId),Vt(this.nonce),Vt(this.gasPrice),Vt(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Vt(this.value),this.data,this.accessList,this.v!==void 0?Vt(this.v):Uint8Array.from([]),this.r!==void 0?Vt(this.r):Uint8Array.from([]),this.s!==void 0?Vt(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return Ts(E2,Nn.RLP.encode(e))}getMessageToSign(e=!0){const n=this.raw().slice(0,8),r=Ts(E2,Nn.RLP.encode(n));return e?vi(r):r}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=vi(this.serialize())),this.cache.hash):vi(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const i=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(i)}const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return b_(e,n+BigInt(27),Vt(r),Vt(s))}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){const s=Object.assign(Object.assign({},this.txOptions),{common:this.common});return Nu.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:dn(n),s:dn(r)},s)}toJSON(){const e=mW(this.accessList);return{chainId:An(this.chainId),nonce:An(this.nonce),gasPrice:An(this.gasPrice),gasLimit:An(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:An(this.value),data:Gt(this.data),accessList:e,v:this.v!==void 0?An(this.v):void 0,r:this.r!==void 0?An(this.r):void 0,s:this.s!==void 0?An(this.s):void 0}}errorStr(){var e,n;let r=this._getSharedErrorPostfix();return r+=` gasPrice=${this.gasPrice} accessListCount=${(n=(e=this.accessList)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}`,r}_errorMsg(e){return`${e} (${this.errorStr()})`}}const a1e=0;function iM(t,e){const n=Number(t),r=Number(e)*2;return n===r+35||n===r+36}class il extends vh{static fromTxData(e,n={}){return new il(e,n)}static fromSerializedTx(e,n={}){const r=Nn.RLP.decode(e);if(!Array.isArray(r))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(r,n)}static fromValuesArray(e,n={}){if(e.length!==6&&e.length!==9)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");const[r,s,i,o,a,c,l,u,d]=e;return Fh({nonce:r,gasPrice:s,gasLimit:i,value:a,v:l,r:u,s:d}),new il({nonce:r,gasPrice:s,gasLimit:i,to:o,value:a,data:c,v:l,r:u,s:d},n)}constructor(e,n={}){var r;if(super(Object.assign(Object.assign({},e),{type:a1e}),n),this.common=this._validateTxV(this.v,n.common),this.gasPrice=dn(En(e.gasPrice===""?"0x":e.gasPrice)),this.gasPrice*this.gasLimit>_g){const i=this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)");throw new Error(i)}this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),vh._validateNotArray(e),this.common.gteHardfork("spuriousDragon")&&(this.isSigned()?iM(this.v,this.common.chainId())&&this.activeCapabilities.push(da.EIP155ReplayProtection):this.activeCapabilities.push(da.EIP155ReplayProtection)),((r=n?.freeze)!==null&&r!==void 0?r:!0)&&Object.freeze(this)}raw(){return[Vt(this.nonce),Vt(this.gasPrice),Vt(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Vt(this.value),this.data,this.v!==void 0?Vt(this.v):Uint8Array.from([]),this.r!==void 0?Vt(this.r):Uint8Array.from([]),this.s!==void 0?Vt(this.s):Uint8Array.from([])]}serialize(){return Nn.RLP.encode(this.raw())}_getMessageToSign(){const e=[Vt(this.nonce),Vt(this.gasPrice),Vt(this.gasLimit),this.to!==void 0?this.to.buf:Uint8Array.from([]),Vt(this.value),this.data];return this.supports(da.EIP155ReplayProtection)&&(e.push(En(this.common.chainId())),e.push(dx(En(0))),e.push(dx(En(0)))),e}getMessageToSign(e=!0){const n=this._getMessageToSign();return e?vi(Nn.RLP.encode(n)):n}getDataFee(){return this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork()?this.cache.dataFee.value:(Object.isFrozen(this)&&(this.cache.dataFee={value:super.getDataFee(),hardfork:this.common.hardfork()}),super.getDataFee())}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=vi(Nn.RLP.encode(this.raw()))),this.cache.hash):vi(Nn.RLP.encode(this.raw()))}getMessageToVerifySignature(){if(!this.isSigned()){const n=this._errorMsg("This transaction is not signed");throw new Error(n)}const e=this._getMessageToSign();return vi(Nn.RLP.encode(e))}getSenderPublicKey(){const e=this.getMessageToVerifySignature(),{v:n,r,s}=this;this._validateHighS();try{return b_(e,n,Vt(r),Vt(s),this.supports(da.EIP155ReplayProtection)?this.common.chainId():void 0)}catch{const o=this._errorMsg("Invalid Signature");throw new Error(o)}}_processSignature(e,n,r){let s=e;this.supports(da.EIP155ReplayProtection)&&(s+=this.common.chainId()*BigInt(2)+BigInt(8));const i=Object.assign(Object.assign({},this.txOptions),{common:this.common});return il.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:s,r:dn(n),s:dn(r)},i)}toJSON(){return{nonce:An(this.nonce),gasPrice:An(this.gasPrice),gasLimit:An(this.gasLimit),to:this.to!==void 0?this.to.toString():void 0,value:An(this.value),data:Gt(this.data),v:this.v!==void 0?An(this.v):void 0,r:this.r!==void 0?An(this.r):void 0,s:this.s!==void 0?An(this.s):void 0}}_validateTxV(e,n){let r;const s=e!==void 0?Number(e):void 0;if(s!==void 0&&s<37&&s!==27&&s!==28)throw new Error(`Legacy txs need either v = 27/28 or v >= 37 (EIP-155 replay protection), got v = ${s}`);if(s!==void 0&&s!==0&&(!n||n.gteHardfork("spuriousDragon"))&&s!==27&&s!==28)if(n){if(!iM(BigInt(s),n.chainId()))throw new Error(`Incompatible EIP155-based V ${s} and chain id ${n.chainId()}. See the Common parameter of the Transaction constructor to set the chain id.`)}else{let i;(s-35)%2===0?i=35:i=36,r=BigInt(s-i)/BigInt(2)}return this._getCommon(n,r)}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}const C2=new Map;class fx{constructor(){}static typeToInt(e){return Number(dn(En(e)))}static registerTransactionType(e,n){const r=fx.typeToInt(e);C2.set(r,n)}static fromTxData(e,n={}){if(!("type"in e)||e.type===void 0)return il.fromTxData(e,n);const r=fx.typeToInt(e.type);if(r===0)return il.fromTxData(e,n);if(r===1)return Nu.fromTxData(e,n);if(r===2)return Au.fromTxData(e,n);const s=C2.get(r);if(s?.fromTxData)return s.fromTxData(e,n);throw new Error(`Tx instantiation with type ${r} not supported`)}static fromSerializedData(e,n={}){if(e[0]<=127)switch(e[0]){case 1:return Nu.fromSerializedTx(e,n);case 2:return Au.fromSerializedTx(e,n);default:{const r=C2.get(Number(e[0]));if(r?.fromSerializedTx)return r.fromSerializedTx(e,n);throw new Error(`TypedTransaction with ID ${e[0]} unknown`)}}else return il.fromSerializedTx(e,n)}static fromBlockBodyData(e,n={}){if(Fl(e))return this.fromSerializedData(e,n);if(Array.isArray(e))return il.fromValuesArray(e,n);throw new Error("Cannot decode transaction: unknown type input")}}var M1=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const Wh=(t,e)=>{let n;if(!e&&typeof t=="string"&&pt(t)&&t.length!==66)throw new bw;try{n=Fl(t)?t:pc(t)}catch{throw new hV}if(!e&&n.byteLength!==32)throw new bw;return n},w_=(t,e=!1)=>{const n=pt(t)?t:mc(t),r=Hn(n),s=Hn(cH(`Ethereum Signed Message:
${r.byteLength}`)),i=e?r:Ts(s,r);return $a(i)},c1e=(t,e)=>{const n=Wh(e),r=kc.sign(t.substring(2),n),s=r.toCompactRawBytes(),i=r.r.toString(16).padStart(64,"0"),o=r.s.toString(16).padStart(64,"0"),a=r.recovery+27;return{messageHash:t,v:No(a),r:`0x${i}`,s:`0x${o}`,signature:`${Gt(s)}${a.toString(16)}`}},yW=(t,e)=>{const n=w_(t),{messageHash:r,v:s,r:i,s:o,signature:a}=c1e(n,e);return{message:t,messageHash:r,v:s,r:i,s:o,signature:a}},l1e=(t,e)=>M1(void 0,void 0,void 0,function*(){const n=t.sign(Hn(e));if(oe(n.v)||oe(n.r)||oe(n.s))throw new kC("Signer Error");const r=n.validate(!0);if(r.length>0){let o="Signer Error ";for(const a of r)o+=`${o} ${a}.`;throw new kC(o)}const s=Gt(n.serialize()),i=$a(s);return{messageHash:Gt(n.getMessageToSign(!0)),v:`0x${n.v.toString(16)}`,r:`0x${n.r.toString(16).padStart(64,"0")}`,s:`0x${n.s.toString(16).padStart(64,"0")}`,rawTransaction:s,transactionHash:Gt(i)}}),u1e=t=>{if(oe(t))throw new toe;const e=fx.fromSerializedData(Hn(t));return l0(e.getSenderAddress().toString())},ET=(t,e,n,r,s)=>{if(typeof t=="object"){const d=`${t.r}${t.s.slice(2)}${t.v.slice(2)}`;return ET(t.messageHash,d,n)}if(typeof e=="string"&&typeof n=="string"&&!oe(r)){const d=`${n}${r.slice(2)}${e.slice(2)}`;return ET(t,d,s)}if(oe(e))throw new jie("signature string undefined");const i=130,o=n?t:w_(t);let a=parseInt(e.substring(i),16);a>26&&(a-=27);const c=kc.Signature.fromCompact(e.slice(2,i)).addRecoveryBit(a).recoverPublicKey(o.replace("0x","")).toRawBytes(!1),l=$a(c.subarray(1));return l0(`0x${l.slice(-40)}`)},x_=t=>{const e=Wh(t),n=kc.getPublicKey(e,!1),s=$a(n.slice(1)).slice(-40);return l0(`0x${s}`)},d1e=(t,e)=>{const n=Wh(t);return`0x${Gt(kc.getPublicKey(n,e)).slice(4)}`},vW=(t,e,n)=>M1(void 0,void 0,void 0,function*(){var r,s,i,o,a,c,l;const u=Wh(t);let d;if(n?.salt?d=typeof n.salt=="string"?Hn(n.salt):n.salt:d=Ag(32),!(lN(e)||Fl(e)))throw new Gie;const h=typeof e=="string"?Hn(mc(e)):e;let m;if(n?.iv){if(m=typeof n.iv=="string"?Hn(n.iv):n.iv,m.length!==16)throw new qie}else m=Ag(16);const g=(r=n?.kdf)!==null&&r!==void 0?r:"scrypt";let v,y;if(g==="pbkdf2"){if(y={dklen:(s=n?.dklen)!==null&&s!==void 0?s:32,salt:Gt(d).replace("0x",""),c:(i=n?.c)!==null&&i!==void 0?i:262144,prf:"hmac-sha256"},y.c<1e3)throw new Kie;v=aW(h,d,y.c,y.dklen,"sha256")}else if(g==="scrypt")y={n:(o=n?.n)!==null&&o!==void 0?o:8192,r:(a=n?.r)!==null&&a!==void 0?a:8,p:(c=n?.p)!==null&&c!==void 0?c:1,dklen:(l=n?.dklen)!==null&&l!==void 0?l:32,salt:Gt(d).replace("0x","")},v=cW(h,d,y.n,y.p,y.r,y.dklen);else throw new pV;const w=yield m_(u,v.slice(0,16),m,"aes-128-ctr"),x=Gt(w).slice(2),S=$a(Ts(v.slice(16,32),w)).replace("0x","");return{version:3,id:a_(),address:x_(u).toLowerCase().replace("0x",""),crypto:{ciphertext:x,cipherparams:{iv:Gt(m).replace("0x","")},cipher:"aes-128-ctr",kdf:g,kdfparams:y,mac:S}}}),I_=(t,e)=>{const n=Wh(t,e);return{address:x_(n),privateKey:Gt(n),signTransaction:r=>{throw new kC("Do not have network access to sign the transaction")},sign:r=>yW(typeof r=="string"?r:JSON.stringify(r),n),encrypt:(r,s)=>M1(void 0,void 0,void 0,function*(){return vW(n,r,s)})}},f1e=()=>{const t=kc.utils.randomPrivateKey();return I_(`${Gt(t)}`)},h1e=(t,e,n)=>M1(void 0,void 0,void 0,function*(){const r=typeof t=="object"?t:JSON.parse(n?t.toLowerCase():t);if(Me.validateJSONSchema(sxe,r),r.version!==3)throw new Wie;const s=typeof e=="string"?Hn(mc(e)):e;Me.validate(["bytes"],[s]);let i;if(r.crypto.kdf==="scrypt"){const l=r.crypto.kdfparams,u=typeof l.salt=="string"?Hn(l.salt):l.salt;i=cW(s,u,l.n,l.p,l.r,l.dklen)}else if(r.crypto.kdf==="pbkdf2"){const l=r.crypto.kdfparams,u=typeof l.salt=="string"?Hn(l.salt):l.salt;i=aW(s,u,l.c,l.dklen,"sha256")}else throw new pV;const o=Hn(r.crypto.ciphertext);if($a(Ts(i.slice(16,32),o)).replace("0x","")!==r.crypto.mac)throw new Hie;const c=yield jwe(Hn(r.crypto.ciphertext),i.slice(0,16),Hn(r.crypto.cipherparams.iv));return I_(c)});var um=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})};const p1e=t=>{const e=(o,a)=>um(void 0,void 0,void 0,function*(){const c=yield Xme(o,t),l=yH({format:"bytes"},a,vt);return l1e(c,l)}),n=o=>{const a=I_(o);return Object.assign(Object.assign({},a),{signTransaction:c=>um(void 0,void 0,void 0,function*(){return e(c,a.privateKey)})})},r=(o,a,c)=>um(void 0,void 0,void 0,function*(){var l;const u=yield h1e(o,a,(l=c?.nonStrict)!==null&&l!==void 0?l:!0);return Object.assign(Object.assign({},u),{signTransaction:d=>um(void 0,void 0,void 0,function*(){return e(d,u.privateKey)})})}),s=()=>{const o=f1e();return Object.assign(Object.assign({},o),{signTransaction:a=>um(void 0,void 0,void 0,function*(){return e(a,o.privateKey)})})},i=new lx({create:s,privateKeyToAccount:n,decrypt:r});return{signTransaction:e,create:s,privateKeyToAccount:n,decrypt:r,recoverTransaction:u1e,hashMessage:w_,sign:yW,recover:ET,encrypt:vW,wallet:i,privateKeyToAddress:x_,parseAndValidatePrivateKey:Wh,privateKeyToPublicKey:d1e}},m1e={version:"4.16.0"};var g1e=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})},hx;(function(t){t.eip6963announceProvider="eip6963:announceProvider",t.eip6963requestProvider="eip6963:requestProvider"})(hx||(hx={}));const T2=new Map,bW="web3:providersMapUpdated",y1e=()=>g1e(void 0,void 0,void 0,function*(){return new Promise((t,e)=>{typeof window>"u"&&e(new Error("window object not available, EIP-6963 is intended to be used within a browser")),window.addEventListener(hx.eip6963announceProvider,(n=>{T2.set(n.detail.info.uuid,n.detail);const r=new CustomEvent(bW,{detail:T2});window.dispatchEvent(r),t(T2)})),window.dispatchEvent(new Event(hx.eip6963requestProvider))})}),v1e=t=>{if(typeof window>"u")throw new Error("window object not available, EIP-6963 is intended to be used within a browser");window.addEventListener(bW,t)};class Id extends Xi{constructor(e=rwe){var n;(Ss(e)||typeof e=="string"&&e.trim()===""||typeof e!="string"&&!Nw(e)&&!e.provider)&&console.warn("NOTE: web3.js is running without provider. You need to pass a provider in order to interact with the network!");let r={};typeof e=="string"||Nw(e)?r.provider=e:e?r=e:r={},r.registeredSubscriptions=Object.assign(Object.assign({},JC),(n=r.registeredSubscriptions)!==null&&n!==void 0?n:{}),super(r);const s=p1e(this);this._wallet=s.wallet,this._accountProvider=s,this.utils=_H;const i=this;class o extends Lu{constructor(l,u,d,h,m){if(Sm(u)&&Sm(d))throw new N3("Should not provide options at both 2nd and 3rd parameters");let g,v={},y,w;if(!Ss(u)&&typeof u!="object"&&typeof u!="string")throw new N3;if(typeof u=="string"&&(g=u),Sm(u)?v=u:Sm(d)?v=d:v={},u instanceof Xi?y=u:d instanceof Xi?y=d:h instanceof Xi?y=h:y=i.getContextObject(),m?w=m:vT(d)?w=d:vT(h)&&(w=h),super(l,g,v,y,w),super.subscribeToContextEvents(i),!Ss(a)){const x=a.getTransactionMiddleware();Ss(x)||super.setTransactionMiddleware(x)}}}const a=i.use(E1);this.eth=Object.assign(a,{ens:i.use(H5,Ww.main),Iban:or,net:i.use(s6),personal:i.use(eH),Contract:o,abi:Uwe,accounts:s})}}Id.version=m1e.version;Id.utils=_H;Id.requestEIP6963Providers=y1e;Id.onNewProviderDiscovered=v1e;Id.modules={Web3Eth:E1,Iban:or,Net:s6,ENS:H5,Personal:eH};const CT=44787,b1e="https://alfajores-forno.celo-testnet.org",w1e="0x0000000000000000000000000000000000000000";let A2=null;function x1e(){if(!window.ethereum)throw new Error("Please install MetaMask or a compatible Web3 wallet");return A2||(A2=new Id(window.ethereum)),A2}async function I1e(){if(typeof window.ethereum>"u")throw new Error("Please install MetaMask or a compatible Web3 wallet");try{const t=await window.ethereum.request({method:"eth_requestAccounts"});try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${CT.toString(16)}`}]})}catch(e){if(e.code===4902)await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${CT.toString(16)}`,chainName:"Celo Alfajores Testnet",nativeCurrency:{name:"Celo",symbol:"CELO",decimals:18},rpcUrls:[b1e],blockExplorerUrls:["https://explorer.celo.org/alfajores"]}]});else throw e}return t[0]}catch(t){throw console.error("Error connecting wallet:",t),t}}async function oM(t){const e=x1e(),n=await e.eth.getBalance(t);return e.utils.fromWei(n,"ether")}async function S1e(){if(typeof window.ethereum>"u")return"Not Connected";const t=await window.ethereum.request({method:"eth_chainId"});return parseInt(t,16)===CT?"Celo Alfajores":"Unknown Network"}const k1e=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"DonationReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"totalAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"}],name:"PoolRedistributed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"score",type:"uint256"}],name:"RewardClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"score",type:"uint256"},{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"}],name:"SmileScored",type:"event"},{inputs:[],name:"donate",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"donationPool",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"emergencyWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getLeaderboard",outputs:[{internalType:"address[]",name:"addresses",type:"address[]"},{internalType:"uint256[]",name:"scores",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTimeUntilRedistribution",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"userAddress",type:"address"}],name:"getUserInfo",outputs:[{internalType:"uint256",name:"bestScore",type:"uint256"},{internalType:"uint256",name:"totalRewards",type:"uint256"},{internalType:"uint256",name:"lastClaimTime",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"leaderboard",outputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"score",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"lastRedistribution",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"MAX_LEADERBOARD_SIZE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"MIN_SCORE_FOR_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"redistributePool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"REDISTRIBUTION_INTERVAL",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"REWARD_AMOUNT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"score",type:"uint256"}],name:"submitScore",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"users",outputs:[{internalType:"uint256",name:"bestScore",type:"uint256"},{internalType:"uint256",name:"totalRewards",type:"uint256"},{internalType:"uint256",name:"lastClaimTime",type:"uint256"},{internalType:"bool",name:"hasScore",type:"bool"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],wW=z.createContext(void 0);function E1e({children:t}){const[e,n]=z.useState({address:null,connected:!1,balance:"0",network:"Not Connected"}),r=async()=>{try{const o=await I1e(),a=await oM(o),c=await S1e();n({address:o,connected:!0,balance:a,network:c})}catch(o){throw console.error("Connection error:",o),o}},s=()=>{n({address:null,connected:!1,balance:"0",network:"Not Connected"})},i=async()=>{if(e.address){const o=await oM(e.address);n(a=>({...a,balance:o}))}};return z.useEffect(()=>{if(typeof window.ethereum<"u"){const o=c=>{c.length===0?s():c[0]!==e.address&&r()},a=()=>{window.location.reload()};return window.ethereum.on("accountsChanged",o),window.ethereum.on("chainChanged",a),()=>{window.ethereum.removeListener("accountsChanged",o),window.ethereum.removeListener("chainChanged",a)}}},[e.address]),F.jsx(wW.Provider,{value:{wallet:e,connect:r,disconnect:s,refreshBalance:i},children:t})}function z1(){const t=z.useContext(wW);if(t===void 0)throw new Error("useWeb3 must be used within a Web3Provider");return t}var Vb={exports:{}},C1e=Vb.exports,aM;function T1e(){return aM||(aM=1,(function(t,e){(function(r,s){t.exports=s(Xg())})(C1e,function(n){return(function(r){var s={};function i(o){if(s[o])return s[o].exports;var a=s[o]={i:o,l:!1,exports:{}};return r[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=r,i.c=s,i.d=function(o,a,c){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:c})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(a&1&&(o=i(o)),a&8||a&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),a&2&&typeof o!="string")for(var l in o)i.d(c,l,(function(u){return o[u]}).bind(null,l));return c},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(r,s,i){i.r(s);var o=i("react"),a=(function(){var h=function(m,g){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,y){v.__proto__=y}||function(v,y){for(var w in y)y.hasOwnProperty(w)&&(v[w]=y[w])},h(m,g)};return function(m,g){h(m,g);function v(){this.constructor=m}m.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}})(),c=function(){return c=Object.assign||function(h){for(var m,g=1,v=arguments.length;g<v;g++){m=arguments[g];for(var y in m)Object.prototype.hasOwnProperty.call(m,y)&&(h[y]=m[y])}return h},c.apply(this,arguments)},l=function(h,m){var g={};for(var v in h)Object.prototype.hasOwnProperty.call(h,v)&&m.indexOf(v)<0&&(g[v]=h[v]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,v=Object.getOwnPropertySymbols(h);y<v.length;y++)m.indexOf(v[y])<0&&Object.prototype.propertyIsEnumerable.call(h,v[y])&&(g[v[y]]=h[v[y]]);return g};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(m){var g=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return g?new Promise(function(v,y){g.call(navigator,m,v,y)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function u(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var d=(function(h){a(m,h);function m(g){var v=h.call(this,g)||this;return v.canvas=null,v.ctx=null,v.requestUserMediaId=0,v.unmounted=!1,v.state={hasUserMedia:!1},v}return m.prototype.componentDidMount=function(){var g=this,v=g.state,y=g.props;if(this.unmounted=!1,!u()){y.onUserMediaError("getUserMedia not supported");return}v.hasUserMedia||this.requestUserMedia(),y.children&&typeof y.children!="function"&&console.warn("children must be a function")},m.prototype.componentDidUpdate=function(g){var v=this.props;if(!u()){v.onUserMediaError("getUserMedia not supported");return}var y=JSON.stringify(g.audioConstraints)!==JSON.stringify(v.audioConstraints),w=JSON.stringify(g.videoConstraints)!==JSON.stringify(v.videoConstraints),x=g.minScreenshotWidth!==v.minScreenshotWidth,S=g.minScreenshotHeight!==v.minScreenshotHeight;(w||x||S)&&(this.canvas=null,this.ctx=null),(y||w)&&(this.stopAndCleanup(),this.requestUserMedia())},m.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},m.stopMediaStream=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().map(function(v){g.removeTrack(v),v.stop()}),g.getAudioTracks().map(function(v){g.removeTrack(v),v.stop()})):g.stop())},m.prototype.stopAndCleanup=function(){var g=this.state;g.hasUserMedia&&(m.stopMediaStream(this.stream),g.src&&window.URL.revokeObjectURL(g.src))},m.prototype.getScreenshot=function(g){var v=this,y=v.state,w=v.props;if(!y.hasUserMedia)return null;var x=this.getCanvas(g);return x&&x.toDataURL(w.screenshotFormat,w.screenshotQuality)},m.prototype.getCanvas=function(g){var v=this,y=v.state,w=v.props;if(!this.video||!y.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,S=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var k=x/S;x=w.minScreenshotWidth||this.video.clientWidth,S=x/k,w.minScreenshotHeight&&S<w.minScreenshotHeight&&(S=w.minScreenshotHeight,x=S*k)}this.canvas=document.createElement("canvas"),this.canvas.width=g?.width||x,this.canvas.height=g?.height||S,this.ctx=this.canvas.getContext("2d")}var E=this,A=E.ctx,R=E.canvas;return A&&R&&(R.width=g?.width||R.width,R.height=g?.height||R.height,w.mirrored&&(A.translate(R.width,0),A.scale(-1,1)),A.imageSmoothingEnabled=w.imageSmoothing,A.drawImage(this.video,0,0,g?.width||R.width,g?.height||R.height),w.mirrored&&(A.scale(-1,1),A.translate(-R.width,0))),R},m.prototype.requestUserMedia=function(){var g=this,v=this.props,y=function(S,k){var E={video:typeof k<"u"?k:!0};v.audio&&(E.audio=typeof S<"u"?S:!0),g.requestUserMediaId++;var A=g.requestUserMediaId;navigator.mediaDevices.getUserMedia(E).then(function(R){g.unmounted||A!==g.requestUserMediaId?m.stopMediaStream(R):g.handleUserMedia(null,R)}).catch(function(R){g.handleUserMedia(R)})};if("mediaDevices"in navigator)y(v.audioConstraints,v.videoConstraints);else{var w=function(S){return{optional:[{sourceId:S}]}},x=function(S){var k=S.deviceId;return typeof k=="string"?k:Array.isArray(k)&&k.length>0?k[0]:typeof k=="object"&&k.ideal?k.ideal:null};MediaStreamTrack.getSources(function(S){var k=null,E=null;S.forEach(function(N){N.kind==="audio"?k=N.id:N.kind==="video"&&(E=N.id)});var A=x(v.audioConstraints);A&&(k=A);var R=x(v.videoConstraints);R&&(E=R),y(w(k),w(E))})}},m.prototype.handleUserMedia=function(g,v){var y=this.props;if(g||!v){this.setState({hasUserMedia:!1}),y.onUserMediaError(g);return}this.stream=v;try{this.video&&(this.video.srcObject=v),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(v)})}y.onUserMedia(v)},m.prototype.render=function(){var g=this,v=this,y=v.state,w=v.props,x=w.audio;w.forceScreenshotSourceSize;var S=w.disablePictureInPicture;w.onUserMedia,w.onUserMediaError,w.screenshotFormat,w.screenshotQuality,w.minScreenshotWidth,w.minScreenshotHeight,w.audioConstraints,w.videoConstraints,w.imageSmoothing;var k=w.mirrored,E=w.style,A=E===void 0?{}:E,R=w.children,N=l(w,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),P=k?c(c({},A),{transform:(A.transform||"")+" scaleX(-1)"}):A,O={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",c({autoPlay:!0,disablePictureInPicture:S,src:y.src,muted:!x,playsInline:!0,ref:function(_){g.video=_},style:P},N)),R&&R(O))},m.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},m})(o.Component);s.default=d}),react:(function(r,s){r.exports=n})}).default})})(Vb)),Vb.exports}var A1e=T1e();const N1e=Wo(A1e),_1e=Zg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ro=z.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Aee:"button";return F.jsx(o,{className:sn(_1e({variant:e,size:n,className:t})),ref:i,...s})});Ro.displayName="Button";const ic=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",t),...e}));ic.displayName="Card";const px=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("flex flex-col space-y-1.5 p-6",t),...e}));px.displayName="CardHeader";const mx=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("text-2xl font-semibold leading-none tracking-tight",t),...e}));mx.displayName="CardTitle";const gx=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("text-sm text-muted-foreground",t),...e}));gx.displayName="CardDescription";const $g=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("p-6 pt-0",t),...e}));$g.displayName="CardContent";const $1e=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("flex items-center p-6 pt-0",t),...e}));$1e.displayName="CardFooter";function R1e({onCapture:t,isProcessing:e=!1}){const n=z.useRef(null),[r,s]=z.useState(null),[i,o]=z.useState(!1),[a,c]=z.useState(!1),l=z.useCallback(()=>{const h=n.current?.getScreenshot();h&&s(h)},[n]),u=()=>{s(null)},d=()=>{r&&(t(r),s(null))};return F.jsxs(ic,{className:"overflow-hidden",children:[F.jsx("div",{className:"relative bg-muted aspect-[3/4] max-h-[600px] flex items-center justify-center",children:r?F.jsx("img",{src:r,alt:"Captured selfie",className:"w-full h-full object-cover","data-testid":"img-captured"}):F.jsxs(F.Fragment,{children:[F.jsx(N1e,{ref:n,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:720,height:960,facingMode:"user"},onUserMedia:()=>{o(!0),c(!1)},onUserMediaError:()=>{c(!0),o(!1)},className:"w-full h-full object-cover","data-testid":"webcam-feed"}),i&&F.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:F.jsx("div",{className:"border-4 border-primary/40 rounded-full w-72 h-96 max-w-[80%] max-h-[80%]"})}),!i&&!a&&F.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 backdrop-blur-sm",children:F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx(gC,{className:"h-12 w-12 mx-auto text-muted-foreground animate-pulse"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"Initializing camera..."})]})}),a&&F.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 backdrop-blur-sm",children:F.jsxs("div",{className:"text-center space-y-2",children:[F.jsx(Ete,{className:"h-12 w-12 mx-auto text-destructive"}),F.jsx("p",{className:"text-sm text-foreground font-medium",children:"Camera access denied"}),F.jsx("p",{className:"text-xs text-muted-foreground",children:"Please allow camera permissions"})]})})]})}),F.jsxs("div",{className:"p-6 space-y-4",children:[r?F.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[F.jsxs(Ro,{onClick:u,variant:"outline",size:"lg",className:"gap-2","data-testid":"button-retake",children:[F.jsx($te,{className:"h-4 w-4"}),"Retake"]}),F.jsxs(Ro,{onClick:d,size:"lg",className:"gap-2",disabled:e,"data-testid":"button-analyze",children:[F.jsx(kte,{className:"h-4 w-4"}),e?"Analyzing...":"Analyze Smile"]})]}):F.jsxs(Ro,{onClick:l,disabled:!i||e,size:"lg",className:"w-full gap-2","data-testid":"button-capture",children:[F.jsx(gC,{className:"h-5 w-5"}),"Capture Smile"]}),F.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Position your face within the oval guide for best results"})]})]})}var S_="Progress",k_=100,[O1e]=Ol(S_),[P1e,D1e]=O1e(S_),xW=z.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=F1e,...o}=t;(s||s===0)&&!cM(s)&&console.error(L1e(`${s}`,"Progress"));const a=cM(s)?s:k_;r!==null&&!lM(r,a)&&console.error(B1e(`${r}`,"Progress"));const c=lM(r,a)?r:null,l=yx(c)?i(c,a):void 0;return F.jsx(P1e,{scope:n,value:c,max:a,children:F.jsx(yn.div,{"aria-valuemax":a,"aria-valuemin":0,"aria-valuenow":yx(c)?c:void 0,"aria-valuetext":l,role:"progressbar","data-state":kW(c,a),"data-value":c??void 0,"data-max":a,...o,ref:e})})});xW.displayName=S_;var IW="ProgressIndicator",SW=z.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=D1e(IW,n);return F.jsx(yn.div,{"data-state":kW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});SW.displayName=IW;function F1e(t,e){return`${Math.round(t/e*100)}%`}function kW(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function yx(t){return typeof t=="number"}function cM(t){return yx(t)&&!isNaN(t)&&t>0}function lM(t,e){return yx(t)&&!isNaN(t)&&t<=e&&t>=0}function L1e(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${k_}\`.`}function B1e(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${k_} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var EW=xW,M1e=SW;const TT=z.forwardRef(({className:t,value:e,...n},r)=>F.jsx(EW,{ref:r,className:sn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:F.jsx(M1e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));TT.displayName=EW.displayName;const z1e=Zg("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function ed({className:t,variant:e,...n}){return F.jsx("div",{className:sn(z1e({variant:e}),t),...n})}const U1e=Pm({amount:cN().min(1,"Amount is required")}),vu=80;function V1e({score:t,isAnalyzing:e=!1}){const[n,r]=z.useState(0);z.useEffect(()=>{if(t!==null&&t>0){const l=t/50;let u=0;const d=setInterval(()=>{u+=l,u>=t?(r(t),clearInterval(d)):r(Math.floor(u))},1e3/50);return()=>clearInterval(d)}else r(0)},[t]);const s=a=>a>=80?F.jsx(yC,{className:"h-16 w-16 text-primary"}):a>=50?F.jsx(_te,{className:"h-16 w-16 text-accent-foreground"}):F.jsx(SU,{className:"h-16 w-16 text-muted-foreground"}),i=a=>a>=90?"Amazing Smile!":a>=80?"Great Smile!":a>=60?"Good Smile":a>=40?"Nice Try":"Keep Smiling!",o=a=>a>=vu?"text-primary":a>=50?"text-accent-foreground":"text-muted-foreground";return e?F.jsx(ic,{className:"p-8",children:F.jsxs("div",{className:"text-center space-y-4",children:[F.jsx("div",{className:"flex justify-center",children:F.jsx(yC,{className:"h-16 w-16 text-primary animate-pulse"})}),F.jsx("h3",{className:"text-2xl font-display font-semibold",children:"Analyzing Your Smile..."}),F.jsx("p",{className:"text-muted-foreground",children:"Our AI is scoring your smile"}),F.jsx(TT,{value:void 0,className:"w-full"})]})}):t===null?F.jsx(ic,{className:"p-8",children:F.jsxs("div",{className:"text-center space-y-4",children:[F.jsx("div",{className:"flex justify-center",children:F.jsx(gC,{className:"h-16 w-16 text-muted-foreground"})}),F.jsx("h3",{className:"text-2xl font-display font-semibold",children:"Ready to Smile?"}),F.jsx("p",{className:"text-muted-foreground",children:"Capture your best smile to earn rewards"}),F.jsxs(ed,{variant:"outline",className:"gap-1",children:[F.jsx(ku,{className:"h-3 w-3"}),"Score ",vu,"+ to earn tokens"]})]})}):F.jsx(ic,{className:"p-8","data-testid":"card-smile-score",children:F.jsxs("div",{className:"text-center space-y-6",children:[F.jsx("div",{className:"flex justify-center",children:s(n)}),F.jsxs("div",{className:"space-y-2",children:[F.jsx("div",{className:`text-7xl font-display font-bold ${o(n)}`,"data-testid":"text-score",children:n}),F.jsx("div",{className:"text-xl text-muted-foreground",children:"/ 100"})]}),F.jsx("h3",{className:"text-2xl font-display font-semibold",children:i(n)}),F.jsxs("div",{className:"space-y-2",children:[F.jsxs("div",{className:"flex justify-between text-sm",children:[F.jsx("span",{className:"text-muted-foreground",children:"Smile Quality"}),F.jsxs("span",{className:"font-medium",children:[n,"%"]})]}),F.jsx(TT,{value:n,className:"h-3","data-testid":"progress-score"})]}),n>=vu&&F.jsxs(ed,{variant:"default",className:"gap-2 text-base px-4 py-2",children:[F.jsx(ku,{className:"h-4 w-4"}),"Reward Eligible!"]}),n<vu&&F.jsxs("p",{className:"text-sm text-muted-foreground",children:["Score ",vu,"+ to earn token rewards"]})]})})}const CW=z.forwardRef(({className:t,type:e,...n},r)=>F.jsx("input",{type:e,className:sn("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));CW.displayName="Input";var j1e="Label",TW=z.forwardRef((t,e)=>F.jsx(yn.label,{...t,ref:e,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(t.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));TW.displayName=j1e;var AW=TW;const H1e=Zg("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),NW=z.forwardRef(({className:t,...e},n)=>F.jsx(AW,{ref:n,className:sn(H1e(),t),...e}));NW.displayName=AW.displayName;var d0=t=>t.type==="checkbox",_u=t=>t instanceof Date,js=t=>t==null;const _W=t=>typeof t=="object";var dr=t=>!js(t)&&!Array.isArray(t)&&_W(t)&&!_u(t),W1e=t=>dr(t)&&t.target?d0(t.target)?t.target.checked:t.target.value:t,G1e=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,q1e=(t,e)=>t.has(G1e(e)),K1e=t=>{const e=t.constructor&&t.constructor.prototype;return dr(e)&&e.hasOwnProperty("isPrototypeOf")},E_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Rr(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(E_&&(t instanceof Blob||r))&&(n||dr(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!K1e(t))e=t;else for(const s in t)t.hasOwnProperty(s)&&(e[s]=Rr(t[s]));else return t;return e}var U1=t=>/^\w*$/.test(t),nr=t=>t===void 0,C_=t=>Array.isArray(t)?t.filter(Boolean):[],T_=t=>C_(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ye=(t,e,n)=>{if(!e||!dr(t))return n;const r=(U1(e)?[e]:T_(e)).reduce((s,i)=>js(s)?s:s[i],t);return nr(r)||r===t?nr(t[e])?n:t[e]:r},ra=t=>typeof t=="boolean",cn=(t,e,n)=>{let r=-1;const s=U1(e)?[e]:T_(e),i=s.length,o=i-1;for(;++r<i;){const a=s[r];let c=n;if(r!==o){const l=t[a];c=dr(l)||Array.isArray(l)?l:isNaN(+s[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;t[a]=c,t=t[a]}};const uM={BLUR:"blur",FOCUS_OUT:"focusout"},Co={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ka={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},X1e=tr.createContext(null);X1e.displayName="HookFormContext";var Q1e=(t,e,n,r=!0)=>{const s={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(s,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Co.all&&(e._proxyFormState[o]=!r||Co.all),t[o]}});return s};const Y1e=typeof window<"u"?tr.useLayoutEffect:tr.useEffect;var mi=t=>typeof t=="string",Z1e=(t,e,n,r,s)=>mi(t)?(r&&e.watch.add(t),Ye(n,t,s)):Array.isArray(t)?t.map(i=>(r&&e.watch.add(i),Ye(n,i))):(r&&(e.watchAll=!0),n),AT=t=>js(t)||!_W(t);function sl(t,e,n=new WeakSet){if(AT(t)||AT(e))return t===e;if(_u(t)&&_u(e))return t.getTime()===e.getTime();const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const i of r){const o=t[i];if(!s.includes(i))return!1;if(i!=="ref"){const a=e[i];if(_u(o)&&_u(a)||dr(o)&&dr(a)||Array.isArray(o)&&Array.isArray(a)?!sl(o,a,n):o!==a)return!1}}return!0}var $W=(t,e,n,r,s)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:s||!0}}:{},Um=t=>Array.isArray(t)?t:[t],dM=()=>{let t=[];return{get observers(){return t},next:s=>{for(const i of t)i.next&&i.next(s)},subscribe:s=>(t.push(s),{unsubscribe:()=>{t=t.filter(i=>i!==s)}}),unsubscribe:()=>{t=[]}}};function RW(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const s=t[r],i=e[r];if(s&&dr(s)&&i){const o=RW(s,i);dr(o)&&(n[r]=o)}else t[r]&&(n[r]=i)}return n}var zs=t=>dr(t)&&!Object.keys(t).length,A_=t=>t.type==="file",To=t=>typeof t=="function",vx=t=>{if(!E_)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},OW=t=>t.type==="select-multiple",N_=t=>t.type==="radio",J1e=t=>N_(t)||d0(t),N2=t=>vx(t)&&t.isConnected;function eIe(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=nr(t)?r++:t[e[r++]];return t}function tIe(t){for(const e in t)if(t.hasOwnProperty(e)&&!nr(t[e]))return!1;return!0}function ir(t,e){const n=Array.isArray(e)?e:U1(e)?[e]:T_(e),r=n.length===1?t:eIe(t,n),s=n.length-1,i=n[s];return r&&delete r[i],s!==0&&(dr(r)&&zs(r)||Array.isArray(r)&&tIe(r))&&ir(t,n.slice(0,-1)),t}var nIe=t=>{for(const e in t)if(To(t[e]))return!0;return!1};function PW(t){return Array.isArray(t)||dr(t)&&!nIe(t)}function NT(t,e={}){for(const n in t)PW(t[n])?(e[n]=Array.isArray(t[n])?[]:{},NT(t[n],e[n])):nr(t[n])||(e[n]=!0);return e}function Af(t,e,n){n||(n=NT(e));for(const r in t)PW(t[r])?nr(e)||AT(n[r])?n[r]=NT(t[r],Array.isArray(t[r])?[]:{}):Af(t[r],js(e)?{}:e[r],n[r]):n[r]=!sl(t[r],e[r]);return n}const fM={value:!1,isValid:!1},hM={value:!0,isValid:!0};var DW=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!nr(t[0].attributes.value)?nr(t[0].value)||t[0].value===""?hM:{value:t[0].value,isValid:!0}:hM:fM}return fM},FW=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>nr(t)?t:e?t===""?NaN:t&&+t:n&&mi(t)?new Date(t):r?r(t):t;const pM={isValid:!1,value:null};var LW=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,pM):pM;function mM(t){const e=t.ref;return A_(e)?e.files:N_(e)?LW(t.refs).value:OW(e)?[...e.selectedOptions].map(({value:n})=>n):d0(e)?DW(t.refs).value:FW(nr(e.value)?t.ref.value:e.value,t)}var rIe=(t,e,n,r)=>{const s={};for(const i of t){const o=Ye(e,i);o&&cn(s,i,o._f)}return{criteriaMode:n,names:[...t],fields:s,shouldUseNativeValidation:r}},bx=t=>t instanceof RegExp,dm=t=>nr(t)?t:bx(t)?t.source:dr(t)?bx(t.value)?t.value.source:t.value:t,gM=t=>({isOnSubmit:!t||t===Co.onSubmit,isOnBlur:t===Co.onBlur,isOnChange:t===Co.onChange,isOnAll:t===Co.all,isOnTouch:t===Co.onTouched});const yM="AsyncFunction";var sIe=t=>!!t&&!!t.validate&&!!(To(t.validate)&&t.validate.constructor.name===yM||dr(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===yM)),iIe=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),vM=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Vm=(t,e,n,r)=>{for(const s of n||Object.keys(t)){const i=Ye(t,s);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(Vm(a,e))break}else if(dr(a)&&Vm(a,e))break}}};function bM(t,e,n){const r=Ye(t,n);if(r||U1(n))return{error:r,name:n};const s=n.split(".");for(;s.length;){const i=s.join("."),o=Ye(e,i),a=Ye(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(a&&a.type)return{name:i,error:a};if(a&&a.root&&a.root.type)return{name:`${i}.root`,error:a.root};s.pop()}return{name:n}}var oIe=(t,e,n,r)=>{n(t);const{name:s,...i}=t;return zs(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!r||Co.all))},aIe=(t,e,n)=>!t||!e||t===e||Um(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),cIe=(t,e,n,r,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||t):(n?r.isOnBlur:s.isOnBlur)?!t:(n?r.isOnChange:s.isOnChange)?t:!0,lIe=(t,e)=>!C_(Ye(t,e)).length&&ir(t,e),uIe=(t,e,n)=>{const r=Um(Ye(t,n));return cn(r,"root",e[n]),cn(t,n,r),t};function wM(t,e,n="validate"){if(mi(t)||Array.isArray(t)&&t.every(mi)||ra(t)&&!t)return{type:n,message:mi(t)?t:"",ref:e}}var mf=t=>dr(t)&&!bx(t)?t:{value:t,message:""},xM=async(t,e,n,r,s,i)=>{const{ref:o,refs:a,required:c,maxLength:l,minLength:u,min:d,max:h,pattern:m,validate:g,name:v,valueAsNumber:y,mount:w}=t._f,x=Ye(n,v);if(!w||e.has(v))return{};const S=a?a[0]:o,k=M=>{s&&S.reportValidity&&(S.setCustomValidity(ra(M)?"":M||""),S.reportValidity())},E={},A=N_(o),R=d0(o),N=A||R,P=(y||A_(o))&&nr(o.value)&&nr(x)||vx(o)&&o.value===""||x===""||Array.isArray(x)&&!x.length,O=$W.bind(null,v,r,E),_=(M,G,q,D=Ka.maxLength,L=Ka.minLength)=>{const K=M?G:q;E[v]={type:M?D:L,message:K,ref:o,...O(M?D:L,K)}};if(i?!Array.isArray(x)||!x.length:c&&(!N&&(P||js(x))||ra(x)&&!x||R&&!DW(a).isValid||A&&!LW(a).isValid)){const{value:M,message:G}=mi(c)?{value:!!c,message:c}:mf(c);if(M&&(E[v]={type:Ka.required,message:G,ref:S,...O(Ka.required,G)},!r))return k(G),E}if(!P&&(!js(d)||!js(h))){let M,G;const q=mf(h),D=mf(d);if(!js(x)&&!isNaN(x)){const L=o.valueAsNumber||x&&+x;js(q.value)||(M=L>q.value),js(D.value)||(G=L<D.value)}else{const L=o.valueAsDate||new Date(x),K=X=>new Date(new Date().toDateString()+" "+X),j=o.type=="time",W=o.type=="week";mi(q.value)&&x&&(M=j?K(x)>K(q.value):W?x>q.value:L>new Date(q.value)),mi(D.value)&&x&&(G=j?K(x)<K(D.value):W?x<D.value:L<new Date(D.value))}if((M||G)&&(_(!!M,q.message,D.message,Ka.max,Ka.min),!r))return k(E[v].message),E}if((l||u)&&!P&&(mi(x)||i&&Array.isArray(x))){const M=mf(l),G=mf(u),q=!js(M.value)&&x.length>+M.value,D=!js(G.value)&&x.length<+G.value;if((q||D)&&(_(q,M.message,G.message),!r))return k(E[v].message),E}if(m&&!P&&mi(x)){const{value:M,message:G}=mf(m);if(bx(M)&&!x.match(M)&&(E[v]={type:Ka.pattern,message:G,ref:o,...O(Ka.pattern,G)},!r))return k(G),E}if(g){if(To(g)){const M=await g(x,n),G=wM(M,S);if(G&&(E[v]={...G,...O(Ka.validate,G.message)},!r))return k(G.message),E}else if(dr(g)){let M={};for(const G in g){if(!zs(M)&&!r)break;const q=wM(await g[G](x,n),S,G);q&&(M={...q,...O(G,q.message)},k(q.message),r&&(E[v]=M))}if(!zs(M)&&(E[v]={ref:S,...M},!r))return E}}return k(!0),E};const dIe={mode:Co.onSubmit,reValidateMode:Co.onChange,shouldFocusError:!0};function fIe(t={}){let e={...dIe,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:To(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=dr(e.defaultValues)||dr(e.values)?Rr(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Rr(s),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,l=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:dM(),state:dM()},m=e.criteriaMode===Co.all,g=Z=>le=>{clearTimeout(l),l=setTimeout(Z,le)},v=async Z=>{if(!e.disabled&&(u.isValid||d.isValid||Z)){const le=e.resolver?zs((await R()).errors):await P(r,!0);le!==n.isValid&&h.state.next({isValid:le})}},y=(Z,le)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((Z||Array.from(a.mount)).forEach(ye=>{ye&&(le?cn(n.validatingFields,ye,le):ir(n.validatingFields,ye))}),h.state.next({validatingFields:n.validatingFields,isValidating:!zs(n.validatingFields)}))},w=(Z,le=[],ye,De,Ne=!0,Ee=!0)=>{if(De&&ye&&!e.disabled){if(o.action=!0,Ee&&Array.isArray(Ye(r,Z))){const Ge=ye(Ye(r,Z),De.argA,De.argB);Ne&&cn(r,Z,Ge)}if(Ee&&Array.isArray(Ye(n.errors,Z))){const Ge=ye(Ye(n.errors,Z),De.argA,De.argB);Ne&&cn(n.errors,Z,Ge),lIe(n.errors,Z)}if((u.touchedFields||d.touchedFields)&&Ee&&Array.isArray(Ye(n.touchedFields,Z))){const Ge=ye(Ye(n.touchedFields,Z),De.argA,De.argB);Ne&&cn(n.touchedFields,Z,Ge)}(u.dirtyFields||d.dirtyFields)&&(n.dirtyFields=Af(s,i)),h.state.next({name:Z,isDirty:_(Z,le),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else cn(i,Z,le)},x=(Z,le)=>{cn(n.errors,Z,le),h.state.next({errors:n.errors})},S=Z=>{n.errors=Z,h.state.next({errors:n.errors,isValid:!1})},k=(Z,le,ye,De)=>{const Ne=Ye(r,Z);if(Ne){const Ee=Ye(i,Z,nr(ye)?Ye(s,Z):ye);nr(Ee)||De&&De.defaultChecked||le?cn(i,Z,le?Ee:mM(Ne._f)):q(Z,Ee),o.mount&&v()}},E=(Z,le,ye,De,Ne)=>{let Ee=!1,Ge=!1;const xt={name:Z};if(!e.disabled){if(!ye||De){(u.isDirty||d.isDirty)&&(Ge=n.isDirty,n.isDirty=xt.isDirty=_(),Ee=Ge!==xt.isDirty);const Ct=sl(Ye(s,Z),le);Ge=!!Ye(n.dirtyFields,Z),Ct?ir(n.dirtyFields,Z):cn(n.dirtyFields,Z,!0),xt.dirtyFields=n.dirtyFields,Ee=Ee||(u.dirtyFields||d.dirtyFields)&&Ge!==!Ct}if(ye){const Ct=Ye(n.touchedFields,Z);Ct||(cn(n.touchedFields,Z,ye),xt.touchedFields=n.touchedFields,Ee=Ee||(u.touchedFields||d.touchedFields)&&Ct!==ye)}Ee&&Ne&&h.state.next(xt)}return Ee?xt:{}},A=(Z,le,ye,De)=>{const Ne=Ye(n.errors,Z),Ee=(u.isValid||d.isValid)&&ra(le)&&n.isValid!==le;if(e.delayError&&ye?(c=g(()=>x(Z,ye)),c(e.delayError)):(clearTimeout(l),c=null,ye?cn(n.errors,Z,ye):ir(n.errors,Z)),(ye?!sl(Ne,ye):Ne)||!zs(De)||Ee){const Ge={...De,...Ee&&ra(le)?{isValid:le}:{},errors:n.errors,name:Z};n={...n,...Ge},h.state.next(Ge)}},R=async Z=>{y(Z,!0);const le=await e.resolver(i,e.context,rIe(Z||a.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return y(Z),le},N=async Z=>{const{errors:le}=await R(Z);if(Z)for(const ye of Z){const De=Ye(le,ye);De?cn(n.errors,ye,De):ir(n.errors,ye)}else n.errors=le;return le},P=async(Z,le,ye={valid:!0})=>{for(const De in Z){const Ne=Z[De];if(Ne){const{_f:Ee,...Ge}=Ne;if(Ee){const xt=a.array.has(Ee.name),Ct=Ne._f&&sIe(Ne._f);Ct&&u.validatingFields&&y([Ee.name],!0);const Zn=await xM(Ne,a.disabled,i,m,e.shouldUseNativeValidation&&!le,xt);if(Ct&&u.validatingFields&&y([Ee.name]),Zn[Ee.name]&&(ye.valid=!1,le))break;!le&&(Ye(Zn,Ee.name)?xt?uIe(n.errors,Zn,Ee.name):cn(n.errors,Ee.name,Zn[Ee.name]):ir(n.errors,Ee.name))}!zs(Ge)&&await P(Ge,le,ye)}}return ye.valid},O=()=>{for(const Z of a.unMount){const le=Ye(r,Z);le&&(le._f.refs?le._f.refs.every(ye=>!N2(ye)):!N2(le._f.ref))&&we(Z)}a.unMount=new Set},_=(Z,le)=>!e.disabled&&(Z&&le&&cn(i,Z,le),!sl(X(),s)),M=(Z,le,ye)=>Z1e(Z,a,{...o.mount?i:nr(le)?s:mi(Z)?{[Z]:le}:le},ye,le),G=Z=>C_(Ye(o.mount?i:s,Z,e.shouldUnregister?Ye(s,Z,[]):[])),q=(Z,le,ye={})=>{const De=Ye(r,Z);let Ne=le;if(De){const Ee=De._f;Ee&&(!Ee.disabled&&cn(i,Z,FW(le,Ee)),Ne=vx(Ee.ref)&&js(le)?"":le,OW(Ee.ref)?[...Ee.ref.options].forEach(Ge=>Ge.selected=Ne.includes(Ge.value)):Ee.refs?d0(Ee.ref)?Ee.refs.forEach(Ge=>{(!Ge.defaultChecked||!Ge.disabled)&&(Array.isArray(Ne)?Ge.checked=!!Ne.find(xt=>xt===Ge.value):Ge.checked=Ne===Ge.value||!!Ne)}):Ee.refs.forEach(Ge=>Ge.checked=Ge.value===Ne):A_(Ee.ref)?Ee.ref.value="":(Ee.ref.value=Ne,Ee.ref.type||h.state.next({name:Z,values:Rr(i)})))}(ye.shouldDirty||ye.shouldTouch)&&E(Z,Ne,ye.shouldTouch,ye.shouldDirty,!0),ye.shouldValidate&&W(Z)},D=(Z,le,ye)=>{for(const De in le){if(!le.hasOwnProperty(De))return;const Ne=le[De],Ee=Z+"."+De,Ge=Ye(r,Ee);(a.array.has(Z)||dr(Ne)||Ge&&!Ge._f)&&!_u(Ne)?D(Ee,Ne,ye):q(Ee,Ne,ye)}},L=(Z,le,ye={})=>{const De=Ye(r,Z),Ne=a.array.has(Z),Ee=Rr(le);cn(i,Z,Ee),Ne?(h.array.next({name:Z,values:Rr(i)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ye.shouldDirty&&h.state.next({name:Z,dirtyFields:Af(s,i),isDirty:_(Z,Ee)})):De&&!De._f&&!js(Ee)?D(Z,Ee,ye):q(Z,Ee,ye),vM(Z,a)&&h.state.next({...n,name:Z}),h.state.next({name:o.mount?Z:void 0,values:Rr(i)})},K=async Z=>{o.mount=!0;const le=Z.target;let ye=le.name,De=!0;const Ne=Ye(r,ye),Ee=Ct=>{De=Number.isNaN(Ct)||_u(Ct)&&isNaN(Ct.getTime())||sl(Ct,Ye(i,ye,Ct))},Ge=gM(e.mode),xt=gM(e.reValidateMode);if(Ne){let Ct,Zn;const $s=le.type?mM(Ne._f):W1e(Z),Tr=Z.type===uM.BLUR||Z.type===uM.FOCUS_OUT,up=!iIe(Ne._f)&&!e.resolver&&!Ye(n.errors,ye)&&!Ne._f.deps||cIe(Tr,Ye(n.touchedFields,ye),n.isSubmitted,xt,Ge),fo=vM(ye,a,Tr);cn(i,ye,$s),Tr?(!le||!le.readOnly)&&(Ne._f.onBlur&&Ne._f.onBlur(Z),c&&c(0)):Ne._f.onChange&&Ne._f.onChange(Z);const _c=E(ye,$s,Tr),dp=!zs(_c)||fo;if(!Tr&&h.state.next({name:ye,type:Z.type,values:Rr(i)}),up)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?Tr&&v():Tr||v()),dp&&h.state.next({name:ye,...fo?{}:_c});if(!Tr&&fo&&h.state.next({...n}),e.resolver){const{errors:Dd}=await R([ye]);if(Ee($s),De){const fp=bM(n.errors,r,ye),Fd=bM(Dd,r,fp.name||ye);Ct=Fd.error,ye=Fd.name,Zn=zs(Dd)}}else y([ye],!0),Ct=(await xM(Ne,a.disabled,i,m,e.shouldUseNativeValidation))[ye],y([ye]),Ee($s),De&&(Ct?Zn=!1:(u.isValid||d.isValid)&&(Zn=await P(r,!0)));De&&(Ne._f.deps&&(!Array.isArray(Ne._f.deps)||Ne._f.deps.length>0)&&W(Ne._f.deps),A(ye,Zn,Ct,_c))}},j=(Z,le)=>{if(Ye(n.errors,le)&&Z.focus)return Z.focus(),1},W=async(Z,le={})=>{let ye,De;const Ne=Um(Z);if(e.resolver){const Ee=await N(nr(Z)?Z:Ne);ye=zs(Ee),De=Z?!Ne.some(Ge=>Ye(Ee,Ge)):ye}else Z?(De=(await Promise.all(Ne.map(async Ee=>{const Ge=Ye(r,Ee);return await P(Ge&&Ge._f?{[Ee]:Ge}:Ge)}))).every(Boolean),!(!De&&!n.isValid)&&v()):De=ye=await P(r);return h.state.next({...!mi(Z)||(u.isValid||d.isValid)&&ye!==n.isValid?{}:{name:Z},...e.resolver||!Z?{isValid:ye}:{},errors:n.errors}),le.shouldFocus&&!De&&Vm(r,j,Z?Ne:a.mount),De},X=(Z,le)=>{let ye={...o.mount?i:s};return le&&(ye=RW(le.dirtyFields?n.dirtyFields:n.touchedFields,ye)),nr(Z)?ye:mi(Z)?Ye(ye,Z):Z.map(De=>Ye(ye,De))},H=(Z,le)=>({invalid:!!Ye((le||n).errors,Z),isDirty:!!Ye((le||n).dirtyFields,Z),error:Ye((le||n).errors,Z),isValidating:!!Ye(n.validatingFields,Z),isTouched:!!Ye((le||n).touchedFields,Z)}),Y=Z=>{Z&&Um(Z).forEach(le=>ir(n.errors,le)),h.state.next({errors:Z?n.errors:{}})},ce=(Z,le,ye)=>{const De=(Ye(r,Z,{_f:{}})._f||{}).ref,Ne=Ye(n.errors,Z)||{},{ref:Ee,message:Ge,type:xt,...Ct}=Ne;cn(n.errors,Z,{...Ct,...le,ref:De}),h.state.next({name:Z,errors:n.errors,isValid:!1}),ye&&ye.shouldFocus&&De&&De.focus&&De.focus()},de=(Z,le)=>To(Z)?h.state.subscribe({next:ye=>"values"in ye&&Z(M(void 0,le),ye)}):M(Z,le,!0),ge=Z=>h.state.subscribe({next:le=>{aIe(Z.name,le.name,Z.exact)&&oIe(le,Z.formState||u,Xt,Z.reRenderRoot)&&Z.callback({values:{...i},...n,...le,defaultValues:s})}}).unsubscribe,be=Z=>(o.mount=!0,d={...d,...Z.formState},ge({...Z,formState:d})),we=(Z,le={})=>{for(const ye of Z?Um(Z):a.mount)a.mount.delete(ye),a.array.delete(ye),le.keepValue||(ir(r,ye),ir(i,ye)),!le.keepError&&ir(n.errors,ye),!le.keepDirty&&ir(n.dirtyFields,ye),!le.keepTouched&&ir(n.touchedFields,ye),!le.keepIsValidating&&ir(n.validatingFields,ye),!e.shouldUnregister&&!le.keepDefaultValue&&ir(s,ye);h.state.next({values:Rr(i)}),h.state.next({...n,...le.keepDirty?{isDirty:_()}:{}}),!le.keepIsValid&&v()},Ae=({disabled:Z,name:le})=>{(ra(Z)&&o.mount||Z||a.disabled.has(le))&&(Z?a.disabled.add(le):a.disabled.delete(le))},_e=(Z,le={})=>{let ye=Ye(r,Z);const De=ra(le.disabled)||ra(e.disabled);return cn(r,Z,{...ye||{},_f:{...ye&&ye._f?ye._f:{ref:{name:Z}},name:Z,mount:!0,...le}}),a.mount.add(Z),ye?Ae({disabled:ra(le.disabled)?le.disabled:e.disabled,name:Z}):k(Z,!0,le.value),{...De?{disabled:le.disabled||e.disabled}:{},...e.progressive?{required:!!le.required,min:dm(le.min),max:dm(le.max),minLength:dm(le.minLength),maxLength:dm(le.maxLength),pattern:dm(le.pattern)}:{},name:Z,onChange:K,onBlur:K,ref:Ne=>{if(Ne){_e(Z,le),ye=Ye(r,Z);const Ee=nr(Ne.value)&&Ne.querySelectorAll&&Ne.querySelectorAll("input,select,textarea")[0]||Ne,Ge=J1e(Ee),xt=ye._f.refs||[];if(Ge?xt.find(Ct=>Ct===Ee):Ee===ye._f.ref)return;cn(r,Z,{_f:{...ye._f,...Ge?{refs:[...xt.filter(N2),Ee,...Array.isArray(Ye(s,Z))?[{}]:[]],ref:{type:Ee.type,name:Z}}:{ref:Ee}}}),k(Z,!1,void 0,Ee)}else ye=Ye(r,Z,{}),ye._f&&(ye._f.mount=!1),(e.shouldUnregister||le.shouldUnregister)&&!(q1e(a.array,Z)&&o.action)&&a.unMount.add(Z)}}},je=()=>e.shouldFocusError&&Vm(r,j,a.mount),st=Z=>{ra(Z)&&(h.state.next({disabled:Z}),Vm(r,(le,ye)=>{const De=Ye(r,ye);De&&(le.disabled=De._f.disabled||Z,Array.isArray(De._f.refs)&&De._f.refs.forEach(Ne=>{Ne.disabled=De._f.disabled||Z}))},0,!1))},dt=(Z,le)=>async ye=>{let De;ye&&(ye.preventDefault&&ye.preventDefault(),ye.persist&&ye.persist());let Ne=Rr(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:Ee,values:Ge}=await R();n.errors=Ee,Ne=Rr(Ge)}else await P(r);if(a.disabled.size)for(const Ee of a.disabled)ir(Ne,Ee);if(ir(n.errors,"root"),zs(n.errors)){h.state.next({errors:{}});try{await Z(Ne,ye)}catch(Ee){De=Ee}}else le&&await le({...n.errors},ye),je(),setTimeout(je);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:zs(n.errors)&&!De,submitCount:n.submitCount+1,errors:n.errors}),De)throw De},yt=(Z,le={})=>{Ye(r,Z)&&(nr(le.defaultValue)?L(Z,Rr(Ye(s,Z))):(L(Z,le.defaultValue),cn(s,Z,Rr(le.defaultValue))),le.keepTouched||ir(n.touchedFields,Z),le.keepDirty||(ir(n.dirtyFields,Z),n.isDirty=le.defaultValue?_(Z,Rr(Ye(s,Z))):_()),le.keepError||(ir(n.errors,Z),u.isValid&&v()),h.state.next({...n}))},Mt=(Z,le={})=>{const ye=Z?Rr(Z):s,De=Rr(ye),Ne=zs(Z),Ee=Ne?s:De;if(le.keepDefaultValues||(s=ye),!le.keepValues){if(le.keepDirtyValues){const Ge=new Set([...a.mount,...Object.keys(Af(s,i))]);for(const xt of Array.from(Ge))Ye(n.dirtyFields,xt)?cn(Ee,xt,Ye(i,xt)):L(xt,Ye(Ee,xt))}else{if(E_&&nr(Z))for(const Ge of a.mount){const xt=Ye(r,Ge);if(xt&&xt._f){const Ct=Array.isArray(xt._f.refs)?xt._f.refs[0]:xt._f.ref;if(vx(Ct)){const Zn=Ct.closest("form");if(Zn){Zn.reset();break}}}}if(le.keepFieldsRef)for(const Ge of a.mount)L(Ge,Ye(Ee,Ge));else r={}}i=e.shouldUnregister?le.keepDefaultValues?Rr(s):{}:Rr(Ee),h.array.next({values:{...Ee}}),h.state.next({values:{...Ee}})}a={mount:le.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!le.keepIsValid||!!le.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:le.keepSubmitCount?n.submitCount:0,isDirty:Ne?!1:le.keepDirty?n.isDirty:!!(le.keepDefaultValues&&!sl(Z,s)),isSubmitted:le.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Ne?{}:le.keepDirtyValues?le.keepDefaultValues&&i?Af(s,i):n.dirtyFields:le.keepDefaultValues&&Z?Af(s,Z):le.keepDirty?n.dirtyFields:{},touchedFields:le.keepTouched?n.touchedFields:{},errors:le.keepErrors?n.errors:{},isSubmitSuccessful:le.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},Ft=(Z,le)=>Mt(To(Z)?Z(i):Z,le),Pt=(Z,le={})=>{const ye=Ye(r,Z),De=ye&&ye._f;if(De){const Ne=De.refs?De.refs[0]:De.ref;Ne.focus&&(Ne.focus(),le.shouldSelect&&To(Ne.select)&&Ne.select())}},Xt=Z=>{n={...n,...Z}},ns={control:{register:_e,unregister:we,getFieldState:H,handleSubmit:dt,setError:ce,_subscribe:ge,_runSchema:R,_focusError:je,_getWatch:M,_getDirty:_,_setValid:v,_setFieldArray:w,_setDisabledField:Ae,_setErrors:S,_getFieldArray:G,_reset:Mt,_resetDefaultValues:()=>To(e.defaultValues)&&e.defaultValues().then(Z=>{Ft(Z,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:O,_disableForm:st,_subjects:h,_proxyFormState:u,get _fields(){return r},get _formValues(){return i},get _state(){return o},set _state(Z){o=Z},get _defaultValues(){return s},get _names(){return a},set _names(Z){a=Z},get _formState(){return n},get _options(){return e},set _options(Z){e={...e,...Z}}},subscribe:be,trigger:W,register:_e,handleSubmit:dt,watch:de,setValue:L,getValues:X,reset:Ft,resetField:yt,clearErrors:Y,unregister:we,setError:ce,setFocus:Pt,getFieldState:H};return{...ns,formControl:ns}}function hIe(t={}){const e=tr.useRef(void 0),n=tr.useRef(void 0),[r,s]=tr.useState({isDirty:!1,isValidating:!1,isLoading:To(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:To(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!To(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...a}=fIe(t);e.current={...a,formState:r}}const i=e.current.control;return i._options=t,Y1e(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(a=>({...a,isReady:!0})),i._formState.isReady=!0,o},[i]),tr.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),tr.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode)},[i,t.mode,t.reValidateMode]),tr.useEffect(()=>{t.errors&&(i._setErrors(t.errors),i._focusError())},[i,t.errors]),tr.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),tr.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==r.isDirty&&i._subjects.state.next({isDirty:o})}},[i,r.isDirty]),tr.useEffect(()=>{t.values&&!sl(t.values,n.current)?(i._reset(t.values,{keepFieldsRef:!0,...i._options.resetOptions}),n.current=t.values,s(o=>({...o}))):i._resetDefaultValues()},[i,t.values]),tr.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=Q1e(r,i),e.current}const IM=(t,e,n)=>{if(t&&"reportValidity"in t){const r=Ye(n,e);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},BW=(t,e)=>{for(const n in e.fields){const r=e.fields[n];r&&r.ref&&"reportValidity"in r.ref?IM(r.ref,n,t):r.refs&&r.refs.forEach(s=>IM(s,n,t))}},pIe=(t,e)=>{e.shouldUseNativeValidation&&BW(t,e);const n={};for(const r in t){const s=Ye(e.fields,r),i=Object.assign(t[r]||{},{ref:s&&s.ref});if(mIe(e.names||Object.keys(t),r)){const o=Object.assign({},Ye(n,r));cn(o,"root",i),cn(n,r,o)}else cn(n,r,i)}return n},mIe=(t,e)=>t.some(n=>n.startsWith(e+"."));var gIe=function(t,e){for(var n={};t.length;){var r=t[0],s=r.code,i=r.message,o=r.path.join(".");if(!n[o])if("unionErrors"in r){var a=r.unionErrors[0].errors[0];n[o]={message:a.message,type:a.code}}else n[o]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return t.push(d)})}),e){var c=n[o].types,l=c&&c[r.code];n[o]=$W(o,e,n,s,l?[].concat(l,r.message):r.message)}t.shift()}return n},yIe=function(t,e,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve((function(o,a){try{var c=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(l){return i.shouldUseNativeValidation&&BW({},i),{errors:{},values:n.raw?r:l}})}catch(l){return a(l)}return c&&c.then?c.then(void 0,a):c})(0,function(o){if((function(a){return Array.isArray(a?.errors)})(o))return{values:{},errors:pIe(gIe(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};function vIe({poolSize:t,onDonate:e}){const{wallet:n}=z1(),{toast:r}=Zx(),[s,i]=z.useState(!1),{register:o,handleSubmit:a,setValue:c,formState:{errors:l}}=hIe({resolver:yIe(U1e),defaultValues:{amount:""}}),u=async h=>{if(!n.connected){r({variant:"destructive",title:"Wallet Not Connected",description:"Please connect your wallet first"});return}i(!0);try{await e(h.amount),c("amount",""),r({title:"Donation Successful!",description:`You donated ${h.amount} CELO to the pool`})}catch(m){r({variant:"destructive",title:"Donation Failed",description:m.message||"Failed to process donation"})}finally{i(!1)}},d=()=>{if(n.balance){const h=Math.max(0,parseFloat(n.balance)-.01).toFixed(4);c("amount",h)}};return F.jsxs(ic,{children:[F.jsx(px,{children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{className:"space-y-1",children:[F.jsxs(mx,{className:"flex items-center gap-2",children:[F.jsx(u3,{className:"h-5 w-5 text-primary"}),"Donation Pool"]}),F.jsx(gx,{children:"Support the SmileChain community"})]}),F.jsxs(ed,{variant:"secondary",className:"gap-2 text-lg px-3 py-1.5",children:[F.jsx(s1,{className:"h-4 w-4"}),parseFloat(t).toFixed(2)," CELO"]})]})}),F.jsxs($g,{children:[F.jsxs("form",{onSubmit:a(u),className:"space-y-4",children:[F.jsxs("div",{className:"space-y-2",children:[F.jsx(NW,{htmlFor:"amount",children:"Donation Amount (CELO)"}),F.jsxs("div",{className:"flex gap-2",children:[F.jsx(CW,{id:"amount",type:"number",step:"0.001",placeholder:"0.00",...o("amount"),disabled:!n.connected||s,"data-testid":"input-donation-amount"}),F.jsx(Ro,{type:"button",variant:"outline",onClick:d,disabled:!n.connected||s,"data-testid":"button-max",children:"MAX"})]}),l.amount&&F.jsx("p",{className:"text-sm text-destructive",children:l.amount.message})]}),F.jsxs(Ro,{type:"submit",className:"w-full gap-2",disabled:!n.connected||s,"data-testid":"button-donate",children:[F.jsx(u3,{className:"h-4 w-4"}),s?"Processing...":"Donate to Pool"]}),!n.connected&&F.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Connect your wallet to donate"})]}),F.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg space-y-2",children:[F.jsx("h4",{className:"font-semibold text-sm",children:"How It Works"}),F.jsx("p",{className:"text-xs text-muted-foreground",children:"Donations are pooled and periodically redistributed to the top smile scorers on the leaderboard. The more you donate, the bigger the rewards for winners!"})]})]})]})}function bIe({entries:t,isLoading:e=!1}){const{wallet:n}=z1(),r=o=>{switch(o){case 1:return F.jsx(ku,{className:"h-5 w-5 text-yellow-500"});case 2:return F.jsx(Nte,{className:"h-5 w-5 text-gray-400"});case 3:return F.jsx(xte,{className:"h-5 w-5 text-amber-600"});default:return F.jsxs("span",{className:"text-muted-foreground font-semibold text-sm",children:["#",o]})}},s=o=>`${o.slice(0,6)}...${o.slice(-4)}`,i=o=>n.address?.toLowerCase()===o.toLowerCase();return e?F.jsxs(ic,{children:[F.jsxs(px,{children:[F.jsxs(mx,{className:"flex items-center gap-2",children:[F.jsx(ku,{className:"h-5 w-5 text-primary"}),"Leaderboard"]}),F.jsx(gx,{children:"Top smile scorers"})]}),F.jsx($g,{children:F.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(o=>F.jsx("div",{className:"h-16 bg-muted animate-pulse rounded-lg"},o))})})]}):F.jsxs(ic,{children:[F.jsxs(px,{children:[F.jsxs(mx,{className:"flex items-center gap-2",children:[F.jsx(ku,{className:"h-5 w-5 text-primary"}),"Leaderboard"]}),F.jsxs(gx,{children:["Top ",t.length," smile scorers"]})]}),F.jsx($g,{children:t.length===0?F.jsxs("div",{className:"text-center py-12 space-y-2",children:[F.jsx(ku,{className:"h-12 w-12 mx-auto text-muted-foreground opacity-50"}),F.jsx("p",{className:"text-sm text-muted-foreground",children:"No scores yet"}),F.jsx("p",{className:"text-xs text-muted-foreground",children:"Be the first to earn a spot on the leaderboard!"})]}):F.jsx("div",{className:"space-y-2",children:t.map(o=>F.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-colors ${i(o.address)?"bg-primary/10 border border-primary/20":"bg-card hover-elevate"}`,"data-testid":`leaderboard-entry-${o.rank}`,children:[F.jsx("div",{className:"w-8 flex justify-center",children:r(o.rank)}),F.jsxs("div",{className:"flex-1 min-w-0",children:[F.jsxs("div",{className:"flex items-center gap-2",children:[F.jsx("span",{className:"font-mono text-sm truncate",children:s(o.address)}),i(o.address)&&F.jsx(ed,{variant:"outline",className:"text-xs",children:"You"})]}),F.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[F.jsxs("span",{className:"text-xs text-muted-foreground",children:["Score: ",F.jsx("span",{className:"font-semibold text-foreground",children:o.score})]}),F.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[F.jsx(s1,{className:"h-3 w-3"}),parseFloat(o.tokensEarned).toFixed(2)," CELO"]})]})]}),F.jsx(ed,{variant:"secondary",className:"font-display text-lg px-3 py-1",children:o.score})]},o.address))})})]})}function wIe({totalSmiles:t,averageScore:e,tokensEarned:n,bestScore:r}){const s=[{label:"Total Smiles",value:t,icon:yC,color:"text-primary"},{label:"Average Score",value:e.toFixed(0),icon:Ote,color:"text-accent-foreground"},{label:"Tokens Earned",value:parseFloat(n).toFixed(2),suffix:"CELO",icon:s1,color:"text-chart-2"},{label:"Best Score",value:r,icon:ku,color:"text-chart-1"}];return F.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(i=>{const o=i.icon;return F.jsx(ic,{children:F.jsxs($g,{className:"p-6",children:[F.jsx("div",{className:"flex items-center justify-between mb-2",children:F.jsx(o,{className:`h-5 w-5 ${i.color}`})}),F.jsxs("div",{className:"space-y-1",children:[F.jsxs("div",{className:"text-3xl font-display font-bold","data-testid":`stat-${i.label.toLowerCase().replace(" ","-")}`,children:[i.value,i.suffix&&F.jsx("span",{className:"text-sm ml-1 text-muted-foreground",children:i.suffix})]}),F.jsx("p",{className:"text-xs text-muted-foreground",children:i.label})]})]})},i.label)})})}var xIe=z.createContext(void 0);function MW(t){const e=z.useContext(xIe);return t||e||"ltr"}var _2=0;function IIe(){z.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??SM()),document.body.insertAdjacentElement("beforeend",t[1]??SM()),_2++,()=>{_2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),_2--}},[])}function SM(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var $2="focusScope.autoFocusOnMount",R2="focusScope.autoFocusOnUnmount",kM={bubbles:!1,cancelable:!0},SIe="FocusScope",zW=z.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,c]=z.useState(null),l=Si(s),u=Si(i),d=z.useRef(null),h=Lr(e,v=>c(v)),m=z.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;z.useEffect(()=>{if(r){let v=function(S){if(m.paused||!a)return;const k=S.target;a.contains(k)?d.current=k:nl(d.current,{select:!0})},y=function(S){if(m.paused||!a)return;const k=S.relatedTarget;k!==null&&(a.contains(k)||nl(d.current,{select:!0}))},w=function(S){if(document.activeElement===document.body)for(const E of S)E.removedNodes.length>0&&nl(a)};document.addEventListener("focusin",v),document.addEventListener("focusout",y);const x=new MutationObserver(w);return a&&x.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",y),x.disconnect()}}},[r,a,m.paused]),z.useEffect(()=>{if(a){CM.add(m);const v=document.activeElement;if(!a.contains(v)){const w=new CustomEvent($2,kM);a.addEventListener($2,l),a.dispatchEvent(w),w.defaultPrevented||(kIe(NIe(UW(a)),{select:!0}),document.activeElement===v&&nl(a))}return()=>{a.removeEventListener($2,l),setTimeout(()=>{const w=new CustomEvent(R2,kM);a.addEventListener(R2,u),a.dispatchEvent(w),w.defaultPrevented||nl(v??document.body,{select:!0}),a.removeEventListener(R2,u),CM.remove(m)},0)}}},[a,l,u,m]);const g=z.useCallback(v=>{if(!n&&!r||m.paused)return;const y=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,w=document.activeElement;if(y&&w){const x=v.currentTarget,[S,k]=EIe(x);S&&k?!v.shiftKey&&w===k?(v.preventDefault(),n&&nl(S,{select:!0})):v.shiftKey&&w===S&&(v.preventDefault(),n&&nl(k,{select:!0})):w===x&&v.preventDefault()}},[n,r,m.paused]);return F.jsx(yn.div,{tabIndex:-1,...o,ref:h,onKeyDown:g})});zW.displayName=SIe;function kIe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(nl(r,{select:e}),document.activeElement!==n)return}function EIe(t){const e=UW(t),n=EM(e,t),r=EM(e.reverse(),t);return[n,r]}function UW(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function EM(t,e){for(const n of t)if(!CIe(n,{upTo:e}))return n}function CIe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function TIe(t){return t instanceof HTMLInputElement&&"select"in t}function nl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&TIe(t)&&e&&t.select()}}var CM=AIe();function AIe(){let t=[];return{add(e){const n=t[0];e!==n&&n?.pause(),t=TM(t,e),t.unshift(e)},remove(e){t=TM(t,e),t[0]?.resume()}}}function TM(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function NIe(t){return t.filter(e=>e.tagName!=="A")}var O2="rovingFocusGroup.onEntryFocus",_Ie={bubbles:!1,cancelable:!0},f0="RovingFocusGroup",[_T,VW,$Ie]=UA(f0),[RIe,jW]=Ol(f0,[$Ie]),[OIe,PIe]=RIe(f0),HW=z.forwardRef((t,e)=>F.jsx(_T.Provider,{scope:t.__scopeRovingFocusGroup,children:F.jsx(_T.Slot,{scope:t.__scopeRovingFocusGroup,children:F.jsx(DIe,{...t,ref:e})})}));HW.displayName=f0;var DIe=z.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...d}=t,h=z.useRef(null),m=Lr(e,h),g=MW(i),[v,y]=HA({prop:o,defaultProp:a??null,onChange:c,caller:f0}),[w,x]=z.useState(!1),S=Si(l),k=VW(n),E=z.useRef(!1),[A,R]=z.useState(0);return z.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(O2,S),()=>N.removeEventListener(O2,S)},[S]),F.jsx(OIe,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:v,onItemFocus:z.useCallback(N=>y(N),[y]),onItemShiftTab:z.useCallback(()=>x(!0),[]),onFocusableItemAdd:z.useCallback(()=>R(N=>N+1),[]),onFocusableItemRemove:z.useCallback(()=>R(N=>N-1),[]),children:F.jsx(yn.div,{tabIndex:w||A===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...t.style},onMouseDown:lt(t.onMouseDown,()=>{E.current=!0}),onFocus:lt(t.onFocus,N=>{const P=!E.current;if(N.target===N.currentTarget&&P&&!w){const O=new CustomEvent(O2,_Ie);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const _=k().filter(L=>L.focusable),M=_.find(L=>L.active),G=_.find(L=>L.id===v),D=[M,G,..._].filter(Boolean).map(L=>L.ref.current);qW(D,u)}}E.current=!1}),onBlur:lt(t.onBlur,()=>x(!1))})})}),WW="RovingFocusGroupItem",GW=z.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...a}=t,c=bC(),l=i||c,u=PIe(WW,n),d=u.currentTabStopId===l,h=VW(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:v}=u;return z.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),F.jsx(_T.ItemSlot,{scope:n,id:l,focusable:r,active:s,children:F.jsx(yn.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:lt(t.onMouseDown,y=>{r?u.onItemFocus(l):y.preventDefault()}),onFocus:lt(t.onFocus,()=>u.onItemFocus(l)),onKeyDown:lt(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const w=BIe(y,u.orientation,u.dir);if(w!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let S=h().filter(k=>k.focusable).map(k=>k.ref.current);if(w==="last")S.reverse();else if(w==="prev"||w==="next"){w==="prev"&&S.reverse();const k=S.indexOf(y.currentTarget);S=u.loop?MIe(S,k+1):S.slice(k+1)}setTimeout(()=>qW(S))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:v!=null}):o})})});GW.displayName=WW;var FIe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function LIe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function BIe(t,e,n){const r=LIe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return FIe[r]}function qW(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function MIe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var zIe=HW,UIe=GW,VIe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},gf=new WeakMap,db=new WeakMap,fb={},P2=0,KW=function(t){return t&&(t.host||KW(t.parentNode))},jIe=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=KW(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},HIe=function(t,e,n,r){var s=jIe(e,Array.isArray(t)?t:[t]);fb[n]||(fb[n]=new WeakMap);var i=fb[n],o=[],a=new Set,c=new Set(s),l=function(d){!d||a.has(d)||(a.add(d),l(d.parentNode))};s.forEach(l);var u=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))u(h);else try{var m=h.getAttribute(r),g=m!==null&&m!=="false",v=(gf.get(h)||0)+1,y=(i.get(h)||0)+1;gf.set(h,v),i.set(h,y),o.push(h),v===1&&g&&db.set(h,!0),y===1&&h.setAttribute(n,"true"),g||h.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",h,w)}})};return u(e),a.clear(),P2++,function(){o.forEach(function(d){var h=gf.get(d)-1,m=i.get(d)-1;gf.set(d,h),i.set(d,m),h||(db.has(d)||d.removeAttribute(r),db.delete(d)),m||d.removeAttribute(n)}),P2--,P2||(gf=new WeakMap,gf=new WeakMap,db=new WeakMap,fb={})}},WIe=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=VIe(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),HIe(r,s,n,"aria-hidden")):function(){return null}},fa=function(){return fa=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fa.apply(this,arguments)};function XW(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function GIe(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var jb="right-scroll-bar-position",Hb="width-before-scroll-bar",qIe="with-scroll-bars-hidden",KIe="--removed-body-scroll-bar-size";function D2(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function XIe(t,e){var n=z.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var QIe=typeof window<"u"?z.useLayoutEffect:z.useEffect,AM=new WeakMap;function YIe(t,e){var n=XIe(null,function(r){return t.forEach(function(s){return D2(s,r)})});return QIe(function(){var r=AM.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||D2(a,null)}),i.forEach(function(a){s.has(a)||D2(a,o)})}AM.set(n,t)},[t]),n}function ZIe(t){return t}function JIe(t,e){e===void 0&&(e=ZIe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var c=function(){var u=o;o=[],u.forEach(i)},l=function(){return Promise.resolve().then(c)};l(),n={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),n}}}};return s}function eSe(t){t===void 0&&(t={});var e=JIe(null);return e.options=fa({async:!0,ssr:!1},t),e}var QW=function(t){var e=t.sideCar,n=XW(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return z.createElement(r,fa({},n))};QW.isSideCarExport=!0;function tSe(t,e){return t.useMedium(e),QW}var YW=eSe(),F2=function(){},V1=z.forwardRef(function(t,e){var n=z.useRef(null),r=z.useState({onScrollCapture:F2,onWheelCapture:F2,onTouchMoveCapture:F2}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,c=t.className,l=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,m=t.noRelative,g=t.noIsolation,v=t.inert,y=t.allowPinchZoom,w=t.as,x=w===void 0?"div":w,S=t.gapMode,k=XW(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=h,A=YIe([n,e]),R=fa(fa({},k),s);return z.createElement(z.Fragment,null,u&&z.createElement(E,{sideCar:YW,removeScrollBar:l,shards:d,noRelative:m,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:S}),o?z.cloneElement(z.Children.only(a),fa(fa({},R),{ref:A})):z.createElement(x,fa({},R,{className:c,ref:A}),a))});V1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};V1.classNames={fullWidth:Hb,zeroRight:jb};var nSe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function rSe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=nSe();return e&&t.setAttribute("nonce",e),t}function sSe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function iSe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var oSe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=rSe())&&(sSe(e,n),iSe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},aSe=function(){var t=oSe();return function(e,n){z.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},ZW=function(){var t=aSe(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},cSe={left:0,top:0,right:0,gap:0},L2=function(t){return parseInt(t||"",10)||0},lSe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[L2(n),L2(r),L2(s)]},uSe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return cSe;var e=lSe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},dSe=ZW(),Wf="data-scroll-locked",fSe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(qIe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Wf,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(jb,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Hb,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(jb," .").concat(jb,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Hb," .").concat(Hb,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Wf,`] {
    `).concat(KIe,": ").concat(a,`px;
  }
`)},NM=function(){var t=parseInt(document.body.getAttribute(Wf)||"0",10);return isFinite(t)?t:0},hSe=function(){z.useEffect(function(){return document.body.setAttribute(Wf,(NM()+1).toString()),function(){var t=NM()-1;t<=0?document.body.removeAttribute(Wf):document.body.setAttribute(Wf,t.toString())}},[])},pSe=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;hSe();var i=z.useMemo(function(){return uSe(s)},[s]);return z.createElement(dSe,{styles:fSe(i,!e,s,n?"":"!important")})},$T=!1;if(typeof window<"u")try{var hb=Object.defineProperty({},"passive",{get:function(){return $T=!0,!0}});window.addEventListener("test",hb,hb),window.removeEventListener("test",hb,hb)}catch{$T=!1}var yf=$T?{passive:!1}:!1,mSe=function(t){return t.tagName==="TEXTAREA"},JW=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!mSe(t)&&n[e]==="visible")},gSe=function(t){return JW(t,"overflowY")},ySe=function(t){return JW(t,"overflowX")},_M=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=eG(t,r);if(s){var i=tG(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},vSe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},bSe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},eG=function(t,e){return t==="v"?gSe(e):ySe(e)},tG=function(t,e){return t==="v"?vSe(e):bSe(e)},wSe=function(t,e){return t==="h"&&e==="rtl"?-1:1},xSe=function(t,e,n,r,s){var i=wSe(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,c=e.contains(a),l=!1,u=o>0,d=0,h=0;do{if(!a)break;var m=tG(t,a),g=m[0],v=m[1],y=m[2],w=v-y-i*g;(g||w)&&eG(t,a)&&(d+=w,h+=g);var x=a.parentNode;a=x&&x.nodeType===Node.DOCUMENT_FRAGMENT_NODE?x.host:x}while(!c&&a!==document.body||c&&(e.contains(a)||e===a));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(l=!0),l},pb=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},$M=function(t){return[t.deltaX,t.deltaY]},RM=function(t){return t&&"current"in t?t.current:t},ISe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},SSe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},kSe=0,vf=[];function ESe(t){var e=z.useRef([]),n=z.useRef([0,0]),r=z.useRef(),s=z.useState(kSe++)[0],i=z.useState(ZW)[0],o=z.useRef(t);z.useEffect(function(){o.current=t},[t]),z.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var v=GIe([t.lockRef.current],(t.shards||[]).map(RM),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=z.useCallback(function(v,y){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var w=pb(v),x=n.current,S="deltaX"in v?v.deltaX:x[0]-w[0],k="deltaY"in v?v.deltaY:x[1]-w[1],E,A=v.target,R=Math.abs(S)>Math.abs(k)?"h":"v";if("touches"in v&&R==="h"&&A.type==="range")return!1;var N=_M(R,A);if(!N)return!0;if(N?E=R:(E=R==="v"?"h":"v",N=_M(R,A)),!N)return!1;if(!r.current&&"changedTouches"in v&&(S||k)&&(r.current=E),!E)return!0;var P=r.current||E;return xSe(P,y,v,P==="h"?S:k)},[]),c=z.useCallback(function(v){var y=v;if(!(!vf.length||vf[vf.length-1]!==i)){var w="deltaY"in y?$M(y):pb(y),x=e.current.filter(function(E){return E.name===y.type&&(E.target===y.target||y.target===E.shadowParent)&&ISe(E.delta,w)})[0];if(x&&x.should){y.cancelable&&y.preventDefault();return}if(!x){var S=(o.current.shards||[]).map(RM).filter(Boolean).filter(function(E){return E.contains(y.target)}),k=S.length>0?a(y,S[0]):!o.current.noIsolation;k&&y.cancelable&&y.preventDefault()}}},[]),l=z.useCallback(function(v,y,w,x){var S={name:v,delta:y,target:w,should:x,shadowParent:CSe(w)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(k){return k!==S})},1)},[]),u=z.useCallback(function(v){n.current=pb(v),r.current=void 0},[]),d=z.useCallback(function(v){l(v.type,$M(v),v.target,a(v,t.lockRef.current))},[]),h=z.useCallback(function(v){l(v.type,pb(v),v.target,a(v,t.lockRef.current))},[]);z.useEffect(function(){return vf.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,yf),document.addEventListener("touchmove",c,yf),document.addEventListener("touchstart",u,yf),function(){vf=vf.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,yf),document.removeEventListener("touchmove",c,yf),document.removeEventListener("touchstart",u,yf)}},[]);var m=t.removeScrollBar,g=t.inert;return z.createElement(z.Fragment,null,g?z.createElement(i,{styles:SSe(s)}):null,m?z.createElement(pSe,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function CSe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const TSe=tSe(YW,ESe);var nG=z.forwardRef(function(t,e){return z.createElement(V1,fa({},t,{ref:e,sideCar:TSe}))});nG.classNames=V1.classNames;var RT=["Enter"," "],ASe=["ArrowDown","PageUp","Home"],rG=["ArrowUp","PageDown","End"],NSe=[...ASe,...rG],_Se={ltr:[...RT,"ArrowRight"],rtl:[...RT,"ArrowLeft"]},$Se={ltr:["ArrowLeft"],rtl:["ArrowRight"]},h0="Menu",[Rg,RSe,OSe]=UA(h0),[Sd,sG]=Ol(h0,[OSe,l1,jW]),j1=l1(),iG=jW(),[PSe,kd]=Sd(h0),[DSe,p0]=Sd(h0),oG=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,a=j1(e),[c,l]=z.useState(null),u=z.useRef(!1),d=Si(i),h=MW(s);return z.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),F.jsx(Bre,{...a,children:F.jsx(PSe,{scope:e,open:n,onOpenChange:d,content:c,onContentChange:l,children:F.jsx(DSe,{scope:e,onClose:z.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:o,children:r})})})};oG.displayName=h0;var FSe="MenuAnchor",__=z.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=j1(n);return F.jsx(tV,{...s,...r,ref:e})});__.displayName=FSe;var $_="MenuPortal",[LSe,aG]=Sd($_,{forceMount:void 0}),cG=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=kd($_,e);return F.jsx(LSe,{scope:e,forceMount:n,children:F.jsx(gd,{present:n||i.open,children:F.jsx(jA,{asChild:!0,container:s,children:r})})})};cG.displayName=$_;var eo="MenuContent",[BSe,R_]=Sd(eo),lG=z.forwardRef((t,e)=>{const n=aG(eo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=kd(eo,t.__scopeMenu),o=p0(eo,t.__scopeMenu);return F.jsx(Rg.Provider,{scope:t.__scopeMenu,children:F.jsx(gd,{present:r||i.open,children:F.jsx(Rg.Slot,{scope:t.__scopeMenu,children:o.modal?F.jsx(MSe,{...s,ref:e}):F.jsx(zSe,{...s,ref:e})})})})}),MSe=z.forwardRef((t,e)=>{const n=kd(eo,t.__scopeMenu),r=z.useRef(null),s=Lr(e,r);return z.useEffect(()=>{const i=r.current;if(i)return WIe(i)},[]),F.jsx(O_,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:lt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),zSe=z.forwardRef((t,e)=>{const n=kd(eo,t.__scopeMenu);return F.jsx(O_,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),USe=Gm("MenuContent.ScrollLock"),O_=z.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:g,...v}=t,y=kd(eo,n),w=p0(eo,n),x=j1(n),S=iG(n),k=RSe(n),[E,A]=z.useState(null),R=z.useRef(null),N=Lr(e,R,y.onContentChange),P=z.useRef(0),O=z.useRef(""),_=z.useRef(0),M=z.useRef(null),G=z.useRef("right"),q=z.useRef(0),D=g?nG:z.Fragment,L=g?{as:USe,allowPinchZoom:!0}:void 0,K=W=>{const X=O.current+W,H=k().filter(we=>!we.disabled),Y=document.activeElement,ce=H.find(we=>we.ref.current===Y)?.textValue,de=H.map(we=>we.textValue),ge=JSe(de,X,ce),be=H.find(we=>we.textValue===ge)?.ref.current;(function we(Ae){O.current=Ae,window.clearTimeout(P.current),Ae!==""&&(P.current=window.setTimeout(()=>we(""),1e3))})(X),be&&setTimeout(()=>be.focus())};z.useEffect(()=>()=>window.clearTimeout(P.current),[]),IIe();const j=z.useCallback(W=>G.current===M.current?.side&&tke(W,M.current?.area),[]);return F.jsx(BSe,{scope:n,searchRef:O,onItemEnter:z.useCallback(W=>{j(W)&&W.preventDefault()},[j]),onItemLeave:z.useCallback(W=>{j(W)||(R.current?.focus(),A(null))},[j]),onTriggerLeave:z.useCallback(W=>{j(W)&&W.preventDefault()},[j]),pointerGraceTimerRef:_,onPointerGraceIntentChange:z.useCallback(W=>{M.current=W},[]),children:F.jsx(D,{...L,children:F.jsx(zW,{asChild:!0,trapped:s,onMountAutoFocus:lt(i,W=>{W.preventDefault(),R.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:F.jsx(t1,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:F.jsx(zIe,{asChild:!0,...S,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:A,onEntryFocus:lt(c,W=>{w.isUsingKeyboardRef.current||W.preventDefault()}),preventScrollOnEntryFocus:!0,children:F.jsx(nV,{role:"menu","aria-orientation":"vertical","data-state":EG(y.open),"data-radix-menu-content":"",dir:w.dir,...x,...v,ref:N,style:{outline:"none",...v.style},onKeyDown:lt(v.onKeyDown,W=>{const H=W.target.closest("[data-radix-menu-content]")===W.currentTarget,Y=W.ctrlKey||W.altKey||W.metaKey,ce=W.key.length===1;H&&(W.key==="Tab"&&W.preventDefault(),!Y&&ce&&K(W.key));const de=R.current;if(W.target!==de||!NSe.includes(W.key))return;W.preventDefault();const be=k().filter(we=>!we.disabled).map(we=>we.ref.current);rG.includes(W.key)&&be.reverse(),YSe(be)}),onBlur:lt(t.onBlur,W=>{W.currentTarget.contains(W.target)||(window.clearTimeout(P.current),O.current="")}),onPointerMove:lt(t.onPointerMove,Og(W=>{const X=W.target,H=q.current!==W.clientX;if(W.currentTarget.contains(X)&&H){const Y=W.clientX>q.current?"right":"left";G.current=Y,q.current=W.clientX}}))})})})})})})});lG.displayName=eo;var VSe="MenuGroup",P_=z.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return F.jsx(yn.div,{role:"group",...r,ref:e})});P_.displayName=VSe;var jSe="MenuLabel",uG=z.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return F.jsx(yn.div,{...r,ref:e})});uG.displayName=jSe;var wx="MenuItem",OM="menu.itemSelect",H1=z.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=z.useRef(null),o=p0(wx,t.__scopeMenu),a=R_(wx,t.__scopeMenu),c=Lr(e,i),l=z.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(OM,{bubbles:!0,cancelable:!0});d.addEventListener(OM,m=>r?.(m),{once:!0}),VA(d,h),h.defaultPrevented?l.current=!1:o.onClose()}};return F.jsx(dG,{...s,ref:c,disabled:n,onClick:lt(t.onClick,u),onPointerDown:d=>{t.onPointerDown?.(d),l.current=!0},onPointerUp:lt(t.onPointerUp,d=>{l.current||d.currentTarget?.click()}),onKeyDown:lt(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||RT.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});H1.displayName=wx;var dG=z.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=R_(wx,n),a=iG(n),c=z.useRef(null),l=Lr(e,c),[u,d]=z.useState(!1),[h,m]=z.useState("");return z.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),F.jsx(Rg.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:F.jsx(UIe,{asChild:!0,...a,focusable:!r,children:F.jsx(yn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:l,onPointerMove:lt(t.onPointerMove,Og(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:lt(t.onPointerLeave,Og(g=>o.onItemLeave(g))),onFocus:lt(t.onFocus,()=>d(!0)),onBlur:lt(t.onBlur,()=>d(!1))})})})}),HSe="MenuCheckboxItem",fG=z.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return F.jsx(yG,{scope:t.__scopeMenu,checked:n,children:F.jsx(H1,{role:"menuitemcheckbox","aria-checked":xx(n)?"mixed":n,...s,ref:e,"data-state":F_(n),onSelect:lt(s.onSelect,()=>r?.(xx(n)?!0:!n),{checkForDefaultPrevented:!1})})})});fG.displayName=HSe;var hG="MenuRadioGroup",[WSe,GSe]=Sd(hG,{value:void 0,onValueChange:()=>{}}),pG=z.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Si(r);return F.jsx(WSe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:F.jsx(P_,{...s,ref:e})})});pG.displayName=hG;var mG="MenuRadioItem",gG=z.forwardRef((t,e)=>{const{value:n,...r}=t,s=GSe(mG,t.__scopeMenu),i=n===s.value;return F.jsx(yG,{scope:t.__scopeMenu,checked:i,children:F.jsx(H1,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":F_(i),onSelect:lt(r.onSelect,()=>s.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});gG.displayName=mG;var D_="MenuItemIndicator",[yG,qSe]=Sd(D_,{checked:!1}),vG=z.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=qSe(D_,n);return F.jsx(gd,{present:r||xx(i.checked)||i.checked===!0,children:F.jsx(yn.span,{...s,ref:e,"data-state":F_(i.checked)})})});vG.displayName=D_;var KSe="MenuSeparator",bG=z.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return F.jsx(yn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});bG.displayName=KSe;var XSe="MenuArrow",wG=z.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=j1(n);return F.jsx(rV,{...s,...r,ref:e})});wG.displayName=XSe;var QSe="MenuSub",[uQe,xG]=Sd(QSe),km="MenuSubTrigger",IG=z.forwardRef((t,e)=>{const n=kd(km,t.__scopeMenu),r=p0(km,t.__scopeMenu),s=xG(km,t.__scopeMenu),i=R_(km,t.__scopeMenu),o=z.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:c}=i,l={__scopeMenu:t.__scopeMenu},u=z.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return z.useEffect(()=>u,[u]),z.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),c(null)}},[a,c]),F.jsx(__,{asChild:!0,...l,children:F.jsx(dG,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":EG(n.open),...t,ref:e1(e,s.onTriggerChange),onClick:d=>{t.onClick?.(d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:lt(t.onPointerMove,Og(d=>{i.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:lt(t.onPointerLeave,Og(d=>{u();const h=n.content?.getBoundingClientRect();if(h){const m=n.content?.dataset.side,g=m==="right",v=g?-5:5,y=h[g?"left":"right"],w=h[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:lt(t.onKeyDown,d=>{const h=i.searchRef.current!=="";t.disabled||h&&d.key===" "||_Se[r.dir].includes(d.key)&&(n.onOpenChange(!0),n.content?.focus(),d.preventDefault())})})})});IG.displayName=km;var SG="MenuSubContent",kG=z.forwardRef((t,e)=>{const n=aG(eo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=kd(eo,t.__scopeMenu),o=p0(eo,t.__scopeMenu),a=xG(SG,t.__scopeMenu),c=z.useRef(null),l=Lr(e,c);return F.jsx(Rg.Provider,{scope:t.__scopeMenu,children:F.jsx(gd,{present:r||i.open,children:F.jsx(Rg.Slot,{scope:t.__scopeMenu,children:F.jsx(O_,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:l,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{o.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:lt(t.onFocusOutside,u=>{u.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:lt(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:lt(t.onKeyDown,u=>{const d=u.currentTarget.contains(u.target),h=$Se[o.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),a.trigger?.focus(),u.preventDefault())})})})})})});kG.displayName=SG;function EG(t){return t?"open":"closed"}function xx(t){return t==="indeterminate"}function F_(t){return xx(t)?"indeterminate":t?"checked":"unchecked"}function YSe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function ZSe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function JSe(t,e,n){const s=e.length>1&&Array.from(e).every(l=>l===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=ZSe(t,Math.max(i,0));s.length===1&&(o=o.filter(l=>l!==n));const c=o.find(l=>l.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function eke(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],c=e[o],l=a.x,u=a.y,d=c.x,h=c.y;u>r!=h>r&&n<(d-l)*(r-u)/(h-u)+l&&(s=!s)}return s}function tke(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return eke(n,e)}function Og(t){return e=>e.pointerType==="mouse"?t(e):void 0}var nke=oG,rke=__,ske=cG,ike=lG,oke=P_,ake=uG,cke=H1,lke=fG,uke=pG,dke=gG,fke=vG,hke=bG,pke=wG,mke=IG,gke=kG,W1="DropdownMenu",[yke]=Ol(W1,[sG]),_s=sG(),[vke,CG]=yke(W1),TG=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,c=_s(e),l=z.useRef(null),[u,d]=HA({prop:s,defaultProp:i??!1,onChange:o,caller:W1});return F.jsx(vke,{scope:e,triggerId:bC(),triggerRef:l,contentId:bC(),open:u,onOpenChange:d,onOpenToggle:z.useCallback(()=>d(h=>!h),[d]),modal:a,children:F.jsx(nke,{...c,open:u,onOpenChange:d,dir:r,modal:a,children:n})})};TG.displayName=W1;var AG="DropdownMenuTrigger",NG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=CG(AG,n),o=_s(n);return F.jsx(rke,{asChild:!0,...o,children:F.jsx(yn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:e1(e,i.triggerRef),onPointerDown:lt(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:lt(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});NG.displayName=AG;var bke="DropdownMenuPortal",_G=t=>{const{__scopeDropdownMenu:e,...n}=t,r=_s(e);return F.jsx(ske,{...r,...n})};_G.displayName=bke;var $G="DropdownMenuContent",RG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=CG($G,n),i=_s(n),o=z.useRef(!1);return F.jsx(ike,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:lt(t.onCloseAutoFocus,a=>{o.current||s.triggerRef.current?.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:lt(t.onInteractOutside,a=>{const c=a.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0,u=c.button===2||l;(!s.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});RG.displayName=$G;var wke="DropdownMenuGroup",xke=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(oke,{...s,...r,ref:e})});xke.displayName=wke;var Ike="DropdownMenuLabel",OG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(ake,{...s,...r,ref:e})});OG.displayName=Ike;var Ske="DropdownMenuItem",PG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(cke,{...s,...r,ref:e})});PG.displayName=Ske;var kke="DropdownMenuCheckboxItem",DG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(lke,{...s,...r,ref:e})});DG.displayName=kke;var Eke="DropdownMenuRadioGroup",Cke=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(uke,{...s,...r,ref:e})});Cke.displayName=Eke;var Tke="DropdownMenuRadioItem",FG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(dke,{...s,...r,ref:e})});FG.displayName=Tke;var Ake="DropdownMenuItemIndicator",LG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(fke,{...s,...r,ref:e})});LG.displayName=Ake;var Nke="DropdownMenuSeparator",BG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(hke,{...s,...r,ref:e})});BG.displayName=Nke;var _ke="DropdownMenuArrow",$ke=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(pke,{...s,...r,ref:e})});$ke.displayName=_ke;var Rke="DropdownMenuSubTrigger",MG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(mke,{...s,...r,ref:e})});MG.displayName=Rke;var Oke="DropdownMenuSubContent",zG=z.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=_s(n);return F.jsx(gke,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zG.displayName=Oke;var Pke=TG,Dke=NG,Fke=_G,UG=RG,VG=OG,jG=PG,HG=DG,WG=FG,GG=LG,qG=BG,KG=MG,XG=zG;const Lke=Pke,Bke=Dke,Mke=z.forwardRef(({className:t,inset:e,children:n,...r},s)=>F.jsxs(KG,{ref:s,className:sn("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,F.jsx(Ste,{className:"ml-auto"})]}));Mke.displayName=KG.displayName;const zke=z.forwardRef(({className:t,...e},n)=>F.jsx(XG,{ref:n,className:sn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));zke.displayName=XG.displayName;const QG=z.forwardRef(({className:t,sideOffset:e=4,...n},r)=>F.jsx(Fke,{children:F.jsx(UG,{ref:r,sideOffset:e,className:sn("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));QG.displayName=UG.displayName;const YG=z.forwardRef(({className:t,inset:e,...n},r)=>F.jsx(jG,{ref:r,className:sn("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...n}));YG.displayName=jG.displayName;const Uke=z.forwardRef(({className:t,children:e,checked:n,...r},s)=>F.jsxs(HG,{ref:s,className:sn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[F.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:F.jsx(GG,{children:F.jsx(Ite,{className:"h-4 w-4"})})}),e]}));Uke.displayName=HG.displayName;const Vke=z.forwardRef(({className:t,children:e,...n},r)=>F.jsxs(WG,{ref:r,className:sn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[F.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:F.jsx(GG,{children:F.jsx(Cte,{className:"h-2 w-2 fill-current"})})}),e]}));Vke.displayName=WG.displayName;const ZG=z.forwardRef(({className:t,inset:e,...n},r)=>F.jsx(VG,{ref:r,className:sn("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));ZG.displayName=VG.displayName;const OT=z.forwardRef(({className:t,...e},n)=>F.jsx(qG,{ref:n,className:sn("-mx-1 my-1 h-px bg-muted",t),...e}));OT.displayName=qG.displayName;function jke(){const{wallet:t,connect:e,disconnect:n}=z1(),[r,s]=z.useState(!1),{toast:i}=Zx(),o=async()=>{s(!0);try{await e(),i({title:"Wallet Connected",description:"Successfully connected to Celo Alfajores"})}catch(c){i({variant:"destructive",title:"Connection Failed",description:c.message||"Failed to connect wallet"})}finally{s(!1)}},a=c=>`${c.slice(0,6)}...${c.slice(-4)}`;return t.connected?F.jsxs(Lke,{children:[F.jsx(Bke,{asChild:!0,children:F.jsxs(Ro,{variant:"outline",className:"gap-2","data-testid":"button-wallet-menu",children:[F.jsx(d3,{className:"h-4 w-4"}),F.jsx("span",{className:"hidden sm:inline",children:a(t.address)}),F.jsxs(ed,{variant:"secondary",className:"ml-2",children:[parseFloat(t.balance).toFixed(2)," CELO"]})]})}),F.jsxs(QG,{align:"end",className:"w-64",children:[F.jsx(ZG,{children:"Wallet Info"}),F.jsx(OT,{}),F.jsxs("div",{className:"px-2 py-2 space-y-2",children:[F.jsxs("div",{className:"flex justify-between items-center text-sm",children:[F.jsx("span",{className:"text-muted-foreground",children:"Address"}),F.jsx("span",{className:"font-mono text-xs",children:a(t.address)})]}),F.jsxs("div",{className:"flex justify-between items-center text-sm",children:[F.jsx("span",{className:"text-muted-foreground",children:"Network"}),F.jsx(ed,{variant:"outline",className:"gap-1",children:t.network==="Celo Alfajores"?F.jsxs(F.Fragment,{children:["✓ ",t.network]}):F.jsxs(F.Fragment,{children:[F.jsx(IU,{className:"h-3 w-3"}),t.network]})})]}),F.jsxs("div",{className:"flex justify-between items-center text-sm",children:[F.jsx("span",{className:"text-muted-foreground",children:"Balance"}),F.jsxs("span",{className:"font-semibold",children:[parseFloat(t.balance).toFixed(4)," CELO"]})]})]}),F.jsx(OT,{}),F.jsxs(YG,{onClick:n,className:"gap-2 text-destructive","data-testid":"button-disconnect",children:[F.jsx(Ate,{className:"h-4 w-4"}),"Disconnect"]})]})]}):F.jsxs(Ro,{onClick:o,disabled:r,size:"default",className:"gap-2","data-testid":"button-connect-wallet",children:[F.jsx(d3,{className:"h-4 w-4"}),r?"Connecting...":"Connect Wallet"]})}const Hke=Zg("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),JG=z.forwardRef(({className:t,variant:e,...n},r)=>F.jsx("div",{ref:r,role:"alert",className:sn(Hke({variant:e}),t),...n}));JG.displayName="Alert";const e8=z.forwardRef(({className:t,...e},n)=>F.jsx("h5",{ref:n,className:sn("mb-1 font-medium leading-none tracking-tight",t),...e}));e8.displayName="AlertTitle";const t8=z.forwardRef(({className:t,...e},n)=>F.jsx("div",{ref:n,className:sn("text-sm [&_p]:leading-relaxed",t),...e}));t8.displayName="AlertDescription";function Wke(){return F.jsxs(JG,{variant:"destructive",className:"mb-6",children:[F.jsx(IU,{className:"h-5 w-5"}),F.jsx(e8,{className:"font-semibold text-lg",children:"Smart Contract Not Deployed"}),F.jsxs(t8,{className:"mt-2 space-y-3",children:[F.jsx("p",{className:"text-sm",children:"The SmileChain smart contract needs to be deployed to Celo Alfajores testnet before you can earn rewards. All blockchain features (scoring, donations, leaderboard) will be unavailable until deployment."}),F.jsxs("div",{className:"flex gap-3 flex-wrap",children:[F.jsxs(Ro,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>window.open("https://github.com/yourusername/smilechain/blob/main/DEPLOYMENT_GUIDE.md","_blank"),"data-testid":"link-deployment-guide",children:[F.jsx(l3,{className:"h-4 w-4"}),"View Deployment Guide"]}),F.jsxs(Ro,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>window.open("https://faucet.celo.org/alfajores","_blank"),"data-testid":"link-celo-faucet",children:[F.jsx(l3,{className:"h-4 w-4"}),"Get Test CELO"]})]}),F.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:[F.jsx("strong",{children:"Note:"})," You can still test the camera and smile detection features without deployment."]})]})]})}let Ca=null,Ii=null;function Gke(){throw new Error("Smart contract not deployed yet. Please deploy SmileChain.sol to Celo Alfajores testnet and update the contract address in client/src/lib/web3.ts. See DEPLOYMENT_GUIDE.md for instructions.")}function m0(){if(Gke(),!window.ethereum)throw new Error("Ethereum provider not found. Please install MetaMask or a compatible Web3 wallet.");return Ca=new Id(window.ethereum),Ii=new Ca.eth.Contract(k1e,w1e),Ii}async function qke(t,e){return Ii||m0(),(await Ii.methods.submitScore(e).send({from:t,gas:3e5})).transactionHash}async function Kke(t,e){if(Ii||m0(),!Ca)throw new Error("Web3 not initialized");const n=Ca.utils.toWei(e,"ether");return(await Ii.methods.donate().send({from:t,value:n,gas:1e5})).transactionHash}async function Xke(){if(Ii||m0(),!Ca)throw new Error("Web3 not initialized");const t=await Ii.methods.getLeaderboard().call(),e=t[0],n=t[1],r=[];for(let s=0;s<e.length;s++){const i=await Ii.methods.getUserInfo(e[s]).call();r.push({address:e[s],score:Number(n[s]),tokensEarned:Ca.utils.fromWei(i.totalRewards.toString(),"ether"),rank:s+1})}return r}async function Qke(){if(Ii||m0(),!Ca)throw new Error("Web3 not initialized");const t=await Ii.methods.donationPool().call();return Ca.utils.fromWei(t.toString(),"ether")}async function Yke(t){if(Ii||m0(),!Ca)throw new Error("Web3 not initialized");const e=await Ii.methods.getUserInfo(t).call();return{bestScore:Number(e.bestScore),totalRewards:Ca.utils.fromWei(e.totalRewards.toString(),"ether"),lastClaimTime:Number(e.lastClaimTime)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zke=1e-7,Jke=1e-4;class n8{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class L_{refCount(e){return Bs("refCount")}incRef(e){return Bs("incRef")}timerAvailable(){return!0}time(e){return Bs("time")}read(e){return Bs("read")}readSync(e){return Bs("readSync")}readToGPU(e,n){return Bs("readToGPU")}numDataIds(){return Bs("numDataIds")}disposeData(e,n){return Bs("disposeData")}write(e,n,r){return Bs("write")}move(e,n,r,s,i){return Bs("move")}createTensorFromGPUData(e,n,r){return Bs("createTensorFromGPUData")}memory(){return Bs("memory")}floatPrecision(){return Bs("floatPrecision")}epsilon(){return this.floatPrecision()===32?Zke:Jke}dispose(){return Bs("dispose")}}function Bs(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eEe(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Nf(t,e,n)}function td(t,e,n){return Math.max(t,Math.min(e,n))}function B_(t){return t%2===0?t:t+1}function Nf(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function tEe(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function U(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function ci(t,e,n=""){U(Dt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Gh(t){U(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function me(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function nEe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Dt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function bh(t){return t%1===0}function PT(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Gf(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function PM(t,e=s=>0,n,r){return new Promise((s,i)=>{let o=0;const a=()=>{if(t()){s();return}o++;const c=e(o);if(n!=null&&o>=n){i();return}r!=null?r(a,c):setTimeout(a,c)};a()})}function r8(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Nt(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),U(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),U(t.every(r=>bh(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Ll(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Nt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Mr(t,e){return qn(t,e)}function qn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function rEe(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function sEe(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function s8(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Ix(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function iEe(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function g0(t){return typeof t=="string"||t instanceof String}function oEe(t){return typeof t=="boolean"}function DT(t){return typeof t=="number"}function qh(t){return Array.isArray(t)?qh(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":DT(t)?"float32":g0(t)?"string":oEe(t)?"bool":"float32"}function FT(t){return!!(t&&t.constructor&&t.call&&t.apply)}function LT(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function nt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function i8(t,e,n,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)s[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((c,l)=>c*l)*(r?2:1);for(let c=0;c<i;c++)s[c]=i8(t+c*a,o,n,r)}return s}function to(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,i)=>s*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return i8(0,t,e,n)}function aEe(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function M_(t,e){const n=Jr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Jr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function o8(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return to(t,new Float32Array(n));if(e==="int32")return to(t,new Int32Array(n));if(e==="bool")return to(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Ni(t){t.forEach(e=>{U(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function va(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function Kh(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function nd(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DM="tfjsflags";class cEe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=lEe,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(fe().getBool("IS_TEST")||fe().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];fe().getBool("IS_TEST")||fe().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(nd(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);DM in e&&e[DM].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=dEe(s,i)})}}function lEe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(uEe(e,r[0],r[1]),r.join("="))),e}function uEe(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function dEe(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function fe(){return a8}let a8=null;function fEe(t){a8=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let B2;function c8(){if(B2==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");B2=t}return B2}function hEe(){const t=c8();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function z_(t,e){const n=hEe();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const G1="Abs",y0="Acos",v0="Acosh",Xh="Add",q1="AddN",U_="All",V_="Any",K1="ArgMax",X1="ArgMin",b0="Asin",w0="Asinh",x0="Atan",I0="Atanh",S0="Atan2",Q1="AvgPool",j_="AvgPoolGrad",Y1="AvgPool3D",H_="AvgPool3DGrad",Z1="BatchMatMul",J1="BatchToSpaceND",W_="Bincount",eI="BitwiseAnd",pEe="BroadcastTo",G_="BroadcastArgs",k0="Cast",E0="Ceil",C0="ClipByValue",q_="Complex",tI="ComplexAbs",nI="Concat",rI="Conv2D",K_="Conv2DBackpropFilter",sI="Conv2DBackpropInput",iI="Conv3D",X_="Conv3DBackpropFilterV2",Q_="Conv3DBackpropInputV2",T0="Cos",A0="Cosh",Y_="Cumprod",oI="Cumsum",Z_="CropAndResize",J_="DenseBincount",e$="DepthToSpace",aI="DepthwiseConv2dNative",t$="DepthwiseConv2dNativeBackpropFilter",n$="DepthwiseConv2dNativeBackpropInput",r$="Diag",cI="Dilation2D",BT="Dilation2DBackpropInput",MT="Dilation2DBackpropFilter",mEe="Draw",N0="RealDiv",s$="Einsum",_0="Elu",i$="EluGrad",$0="Erf",lI="Equal",R0="Exp",uI="ExpandDims",O0="Expm1",o$="FFT",a$="Fill",c$="FlipLeftRight",P0="Floor",D0="FloorDiv",dI="FusedBatchNorm",fI="GatherV2",l$="GatherNd",hI="Greater",F0="GreaterEqual",L0="Identity",u$="IFFT",d$="Imag",B0="IsFinite",M0="IsInf",z0="IsNan",pI="LeakyRelu",mI="Less",gI="LessEqual",f$="LinSpace",U0="Log",V0="Log1p",yI="LogicalAnd",vI="LogicalNot",bI="LogicalOr",gEe="LogSoftmax",wI="LRN",h$="LRNGrad",xI="Max",j0="Maximum",II="MaxPool",p$="MaxPoolGrad",SI="MaxPool3D",m$="MaxPool3DGrad",g$="MaxPoolWithArgmax",kI="Mean",EI="Min",H0="Minimum",CI="MirrorPad",W0="Mod",y$="Multinomial",G0="Multiply",TI="Neg",AI="NotEqual",v$="NonMaxSuppressionV3",b$="NonMaxSuppressionV4",w$="NonMaxSuppressionV5",NI="OnesLike",_I="OneHot",$I="Pack",RI="PadV2",q0="Pow",OI="Prelu",PI="Prod",x$="RaggedGather",I$="RaggedRange",S$="RaggedTensorToTensor",k$="Range",E$="Real",K0="Reciprocal",X0="Relu",DI="Reshape",FI="ResizeNearestNeighbor",C$="ResizeNearestNeighborGrad",LI="ResizeBilinear",T$="ResizeBilinearGrad",Q0="Relu6",BI="Reverse",Y0="Round",Z0="Rsqrt",A$="ScatterNd",N$="TensorScatterUpdate",_$="SearchSorted",MI="Select",J0="Selu",zI="Slice",ey="Sin",ty="Sinh",ny="Sign",ry="Sigmoid",sy="Softplus",iy="Sqrt",UI="Sum",VI="SpaceToBatchND",jI="SplitV",HI="Softmax",$$="SparseFillEmptyRows",R$="SparseReshape",O$="SparseSegmentMean",P$="SparseSegmentSum",D$="SparseToDense",oy="SquaredDifference",F$="Square",WI="StaticRegexReplace",L$="StridedSlice",B$="StringNGrams",M$="StringSplit",z$="StringToHashBucketFast",ay="Sub",cy="Tan",ly="Tanh",uy="Tile",U$="TopK",V$="Transform",qf="Transpose",j$="Unique",GI="Unpack",qI="UnsortedSegmentSum",KI="ZerosLike",dy="Step",zT="FromPixels",H$="RotateWithOffset",Sx="_FusedMatMul",kx="FusedConv2D",Ex="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gi(...t){fe().getBool("IS_TEST")||fe().getBool("PROD")||console.warn(...t)}function yEe(...t){fe().getBool("IS_TEST")||fe().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cx=z_("kernelRegistry",()=>new Map),UT=z_("gradRegistry",()=>new Map);function VT(t,e){const n=u8(t,e);return Cx.get(n)}function FM(t){return UT.get(t)}function LM(t){const e=Cx.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,o]=s,[a]=i.split("_");a===t&&n.push(o)}return n}function l8(t){const{kernelName:e,backendName:n}=t,r=u8(e,n);Cx.has(r)&&gi(`The kernel '${e}' for backend '${n}' is already registered`),Cx.set(r,t)}function vEe(t){const{kernelName:e}=t;UT.has(e)&&fe().getBool("DEBUG")&&gi(`Overriding the gradient for '${e}'`),UT.set(e,t)}function u8(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var M2,BM;function bEe(){if(BM)return M2;BM=1,M2=e;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(O,_,M){this.low=O|0,this.high=_|0,this.unsigned=!!M}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function n(O){return(O&&O.__isLong__)===!0}e.isLong=n;var r={},s={};function i(O,_){var M,G,q;return _?(O>>>=0,(q=0<=O&&O<256)&&(G=s[O],G)?G:(M=a(O,(O|0)<0?-1:0,!0),q&&(s[O]=M),M)):(O|=0,(q=-128<=O&&O<128)&&(G=r[O],G)?G:(M=a(O,O<0?-1:0,!1),q&&(r[O]=M),M))}e.fromInt=i;function o(O,_){if(isNaN(O))return _?x:w;if(_){if(O<0)return x;if(O>=g)return R}else{if(O<=-v)return N;if(O+1>=v)return A}return O<0?o(-O,_).neg():a(O%m|0,O/m|0,_)}e.fromNumber=o;function a(O,_,M){return new e(O,_,M)}e.fromBits=a;var c=Math.pow;function l(O,_,M){if(O.length===0)throw Error("empty string");if(O==="NaN"||O==="Infinity"||O==="+Infinity"||O==="-Infinity")return w;if(typeof _=="number"?(M=_,_=!1):_=!!_,M=M||10,M<2||36<M)throw RangeError("radix");var G;if((G=O.indexOf("-"))>0)throw Error("interior hyphen");if(G===0)return l(O.substring(1),_,M).neg();for(var q=o(c(M,8)),D=w,L=0;L<O.length;L+=8){var K=Math.min(8,O.length-L),j=parseInt(O.substring(L,L+K),M);if(K<8){var W=o(c(M,K));D=D.mul(W).add(o(j))}else D=D.mul(q),D=D.add(o(j))}return D.unsigned=_,D}e.fromString=l;function u(O,_){return typeof O=="number"?o(O,_):typeof O=="string"?l(O,_):a(O.low,O.high,typeof _=="boolean"?_:O.unsigned)}e.fromValue=u;var d=65536,h=1<<24,m=d*d,g=m*m,v=g/2,y=i(h),w=i(0);e.ZERO=w;var x=i(0,!0);e.UZERO=x;var S=i(1);e.ONE=S;var k=i(1,!0);e.UONE=k;var E=i(-1);e.NEG_ONE=E;var A=a(-1,2147483647,!1);e.MAX_VALUE=A;var R=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=R;var N=a(0,-2147483648,!1);e.MIN_VALUE=N;var P=e.prototype;return P.toInt=function(){return this.unsigned?this.low>>>0:this.low},P.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},P.toString=function(_){if(_=_||10,_<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(N)){var M=o(_),G=this.div(M),q=G.mul(M).sub(this);return G.toString(_)+q.toInt().toString(_)}else return"-"+this.neg().toString(_);for(var D=o(c(_,6),this.unsigned),L=this,K="";;){var j=L.div(D),W=L.sub(j.mul(D)).toInt()>>>0,X=W.toString(_);if(L=j,L.isZero())return X+K;for(;X.length<6;)X="0"+X;K=""+X+K}},P.getHighBits=function(){return this.high},P.getHighBitsUnsigned=function(){return this.high>>>0},P.getLowBits=function(){return this.low},P.getLowBitsUnsigned=function(){return this.low>>>0},P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,M=31;M>0&&(_&1<<M)==0;M--);return this.high!=0?M+33:M+1},P.isZero=function(){return this.high===0&&this.low===0},P.eqz=P.isZero,P.isNegative=function(){return!this.unsigned&&this.high<0},P.isPositive=function(){return this.unsigned||this.high>=0},P.isOdd=function(){return(this.low&1)===1},P.isEven=function(){return(this.low&1)===0},P.equals=function(_){return n(_)||(_=u(_)),this.unsigned!==_.unsigned&&this.high>>>31===1&&_.high>>>31===1?!1:this.high===_.high&&this.low===_.low},P.eq=P.equals,P.notEquals=function(_){return!this.eq(_)},P.neq=P.notEquals,P.ne=P.notEquals,P.lessThan=function(_){return this.comp(_)<0},P.lt=P.lessThan,P.lessThanOrEqual=function(_){return this.comp(_)<=0},P.lte=P.lessThanOrEqual,P.le=P.lessThanOrEqual,P.greaterThan=function(_){return this.comp(_)>0},P.gt=P.greaterThan,P.greaterThanOrEqual=function(_){return this.comp(_)>=0},P.gte=P.greaterThanOrEqual,P.ge=P.greaterThanOrEqual,P.compare=function(_){if(n(_)||(_=u(_)),this.eq(_))return 0;var M=this.isNegative(),G=_.isNegative();return M&&!G?-1:!M&&G?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},P.comp=P.compare,P.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(S)},P.neg=P.negate,P.add=function(_){n(_)||(_=u(_));var M=this.high>>>16,G=this.high&65535,q=this.low>>>16,D=this.low&65535,L=_.high>>>16,K=_.high&65535,j=_.low>>>16,W=_.low&65535,X=0,H=0,Y=0,ce=0;return ce+=D+W,Y+=ce>>>16,ce&=65535,Y+=q+j,H+=Y>>>16,Y&=65535,H+=G+K,X+=H>>>16,H&=65535,X+=M+L,X&=65535,a(Y<<16|ce,X<<16|H,this.unsigned)},P.subtract=function(_){return n(_)||(_=u(_)),this.add(_.neg())},P.sub=P.subtract,P.multiply=function(_){if(this.isZero())return w;if(n(_)||(_=u(_)),t){var M=t.mul(this.low,this.high,_.low,_.high);return a(M,t.get_high(),this.unsigned)}if(_.isZero())return w;if(this.eq(N))return _.isOdd()?N:w;if(_.eq(N))return this.isOdd()?N:w;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(y)&&_.lt(y))return o(this.toNumber()*_.toNumber(),this.unsigned);var G=this.high>>>16,q=this.high&65535,D=this.low>>>16,L=this.low&65535,K=_.high>>>16,j=_.high&65535,W=_.low>>>16,X=_.low&65535,H=0,Y=0,ce=0,de=0;return de+=L*X,ce+=de>>>16,de&=65535,ce+=D*X,Y+=ce>>>16,ce&=65535,ce+=L*W,Y+=ce>>>16,ce&=65535,Y+=q*X,H+=Y>>>16,Y&=65535,Y+=D*W,H+=Y>>>16,Y&=65535,Y+=L*j,H+=Y>>>16,Y&=65535,H+=G*X+q*W+D*j+L*K,H&=65535,a(ce<<16|de,H<<16|Y,this.unsigned)},P.mul=P.multiply,P.divide=function(_){if(n(_)||(_=u(_)),_.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&_.low===-1&&_.high===-1)return this;var M=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,_.low,_.high);return a(M,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:w;var G,q,D;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return x;if(_.gt(this.shru(1)))return k;D=x}else{if(this.eq(N)){if(_.eq(S)||_.eq(E))return N;if(_.eq(N))return S;var L=this.shr(1);return G=L.div(_).shl(1),G.eq(w)?_.isNegative()?S:E:(q=this.sub(_.mul(G)),D=G.add(q.div(_)),D)}else if(_.eq(N))return this.unsigned?x:w;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();D=w}for(q=this;q.gte(_);){G=Math.max(1,Math.floor(q.toNumber()/_.toNumber()));for(var K=Math.ceil(Math.log(G)/Math.LN2),j=K<=48?1:c(2,K-48),W=o(G),X=W.mul(_);X.isNegative()||X.gt(q);)G-=j,W=o(G,this.unsigned),X=W.mul(_);W.isZero()&&(W=S),D=D.add(W),q=q.sub(X)}return D},P.div=P.divide,P.modulo=function(_){if(n(_)||(_=u(_)),t){var M=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,_.low,_.high);return a(M,t.get_high(),this.unsigned)}return this.sub(this.div(_).mul(_))},P.mod=P.modulo,P.rem=P.modulo,P.not=function(){return a(~this.low,~this.high,this.unsigned)},P.and=function(_){return n(_)||(_=u(_)),a(this.low&_.low,this.high&_.high,this.unsigned)},P.or=function(_){return n(_)||(_=u(_)),a(this.low|_.low,this.high|_.high,this.unsigned)},P.xor=function(_){return n(_)||(_=u(_)),a(this.low^_.low,this.high^_.high,this.unsigned)},P.shiftLeft=function(_){return n(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?a(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):a(0,this.low<<_-32,this.unsigned)},P.shl=P.shiftLeft,P.shiftRight=function(_){return n(_)&&(_=_.toInt()),(_&=63)===0?this:_<32?a(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):a(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},P.shr=P.shiftRight,P.shiftRightUnsigned=function(_){if(n(_)&&(_=_.toInt()),_&=63,_===0)return this;var M=this.high;if(_<32){var G=this.low;return a(G>>>_|M<<32-_,M>>>_,this.unsigned)}else return _===32?a(M,0,this.unsigned):a(M>>>_-32,0,this.unsigned)},P.shru=P.shiftRightUnsigned,P.shr_u=P.shiftRightUnsigned,P.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},P.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},P.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},P.toBytesLE=function(){var _=this.high,M=this.low;return[M&255,M>>>8&255,M>>>16&255,M>>>24,_&255,_>>>8&255,_>>>16&255,_>>>24]},P.toBytesBE=function(){var _=this.high,M=this.low;return[_>>>24,_>>>16&255,_>>>8&255,_&255,M>>>24,M>>>16&255,M>>>8&255,M&255]},e.fromBytes=function(_,M,G){return G?e.fromBytesLE(_,M):e.fromBytesBE(_,M)},e.fromBytesLE=function(_,M){return new e(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,M)},e.fromBytesBE=function(_,M){return new e(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],M)},M2}var f8=bEe();const h8=Wo(f8),wEe=_z({__proto__:null,default:h8},[f8]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bu=h8||wEe;function XI(t){return bu.fromString(t,!0,16)}const p8=XI("c3a5c85c97cb3127"),mu=XI("b492b66fbe98f273"),us=XI("9ae16a3b2f90404f");function jT(t){return t.xor(t.shru(47))}function m8(t,e,n){const r=t.slice(e,e+n);return bu.fromBytes(Array.from(r),!0,!0)}function ln(t,e){return m8(t,e,8)}function MM(t,e){return m8(t,e,4)}function wr(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function ul(t,e,n=XI("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function xEe(t,e,n,r,s,i){s=s.add(t),i=wr(i.add(s).add(r),21);const o=s;return s=s.add(e),s=s.add(n),i=i.add(wr(s,44)),[s.add(r),i.add(o)]}function mb(t,e,n,r){return xEe(ln(t,e),ln(t,e+8),ln(t,e+16),ln(t,e+24),n,r)}function IEe(t,e=t.length){if(e>=8){const n=us.add(e*2),r=ln(t,0).add(us),s=ln(t,e-8),i=wr(s,37).mul(n).add(r),o=wr(r,25).add(s).mul(n);return ul(i,o,n)}if(e>=4){const n=us.add(e*2),r=MM(t,0);return ul(r.shl(3).add(e),MM(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],i=n+(r<<8),o=e+(s<<2);return jT(us.mul(i).xor(p8.mul(o))).mul(us)}return us}function SEe(t,e=t.length){const n=us.add(e*2),r=ln(t,0).mul(mu),s=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(us);return ul(wr(r.add(s),43).add(wr(i,30)).add(o),r.add(wr(s.add(us),18)).add(i),n)}function kEe(t,e=t.length){const n=us.add(e*2),r=ln(t,0).mul(us),s=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(us),a=wr(r.add(s),43).add(wr(i,30)).add(o),c=ul(a,r.add(wr(s.add(us),18)).add(i),n),l=ln(t,16).mul(n),u=ln(t,24),d=a.add(ln(t,e-32)).mul(n),h=c.add(ln(t,e-24)).mul(n);return ul(wr(l.add(u),43).add(wr(d,30)).add(h),l.add(wr(u.add(r),18)).add(d),n)}function EEe(t,e=t.length){const n=bu.fromNumber(81,!0);if(e<=32)return e<=16?IEe(t,e):SEe(t,e);if(e<=64)return kEe(t,e);let r=n,s=n.mul(mu).add(113),i=jT(s.mul(us).add(113)).mul(us),o=[bu.UZERO,bu.UZERO],a=[bu.UZERO,bu.UZERO];r=r.mul(us).add(ln(t,0));let c=0;const l=(e-1>>6)*64,u=l+(e-1&63)-63;do r=wr(r.add(s).add(o[0]).add(ln(t,c+8)),37).mul(mu),s=wr(s.add(o[1]).add(ln(t,c+48)),42).mul(mu),r=r.xor(a[1]),s=s.add(o[0]).add(ln(t,c+40)),i=wr(i.add(a[0]),33).mul(mu),o=mb(t,c,o[1].mul(mu),r.add(a[0])),a=mb(t,c+32,i.add(a[1]),s.add(ln(t,c+16))),[i,r]=[r,i],c+=64;while(c!==l);const d=mu.add(i.and(255).shl(1));return c=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=wr(r.add(s).add(o[0]).add(ln(t,c+8)),37).mul(d),s=wr(s.add(o[1]).add(ln(t,c+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(o[0].mul(9).add(ln(t,c+40))),i=wr(i.add(a[0]),33).mul(d),o=mb(t,c,o[1].mul(d),r.add(a[0])),a=mb(t,c+32,i.add(a[1]),s.add(ln(t,c+16))),[i,r]=[r,i],ul(ul(o[0],a[0],d).add(jT(s).mul(p8)).add(i),ul(o[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(t,e){return e==="string"?dl(t):Ed([t],e)}function CEe(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ed(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=rd(t)),fe().getBool("DEBUG")&&rEe(t,e),CEe(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function ws(){return fe().platform.now()}function dl(t,e="utf-8"){return e=e||"utf-8",fe().platform.encode(t,e)}function Sl(t,e="utf-8"){return e=e||"utf-8",fe().platform.decode(t,e)}function io(t){return fe().platform.isTypedArray!=null?fe().platform.isTypedArray(t):d8(t)}function rd(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||nd(t)||t==null||io(t)&&n)e.push(t);else if(Array.isArray(t)||io(t))for(let r=0;r<t.length;++r)rd(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)rd(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TEe{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new NEe)}profileKernel(e,n,r){let s;const i=()=>{s=r()};let o;const a=ws();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const l of s)l.dataSync();o=Promise.resolve({kernelMs:ws()-a})}if(fe().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<s.length;l++){const u=s[l];u.data().then(d=>{AEe(d,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:i,extraInfo:o}=e;r.forEach(a=>{Promise.all([a.data(),s,o]).then(c=>{this.logger.logKernelProfile(n,a,c[0],c[1],i,c[2])})})}}function AEe(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class NEe{logKernelProfile(e,n,r,s,i,o){const a=typeof s=="number"?Gf(`${s}ms`,9):s.error,c=Gf(e,25),l=n.rank,u=n.size,d=Gf(n.shape.toString(),14);let h="";for(const m in i){const g=i[m];if(g!=null){const v=g.shape||n.shape,y=v.length;h+=`${m}: ${y}D ${y>0?v:""} `}}console.log(`%c${c}	%c${a}	%c${l}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ee(t,e,n){const r={},s={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<t.length;c++){const l=t[c],u=l.inputs;for(const d in u){const h=u[d];let m=!1;for(let g=0;g<e.length;g++)if(r[h.id]){l.outputs.forEach(v=>r[v.id]=!0),m=!0,s[l.id]=!0;break}if(m)break}}const i={};i[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const l=t[c],u=l.inputs;for(let d=0;d<l.outputs.length;d++)if(i[l.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[l.id]=!0;break}}const a=[];for(let c=0;c<t.length;c++){const l=t[c];if(s[l.id]&&o[l.id]){const u={};for(const h in l.inputs){const m=l.inputs[h];r[m.id]&&(u[h]=m)}const d=Object.assign({},l);d.inputs=u,d.outputs=l.outputs,a.push(d)}}return a}function $Ee(t,e,n,r){for(let s=e.length-1;s>=0;s--){const i=e[s],o=[];if(i.outputs.forEach(c=>{const l=t[c.id];l!=null?o.push(l):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const c in i.inputs){if(!(c in a))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(a)}.`);const l=n(()=>a[c]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${l.dtype}'`);const u=i.inputs[c];if(!Dt(l.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${c}' has shape '${l.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=l;else{const d=t[u.id];t[u.id]=r(d,l),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zM=20,fm=3,z2=7;function REe(t,e,n,r){const s=nt(e),i=OEe(t,e,n,s),o=e.length,a=Wb(t,e,n,s,i),c=["Tensor"];return r&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${o}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(a.map(l=>"    "+l).join(`
`)),c.join(`
`)}function OEe(t,e,n,r){const s=me(e),i=r[r.length-1],o=new Array(i).fill(0),a=e.length,c=n==="complex64"?Cm(t):t;if(a>1)for(let l=0;l<s/i;l++){const u=l*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Em(c[u+d],0,n).length)}return o}function Em(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(z2))} + ${parseFloat(t[1].toFixed(z2))}j`:g0(t)?r=`'${t}'`:n==="bool"?r=g8(t):r=parseFloat(t.toFixed(z2)).toString(),Gf(r,e)}function g8(t){return t===0?"false":"true"}function Wb(t,e,n,r,s,i=!0){const o=n==="complex64"?2:1,a=e[0],c=e.length;if(c===0){if(n==="complex64"){const v=Cm(t);return[Em(v[0],0,n)]}return n==="bool"?[g8(t[0])]:[t[0].toString()]}if(c===1){if(a>zM){const y=fm*o;let w=Array.from(t.slice(0,y)),x=Array.from(t.slice((a-fm)*o,a*o));return n==="complex64"&&(w=Cm(w),x=Cm(x)),["["+w.map((S,k)=>Em(S,s[k],n)).join(", ")+", ..., "+x.map((S,k)=>Em(S,s[a-fm+k],n)).join(", ")+"]"]}return["["+(n==="complex64"?Cm(t):Array.from(t)).map((y,w)=>Em(y,s[w],n)).join(", ")+"]"]}const l=e.slice(1),u=r.slice(1),d=r[0]*o,h=[];if(a>zM){for(let v=0;v<fm;v++){const y=v*d,w=y+d;h.push(...Wb(t.slice(y,w),l,n,u,s,!1))}h.push("...");for(let v=a-fm;v<a;v++){const y=v*d,w=y+d;h.push(...Wb(t.slice(y,w),l,n,u,s,v===a-1))}}else for(let v=0;v<a;v++){const y=v*d,w=y+d;h.push(...Wb(t.slice(y,w),l,n,u,s,v===a-1))}const m=c===2?",":"";h[0]="["+(a>0?h[0]+m:"");for(let v=1;v<h.length-1;v++)h[v]=" "+h[v]+m;let g=`,
`;for(let v=2;v<c;v++)g+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":g),h}function Cm(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fr{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=me(e),r!=null){const s=r.length;U(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||qn(n,this.size),this.strides=nt(e)}set(e,...n){n.length===0&&(n=[0]),U(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return ko().makeTensor(this.values,this.shape,this.dtype)}}let ko=null,_f=null;function PEe(t){ko=t}function DEe(t){_f=t}class Yt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=me(e),this.strides=nt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return _f.buffer(this.shape,this.dtype,e)}bufferSync(){return _f.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return to(this.shape,e,this.dtype==="complex64")}arraySync(){return to(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ko().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Sl(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ko().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ko().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Sl(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ko().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ko().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return _f.print(this,e)}clone(){return this.throwIfDisposed(),_f.clone(this)}toString(e=!1){const n=this.dataSync();return REe(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),_f.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),ko().makeVariable(this,e,n,r)}}Object.defineProperty(Yt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ve(){return z_("Tensor",()=>Yt)}ve();class Tx extends Yt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Dt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ko().disposeTensor(this),this.dataId=e.dataId,ko().incRef(this,null)}dispose(){ko().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Tx,Symbol.hasInstance,{value:t=>t instanceof Yt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var UM;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(UM||(UM={}));var HT;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(HT||(HT={}));var WT;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(WT||(WT={}));var GT;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(GT||(GT={}));var qT;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(qT||(qT={}));const FEe={float32:GT,int32:HT,bool:WT,complex64:qT};function ni(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return FEe[t][e]}function W$(t){return ni(t,"int32")}function y8(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function v8(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t,e){if(t.dtype===e.dtype)return[t,e];const n=ni(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function LEe(t,e){U(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function b8(t){const e=[];return w8(t,e,new Set),e}function w8(t,e,n){if(t==null)return;if(t instanceof Yt){e.push(t);return}if(!BEe(t))return;const r=t;for(const s in r){const i=r[s];n.has(i)||(n.add(i),w8(i,e,n))}}function BEe(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2(t){return t.kernelName!=null}class VM{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class wh{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new VM}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(gi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new TEe(this.backendInstance),!0}setupRegisteredKernels(){LM(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){LM(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof L_)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(o=>s<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,gi(`Initialization of backend ${e} failed`),gi(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return gi(`Initialization of backend ${e} failed`),gi(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,i=this.readSync(n),o=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return wh.nextTensorId++}nextVariableId(){return wh.nextVariableId++}clone(e){const n=te.runKernel(L0,{x:e}),r={x:e},s=o=>({x:()=>{const a="float32",c={x:o},l={dtype:a};return te.runKernel(k0,c,l)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(VT(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let i=0;r.forEach(c=>{i+=c.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let c;const l=U2(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(U2(e)){const{kernelName:g,inputs:v,attrs:y}=e;this.backendName==null&&this.backend;const w=VT(g,this.backendName);U(w!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();c=w.kernelFunc({inputs:v,attrs:y,backend:this.backend});const S=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,x,S);const k=S.map(E=>E.rank!=null?E:this.makeTensorFromTensorInfo(E));if(s){const E=this.getTensorsForGradient(g,v,k);r=this.saveTensorsForBackwardMode(E)}return k}}else{const{forwardFunc:g}=e,v=y=>{s&&(r=y.map(w=>this.keep(this.clone(w))))};a=()=>{const y=this.backend.numDataIds();c=this.tidy(()=>g(this.backend,v));const w=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,y,w),w}}const{inputs:u,attrs:d}=e,h=U2(e)?null:e.backwardsFunc;let m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(m=this.profiler.profileKernel(l,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),n=m.outputs)}),s&&this.addTapeNode(l,u,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(g=>u[g]!=null?u[g].shape:null),outputShapes:n.map(g=>g.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(c)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=FM(e);if(s!=null){const i=s.inputsToSave||[],o=s.outputsToSave||[];let a;s.saveAllInputs?(U(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(l=>n[l])):a=i.map(l=>n[l]);const c=r.filter((l,u)=>o[u]);return a.concat(c)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&g0(e[0])&&(i=e.map(c=>dl(c)));const o=s.write(i,n,r),a=new Yt(n,r,o,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const c=this.state.tensorInfo.get(o),l=iEe(i);this.state.numBytes+=l-c.bytes,c.bytes=l}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:i}=e,o=new Yt(s,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new Tx(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Ix(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Tx||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Ix(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},c=FM(e);c!=null&&(s=c.gradFunc),s!=null&&(a.gradient=l=>(l=l.map((u,d)=>{if(u==null){const h=r[d],m=Jr(h.size,h.dtype);return this.makeTensor(m,h.shape,h.dtype)}return u}),s(l.length>1?l:l[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=b8(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,n,r,s=!1){if(U(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));U(i instanceof Yt,()=>"The result y returned by f() must be a tensor.");const o=_Ee(this.state.activeTape,n,i);if(!s&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??MEe(i.shape),$Ee(a,o,l=>this.tidy(l),zEe);const c=n.map(l=>a[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(const u of l.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:c}})}customGrad(e){return U(FT(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{U(n.every(a=>a instanceof Yt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,c)=>{s[c]=a});const i=(a,c)=>(r=e(...n,c),U(r.value instanceof Yt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),U(FT(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(a,c)=>{const l=r.gradFunc(a,c),u=Array.isArray(l)?l:[l];U(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),U(u.every(h=>h instanceof Yt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,m)=>{d[m]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=ws(),r=await this.backend.time(e);return r.wallMs=ws()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new VM;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}wh.nextTensorId=0;wh.nextVariableId=0;function MEe(t){const e=M_(me(t),"float32");return te.makeTensor(e,t,"float32")}function x8(){const t=c8();if(t._tfengine==null){const e=new cEe(t);t._tfengine=new wh(e)}return fEe(t._tfengine.ENV),PEe(()=>t._tfengine),t._tfengine}const te=x8();function zEe(t,e){const n={a:t,b:e};return te.runKernel(Xh,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UEe(){return typeof navigator<"u"&&navigator!=null}function I8(t){if(t||UEe()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function S8(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const As=fe();As.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});As.registerFlag("IS_BROWSER",()=>S8());As.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");As.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));As.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));As.registerFlag("PROD",()=>!1);As.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>As.getBool("DEBUG"));As.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);As.registerFlag("IS_TEST",()=>!1);As.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>As.getBool("DEBUG"));As.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);As.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);As.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ml(t,e){let n=t;if(io(t))return e==="string"?[]:[t.length];if(y8(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(v8(t))return[t.buffer.size/(e==null?4:Ix(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||io(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&fe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&k8(t,r,[]),r}function k8(t,e,n){if(n=n||[],!Array.isArray(t)&&!io(t)){U(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}U(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),U(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)k8(t[s],r,n.concat(s))}function jM(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function V(t,e,n,r="numeric"){if(t instanceof ve())return jM(r,t.dtype,e,n),t;let s=qh(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),jM(r,s,e,n),t==null||!io(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const c=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${c}'`)}const i=Ml(t,s);!io(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Ed(t,s):rd(t,[],!0);return te.makeTensor(a,i,s)}function Ax(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>V(i,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8="__op";function J(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+E8;const s=(...i)=>{te.startScope(n);try{const o=r(...i);return nd(o)&&console.error("Cannot return a Promise inside of tidy."),te.endScope(o),o}catch(o){throw te.endScope(null),o}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VEe(t,e){const n=V(t,"real","complex"),r=V(e,"imag","complex");ci(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return te.runKernel(q_,s)}const kl=J({complex_:VEe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(t,e,n,r){if(r==null)r=qh(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(v8(t)||y8(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return te.backend.createTensorFromGPUData(t,e||n,r)}if(!io(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ni(e);const s=me(e),i=me(n);U(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],c=o===n.length-1?a!==me(e.slice(o)):!0;U(n[o]===e[o]||!c,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!io(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Ed(t,r):rd(t,[],!0),te.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(t,e,n){const r=Ml(t,n);return zl(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sd={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class qo{static join(e){return new qo(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>io(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+s.byteLength;this.shards.push({buffer:s,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,i=new ArrayBuffer(s),o=new Uint8Array(i);let a=0;for(let c=r;c<this.shards.length;c++){const l=this.shards[c],d=e+a-l.start,h=a,g=Math.min(n,l.end)-l.start,v=new Uint8Array(l.buffer,d,g-d);if(o.set(v,h),a+=v.length,n<l.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=jEe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function jEe(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,i=e(t[s]);if(i===0)return s;i<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(){return te}function HM(){return te.memory()}function ae(t,e){return te.tidy(t,e)}function Tt(t){b8(t).forEach(n=>n.dispose())}function xr(t){return te.keep(t)}function HEe(){return te.ready()}function WEe(){return te.backendName}function C8(t,e,n=1){return te.registerBackend(t,e,n)}function T8(){return te.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const El=4;async function KT(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<s.length;++o){const a=s[o],c=Array.isArray(t)?t[o].tensor:t[a];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${c.dtype}`);const l={name:a,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const u=new Promise(async d=>{const h=await c.bytes(),m=h.reduce((y,w)=>y+w.length,0)+El*h.length,g=new Uint8Array(m);let v=0;for(let y=0;y<h.length;y++){const w=h[y],x=new Uint8Array(new Uint32Array([w.length]).buffer);g.set(x,v),v+=El,g.set(w,v),v+=w.length}d(g)});r.push(u)}else r.push(c.data());e!=null&&(l.group=e),n.push(l)}const i=await Promise.all(r);return{data:KEe(i),specs:n}}function A8(t,e){const n=new qo(t),r={};let s=0;for(const i of e){const o=GEe(i,(a,c)=>n.slice(s+a,s+c));r[i.name]=N8(i,n.slice(s,s+o)),s+=o}return r}function GEe(t,e){const n=me(t.shape);let r;if("quantization"in t){const s=t.quantization;r=sd[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=El+new Uint32Array(e(s,s+El))[0];return s}else r=sd[t.dtype];return n*r}async function qEe(t,e){const n=me(t.shape);let r;if("quantization"in t){const s=t.quantization;r=sd[s.dtype]}else if(t.dtype==="string"){let s=0;for(let i=0;i<n;i++)s+=El+new Uint32Array(await e(s,s+El))[0];return s}else r=sd[t.dtype];return n*r}function N8(t,e){const n=t.name,r=t.dtype,s=t.shape,i=me(s);let o,a=0;if("quantization"in t){const c=t.quantization;if(c.dtype==="uint8"||c.dtype==="uint16"){if(!("min"in c&&"scale"in c))throw new Error(`Weight ${t.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else if(c.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const l=sd[c.dtype],u=c.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(c.dtype==="uint8"||c.dtype==="uint16"){o=new Float32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=h*c.scale+c.min}}else if(c.dtype==="float16")o=e2e()(u);else throw new Error(`Unsupported quantization type ${c.dtype} for weight type float32.`);else if(r==="int32"){if(c.dtype!=="uint8"&&c.dtype!=="uint16")throw new Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=Math.round(h*c.scale+c.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*l}else if(r==="string"){const c=me(t.shape);o=[];for(let l=0;l<c;l++){const u=new Uint32Array(e.slice(a,a+El))[0];a+=El;const d=new Uint8Array(e.slice(a,a+u));o.push(d),a+=u}}else{const c=sd[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const l=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let g=0;g<l.length;g++)l[g]=o[g*2],u[g]=o[g*2+1];const d=Oo(l,s,"float32"),h=Oo(u,s,"float32"),m=kl(d,h);return d.dispose(),h.dispose(),m}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=i*c}return Oo(o,s,r)}async function WM(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:i}=await t.read();if(s&&i==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(r.length+i.byteLength);o.set(r,0),o.set(new Uint8Array(i),r.length),r=o}return r.buffer}async function _8(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const i of e){const o=await qEe(i,async(l,u)=>(s=await WM(r,s,u),s.slice(l,u)));s=await WM(r,s,o);const a=s.slice(0,o);s=s.slice(o);const c=N8(i,a);if(n[i.name]=c,WEe()==="webgpu"){const l=T8();"uploadToGPU"in l&&me(c.shape)>=fe().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&l.uploadToGPU(c.dataId)}}return n}function KEe(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const G$=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function GM(t){return G$?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function XEe(t){if(G$)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function QEe(t){if(G$){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function $8(t){return qo.join(t)}function qM(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const n=t.split("/");return n[n.length-1]}function R8(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function O8(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function q$(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),O8(t,n,r)}function fy(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:GM(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:GM(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new qo(t.weightData).byteLength}}function XT(t){const e=[];for(const n of t)e.push(...n.weights);return e}function YEe(){const t=n=>{let r=n<<13,s=0;for(;(r&8388608)===0;)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function ZEe(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function JEe(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function e2e(){const t=YEe(),e=ZEe(),n=JEe();return r=>{const s=new ArrayBuffer(4*r.length),i=new Uint32Array(s);for(let o=0;o<r.length;o++){const a=r[o],c=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=c}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Cn.instance==null&&(Cn.instance=new Cn),Cn.instance}static registerSaveRouter(e){Cn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Cn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Cn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Cn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Cn.getInstance().loadRouters:Cn.getInstance().saveRouters).forEach(o=>{const a=o(e,r);a!==null&&s.push(a)}),s}}const t2e=t=>Cn.registerSaveRouter(t),n2e=t=>Cn.registerLoadRouter(t),P8=t=>Cn.getSaveHandlers(t),r2e=(t,e)=>Cn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QT="tensorflowjs",YT=1,$u="models_store",ol="model_info_store";function D8(){if(!fe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ZT(t){const e=t.result;e.createObjectStore($u,{keyPath:"modelPath"}),e.createObjectStore(ol,{keyPath:"modelPath"})}class id{constructor(e){if(this.indexedDB=D8(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const i=this.indexedDB.open(QT,YT);i.onupgradeneeded=()=>ZT(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction($u,"readonly"),l=a.objectStore($u).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=u=>(o.close(),s(l.error)),a.oncomplete=()=>o.close()}else{n.weightData=qo.join(n.weightData);const a=fy(n),c=o.transaction(ol,"readwrite");let l=c.objectStore(ol),u;try{u=l.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return s(h)}let d;u.onsuccess=()=>{d=o.transaction($u,"readwrite");const h=d.objectStore($u);let m;try{m=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(g){return s(g)}m.onsuccess=()=>r({modelArtifactsInfo:a}),m.onerror=g=>{l=c.objectStore(ol);const v=l.delete(this.modelPath);v.onsuccess=()=>(o.close(),s(m.error)),v.onerror=y=>(o.close(),s(m.error))}},u.onerror=h=>(o.close(),s(u.error)),c.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>s(i.error)})}}id.URL_SCHEME="indexeddb://";const F8=t=>fe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(id.URL_SCHEME)?s2e(t.slice(id.URL_SCHEME.length)):null;Cn.registerSaveRouter(F8);Cn.registerLoadRouter(F8);function s2e(t){return new id(t)}function i2e(t){return t.startsWith(id.URL_SCHEME)?t.slice(id.URL_SCHEME.length):t}class o2e{constructor(){this.indexedDB=D8()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(QT,YT);r.onupgradeneeded=()=>ZT(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(ol,"readonly"),a=i.objectStore(ol).getAll();a.onsuccess=()=>{const c={};for(const l of a.result)c[l.modelPath]=l.modelArtifactsInfo;e(c)},a.onerror=c=>(s.close(),n(a.error)),i.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=i2e(e),new Promise((n,r)=>{const s=this.indexedDB.open(QT,YT);s.onupgradeneeded=()=>ZT(s),s.onsuccess=()=>{const i=s.result,o=i.transaction(ol,"readwrite"),a=o.objectStore(ol),c=a.get(e);let l;c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{l=i.transaction($u,"readwrite");const m=l.objectStore($u).delete(e);m.onsuccess=()=>n(c.result.modelArtifactsInfo),m.onerror=g=>r(c.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),r(c.error))}},c.onerror=u=>(i.close(),r(c.error)),o.oncomplete=()=>{l==null?i.close():l.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rc="/",$f="tensorflowjs_models",L8="info",a2e="model_topology",c2e="weight_specs",l2e="weight_data",u2e="model_metadata";function B8(t){return{info:[$f,t,L8].join(rc),topology:[$f,t,a2e].join(rc),weightSpecs:[$f,t,c2e].join(rc),weightData:[$f,t,l2e].join(rc),modelMetadata:[$f,t,u2e].join(rc)}}function M8(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function d2e(t){const e=t.split(rc);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(rc)}function f2e(t){return t.startsWith(od.URL_SCHEME)?t.slice(od.URL_SCHEME.length):t}class od{constructor(e){if(!fe().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=B8(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=fy(e),i=qo.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,XEe(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw M8(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=QEe(o),n}}od.URL_SCHEME="localstorage://";const z8=t=>fe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(od.URL_SCHEME)?h2e(t.slice(od.URL_SCHEME.length)):null;Cn.registerSaveRouter(z8);Cn.registerLoadRouter(z8);function h2e(t){return new od(t)}class p2e{constructor(){U(fe().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),U(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=$f+rc,r=rc+L8;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(n)&&i.endsWith(r)){const o=d2e(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=f2e(e);const n=B8(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return M8(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kf="://";class ls{constructor(){this.managers={}}static getInstance(){return ls.instance==null&&(ls.instance=new ls),ls.instance}static registerManager(e,n){U(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Kf)&&(e=e.slice(0,e.indexOf(Kf))),U(e.length>0,()=>"scheme must not be an empty string.");const r=ls.getInstance();U(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=ls.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ls.getInstance().managers)}}function Gb(t){if(t.indexOf(Kf)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ls.getSchemes().join(",")}`);return{scheme:t.split(Kf)[0],path:t.split(Kf)[1]}}async function U8(t,e,n=!1){U(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Cn.getLoadHandlers(t);U(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),U(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],i=Cn.getSaveHandlers(e);U(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),U(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],a=Gb(t).scheme,c=Gb(t).path,l=a===Gb(t).scheme,u=await s.load();n&&l&&await ls.getManager(a).removeModel(c);const d=await o.save(u);return n&&!l&&await ls.getManager(a).removeModel(c),d.modelArtifactsInfo}async function m2e(){const t=ls.getSchemes(),e={};for(const n of t){const r=await ls.getManager(n).listModels();for(const s in r){const i=n+Kf+s;e[i]=r[s]}}return e}async function g2e(t){const e=Gb(t);return ls.getManager(e.scheme).removeModel(e.path)}async function y2e(t,e){return U8(t,e,!1)}async function v2e(t,e){return U8(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b2e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!fe().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return d8(e)}}if(fe().get("IS_BROWSER")){fe().setPlatform("browser",new b2e);try{ls.registerManager(od.URL_SCHEME,new p2e)}catch{}try{ls.registerManager(id.URL_SCHEME,new o2e)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e={importFetch:()=>require("node-fetch")};let V2;class x2e{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return fe().global.fetch!=null?fe().global.fetch(e,n):(V2==null&&(V2=w2e.importFetch()),V2(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}fe().get("IS_NODE")&&!fe().get("IS_BROWSER")&&fe().setPlatform("node",new x2e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kt(t,e="float32",n){return e=e||"float32",Ni(t),new fr(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t,e){const n=V(t,"x","cast");if(!sEe(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return te.runKernel(k0,r,s)}const Fe=J({cast_:I2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2e(t){const n={x:V(t,"x","clone","string_or_numeric")};return te.runKernel(L0,n)}const oc=J({clone_:S2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */x8();const k2e={buffer:kt,cast:Fe,clone:oc,print:V8};DEe(k2e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(t,e){let n=V(t,"a","add"),r=V(e,"b","add");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(Xh,s)}const xe=J({add_:E2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(t,e){let n=V(t,"a","floorDiv"),r=V(e,"b","floorDiv");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(D0,s)}const K$=J({floorDiv_:C2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2e(t,e){let n=V(t,"a","div"),r=V(e,"b","div");if([n,r]=Un(n,r),n.dtype==="int32"&&r.dtype==="int32")return K$(n,r);const s={a:n,b:r},i={};return te.runKernel(N0,s,i)}const We=J({div_:T2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2e(t,e){let n=V(t,"a","mul"),r=V(e,"b","mul");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(G0,s)}const ee=J({mul_:A2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2e(t){const e=V(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return te.runKernel(tI,n)}else{const n={x:e};return te.runKernel(G1,n)}}const ar=J({abs_:N2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2e(t){const n={x:V(t,"x","acos")};return te.runKernel(y0,n)}const j8=J({acos_:_2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2e(t){const n={x:V(t,"x","acosh")};return te.runKernel(v0,n)}const H8=J({acosh_:$2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t){U(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),U(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,i)=>V(s,`tensors${i}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!Dt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return te.runKernel(q1,r)}const O2e=J({addN_:R2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t,e=null,n=!1){const s={x:V(t,"x","all","bool")},i={axis:e,keepDims:n};return te.runKernel(U_,s,i)}const X$=J({all_:P2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t,e=null,n=!1){const s={x:V(t,"x","any","bool")},i={axis:e,keepDims:n};return te.runKernel(V_,s,i)}const Nx=J({any_:D2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2e(t,e=0){const r={x:V(t,"x","argMax")},s={axis:e};return te.runKernel(K1,r,s)}const xh=J({argMax_:F2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(t,e=0){const r={x:V(t,"x","argMin")},s={axis:e};return te.runKernel(X1,r,s)}const W8=J({argMin_:L2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2e(t){const n={x:V(t,"x","asin")};return te.runKernel(b0,n)}const G8=J({asin_:B2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const n={x:V(t,"x","asinh")};return te.runKernel(w0,n)}const q8=J({asinh_:M2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(t){const n={x:V(t,"x","atan")};return te.runKernel(x0,n)}const K8=J({atan_:z2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2e(t,e){let n=V(t,"a","atan2"),r=V(e,"b","atan2");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(S0,s)}const X8=J({atan2_:U2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2e(t){const n={x:V(t,"x","atanh")};return te.runKernel(I0,n)}const Q8=J({atanh_:V2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hy(t,e,n,r,s="NHWC",i){const o=t[3],a=[...e,o],c=Cc(s);return Er(t,a,n,i,r,null,null,c)}function co(t,e,n,r,s,i,o="channelsLast"){const[a,c]=Pg(e);let l;if(o==="channelsLast")l=[a,c,t[3],t[3]];else if(o==="channelsFirst")l=[a,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Er(t,l,n,r,s,i,!1,o)}function Ec(t,e,n,r,s,i,o="NDHWC"){const[a,c,l]=JT(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,c,l,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,c,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ul(t,u,n,r,s,!1,d,i)}function Er(t,e,n,r,s,i,o=!1,a="channelsLast"){let[c,l,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[c,l,u,d]=t;else if(a==="channelsFirst")[c,d,l,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,m,,g]=e,[v,y]=Pg(n),[w,x]=Pg(r),S=Xf(h,w),k=Xf(m,x),{padInfo:E,outHeight:A,outWidth:R}=W2e(s,l,u,v,y,S,k,i,a),N=o?g*d:g;let P;return a==="channelsFirst"?P=[c,N,A,R]:a==="channelsLast"&&(P=[c,A,R,N]),{batchSize:c,dataFormat:a,inHeight:l,inWidth:u,inChannels:d,outHeight:A,outWidth:R,outChannels:N,padInfo:E,strideHeight:v,strideWidth:y,filterHeight:h,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:k,dilationHeight:w,dilationWidth:x,inShape:t,outShape:P,filterShape:e}}function Ul(t,e,n,r,s,i=!1,o="channelsLast",a){let[c,l,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[c,l,u,d,h]=t;else if(o==="channelsFirst")[c,h,l,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[m,g,v,,y]=e,[w,x,S]=JT(n),[k,E,A]=JT(r),R=Xf(m,k),N=Xf(g,E),P=Xf(v,A),{padInfo:O,outDepth:_,outHeight:M,outWidth:G}=G2e(s,l,u,d,w,x,S,R,N,P,a),q=i?y*h:y;let D;return o==="channelsFirst"?D=[c,q,_,M,G]:o==="channelsLast"&&(D=[c,_,M,G,q]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:u,inWidth:d,inChannels:h,outDepth:_,outHeight:M,outWidth:G,outChannels:q,padInfo:O,strideDepth:w,strideHeight:x,strideWidth:S,filterDepth:m,filterHeight:g,filterWidth:v,effectiveFilterDepth:R,effectiveFilterHeight:N,effectiveFilterWidth:P,dilationDepth:k,dilationHeight:E,dilationWidth:A,inShape:t,outShape:D,filterShape:e}}function j2e(t,e,n,r,s){r==null&&(r=Q$(t,e,n));const i=t[0],o=t[1],a=Dg((i-e+2*r)/n+1,s),c=Dg((o-e+2*r)/n+1,s);return[a,c]}function H2e(t,e,n,r,s,i){s==null&&(s=Q$(t,e[0],r[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(o[a]=Dg((t[a]-e[a]+2*s)/r[a]+1,i));return o}function Q$(t,e,n,r=1){const s=Xf(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function Pg(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function JT(t){return typeof t=="number"?[t,t,t]:t}function Xf(t,e){return e<=1?t:t+(t-1)*(e-1)}function W2e(t,e,n,r,s,i,o,a,c){let l,u,d;if(typeof t=="number"){l={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const m=j2e([e,n],i,r,t,a);u=m[0],d=m[1]}else if(t==="same"){u=Math.ceil(e/r),d=Math.ceil(n/s);const h=Math.max(0,(u-1)*r+i-e),m=Math.max(0,(d-1)*s+o-n),g=Math.floor(h/2),v=h-g,y=Math.floor(m/2),w=m-y;l={top:g,bottom:v,left:y,right:w,type:"SAME"}}else if(t==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/s);else if(typeof t=="object"){const h=c==="channelsLast"?t[1][0]:t[2][0],m=c==="channelsLast"?t[1][1]:t[2][1],g=c==="channelsLast"?t[2][0]:t[3][0],v=c==="channelsLast"?t[2][1]:t[3][1];l={top:h,bottom:m,left:g,right:v,type:h===0&&m===0&&g===0&&v===0?"VALID":"EXPLICIT"},u=Dg((e-i+h+m)/r+1,a),d=Dg((n-o+g+v)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:l,outHeight:u,outWidth:d}}function G2e(t,e,n,r,s,i,o,a,c,l,u){let d,h,m,g;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=H2e([e,n,r,1],[a,c,l],1,[s,i,o],t,u);h=y[0],m=y[1],g=y[2]}else if(t==="same"){h=Math.ceil(e/s),m=Math.ceil(n/i),g=Math.ceil(r/o);const v=(h-1)*s+a-e,y=(m-1)*i+c-n,w=(g-1)*o+l-r,x=Math.floor(v/2),S=v-x,k=Math.floor(y/2),E=y-k,A=Math.floor(w/2),R=w-A;d={top:k,bottom:E,left:A,right:R,front:x,back:S,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:m,outWidth:g}}function Dg(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Cl(t){const[e,n,r]=Pg(t);return e===1&&n===1&&r===1}function Vr(t,e){return Cl(t)||Cl(e)}function ad(t){return Pg(t).every(e=>e>0)}function Cc(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function gs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")U(bh(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{U(bh(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(t,e){const r={x:V(t,"x","reshape","string_or_numeric")},s={shape:e};return te.runKernel(DI,r,s)}const re=J({reshape_:q2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(t,e,n,r,s){const i=V(t,"x","avgPool","float32"),o=1;U(Vr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,c=!1;i.rank===3&&(c=!0,a=re(i,[1,i.shape[0],i.shape[1],i.shape[2]])),U(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),gs("avgPool",r,s);const l={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=te.runKernel(Q1,l,u);return d=Fe(d,i.dtype),c?re(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const QI=J({avgPool_:K2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2e(t,e,n,r,s,i="NDHWC"){const o=V(t,"x","avgPool3d","float32");let a=o,c=!1;o.rank===4&&(c=!0,a=re(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),U(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),U(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),gs("avgPool3d",r,s);const l={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i};let d=te.runKernel(Y1,l,u);return d=Fe(d,a.dtype),c?re(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Y8=J({avgPool3d_:X2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2e(t,e=0){U(t.length>=1,()=>"Pass at least one tensor to concat");const n=Ax(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return oc(n[0]);const r=n,s={axis:e};return te.runKernel(nI,r,s)}const zn=J({concat_:Q2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2e(t,e,n=!1,r=!1){let s=V(t,"a","matMul"),i=V(e,"b","matMul");[s,i]=Un(s,i);const o={a:s,b:i},a={transposeA:n,transposeB:r};return te.runKernel(Z1,o,a)}const $t=J({matMul_:Y2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2e(t){const n={x:V(t,"x","sigmoid","float32")};return te.runKernel(ry,n)}const Po=J({sigmoid_:Z2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(t,e,n){const r=V(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:n};return te.runKernel(zI,s,i)}const at=J({slice_:J2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const n={x:V(t,"x","tanh","float32")};return te.runKernel(ly,n)}const cd=J({tanh_:eCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(t,e,n,r,s,i){const o=V(t,"forgetBias","basicLSTMCell"),a=V(e,"lstmKernel","basicLSTMCell"),c=V(n,"lstmBias","basicLSTMCell"),l=V(r,"data","basicLSTMCell"),u=V(s,"c","basicLSTMCell"),d=V(i,"h","basicLSTMCell"),h=zn([l,d],1),m=$t(h,a),g=xe(m,c),v=g.shape[0],y=g.shape[1]/4,w=[v,y],x=at(g,[0,0],w),S=at(g,[0,y],w),k=at(g,[0,y*2],w),E=at(g,[0,y*3],w),A=xe(ee(Po(x),cd(S)),ee(u,Po(xe(o,k)))),R=ee(cd(A),Po(E));return[A,R]}const nCe=J({basicLSTMCell_:tCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t,e,n){const r=V(t,"x","batchToSpaceND"),s=e.reduce((a,c)=>a*c);U(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),U(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),U(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},o={blockShape:e,crops:n};return te.runKernel(J1,i,o)}const YI=J({batchToSpaceND_:rCe});function sCe(t){let e;return t.rank===0||t.rank===1?e=re(t,[1,1,1,t.size]):t.rank===2?e=re(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=re(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(t,e,n,r,s,i){i==null&&(i=.001);const o=V(t,"x","batchNorm"),a=V(e,"mean","batchNorm"),c=V(n,"variance","batchNorm");let l;s!=null&&(l=V(s,"scale","batchNorm"));let u;r!=null&&(u=V(r,"offset","batchNorm")),U(a.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:sCe(o),scale:l,offset:u,mean:a,variance:c},m={varianceEpsilon:i},g=te.runKernel(dI,h,m);return re(g,o.shape)}const py=J({batchNorm_:iCe});function oCe(t,e,n,r,s,i){const o=V(t,"x","batchNorm"),a=V(e,"mean","batchNorm"),c=V(n,"variance","batchNorm");let l;s!=null&&(l=V(s,"scale","batchNorm"));let u;return r!=null&&(u=V(r,"offset","batchNorm")),U(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),U(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),U(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&U(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&U(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),py(o,a,c,u,l,i)}const Z8=J({batchNorm2d_:oCe});function aCe(t,e,n,r,s,i){const o=V(t,"x","batchNorm"),a=V(e,"mean","batchNorm"),c=V(n,"variance","batchNorm");let l;s!=null&&(l=V(s,"scale","batchNorm"));let u;return r!=null&&(u=V(r,"offset","batchNorm")),U(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),U(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),U(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&U(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&U(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),py(o,a,c,u,l,i)}const J8=J({batchNorm3d_:aCe});function cCe(t,e,n,r,s,i){const o=V(t,"x","batchNorm"),a=V(e,"mean","batchNorm"),c=V(n,"variance","batchNorm");let l;s!=null&&(l=V(s,"scale","batchNorm"));let u;return r!=null&&(u=V(r,"offset","batchNorm")),U(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),U(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),U(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&U(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&U(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),py(o,a,c,u,l,i)}const eq=J({batchNorm4d_:cCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lCe(t,e,n){const r=V(t,"x","bincount"),s=V(e,"weights","bincount");U(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),U(n>=0,()=>`size must be non-negative, but got ${n}.`),U(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},o={size:n};return te.runKernel(W_,i,o)}const tq=J({bincount_:lCe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCe(t,e){const n=V(t,"x","bitwiseAnd"),r=V(e,"y","bitwiseAnd");if(!Dt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return te.runKernel(eI,s)}const dCe=J({bitwiseAnd_:uCe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(t,e){const n=V(t,"s0","broadcastArgs","int32"),r=V(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return te.runKernel(G_,s)}const hCe=J({broadcastArgs_:fCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pCe(t,e){let n=V(t,"broadcastTo","x");const r=n.shape;if(Ni(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const l=n.shape.slice();for(;l.length<e.length;)l.unshift(1);n=re(n,l)}const s=n.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(s[l]===e[l])i[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((l,u)=>l>1?u:-1).filter(l=>l>=0).length===0)return oc(n);const a={x:n},c={reps:i};return te.runKernel(uy,a,c)}const Qf=J({broadcastTo_:pCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(t){const n={x:V(t,"x","ceil","float32")};return te.runKernel(E0,n)}const nq=J({ceil_:mCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qh(t,e,n){Ni(t),n=n||qh(e);const r={shape:t,value:e,dtype:n};return te.runKernel(a$,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gCe(t,e,n){const r=V(t,"x","clipByValue");if(U(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Qh(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:n};return te.runKernel(C0,s,i)}const ri=J({clipByValue_:gCe});function yCe(t){return zn(t,0)}const rq=J({concat1d_:yCe});function vCe(t,e){return zn(t,e)}const ZI=J({concat2d_:vCe});function bCe(t,e){return zn(t,e)}const sq=J({concat3d_:bCe});function wCe(t,e){return zn(t,e)}const iq=J({concat4d_:wCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xCe(t,e,n,r,s="NHWC",i=[1,1],o){const a=V(t,"x","conv2d","float32"),c=V(e,"filter","conv2d","float32");let l=a,u=!1;a.rank===3&&(u=!0,l=re(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),U(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),gs("conv2d",r,o);const d=s==="NHWC"?l.shape[3]:l.shape[1];U(d===c.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${c.shape[2]}.`),U(Vr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),U(ad(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),U(ad(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:l,filter:c},m={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},g=te.runKernel(rI,h,m);return u?re(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Tl=J({conv2d_:xCe});function ICe(t,e,n,r,s="NWC",i=1,o){const a=V(t,"x","conv1d"),c=V(e,"filter","conv1d");let l=a,u=!1;a.rank===2&&(u=!0,l=re(a,[1,a.shape[0],a.shape[1]])),U(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),U(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),gs("conv1d",r,o),U(l.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${c.shape[1]}.`),U(Vr(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),U(ad(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),U(ad(n),()=>"Error in conv1D: Stride should be larger than 0."),U(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=re(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=re(l,[l.shape[0],1,l.shape[1],l.shape[2]]),y=Tl(h,d,[1,n],r,"NHWC",[1,i],o);return u?re(y,[y.shape[2],y.shape[3]]):re(y,[y.shape[0],y.shape[2],y.shape[3]])}const Y$=J({conv1d_:ICe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SCe(t,e,n,r,s,i="NHWC",o){U(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,c=e,l=!1;e.rank===3&&(l=!0,c=re(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),U(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),U(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),U(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?c.shape[3]:c.shape[1];U(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),U(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),gs("conv2dDerInput",s,o);const h={dy:c,filter:n},m={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,inputShape:a},g=te.runKernel(sI,h,m);return l?re(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Z$=J({conv2DBackpropInput_:SCe});function kCe(t,e,n,r,s,i){const o=V(t,"x","conv2dTranspose"),a=V(e,"filter","conv2dTranspose");return Z$(n,o,a,r,s,"NHWC",i)}const J$=J({conv2dTranspose_:kCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(t,e,n,r,s="NDHWC",i=[1,1,1]){const o=V(t,"x","conv3d"),a=V(e,"filter","conv3d");let c=o,l=!1;o.rank===4&&(l=!0,c=re(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),U(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),U(c.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${a.shape[3]}.`),U(Vr(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),U(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),U(ad(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),U(ad(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:c,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:i},h=te.runKernel(iI,u,d);return l?re(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const oq=J({conv3d_:ECe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CCe(t,e,n,r,s){U(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=re(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const c=i[4],l=o.shape[4];U(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),U(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),U(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),U(c===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[3]}.`),U(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:s,strides:r,inputShape:i},h=te.runKernel(Q_,u,d);return a?re(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const aq=J({conv3DBackpropInput_:CCe});function TCe(t,e,n,r,s){const i=V(t,"x","conv3dTranspose"),o=V(e,"filter","conv3dTranspose");return aq(n,i,o,r,s)}const cq=J({conv3dTranspose_:TCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(t){const n={x:V(t,"x","cos","float32")};return te.runKernel(T0,n)}const JI=J({cos_:ACe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NCe(t){const n={x:V(t,"x","cosh","float32")};return te.runKernel(A0,n)}const eR=J({cosh_:NCe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ce(t,e=0,n=!1,r=!1){const i={x:V(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return te.runKernel(Y_,i,o)}const _x=J({cumprod_:_Ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ce(t,e=0,n=!1,r=!1){const i={x:V(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return te.runKernel(oI,i,o)}const tR=J({cumsum_:$Ce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCe(t,e,n,r=!1){const s=V(t,"x","denseBincount"),i=V(e,"weights","denseBincount");U(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),U(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),U(n>=0,()=>`size must be non-negative, but got ${n}.`),U(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const o={x:s,weights:i},a={size:n,binaryOutput:r};return te.runKernel(J_,o,a)}const eA=J({denseBincount_:RCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(t,e,n="NHWC"){const r=V(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];U(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),U(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),U(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),U(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const a={x:r},c={blockSize:e,dataFormat:n};return te.runKernel(e$,a,c)}const lq=J({depthToSpace_:OCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PCe(t,e,n,r,s="NHWC",i=[1,1],o){const a=V(t,"x","depthwiseConv2d","float32"),c=V(e,"filter","depthwiseConv2d","float32");let l=a,u=!1;a.rank===3&&(u=!0,l=re(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),U(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const d=s==="NHWC"?l.shape[3]:l.shape[1];U(d===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${c.shape[2]}.`),gs("depthwiseConv2d",r,o);const h={x:l,filter:c},m={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o},g=te.runKernel(aI,h,m);return u?re(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const my=J({depthwiseConv2d_:PCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DCe(t){const n={x:V(t,"x","diag")};return te.runKernel(r$,n)}const FCe=J({diag_:DCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(t,e,n,r,s=[1,1],i="NHWC"){const o=V(t,"x","dilation2d"),a=V(e,"filter","dilation2d");U(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),U(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),U(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let c=o,l=!1;o.rank===3&&(c=re(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0),U(c.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${a.shape[2]}`);const u={x:c,filter:a},d={strides:n,pad:r,dilations:s},h=te.runKernel(cI,u,d);return l?re(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const uq=J({dilation2d_:LCe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ih(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const i=n-1-s,o=t[i]||1;(e[e.length-1-s]||1)>1&&o===1&&r.unshift(i)}return r}function gr(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],i=e.length-r-1,o=e[i];(s==null||s===1&&o>1)&&n.unshift(i)}return n}function bt(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let i=t[t.length-s-1];i==null&&(i=1);let o=e[e.length-s-1];if(o==null&&(o=1),i===1)r[n-s-1]=o;else if(o===1)r[n-s-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BCe(t,e){let n=V(t,"a","equal","string_or_numeric"),r=V(e,"b","equal","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(lI,s)}const Uo=J({equal_:BCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCe(t,e,n){const r=V(e,"a","where"),s=V(n,"b","where"),i=V(t,"condition","where","bool"),o=bt(bt(i.shape,r.shape),s.shape),a=Qf(i,o),c=Qf(r,o),l=Qf(s,o),u={condition:a,t:c,e:l};return te.runKernel(MI,u)}const Zr=J({where_:MCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(t){const n={x:V(t,"x","zerosLike")};return te.runKernel(KI,n)}const Bt=J({zerosLike_:zCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UCe(t,e){let n=V(t,"a","div"),r=V(e,"b","div");[n,r]=Un(n,r);const s=We(n,r),i=Bt(s),o=Uo(r,i);return Zr(o,i,s)}const dq=J({divNoNan_:UCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(t,e){const n=V(t,"t1","dot"),r=V(e,"t2","dot");U((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(U(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),n.rank===1&&r.rank===1){const o=re(n,[1,-1]),a=re(r,[-1,1]),c=$t(o,a);return re(c,[])}else if(n.rank===1&&r.rank===2){const o=re(n,[1,-1]),a=re(r,[r.shape[0],r.shape[1]]),c=$t(o,a);return re(c,[c.size])}else if(n.rank===2&&r.rank===1){const o=re(r,[-1,1]),a=$t(n,o);return re(a,[a.size])}else{const o=re(r,[r.shape[0],r.shape[1]]);return $t(n,o)}}const fq=J({dot_:VCe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(t,...e){const n=e.map((s,i)=>V(s,`tensors${i}`,"einsum")),r={equation:t};return te.runKernel(s$,n,r)}const Rf=J({einsum_:jCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(t){const n={x:V(t,"x","elu","float32")};return te.runKernel(_0,n)}const gy=J({elu_:HCe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t,e){const n=V(t,"x","ensureShape","string_or_numeric");if(!nEe(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const GCe=J({ensureShape_:WCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(t){let e=V(t,"x","erf");U(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Fe(e,"float32"));const n={x:e};return te.runKernel($0,n)}const nR=J({erf_:qCe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rR(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function hq(t,e,n){const r=t.length+e.length,s=[];let i=0,o=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[i++]):s.push(e[o++]);return s}function Cr(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const s=e.map(i=>t[i]);return[n,s]}function Kn(t,e){const n=e.map(r=>1);return hq(t,n,e)}function jr(t,e,n){U(rR(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Pn(t,e){if(rR(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Vl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Xn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t,e=null,n=!1){const s={x:V(t,"x","max")},i={reductionIndices:e,keepDims:n};return te.runKernel(xI,s,i)}const no=J({max_:KCe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t,e=null,n=!1){const s={x:V(t,"x","min")},i={axis:e,keepDims:n};return te.runKernel(EI,s,i)}const Fg=J({min_:XCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCe(t,e){let n=V(t,"base","pow"),r=V(e,"exp","pow");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(q0,s)}const gc=J({pow_:QCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(t,e){if((io(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&io(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return zl(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YCe(t){const n={x:V(t,"x","sqrt","float32")};return te.runKernel(iy,n)}const zr=J({sqrt_:YCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(t){const e=V(t,"x","square"),n={};return te.runKernel("Square",{x:e},n)}const on=J({square_:ZCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JCe(t,e=null,n=!1){let r=V(t,"x","sum");r.dtype==="bool"&&(r=Fe(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return te.runKernel(UI,s,i)}const Ke=J({sum_:JCe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eTe(t,e="euclidean",n=null,r=!1){t=V(t,"x","norm");const s=pq(t,e,n);let i=s.shape;if(r){const o=Nt(n,t.shape);i=Kn(s.shape,o)}return re(s,i)}function pq(t,e,n=null){if(t.rank===0)return ar(t);if(t.rank!==1&&n===null)return pq(re(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Ke(ar(t),n);if(e===1/0)return no(ar(t),n);if(e===-1/0)return Fg(ar(t),n);if(e==="euclidean"||e===2)return zr(Ke(gc(ar(t),rt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return no(Ke(ar(t),n[0]),n[1]-1);if(e===1/0)return no(Ke(ar(t),n[1]),n[0]);if(e===-1/0)return Fg(Ke(ar(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return zr(Ke(on(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const yy=J({norm_:eTe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tTe(t,e=null,n=!1){return yy(t,"euclidean",e,n)}const mq=J({euclideanNorm_:tTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nTe(t){const n={x:V(t,"x","exp")};return te.runKernel(R0,n)}const si=J({exp_:nTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rTe(t,e=0){const n=V(t,"x","expandDims","string_or_numeric");U(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return te.runKernel(uI,r,s)}const Qr=J({expandDims_:rTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sTe(t){const n={x:V(t,"x","expm1")};return te.runKernel(O0,n)}const gq=J({expm1_:sTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iTe(t,e){const n=V(t,"x","tile","string_or_numeric");U(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return te.runKernel(uy,r,s)}const Qi=J({tile_:iTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(t,e,n,r="float32"){e==null&&(e=t);const s=kt([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)s.set(1,a,a);const o=re(s.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Qi(Qr(o,0),[n[0],1,1]);if(n.length===2)return Qi(Qr(Qr(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Qi(Qr(Qr(Qr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const sR=J({eye_:oTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aTe(t){const n={x:V(t,"x","floor","float32")};return te.runKernel(P0,n)}const vy=J({floor_:aTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cTe(t,e,n=0,r=0){const s=V(t,"x","gather"),i=V(e,"indices","gather","int32"),o={x:s,indices:i},a={axis:n,batchDims:r};return te.runKernel(fI,o,a)}const by=J({gather_:cTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(t,e){let n=V(t,"a","greater","string_or_numeric"),r=V(e,"b","greater","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(hI,s)}const li=J({greater_:lTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uTe(t,e){let n=V(t,"a","greaterEqual","string_or_numeric"),r=V(e,"b","greaterEqual","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(F0,s)}const jl=J({greaterEqual_:uTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(t){const n={input:V(t,"input","imag")};return te.runKernel(d$,n)}const eS=J({imag_:dTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fTe(t){const n={x:V(t,"x","isFinite")};return te.runKernel(B0,n)}const yq=J({isFinite_:fTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hTe(t){const n={x:V(t,"x","isInf")};return te.runKernel(M0,n)}const vq=J({isInf_:hTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pTe(t){const n={x:V(t,"x","isNaN")};return te.runKernel(z0,n)}const bq=J({isNaN_:pTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTe(t,e=.2){const r={x:V(t,"x","leakyRelu")},s={alpha:e};return te.runKernel(pI,r,s)}const tS=J({leakyRelu_:mTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gTe(t,e){let n=V(t,"a","less","string_or_numeric"),r=V(e,"b","less","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(mI,s)}const Lg=J({less_:gTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yTe(t,e){let n=V(t,"a","lessEqual","string_or_numeric"),r=V(e,"b","lessEqual","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(gI,s)}const Cd=J({lessEqual_:yTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vTe(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return te.runKernel(f$,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bTe(t,e=5,n=1,r=1,s=.5){const i=V(t,"x","localResponseNormalization");U(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),U(bh(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=re(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const c={x:o},l={depthRadius:e,bias:n,alpha:r,beta:s},u=te.runKernel(wI,c,l);return a?re(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const wq=J({localResponseNormalization_:bTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wTe(t){const n={x:V(t,"x","log","float32")};return te.runKernel(U0,n)}const Ei=J({log_:wTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe(t){const n={x:V(t,"x","log1p")};return te.runKernel(V0,n)}const nS=J({log1p_:xTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ITe(t,e){U(FT(t),()=>"The f passed in variableGrads(f) must be a function"),U(e==null||Array.isArray(e)&&e.every(l=>l instanceof Tx),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const l in te.registeredVariables)e.push(te.registeredVariables[l])}const r=n?e.filter(l=>!l.trainable):null,s=e.length;e=e.filter(l=>l.trainable),U(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:o,grads:a}=te.gradients(t,e,null,i);U(a.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),U(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const c={};return e.forEach((l,u)=>{a[u]!=null&&(c[l.name]=a[u])}),r?.forEach(l=>c[l.name]=null),{value:o,grads:c}}function yc(t){return te.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function STe(t){const n={x:V(t,"x","neg")};return te.runKernel(TI,n)}const gn=J({neg_:STe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kTe(t){const n={x:V(t,"x","softplus")};return te.runKernel(sy,n)}const Yh=J({softplus_:kTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ETe(t){const e=V(t,"x","logSigmoid");return yc(r=>({value:gn(Yh(gn(r))),gradFunc:o=>ee(o,Po(gn(r)))}))(e)}const xq=J({logSigmoid_:ETe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CTe(t,e){let n=V(t,"a","sub"),r=V(e,"b","sub");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(ay,s)}const Be=J({sub_:CTe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TTe(t,e=-1){const n=V(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return yc((s,i)=>{const a=no(s,e,!0),c=Be(s,a),l=Be(Fe(c,"float32"),Ei(Ke(si(c),e,!0)));return i([l]),{value:l,gradFunc:(d,h)=>{const[m]=h,g=!0,v=si(m);return Be(d,ee(Ke(d,e,g),v))}}})(n)}const iR=J({logSoftmax_:TTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ATe(t,e=null,n=!1){const r=V(t,"x","logSumExp"),s=Nt(e,r.shape),i=no(r,s,!0),o=Be(r,i),a=si(o),c=Ke(a,s),l=Ei(c),u=xe(re(i,l.shape),l);if(n){const d=Kn(u.shape,s);return re(u,d)}return u}const rS=J({logSumExp_:ATe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NTe(t,e){const n=V(t,"a","logicalAnd","bool"),r=V(e,"b","logicalAnd","bool");bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(yI,s)}const Ta=J({logicalAnd_:NTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Te(t){const n={x:V(t,"x","logicalNot","bool")};return te.runKernel(vI,n)}const sS=J({logicalNot_:_Te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Te(t,e){const n=V(t,"a","logicalOr","bool"),r=V(e,"b","logicalOr","bool");bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(bI,s)}const oR=J({logicalOr_:$Te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RTe(t,e){const n=V(t,"a","logicalXor","bool"),r=V(e,"b","logicalXor","bool");return bt(n.shape,r.shape),Ta(oR(t,e),sS(Ta(t,e)))}const Iq=J({logicalXor_:RTe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gb=2147483648;function OTe(t,e,n="left"){const r=V(t,"sortedSequence","searchSorted"),s=V(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=s.shape[s.shape.length-1],a=re(r,[-1,i]),c=re(s,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(me(c.shape)>=gb)throw new Error(`values tensor size must less than ${gb}`);if(a.shape[1]>=gb)throw new Error(`trailing dim_size must less than ${gb} for int32 output type, was ${a.shape[1]}`);const l={sortedSequence:a,values:c},u={side:n};return te.runKernel(_$,l,u)}const aR=J({searchSorted_:OTe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(t,e){return aR(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DTe(t,e,n,r,s){const i=V(t,"x","maxPool"),o=1;let a=i,c=!1;i.rank===3&&(c=!0,a=re(i,[1,i.shape[0],i.shape[1],i.shape[2]])),U(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),U(Vr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),gs("maxPool",r,s);const l={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=te.runKernel(II,l,u);return c?re(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const iS=J({maxPool_:DTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FTe(t,e=[1,1,1],n,r,s,i="NDHWC"){const o=V(t,"x","maxPool3d");let a=o,c=!1;o.rank===4&&(c=!0,a=re(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),U(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),U(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),gs("maxPool3d",r,s);const l={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:i},d=te.runKernel(SI,l,u);return c?re(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Sq=J({maxPool3d_:FTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LTe(t,e,n,r,s=!1){const o={x:V(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},c=te.runKernel(g$,o,a);return{result:c[0],indexes:c[1]}}const BTe=J({maxPoolWithArgmax_:LTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MTe(t,e){let n=V(t,"a","maximum"),r=V(e,"b","maximum");[n,r]=Un(n,r),n.dtype==="bool"&&(n=Fe(n,"int32"),r=Fe(r,"int32")),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(j0,s)}const Tc=J({maximum_:MTe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTe(t,e=null,n=!1){const s={x:V(t,"x","mean")},i={axis:e,keepDims:n};return te.runKernel(kI,s,i)}const Mn=J({mean_:zTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(t,e="float32"){if(Ni(t),e==="complex64"){const r=cr(t,"float32"),s=cr(t,"float32");return kl(r,s)}const n=Jr(me(t),e);return te.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zs(t,e="float32"){if(Ni(t),e==="complex64"){const r=Zs(t,"float32"),s=cr(t,"float32");return kl(r,s)}const n=M_(me(t),e);return te.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UTe(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=V(t,"x","meshgrid",t instanceof Yt?t.dtype:"float32");if(e===void 0)return[r];let s=V(e,"y","meshgrid",e instanceof Yt?e.dtype:"float32");const i=me(r.shape),o=me(s.shape);return n==="xy"?(r=re(r,[1,-1]),s=re(s,[-1,1]),[$t(Zs([o,1],r.dtype),r),$t(s,Zs([1,i],s.dtype))]):(r=re(r,[-1,1]),s=re(s,[1,-1]),[$t(r,Zs([1,o],r.dtype)),$t(Zs([i,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTe(t,e){let n=V(t,"a","minimum"),r=V(e,"b","minimum");[n,r]=Un(n,r),n.dtype==="bool"&&(n=Fe(n,"int32"),r=Fe(r,"int32")),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(H0,s)}const ld=J({minimum_:VTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTe(t,e,n){U(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=V(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");U(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)U(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),U(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return te.runKernel(CI,o,i)}const kq=J({mirrorPad_:jTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(t,e){let n=V(t,"a","mod"),r=V(e,"b","mod");[n,r]=Un(n,r);const s={a:n,b:r};return te.runKernel(W0,s)}const Eq=J({mod_:HTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WTe(t,e=null,n=!1){t=V(t,"x","moments");const r=Nt(e,t.shape),s=Mn(t,r,n);let i=s.shape;n||(i=Kn(s.shape,r));const o=on(Be(Fe(t,"float32"),re(s,i))),a=Mn(o,r,n);return{mean:s,variance:a}}const oS=J({moments_:WTe});function GTe(t,e,n,r){const s=V(e,"data","multiRNNCell"),i=Ax(n,"c","multiRNNCell"),o=Ax(r,"h","multiRNNCell");let a=s;const c=[];for(let d=0;d<t.length;d++){const h=t[d](a,i[d],o[d]);c.push(h[0]),c.push(h[1]),a=h[1]}const l=[],u=[];for(let d=0;d<c.length;d+=2)l.push(c[d]),u.push(c[d+1]);return[l,u]}const qTe=J({multiRNNCell_:GTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KTe(t,e,n,r=!1){const s=V(t,"logits","multinomial"),i=s.size,o=s.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const c={logits:o===1?re(s,[1,-1]):s},l={numSamples:e,seed:n,normalized:r},u=te.runKernel(y$,c,l);return o===1?re(u,[u.size]):u}const XTe=J({multinomial_:KTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QTe(t,e){let n=V(t,"a","notEqual","string_or_numeric"),r=V(e,"b","notEqual","string_or_numeric");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r};return te.runKernel(AI,s)}const Sh=J({notEqual_:QTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YTe(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:V(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return te.runKernel(_I,o,a)}const cR=J({oneHot_:YTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZTe(t){const n={x:V(t,"x","onesLike")};return te.runKernel(NI,n)}const Ci=J({onesLike_:ZTe});function JTe(t,e){const n=V(t,"v1","outerProduct"),r=V(e,"v2","outerProduct");U(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=re(n,[-1,1]),i=re(r,[1,-1]);return $t(s,i)}const eAe=J({outerProduct_:JTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tAe(t,e,n=0){const r=V(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},i={x:r};return te.runKernel(RI,i,s)}const Hl=J({pad_:tAe});function nAe(t,e,n=0){return U(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Hl(t,[e],n)}const rAe=J({pad1d_:nAe});function sAe(t,e,n=0){return U(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Hl(t,e,n)}const iAe=J({pad2d_:sAe});function oAe(t,e,n=0){return U(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Hl(t,e,n)}const aAe=J({pad3d_:oAe});function cAe(t,e,n=0){return U(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Hl(t,e,n)}const lAe=J({pad4d_:cAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uAe(t,e,n){const r=V(t,"x","spaceToBatchND");U(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),U(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),U(r.shape.reduce((o,a,c)=>c>0&&c<=e.length?o&&(a+n[c-1][0]+n[c-1][1])%e[c-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:n};return te.runKernel(VI,s,i)}const aS=J({spaceToBatchND_:uAe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dAe(t,e,n,r,s,i,o){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=V(t,"x","maxPool");let c=a,l=!1;a.rank===3&&(l=!0,c=re(a,[1,a.shape[0],a.shape[1],a.shape[2]])),U(Vr(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=co(c.shape,e,i,s,r),d=[u.dilationHeight,u.dilationWidth];let h;r==="same"?h=hAe([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const m=d[0]===1&&d[1]===1,[g,v]=fAe([u.inHeight,u.inWidth],d,h),y=m?r:"valid",w=m?c:aS(c,d,g),S=(n==="avg"?()=>QI(w,e,i,y,o):()=>iS(w,e,i,y,o))(),k=m?S:YI(S,d,v);return l?re(k,[k.shape[1],k.shape[2],k.shape[3]]):k}function fAe(t,e,n){const r=n.map(u=>u[0]),s=n.map(u=>u[1]),i=t.concat(r,s),o=e.map((u,d)=>(u-i[d]%u)%u),a=s.map((u,d)=>u+o[d]),c=e.map((u,d)=>[r[d],a[d]]),l=e.map((u,d)=>[0,o[d]]);return[c,l]}function hAe(t,e){const r=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),s=r.map(o=>Math.floor(o/2)),i=r.map((o,a)=>o-s[a]);return r.map((o,a)=>[s[a],i[a]])}const Cq=J({pool_:dAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pAe(t,e){const n=V(t,"x","prelu"),r=V(e,"alpha","prelu"),s={x:n,alpha:r};return te.runKernel(OI,s)}const cS=J({prelu_:pAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mAe(t,e=null,n=!1){let r=V(t,"x","prod");r.dtype==="bool"&&(r=Fe(r,"int32"));const s={x:r},i={axis:e,keepDims:n};return te.runKernel(PI,s,i)}const Tq=J({prod_:mAe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gAe(t,e,n,r){const s=t.map((u,d)=>V(u,`tensors${d}`,"raggedGather","int32")),i=V(e,"paramsDenseValues","raggedGather"),o=V(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:i,indices:o},c={outputRaggedRank:r},l=te.runKernel(x$,a,c);return{outputNestedSplits:l.slice(0,l.length-1),outputDenseValues:l[l.length-1]}}const yAe=J({raggedGather_:gAe});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vAe(t,e,n){const r=V(t,"starts","raggedRange"),s=V(e,"limits","raggedRange",r.dtype),i=V(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:s,deltas:i},a=te.runKernel(I$,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const bAe=J({raggedRange_:vAe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wAe(t,e,n,r,s){const i=V(t,"shape","raggedTensorToTensor","int32"),o=V(e,"values","raggedTensorToTensor"),a=V(n,"defaultValue","raggedTensorToTensor",o.dtype),c=r.map((d,h)=>V(d,`tensors${h}`,"raggedTensorToTensor","int32")),l={shape:i,values:o,defaultValue:a,rowPartitionTensors:c},u={rowPartitionTypes:s};return te.runKernel(S$,l,u)}const xAe=J({raggedTensorToTensor_:wAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAe(t,e,n){Ni(t);const r=me(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)s[i]=e();return te.makeTensor(s,t,n)}const SAe=J({rand_:IAe});var qb={exports:{}},kAe=qb.exports,KM;function EAe(){return KM||(KM=1,(function(t){(function(e,n,r){function s(c){var l=this,u=a();l.next=function(){var d=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=d|0)},l.c=1,l.s0=u(" "),l.s1=u(" "),l.s2=u(" "),l.s0-=u(c),l.s0<0&&(l.s0+=1),l.s1-=u(c),l.s1<0&&(l.s1+=1),l.s2-=u(c),l.s2<0&&(l.s2+=1),u=null}function i(c,l){return l.c=c.c,l.s0=c.s0,l.s1=c.s1,l.s2=c.s2,l}function o(c,l){var u=new s(c),d=l&&l.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var c=4022871197,l=function(u){u=String(u);for(var d=0;d<u.length;d++){c+=u.charCodeAt(d);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=o:this.alea=o})(kAe,t)})(qb)),qb.exports}var Kb={exports:{}},CAe=Kb.exports,XM;function TAe(){return XM||(XM=1,(function(t){(function(e,n,r){function s(a){var c=this,l="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var d=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^d^d>>>8},a===(a|0)?c.x=a:l+=a;for(var u=0;u<l.length+64;u++)c.x^=l.charCodeAt(u)|0,c.next()}function i(a,c){return c.x=a.x,c.y=a.y,c.z=a.z,c.w=a.w,c}function o(a,c){var l=new s(a),u=c&&c.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var h=l.next()>>>11,m=(l.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},d.int32=l.next,d.quick=d,u&&(typeof u=="object"&&i(u,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(CAe,t)})(Kb)),Kb.exports}var Xb={exports:{}},AAe=Xb.exports,QM;function NAe(){return QM||(QM=1,(function(t){(function(e,n,r){function s(a){var c=this,l="";c.next=function(){var d=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(d^d<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,a===(a|0)?c.x=a:l+=a;for(var u=0;u<l.length+64;u++)c.x^=l.charCodeAt(u)|0,u==l.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(a,c){return c.x=a.x,c.y=a.y,c.z=a.z,c.w=a.w,c.v=a.v,c.d=a.d,c}function o(a,c){var l=new s(a),u=c&&c.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var h=l.next()>>>11,m=(l.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},d.int32=l.next,d.quick=d,u&&(typeof u=="object"&&i(u,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(AAe,t)})(Xb)),Xb.exports}var Qb={exports:{}},_Ae=Qb.exports,YM;function $Ae(){return YM||(YM=1,(function(t){(function(e,n,r){function s(a){var c=this;c.next=function(){var u=c.x,d=c.i,h,m;return h=u[d],h^=h>>>7,m=h^h<<24,h=u[d+1&7],m^=h^h>>>10,h=u[d+3&7],m^=h^h>>>3,h=u[d+4&7],m^=h^h<<7,h=u[d+7&7],h=h^h<<13,m^=h^h<<9,u[d]=m,c.i=d+1&7,m};function l(u,d){var h,m=[];if(d===(d|0))m[0]=d;else for(d=""+d,h=0;h<d.length;++h)m[h&7]=m[h&7]<<15^d.charCodeAt(h)+m[h+1&7]<<13;for(;m.length<8;)m.push(0);for(h=0;h<8&&m[h]===0;++h);for(h==8?m[7]=-1:m[h],u.x=m,u.i=0,h=256;h>0;--h)u.next()}l(c,a)}function i(a,c){return c.x=a.x.slice(),c.i=a.i,c}function o(a,c){a==null&&(a=+new Date);var l=new s(a),u=c&&c.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var h=l.next()>>>11,m=(l.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},d.int32=l.next,d.quick=d,u&&(u.x&&i(u,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(_Ae,t)})(Qb)),Qb.exports}var Yb={exports:{}},RAe=Yb.exports,ZM;function OAe(){return ZM||(ZM=1,(function(t){(function(e,n,r){function s(a){var c=this;c.next=function(){var u=c.w,d=c.X,h=c.i,m,g;return c.w=u=u+1640531527|0,g=d[h+34&127],m=d[h=h+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,g=d[h]=g^m,c.i=h,g+(u^u>>>16)|0};function l(u,d){var h,m,g,v,y,w=[],x=128;for(d===(d|0)?(m=d,d=null):(d=d+"\0",m=0,x=Math.max(x,d.length)),g=0,v=-32;v<x;++v)d&&(m^=d.charCodeAt((v+32)%d.length)),v===0&&(y=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,v>=0&&(y=y+1640531527|0,h=w[v&127]^=m+y,g=h==0?g+1:0);for(g>=128&&(w[(d&&d.length||0)&127]=-1),g=127,v=512;v>0;--v)m=w[g+34&127],h=w[g=g+1&127],m^=m<<13,h^=h<<17,m^=m>>>15,h^=h>>>12,w[g]=m^h;u.w=y,u.X=w,u.i=g}l(c,a)}function i(a,c){return c.i=a.i,c.w=a.w,c.X=a.X.slice(),c}function o(a,c){a==null&&(a=+new Date);var l=new s(a),u=c&&c.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var h=l.next()>>>11,m=(l.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},d.int32=l.next,d.quick=d,u&&(u.X&&i(u,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(RAe,t)})(Yb)),Yb.exports}var Zb={exports:{}},PAe=Zb.exports,JM;function DAe(){return JM||(JM=1,(function(t){(function(e,n,r){function s(a){var c=this,l="";c.next=function(){var d=c.b,h=c.c,m=c.d,g=c.a;return d=d<<25^d>>>7^h,h=h-m|0,m=m<<24^m>>>8^g,g=g-d|0,c.b=d=d<<20^d>>>12^h,c.c=h=h-m|0,c.d=m<<16^h>>>16^g,c.a=g-d|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,a===Math.floor(a)?(c.a=a/4294967296|0,c.b=a|0):l+=a;for(var u=0;u<l.length+20;u++)c.b^=l.charCodeAt(u)|0,c.next()}function i(a,c){return c.a=a.a,c.b=a.b,c.c=a.c,c.d=a.d,c}function o(a,c){var l=new s(a),u=c&&c.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var h=l.next()>>>11,m=(l.next()>>>0)/4294967296,g=(h+m)/(1<<21);while(g===0);return g},d.int32=l.next,d.quick=d,u&&(typeof u=="object"&&i(u,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(PAe,t)})(Zb)),Zb.exports}var Jb={exports:{}};const FAe={},LAe=Object.freeze(Object.defineProperty({__proto__:null,default:FAe},Symbol.toStringTag,{value:"Module"})),BAe=nJ(LAe);var MAe=Jb.exports,e4;function zAe(){return e4||(e4=1,(function(t){(function(e,n,r){var s=256,i=6,o=52,a="random",c=r.pow(s,i),l=r.pow(2,o),u=l*2,d=s-1,h;function m(k,E,A){var R=[];E=E==!0?{entropy:!0}:E||{};var N=w(y(E.entropy?[k,S(n)]:k??x(),3),R),P=new g(R),O=function(){for(var _=P.g(i),M=c,G=0;_<l;)_=(_+G)*s,M*=s,G=P.g(1);for(;_>=u;)_/=2,M/=2,G>>>=1;return(_+G)/M};return O.int32=function(){return P.g(4)|0},O.quick=function(){return P.g(4)/4294967296},O.double=O,w(S(P.S),n),(E.pass||A||function(_,M,G,q){return q&&(q.S&&v(q,P),_.state=function(){return v(P,{})}),G?(r[a]=_,M):_})(O,N,"global"in E?E.global:this==r,E.state)}function g(k){var E,A=k.length,R=this,N=0,P=R.i=R.j=0,O=R.S=[];for(A||(k=[A++]);N<s;)O[N]=N++;for(N=0;N<s;N++)O[N]=O[P=d&P+k[N%A]+(E=O[N])],O[P]=E;(R.g=function(_){for(var M,G=0,q=R.i,D=R.j,L=R.S;_--;)M=L[q=d&q+1],G=G*s+L[d&(L[q]=L[D=d&D+M])+(L[D]=M)];return R.i=q,R.j=D,G})(s)}function v(k,E){return E.i=k.i,E.j=k.j,E.S=k.S.slice(),E}function y(k,E){var A=[],R=typeof k,N;if(E&&R=="object")for(N in k)try{A.push(y(k[N],E-1))}catch{}return A.length?A:R=="string"?k:k+"\0"}function w(k,E){for(var A=k+"",R,N=0;N<A.length;)E[d&N]=d&(R^=E[d&N]*19)+A.charCodeAt(N++);return S(E)}function x(){try{var k;return h&&(k=h.randomBytes)?k=k(s):(k=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(k)),S(k)}catch{var E=e.navigator,A=E&&E.plugins;return[+new Date,e,A,e.screen,S(n)]}}function S(k){return String.fromCharCode.apply(0,k)}if(w(r.random(),n),t.exports){t.exports=m;try{h=BAe}catch{}}else r["seed"+a]=m})(typeof self<"u"?self:MAe,[],Math)})(Jb)),Jb.exports}var j2,t4;function UAe(){if(t4)return j2;t4=1;var t=EAe(),e=TAe(),n=NAe(),r=$Ae(),s=OAe(),i=DAe(),o=zAe();return o.alea=t,o.xor128=e,o.xorwow=n,o.xorshift7=r,o.xor4096=s,o.tychei=i,j2=o,j2}var lS=UAe();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lR{constructor(e,n,r,s,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=lS.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,i,o;do s=2*this.random()-1,i=2*this.random()-1,o=s*s+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class VAe{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const i=s||Math.random();this.randu=lS.alea(i.toString()),this.randn=new lR(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,i,o;for(;;){do s=this.randn.nextValue(),o=1+this.c*s;while(o<=0);if(o*=o*o,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class jAe{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=lS.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HAe(t,e,n=1,r="float32",s){if(Ni(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new VAe(e,n,r,s),o=kt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const WAe=J({randomGamma_:HAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GAe(t,e=0,n=1,r,s){if(Ni(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new lR(e,n,r,!1,s),o=kt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const uR=J({randomNormal_:GAe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qAe(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return uR(t,0,1,e,n)}const KAe=J({randomStandardNormal_:qAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(t,e=0,n=1,r="float32",s){Ni(t);const i=kt(t,r),o=new jAe(e,n,null,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Td=J({randomUniform_:XAe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QAe(t,e,n,r){return Td(t,e,n,"int32",r)}const YAe=J({randomUniformInt_:QAe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kh(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return te.runKernel(k$,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZAe(t){const n={input:V(t,"input","real")};return te.runKernel(E$,n)}const Bg=J({real_:ZAe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JAe(t){const n={x:V(t,"x","reciprocal")};return te.runKernel(K0,n)}const Aq=J({reciprocal_:JAe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNe(t){const n={x:V(t,"x","relu")};return te.runKernel(X0,n)}const Ra=J({relu_:eNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tNe(t){const n={x:V(t,"x","relu6")};return te.runKernel(Q0,n)}const dR=J({relu6_:tNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe(t,e){const r={x:V(t,"x","reverse")},s={dims:e};return te.runKernel(BI,r,s)}const oo=J({reverse_:nNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(t){const e=V(t,"x","reverse");return U(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),oo(e,0)}const sNe=J({reverse1d_:rNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iNe(t,e){const n=V(t,"x","reverse");return U(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),oo(n,e)}const oNe=J({reverse2d_:iNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aNe(t,e){const n=V(t,"x","reverse");return U(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),oo(n,e)}const cNe=J({reverse3d_:aNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(t,e){const n=V(t,"x","reverse");return U(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),oo(n,e)}const uNe=J({reverse4d_:lNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dNe(t){const n={x:V(t,"x","round")};return te.runKernel(Y0,n)}const fR=J({round_:dNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(t){const n={x:V(t,"x","rsqrt","float32")};return te.runKernel(Z0,n)}const hR=J({rsqrt_:fNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hNe(t){const n={x:V(t,"x","selu")};return te.runKernel(J0,n)}const pR=J({selu_:hNe});function pNe(t,e,n,r,s,i=[1,1],o="NHWC"){const a=V(t,"x","separableConv2d"),c=V(e,"depthwiseFilter","separableConv2d"),l=V(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=re(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),U(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),U(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),U(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),U(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const h=c.shape[2],m=c.shape[3];U(l.shape[2]===h*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*m}, but got ${l.shape[2]}.`);const g=my(u,c,r,s,o,i),y=Tl(g,l,1,"valid",o);return d?re(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const mR=J({separableConv2d_:pNe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mNe(t,e){const n=V(t,"x","setdiff1d"),r=V(e,"y","setdiff1d");U(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),U(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),U(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),i=await r.data(),o=new Set(i);let a=0;for(let u=0;u<s.length;u++)o.has(s[u])||a++;const c=new fr([a],n.dtype),l=new fr([a],"int32");for(let u=0,d=0;u<s.length;u++)o.has(s[u])||(c.values[d]=s[u],l.values[d]=u,d++);return[c.toTensor(),l.toTensor()]}const gNe=mNe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNe(t){const n={x:V(t,"x","sign")};return te.runKernel(ny,n)}const Nq=J({sign_:yNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNe(t){const n={x:V(t,"x","sin","float32")};return te.runKernel(ey,n)}const gR=J({sin_:vNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bNe(t){const n={x:V(t,"x","sinh")};return te.runKernel(ty,n)}const yR=J({sinh_:bNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wNe(t,e,n){const r=V(t,"x","slice1d");return U(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),at(r,[e],[n])}const uS=J({slice1d_:wNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xNe(t,e,n){const r=V(t,"x","slice2d");return U(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const vR=J({slice2d_:xNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function INe(t,e,n){const r=V(t,"x","slice3d");return U(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const dS=J({slice3d_:INe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNe(t,e,n){const r=V(t,"x","slice4d");return U(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),at(r,e,n)}const Mg=J({slice4d_:SNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kNe(t,e=-1){const n=V(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return te.runKernel(HI,r,s)}const fS=J({softmax_:kNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(t){U(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(o$,e)}const hS=J({fft_:ENe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNe(t){U(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(u$,e)}const zg=J({ifft_:CNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TNe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=re(t,[n,e]);r=zg(s)}else{const s=[n,2*(e-1)],i=re(Bg(t),[n,e]),o=re(eS(t),[n,e]),a=oo(at(i,[0,1],[n,e-2]),1),c=ee(oo(at(o,[0,1],[n,e-2]),1),rt(-1)),l=zn([i,a],1),u=zn([o,c],1),d=re(kl(l,u),[s[0],s[1]]);r=zg(d)}if(r=Bg(r),t.rank===3&&t.shape[0]!==0){const s=r,i=t.shape[0];r=re(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const bR=J({irfft_:TNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ANe(t,e,n=0){const s={x:V(t,"x","split")},i={numOrSizeSplits:e,axis:n};return te.runKernel(jI,s,i)}const ei=J({split_:ANe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(t,e){U(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const g=t.shape.map(y=>0),v=t.shape.map(y=>y);v[t.shape.length-1]=e,s=at(t,g,v),n=e}else if(e!=null&&e>n){const g=t.shape.map(v=>v);g[t.shape.length-1]=e-n,s=zn([t,cr(g)],t.shape.length-1),n=e}else s=t;const i=Bt(s),o=re(kl(s,i),[r,n]),a=hS(o),c=Math.floor(n/2)+1,l=Bg(a),u=eS(a),d=ei(l,[c,n-c],l.shape.length-1),h=ei(u,[c,n-c],u.shape.length-1),m=s.shape.slice();return m[s.shape.length-1]=c,re(kl(d[0],h[0]),m)}const pS=J({rfft_:NNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne(t,e){let n=V(t,"a","squaredDifference"),r=V(e,"b","squaredDifference");[n,r]=Un(n,r),bt(n.shape,r.shape);const s={a:n,b:r},i={};return te.runKernel(oy,s,i)}const wR=J({squaredDifference_:_Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(t,e){const n=V(t,"x","squeeze","string_or_numeric");return re(n,Ll(n.shape,e).newShape)}const Do=J({squeeze_:$Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RNe(t,e=0){const n=Ax(t,"tensors","stack","string_or_numeric");U(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&U(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return te.runKernel($I,r,s)}const ii=J({stack_:RNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(t,e=0){const r={x:V(t,"x","step")},s={alpha:e};return te.runKernel(dy,r,s)}const Zh=J({step_:ONe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PNe(t,e,n,r,s=0,i=0,o=0,a=0,c=0){const u={x:V(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:c};return te.runKernel(L$,u,d)}const _q=J({stridedSlice_:PNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNe(t){const n={x:V(t,"x","tan","float32")};return te.runKernel(cy,n)}const $q=J({tan_:DNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(t,e){Gh(t);const n=Ml(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return zl(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bu(t,e,n){if(Gh(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Ml(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return zl(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t,e,n){if(Gh(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Ml(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return zl(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t,e,n){if(Gh(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Ml(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return zl(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(t,e,n){if(Gh(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Ml(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return zl(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(t,e,n){if(Gh(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Ml(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,zl(t,e,r,n)}function Oq(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(i+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(i+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(i+` update.rank != ${s+t.length-r}`);for(let o=0;o<s;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-s;++o)if(n.shape[o+s]!==t[o+r])throw new Error(i+` updates.shape[${o+s}] (${n.shape[o+s]}) != shape[${o+s}] (${t[o+s]})`)}function xR(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}Oq(n,e,t)}function Ad(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=s;d<i;++d)o*=n[d];const a=s<1?1:s,c=me(e.shape)/a,l=[...nt(n.slice(0,s)),1],u=me(n);return{sliceRank:s,numUpdates:c,sliceSize:o,strides:l,outputSize:u}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNe(t,e,n){const r=V(t,"tensor","tensorScatterupdate"),s=V(e,"indices","tensorScatterupdate","int32"),i=V(n,"updates","tensorScatterupdate");if(xR(i,s,r.shape),r.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${i.dtype}.`);const o={tensor:r,indices:s,updates:i},a={};return te.runKernel(N$,o,a)}const zNe=J({tensorScatterUpdate_:MNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(t,e=1,n=!0){const r=V(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[a,c]=te.runKernel(U$,i,o);return{values:a,indices:c}}const Pq=J({topk_:UNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(t,e=0,n=1,r,s){if(Ni(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new lR(e,n,r,!0,s),o=kt(t,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const IR=J({truncatedNormal_:VNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t,e=0){const n=V(t,"x","unique","string_or_numeric");U(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[i,o]=te.runKernel(j$,r,s);return{values:i,indices:o}}const Dq=J({unique_:jNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HNe(t,e,n){const r=V(t,"x","unsortedSegmentSum"),s=V(e,"segmentIds","unsortedSegmentSum","int32");U(bh(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},o={numSegments:n};return te.runKernel(qI,i,o)}const SR=J({unsortedSegmentSum_:HNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNe(t,e=0){const n=V(t,"x","unstack","string_or_numeric");U(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return te.runKernel(GI,r,s)}const ao=J({unstack_:WNe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(t,e){return aR(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(t,e=!0,n,r){return te.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kR(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=kt(t,"int32"),s=kt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),a=i*t.length;s.values.set(o,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qNe(t){const e=V(t,"condition","whereAsync","bool"),n=await e.data(),r=kR(e.shape,n);return t!==e&&e.dispose(),r}const Lq=qNe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function KNe(t,e,n){const r=V(t,"tensor","boolMask"),s=V(e,"mask","boolMask","bool"),i=n??0,o=s.rank,a=r.shape;U(o>0,()=>"mask cannot be scalar"),ci(a.slice(i,i+o),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let v=i;v<i+o;v++)c*=a[v];const l=a.slice(0,i).concat([c],a.slice(i+o)),u=re(r,l),d=re(s,[-1]),h=await Lq(d),m=Do(h,[1]),g=by(u,m,i);return t!==r&&r.dispose(),e!==s&&s.dispose(),m.dispose(),u.dispose(),d.dispose(),h.dispose(),g}const XNe=KNe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNe(t,e,n){const r=V(t,"x","transpose");if(e==null&&(e=r.shape.map((o,a)=>a).reverse()),U(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{U(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?ae(()=>{let o=Bg(r),a=eS(r);return o=te.runKernel(qf,{x:o},i),a=te.runKernel(qf,{x:a},i),n&&(a=gn(a)),kl(o,a)}):te.runKernel(qf,s,i)}const Lt=J({transpose_:QNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(t,e,n,r,s=!0){const i=V(t,"v","movingAverage"),o=V(e,"x","movingAverage"),a=V(n,"decay","movingAverage");LEe(i,o),U(Dt(i.shape,o.shape),()=>"Shape mismatch in v and x");const c=rt(1),l=Be(c,a);let u=ee(Be(o,i),l);if(s){U(r!=null,()=>"When using zeroDebias: true, step is required.");const d=V(r,"step","movingAverage");u=We(u,Be(c,gc(a,d)))}return xe(i,u)}const ZNe=J({movingAverage_:YNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(t,e,n){Ni(n);const r=V(t,"indices","scatterND","int32"),s=V(e,"updates","scatterND");xR(s,r,n);const i={indices:r,updates:s},o={shape:n};return te.runKernel(A$,i,o)}const e_e=J({scatterND_:JNe});function t_e(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_e(t,e,n,r=0){Ni(n);const s=V(t,"sparseIndices","sparseToDense","int32"),i=V(e,"sparseValues","sparseToDense","string_or_numeric"),o=V(r,"defaultValue","sparseToDense",i.dtype);t_e(s,i,n,o);const a={sparseIndices:s,sparseValues:i,defaultValue:o},c={outputShape:n};return te.runKernel(D$,a,c)}const r_e=J({sparseToDense_:n_e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_e(t,e){const n=V(e,"indices","gatherND","int32"),s={params:V(t,"x","gatherND","string_or_numeric"),indices:n};return te.runKernel(l$,s)}const i_e=J({gatherND_:s_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(t,e){if(e==null)return t.shape.slice();if(Dt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_e(t,e,n,r){const s=V(t,"x","dropout");if(U(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),U(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Yt?s.clone():s;const i=o_e(s,n),o=1-e,a=We(vy(xe(Td(i,0,1,"float32",r),o)),o);return ee(s,a)}const Bq=J({dropout_:a_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function ER(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);s[i]=e-n*Math.cos(o)}return Ir(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function c_e(t,e,n=1){const r=V(t,"predictions","inTopK"),s=V(e,"targets","inTopK");U(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),U(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),ci(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];U(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),a=await s.data(),[c,l]=[o.length/i,i],u=Mr("bool",c);for(let d=0;d<c;d++){const h=d*l,m=o.subarray(h,h+l),g=[];for(let v=0;v<m.length;v++)g.push({value:m[v],index:v});g.sort((v,y)=>y.value-v.value),u[d]=0;for(let v=0;v<n;v++)if(g[v].index===a[d]){u[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),Oo(u,s.shape,"bool")}const l_e=c_e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(t,e,n,r,s,i="NHWC",o){let a=t;t.rank===3&&(a=re(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=re(e,[1,e.shape[0],e.shape[1],e.shape[2]])),U(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),U(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),U(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const l=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?c.shape[3]:c.shape[1];U(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),U(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),gs("conv2dDerFilter",s,o);const d={x:a,dy:c},h={strides:r,pad:s,dataFormat:i,dimRoundingMode:o,filterShape:n};return te.runKernel(K_,d,h)}const CR=J({conv2DBackpropFilter_:u_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return ee(t,Zh(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function gS(t,e){let n=e;const r=gr(t.shape,e.shape);return r.length>0&&(n=Ke(n,r)),re(n,t.shape)}function yS(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Ra(t);if(e==="elu")return gy(t);if(e==="relu6")return dR(t);if(e==="prelu")return cS(t,n);if(e==="leakyrelu")return tS(t,r);if(e==="sigmoid")return Po(t);throw new Error(`Unknown fused activation ${e}.`)}const vS=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:u}){if(c=c||"linear",vS(te.state.gradientDepth,c)===!1){U(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let A=Tl(t,e,n,r,s,i,o);return a!=null&&(A=xe(A,a)),yS(A,c,l,u)}const d=V(t,"x","conv2d","float32"),h=V(e,"filter","conv2d","float32");let m=d,g=!1;d.rank===3&&(g=!0,m=re(d,[1,d.shape[0],d.shape[1],d.shape[2]])),U(m.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${m.rank}.`),U(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),gs("fused conv2d",r,o);const v=s==="NHWC"?m.shape[3]:m.shape[1];U(h.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${h.shape[2]}.`),U(Vr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const y=Er(m.shape,h.shape,n,i,r,o);let w;a!=null&&(w=V(a,"bias","fused conv2d"),[w]=Un(w,d),s==="NHWC"?bt(y.outShape,w.shape):(U(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),U(w.shape.length===0||w.shape[0]===y.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(l!=null){const A=l.shape;if(U(A.length<=1||A.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${A.length}.`),A.length===1)U(A[0]===1||A[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the number of output channels (${y.outChannels}).`);else if(A.length===3)try{bt(A,y.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(N)}x=V(l,"prelu weights","fused conv2d")}const S=(A,R)=>{U(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[N,P,O,_]=R,M=mS(A,O,c);U(Cl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const G=Z$(P.shape,M,N,n,r),q=CR(P,M,N.shape,n,r),D=[G,q];if(_!=null){const L=gS(_,M);D.push(L)}return D},k={x:m,filter:h,bias:w,preluActivationWeights:x},E={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:u};return a==null?yc((R,N,P)=>{let O=te.runKernel(kx,k,E);return P([N,R,O]),g&&(O=re(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:S}})(m,h):yc((R,N,P,O)=>{let _=te.runKernel(kx,k,E);return O([N,R,_,P]),g&&(_=re(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:S}})(m,h,w)}const zq=J({fusedConv2d_:d_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(t,e,n,r,s,i=[1,1],o){let a=t;t.rank===3&&(a=re(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=re(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={x:a,dy:c},u={strides:r,pad:s,dimRoundingMode:o,dilations:i,filterShape:n};return te.runKernel(t$,l,u)}const Uq=J({depthwiseConv2dNativeBackpropFilter_:f_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_e(t,e,n,r,s,i=[1,1],o){let a=e,c=!1;e.rank===3&&(c=!0,a=re(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={dy:a,filter:n},u={strides:r,pad:s,dimRoundingMode:o,dilations:i,inputShape:t},d=te.runKernel(n$,l,u);return c?re(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Vq=J({depthwiseConv2dNativeBackpropInput_:h_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_e({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:u}){if(vS(te.state.gradientDepth,c)===!1){let E=my(t,e,n,r,s,i,o);return a!=null&&(E=xe(E,a)),yS(E,c,l,u)}const d=V(t,"x","depthwiseConv2d","float32"),h=V(e,"filter","depthwiseConv2d","float32");let m=d,g=!1;d.rank===3&&(g=!0,m=re(d,[1,d.shape[0],d.shape[1],d.shape[2]])),U(m.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),U(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),U(m.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${m.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),i==null&&(i=[1,1]),U(Vr(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),gs("fused depthwiseConv2d",r,o);const v=Er(m.shape,h.shape,n,i,r,o,!0);let y;a!=null&&(y=V(a,"bias","fused conv2d"),[y]=Un(y,d),bt(v.outShape,y.shape));let w;l!=null&&(w=V(l,"prelu weights","fused depthwiseConv2d"));const x=(E,A)=>{U(Cl(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[R,N,P,O]=A,_=mS(E,P,c),M=Vq(N.shape,_,R,n,r,i,o),G=Uq(N,_,R.shape,n,r,i,o);if(O!=null){const q=gS(y,_);return[M,G,q]}return[M,G]},S={x:m,filter:h,bias:y,preluActivationWeights:w},k={strides:n,pad:r,dataFormat:s,dilations:i,dimRoundingMode:o,activation:c,leakyreluAlpha:u};return a==null?yc((A,R,N)=>{let P=te.runKernel(Ex,S,k);return N([R,A,P]),g&&(P=re(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:x}})(m,h):yc((A,R,N,P)=>{let O=te.runKernel(Ex,S,k);return P([R,A,O,N]),g&&(O=re(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:x}})(m,h,y)}const m_e=J({fusedDepthwiseConv2d_:p_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(vS(te.state.gradientDepth,i)===!1){let _=$t(t,e,n,r);return s!=null&&(_=xe(_,s)),yS(_,i,o,a)}let c=V(t,"a","fused matMul"),l=V(e,"b","fused matMul");[c,l]=Un(c,l);const u=n?c.shape[c.rank-2]:c.shape[c.rank-1],d=r?l.shape[l.rank-1]:l.shape[l.rank-2],h=n?c.shape[c.rank-1]:c.shape[c.rank-2],m=r?l.shape[l.rank-2]:l.shape[l.rank-1],g=c.shape.slice(0,-2),v=l.shape.slice(0,-2),y=me(g),w=me(v);U(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${c.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=bt(c.shape.slice(0,-2),l.shape.slice(0,-2)).concat([h,m]),k=n?re(c,[y,u,h]):re(c,[y,h,u]),E=r?re(l,[w,m,d]):re(l,[w,d,m]);let A;s!=null&&(A=V(s,"bias","fused matMul"),[A]=Un(A,c),bt(S,A.shape));let R;o!=null&&(R=V(o,"prelu weights","fused matMul"));const N=(_,M)=>{const[G,q,D,L]=M,K=mS(re(_,D.shape),D,i);let j,W;if(!n&&!r?(j=$t(K,q,!1,!0),W=$t(G,K,!0,!1)):!n&&r?(j=$t(K,q,!1,!1),W=$t(K,G,!0,!1)):n&&!r?(j=$t(q,K,!1,!0),W=$t(G,K,!1,!1)):(j=$t(q,K,!0,!0),W=$t(K,G,!0,!0)),s!=null){const X=gS(L,K);return[j,W,X]}else return[j,W]},P={a:k,b:E,bias:A,preluActivationWeights:R},O={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return s==null?yc((M,G,q)=>{const D=te.runKernel(Sx,P,O);return q([M,G,D]),{value:re(D,S),gradFunc:N}})(k,E):yc((M,G,q,D)=>{const L=te.runKernel(Sx,P,O);return D([M,G,L,q]),{value:re(L,S),gradFunc:N}})(k,E,A)}const tA=J({fusedMatMul_:g_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_e=Object.freeze(Object.defineProperty({__proto__:null,conv2d:zq,depthwiseConv2d:m_e,matMul:tA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_e(t){return ER(t,.54,.46)}const b_e=J({hammingWindow_:v_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_e(t){return ER(t,.5,.5)}const jq=J({hannWindow_:w_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_e(t,e,n,r=!1,s=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(at(t,i,e)),i+=n;if(r)for(;i<t.size;){const a=i+e-t.size,c=zn([at(t,i,e-a),Qh([a],s)]);o.push(c),i+=n}return o.length===0?Bu([],[0,e]):re(zn(o),[o.length,e])}const Hq=J({frame_:x_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_e(t,e,n,r,s=jq){r==null&&(r=Mq(e));const i=Hq(t,e,n),o=ee(i,s(e));return pS(o,r)}const S_e=J({stft_:I_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_e(t,e,n,r,s="bilinear",i=0){const o=V(t,"image","cropAndResize"),a=V(e,"boxes","cropAndResize","float32"),c=V(n,"boxInd","cropAndResize","int32"),l=a.shape[0];U(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),U(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),U(c.rank===1&&c.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),U(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),U(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),U(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:o,boxes:a,boxInd:c},d={method:s,extrapolationValue:i,cropSize:r};return te.runKernel(Z_,u,d)}const E_e=J({cropAndResize_:k_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_e(t){const e=V(t,"image","flipLeftRight","float32");U(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return te.runKernel(c$,n,{})}const T_e=J({flipLeftRight_:C_e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_e(t){const e=V(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];U(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),U(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Qi(e,s)}const N_e=J({grayscaleToRGB_:A_e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __e(t){const e=V(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];U(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),U(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,i=Fe(e,"float32"),o=Ir([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Rf("ij,j->i",i,o);break;case 3:a=Rf("ijk,k->ij",i,o);break;case 4:a=Rf("ijkl,l->ijk",i,o);break;case 5:a=Rf("ijklm,m->ijkl",i,o);break;case 6:a=Rf("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Qr(a,-1),Fe(a,s)}const $_e=J({rgbToGrayscale_:__e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(t,e,n=0,r=.5){const s=V(t,"image","rotateWithOffset","float32");U(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},o={radians:e,fillValue:n,center:r};return te.runKernel(H$,i,o)}const O_e=J({rotateWithOffset_:R_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jh(t,e,n,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),U(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),U(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),U(e.rank===1,()=>"scores must be a 1D tensor"),U(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),U(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=V(t,"boxes","nonMaxSuppression","float32"),o=V(e,"scores","nonMaxSuppression","float32"),a=Jh(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return te.runKernel(v$,{boxes:i,scores:o},c)}const D_e=J({nonMaxSuppression_:P_e});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_e(t,e,n){const r=L_e(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function L_e(t,e,n){return M_e(t,e,n||B_e)}function B_e(t,e){return t>e?1:t<e?-1:0}function M_e(t,e,n){let r=0,s=t.length,i=0,o=!1;for(;r<s;){i=r+(s-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(s=i,o=!a)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TR(t,e,n,r,s){return _R(t,e,n,r,s,0)}function AR(t,e,n,r,s,i){return _R(t,e,n,r,s,0,!1,i,!0)}function NR(t,e,n,r,s,i){return _R(t,e,n,r,s,i,!0)}function _R(t,e,n,r,s,i,o=!1,a=!1,c=!1){const l=[];for(let y=0;y<e.length;y++)e[y]>s&&l.push({score:e[y],boxIndex:y,suppressBeginIndex:0});l.sort(n4);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&l.length>0;){const y=l.pop(),{score:w,boxIndex:x,suppressBeginIndex:S}=y;if(w<s)break;let k=!1;for(let E=d.length-1;E>=S;--E){const A=z_e(t,x,d[E]);if(A>=r){k=!0;break}if(y.score=y.score*U_e(r,u,A),y.score<=s)break}y.suppressBeginIndex=d.length,k||(y.score===w?(d.push(x),h.push(y.score)):y.score>s&&F_e(l,y,n4))}const m=d.length,g=n-m;a&&g>0&&(d.push(...new Array(g).fill(0)),h.push(...new Array(g).fill(0)));const v={selectedIndices:d};return o&&(v.selectedScores=h),c&&(v.validOutputs=m),v}function z_e(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),h=Math.max(s[1],s[3]),m=(a-i)*(c-o),g=(d-l)*(h-u);if(m<=0||g<=0)return 0;const v=Math.max(i,l),y=Math.max(o,u),w=Math.min(a,d),x=Math.min(c,h),S=Math.max(w-v,0)*Math.max(x-y,0);return S/(m+g-S)}function U_e(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function n4(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function V_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const i=V(t,"boxes","nonMaxSuppressionAsync"),o=V(e,"scores","nonMaxSuppressionAsync"),a=Jh(i,o,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const c=await Promise.all([i.data(),o.data()]),l=c[0],u=c[1],{selectedIndices:d}=TR(l,u,n,r,s);return i!==t&&i.dispose(),o!==e&&o.dispose(),Ir(d,"int32")}const j_e=V_e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=V(t,"boxes","nonMaxSuppression"),a=V(e,"scores","nonMaxSuppression"),c=Jh(o,a,n,r,s,i);n=c.maxOutputSize,r=c.iouThreshold,s=c.scoreThreshold,i=c.softNmsSigma;const l={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},d=te.runKernel(w$,l,u);return{selectedIndices:d[0],selectedScores:d[1]}}const W_e=J({nonMaxSuppressionWithScore_:H_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function G_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const o=V(t,"boxes","nonMaxSuppressionAsync"),a=V(e,"scores","nonMaxSuppressionAsync"),c=Jh(o,a,n,r,s,i);n=c.maxOutputSize,r=c.iouThreshold,s=c.scoreThreshold,i=c.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),u=l[0],d=l[1],{selectedIndices:h,selectedScores:m}=NR(u,d,n,r,s,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ir(h,"int32"),selectedScores:Ir(m)}}const q_e=G_e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=V(t,"boxes","nonMaxSuppression"),a=V(e,"scores","nonMaxSuppression"),c=Jh(o,a,n,r,s,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,h={boxes:o,scores:a},m={maxOutputSize:l,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},g=te.runKernel(b$,h,m);return{selectedIndices:g[0],validOutputs:g[1]}}const X_e=J({nonMaxSuppressionPadded_:K_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Q_e(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const o=V(t,"boxes","nonMaxSuppressionAsync"),a=V(e,"scores","nonMaxSuppressionAsync"),c=Jh(o,a,n,r,s,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,[h,m]=await Promise.all([o.data(),a.data()]),{selectedIndices:g,validOutputs:v}=AR(h,m,l,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Ir(g,"int32"),validOutputs:rt(v,"int32")}}const Y_e=Q_e;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_e(t,e,n=!1,r=!1){const s=V(t,"images","resizeBilinear");U(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),U(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),U(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=re(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},c={alignCorners:n,halfPixelCenters:r,size:e},l=te.runKernel(LI,a,c);return o?re(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Wq=J({resizeBilinear_:Z_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(t,e,n=!1,r=!1){const s=V(t,"images","resizeNearestNeighbor");U(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),U(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),U(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),U(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,o=!1;s.rank===3&&(o=!0,i=re(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:i},c={alignCorners:n,halfPixelCenters:r,size:e},l=te.runKernel(FI,a,c);return o?re(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Gq=J({resizeNearestNeighbor_:J_e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$e(t,e="binary",n=!1,r=.5){const s=V(t,"image","threshold"),i=.2989,o=.587,a=.114,c=s.shape[0]*s.shape[1];let l=ee(Ir([r]),255),u,d,h,m;if(U(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),U(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),U(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),U(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,d,h]=ei(s,[1,1,1],-1);const y=ee(u,i),w=ee(d,o),x=ee(h,a);m=xe(xe(y,w),x)}else m=t;if(e==="otsu"){const y=tq(Fe(fR(m),"int32"),Oo([]),256);l=t$e(y,c)}const g=n?Cd(m,l):li(m,l);return Fe(ee(g,255),"int32")}function t$e(t,e){let n=Ir([-1]),r=Ir([0]),s=Ir([0]),i,o,a,c,l,u;for(let d=0;d<t.size-1;d++){i=at(t,0,d+1),o=at(t,d+1),l=We(Ke(i),e),u=We(Ke(o),e);const h=Ke(ee(i,kh(0,i.size)));a=We(h,Ke(i));const m=Qh(o.shape,i.size),g=xe(kh(0,o.size),m),v=ee(o,g);c=We(Ke(v),Ke(o));const y=Be(a,c),w=Be(a,c),x=ee(l,u);s=ee(ee(x,y),w);const S=li(s,r);r=Zr(S,s,r),n=Zr(S,Ir([d]),n)}return n}const n$e=J({threshold_:e$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$e(t,e,n="nearest",r="constant",s=0,i){const o=V(t,"image","transform","float32"),a=V(e,"transforms","transform","float32");U(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),U(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),U(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const c={image:o,transforms:a},l={interpolation:n,fillMode:r,fillValue:s,outputShape:i};return te.runKernel(V$,c,l)}const s$e=J({transform_:r$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$e(t,e,n){const r=V(t,"a","bandPart");U(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,o]=r.shape.slice(-2);let a,c;typeof e=="number"?(U(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),U(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=V(e<0?i:e,"numLower","bandPart")):(U(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Zr(Lg(e,0),i,ld(e,i))),typeof n=="number"?(U(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),U(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),c=V(n<0?o:n,"numUpper","bandPart")):(U(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=Zr(Lg(n,0),o,ld(n,o)));const l=re(kh(0,i,1,"int32"),[-1,1]),u=kh(0,o,1,"int32"),d=Be(l,u),h=Ta(Cd(d,a),jl(d,gn(c))),m=cr([i,o],r.dtype);return re(ii(ao(re(r,[-1,i,o])).map(g=>Zr(h,g,m))),s)}const o$e=J({bandPart_:i$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$e(t){let e;if(Array.isArray(t)){e=!1,U(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let i=1;i<t.length;++i)U(t[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${s})`)}else e=!0,t=ei(t,t.shape[0],0).map(s=>Do(s,[0]));U(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(te.tidy(()=>{let i=r[s];if(s>0)for(let o=0;o<s;++o){const a=ee(Ke(ee(n[o],i)),n[o]);i=Be(i,a)}return We(i,yy(i,"euclidean"))}));return e?ii(n,0):n}const c$e=J({gramSchmidt_:a$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$e(t,e=!1){if(U(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return r4(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((c,l)=>c*l),r=ao(re(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],i=[];r.forEach(c=>{const[l,u]=r4(c,e);s.push(l),i.push(u)});const o=re(ii(s,0),t.shape),a=re(ii(i,0),t.shape);return[o,a]}}function r4(t,e=!1){return te.tidy(()=>{U(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=sR(n),i=oc(t);const o=Bu([[1]],[1,1]);let a=oc(o);const c=n>=r?r:n;for(let l=0;l<c;++l){const u=i,d=a,h=s;[a,i,s]=te.tidy(()=>{const m=at(i,[l,l],[n-l,1]),g=yy(m),v=at(i,[l,l],[1,1]),y=Zr(li(v,0),Bu([[-1]]),Bu([[1]])),w=Be(v,ee(y,g)),x=We(m,w);x.shape[0]===1?a=oc(o):a=zn([o,at(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const S=gn(We($t(y,w),g)),k=at(i,[l,0],[n-l,r]),E=ee(S,a),A=Lt(a);if(l===0)i=Be(k,$t(E,$t(A,k)));else{const P=Be(k,$t(E,$t(A,k)));i=zn([at(i,[0,0],[l,r]),P],0)}const R=Lt(E),N=at(s,[0,l],[n,s.shape[1]-l]);if(l===0)s=Be(N,$t($t(N,a),R));else{const P=Be(N,$t($t(N,a),R));s=zn([at(s,[0,0],[n,l]),P],1)}return[a,i,s]}),Tt([u,d,h])}return!e&&n>r&&(s=at(s,[0,0],[n,r]),i=at(i,[0,0],[r,r])),[s,i]})}const u$e=J({qr_:l$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Is;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Is||(Is={}));function d$e(t,e,n=Is.SUM_BY_NONZERO_WEIGHTS){const r=V(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=V(e,"weights","computeWeightedLoss"));const i=s==null?r:ee(r,s);if(n===Is.NONE)return i;if(n===Is.SUM)return Ke(i);if(n===Is.MEAN){if(s==null)return Mn(i);{const o=r.size/s.size,a=We(Ke(i),Ke(s));return o>1?We(a,rt(o)):a}}if(n===Is.SUM_BY_NONZERO_WEIGHTS){if(s==null)return We(Ke(i),rt(r.size));{const o=ee(s,Zs(r.shape)),a=Fe(Ke(Sh(o,rt(0))),"float32");return We(Ke(i),a)}}throw Error(`Unknown reduction: ${n}`)}const Ac=J({computeWeightedLoss_:d$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$e(t,e,n,r=Is.SUM_BY_NONZERO_WEIGHTS){const s=V(t,"labels","absoluteDifference"),i=V(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=V(n,"weights","absoluteDifference")),ci(s.shape,i.shape,"Error in absoluteDifference: ");const a=ar(Be(s,i));return Ac(a,o,r)}const h$e=J({absoluteDifference_:f$e});function p$e(t,e,n,r,s=Is.SUM_BY_NONZERO_WEIGHTS){const i=V(t,"labels","cosineDistance"),o=V(e,"predictions","cosineDistance");let a=null;r!=null&&(a=V(r,"weights","cosineDistance")),ci(i.shape,o.shape,"Error in cosineDistance: ");const c=rt(1),l=Be(c,Ke(ee(i,o),n,!0));return Ac(l,a,s)}const m$e=J({cosineDistance_:p$e});function g$e(t,e,n,r=Is.SUM_BY_NONZERO_WEIGHTS){let s=V(t,"labels","hingeLoss");const i=V(e,"predictions","hingeLoss");let o=null;n!=null&&(o=V(n,"weights","hingeLoss")),ci(s.shape,i.shape,"Error in hingeLoss: ");const a=rt(1);s=Be(ee(rt(2),s),a);const c=Ra(Be(a,ee(s,i)));return Ac(c,o,r)}const y$e=J({hingeLoss_:g$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$e(t,e,n,r=1,s=Is.SUM_BY_NONZERO_WEIGHTS){const i=V(t,"labels","huberLoss"),o=V(e,"predictions","huberLoss");let a=null;n!=null&&(a=V(n,"weights","huberLoss")),ci(i.shape,o.shape,"Error in huberLoss: ");const c=rt(r),l=ar(Be(o,i)),u=ld(l,c),d=Be(l,u),h=xe(ee(rt(.5),on(u)),ee(c,d));return Ac(h,a,s)}const b$e=J({huberLoss_:v$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$e(t,e,n,r=1e-7,s=Is.SUM_BY_NONZERO_WEIGHTS){const i=V(t,"labels","logLoss"),o=V(e,"predictions","logLoss");let a=null;n!=null&&(a=V(n,"weights","logLoss")),ci(i.shape,o.shape,"Error in logLoss: ");const c=rt(1),l=rt(r),u=gn(ee(i,Ei(xe(o,l)))),d=ee(Be(c,i),Ei(xe(Be(c,o),l))),h=Be(u,d);return Ac(h,a,s)}const x$e=J({logLoss_:w$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$e(t,e,n,r=Is.SUM_BY_NONZERO_WEIGHTS){const s=V(t,"labels","meanSquaredError"),i=V(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=V(n,"weights","meanSquaredError")),ci(s.shape,i.shape,"Error in meanSquaredError: ");const a=wR(s,i);return Ac(a,o,r)}const S$e=J({meanSquaredError_:I$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$e(t,e){const n=V(t,"labels","sigmoidCrossEntropyWithLogits"),r=V(e,"logits","sigmoidCrossEntropyWithLogits");ci(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=Ra(r),i=ee(r,n),o=nS(si(gn(ar(r))));return xe(Be(s,i),o)}function E$e(t,e,n,r=0,s=Is.SUM_BY_NONZERO_WEIGHTS){let i=V(t,"multiClassLabels","sigmoidCrossEntropy");const o=V(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=V(n,"weights","sigmoidCrossEntropy")),ci(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const l=rt(r),u=rt(1),d=rt(.5);i=xe(ee(i,Be(u,l)),ee(d,l))}const c=k$e(i,o);return Ac(c,a,s)}const C$e=J({sigmoidCrossEntropy_:E$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$e(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return yc((s,i,o)=>{const c=rS(i,[n],!0),l=Be(Fe(i,"float32"),c);o([s,l]);const u=gn(ee(l,s));return{value:Ke(u,[n]),gradFunc:(m,g)=>{const[v,y]=g,w=Kn(m.shape,[n]);return[ee(re(m,w),Be(Fe(v,"float32"),si(y))),ee(re(m,w),Be(si(y),Fe(v,"float32")))]}}})(t,e)}function A$e(t,e,n,r=0,s=Is.SUM_BY_NONZERO_WEIGHTS){let i=V(t,"onehotLabels","softmaxCrossEntropy");const o=V(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=V(n,"weights","softmaxCrossEntropy")),ci(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const l=rt(r),u=rt(1),d=rt(i.shape[1]);i=xe(ee(i,Be(u,l)),We(l,d))}const c=T$e(i,o);return Ac(c,a,s)}const N$e=J({softmaxCrossEntropy_:A$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$e(t,e,n,r){const s=V(t,"indices","sparseFillEmptyRows","int32"),i=V(e,"values","sparseFillEmptyRows"),o=V(n,"denseShape","sparseFillEmptyRows","int32"),a=V(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const c={indices:s,values:i,denseShape:o,defaultValue:a},l=te.runKernel($$,c);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}const $$e=J({sparseFillEmptyRows_:_$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$e(t,e,n){const r=V(t,"inputIndices","sparseReshape","int32"),s=V(e,"inputShape","sparseReshape","int32"),i=V(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:s,newShape:i},a=te.runKernel(R$,o);return{outputIndices:a[0],outputShape:a[1]}}const O$e=J({sparseReshape_:R$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P$e(t,e,n){const r=V(t,"data","sparseSegmentMean"),s=V(e,"indices","sparseSegmentMean","int32"),i=V(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return te.runKernel(O$,o)}const D$e=J({sparseSegmentMean_:P$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F$e(t,e,n){const r=V(t,"data","sparseSegmentSum"),s=V(e,"indices","sparseSegmentSum","int32"),i=V(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:s,segmentIds:i};return te.runKernel(P$,o)}const L$e=J({sparseSegmentSum_:F$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(t,e,n,r,s,i,o,a){const c=V(t,"data","stringNGrams","string");if(c.dtype!=="string")throw new Error("Data must be of datatype string");if(c.shape.length!==1)throw new Error(`Data must be a vector, saw: ${c.shape}`);const l=V(e,"dataSplits","stringNGrams");if(l.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:s,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:c,dataSplits:l},h=te.runKernel(B$,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const M$e=J({stringNGrams_:B$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z$e(t,e,n=!0){const r=V(t,"input","stringSplit","string"),s=V(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const i={skipEmpty:n},o={input:r,delimiter:s},a=te.runKernel(M$,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const U$e=J({stringSplit_:z$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$e(t,e){const n=V(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return te.runKernel(z$,s,r)}const j$e=J({stringToHashBucketFast_:V$e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H$e(t,e,n,r=!0){const s=V(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:r};return te.runKernel(WI,{x:s},i)}const W$e=J({staticRegexReplace_:H$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e={fft:hS,ifft:zg,rfft:pS,irfft:bR},q$e={hammingWindow:b_e,hannWindow:jq,frame:Hq,stft:S_e},Yi={flipLeftRight:T_e,grayscaleToRGB:N_e,resizeNearestNeighbor:Gq,resizeBilinear:Wq,rgbToGrayscale:$_e,rotateWithOffset:O_e,cropAndResize:E_e,nonMaxSuppression:D_e,nonMaxSuppressionAsync:j_e,nonMaxSuppressionWithScore:W_e,nonMaxSuppressionWithScoreAsync:q_e,nonMaxSuppressionPadded:X_e,nonMaxSuppressionPaddedAsync:Y_e,threshold:n$e,transform:s$e},qq={bandPart:o$e,gramSchmidt:c$e,qr:u$e},K$e={absoluteDifference:h$e,computeWeightedLoss:Ac,cosineDistance:m$e,hingeLoss:y$e,huberLoss:b$e,logLoss:x$e,meanSquaredError:S$e,sigmoidCrossEntropy:C$e,softmaxCrossEntropy:N$e},X$e={sparseFillEmptyRows:$$e,sparseReshape:O$e,sparseSegmentMean:D$e,sparseSegmentSum:L$e},Q$e={stringNGrams:M$e,stringSplit:U$e,stringToHashBucketFast:j$e,staticRegexReplace:W$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y$e=new Map,Z$e=new Map;class ep{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ki{constructor(){this.classNameMap={}}static getMap(){return Ki.instance==null&&(Ki.instance=new Ki),Ki.instance}static register(e){Ki.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ie(t,e,n){U(t.className!=null,()=>"Class being registered does not have the static className property defined."),U(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),U(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return Ki.register(t),Y$e.set(s,t),Z$e.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wl extends ep{minimize(e,n=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Tt(i),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return ITe(e,n)}dispose(){this.iterations_!=null&&Tt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:rt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Wl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kq extends Wl{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:ae(()=>Bt(i).variable(o))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:ae(()=>Bt(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const c=this.accumulatedGrads[s].variable,l=this.accumulatedUpdates[s].variable;ae(()=>{const u=xe(ee(c,this.rho),ee(on(a),1-this.rho)),d=ee(We(zr(xe(l,this.epsilon)),zr(xe(c,this.epsilon))),a),h=xe(ee(l,this.rho),ee(on(d),1-this.rho));c.assign(u),l.assign(h);const m=xe(ee(d,-this.learningRate),i);i.assign(m)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Tt(this.accumulatedGrads.map(e=>e.variable)),Tt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xq extends Wl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:ae(()=>Qh(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const a=this.accumulatedGrads[s].variable;ae(()=>{const c=xe(a,on(o));a.assign(c);const l=xe(ee(We(o,zr(xe(c,te.backend.epsilon()))),-this.learningRate),i);i.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Tt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qq extends Wl{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ae(()=>{this.accBeta1=rt(n).variable(),this.accBeta2=rt(r).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ae(()=>{const r=Be(1,this.accBeta1),s=Be(1,this.accBeta2);n.forEach((i,o)=>{const a=te.registeredVariables[i],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:ae(()=>Bt(a).variable(c))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:ae(()=>Bt(a).variable(c))});const l=Array.isArray(e)?e[o].tensor:e[i];if(l==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=xe(ee(u,this.beta1),ee(l,1-this.beta1)),m=xe(ee(d,this.beta2),ee(on(l),1-this.beta2)),g=We(h,r),v=We(m,s);u.assign(h),d.assign(m);const y=xe(ee(We(g,xe(zr(v),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(ee(this.accBeta1,this.beta1)),this.accBeta2.assign(ee(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Tt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Tt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ae(()=>{this.accBeta1.assign(gc(this.beta1,this.iterations_+1)),this.accBeta2.assign(gc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yq extends Wl{static get className(){return"Adamax"}constructor(e,n,r,s=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ae(()=>{this.iteration=rt(0).variable(),this.accBeta1=rt(n).variable()}),s==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ae(()=>{const r=Be(1,this.accBeta1),s=We(-this.learningRate,xe(ee(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=te.registeredVariables[i],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Bt(a).variable(c)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Bt(a).variable(c)});const l=Array.isArray(e)?e[o].tensor:e[i];if(l==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=xe(ee(u,this.beta1),ee(l,1-this.beta1)),m=ee(d,this.beta2),g=ar(l),v=Tc(m,g);u.assign(h),d.assign(v);const y=xe(ee(We(s,r),We(h,xe(v,this.epsilon))),a);a.assign(y)}),this.iteration.assign(xe(this.iteration,1)),this.accBeta1.assign(ee(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Tt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Tt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $R extends Wl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const o=te.registeredVariables[r];ae(()=>{const a=xe(ee(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=xr(rt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zq extends $R{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=rt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:ae(()=>Bt(i).variable(!1))});const o=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&ae(()=>{let c;const l=xe(ee(this.m,o),a);this.useNesterov?c=xe(ee(this.c,xe(a,ee(l,this.m))),i):c=xe(ee(this.c,l),i),o.assign(l),i.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Tt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jq extends Wl{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=te.registeredVariables[r],o=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:ae(()=>Bt(i).variable(o))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:ae(()=>Bt(i).variable(o))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:ae(()=>Bt(i).variable(o))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const c=this.accumulatedMeanSquares[s].variable,l=this.accumulatedMoments[s].variable;ae(()=>{const u=xe(ee(c,this.decay),ee(on(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,h=xe(ee(d,this.decay),ee(a,1-this.decay)),m=We(ee(a,this.learningRate),zr(Be(u,xe(on(h),this.epsilon)))),g=xe(ee(l,this.momentum),m);c.assign(u),d.assign(h),l.assign(g);const v=Be(i,g);i.assign(v)}else{const d=xe(ee(c,this.decay),ee(on(a),1-this.decay)),h=xe(ee(l,this.momentum),We(ee(a,this.learningRate),zr(xe(d,this.epsilon))));c.assign(d),l.assign(h);const m=Be(i,h);i.assign(m)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Tt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Tt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Tt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J$e=[Kq,Xq,Qq,Yq,Zq,Jq,$R];function eRe(){for(const t of J$e)Ie(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tRe="model",nRe=".json",rRe=".weights.bin";function s4(t){return new Promise(e=>setTimeout(e)).then(t)}class ud{constructor(e){if(!fe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(ud.URL_SCHEME)&&(e=e.slice(ud.URL_SCHEME.length)),(e==null||e.length===0)&&(e=tRe),this.modelJsonFileName=e+nRe,this.weightDataFileName=e+rRe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=qo.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=R8(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await s4(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=r,await s4(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:fy(e)}}}}ud.URL_SCHEME="downloads://";class sRe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const i=JSON.parse(s.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const c=q$(i,l=>this.loadWeights(l));e(c)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const s=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,s[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,s)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;r(a)},i.onerror=o=>s(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>qM(i.name)),s={};for(const i of e)i.paths.forEach(o=>{const a=qM(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[o]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const iRe=t=>fe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ud.URL_SCHEME)?oRe(t.slice(ud.URL_SCHEME.length)):null;Cn.registerSaveRouter(iRe);function oRe(t="model"){return new ud(t)}function aRe(t){return new sRe(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(t,e,n,r){o(t),n=n??0,r=r??1,a(n,r);let s=0;const i=c=>(c.then(l=>{const u=n+ ++s/t.length*(r-n);return e(u),l}),c);function o(c){U(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function a(c,l){U(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),U(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${l}`),U(l>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${l}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function e9(t,e){e==null&&(e={});const n=e.fetchFunc==null?fe().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(r):await i4(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await i4(a,e.onProgress,.5,1)}function cRe(t,e){var n;const r=e.fetchFunc==null?fe().platform.fetch:e.fetchFunc;let s=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;s<t.length;){i||(i=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:c,value:l}=await i.read();if(c){s++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}o.enqueue(l);return}o.close()}})}async function lRe(t,e="",n,r){return t9(o=>e9(o,{requestInit:r}))(t,e,n)}function t9(t){return async(e,n="",r)=>{const s=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((m,g)=>{let v=0;m.weights.forEach(y=>{const w="quantization"in y?y.quantization.dtype:y.dtype,x=sd[w]*me(y.shape),S=()=>{s[g]=!0,i[g]==null&&(i[g]=[]),i[g].push({manifestEntry:y,groupOffset:v,sizeBytes:x})};r!=null?r.forEach((k,E)=>{k===y.name&&(S(),o[E]=!0)}):S(),a.push(y.name),v+=x})}),!o.every(m=>m)){const m=r.filter((g,v)=>!o[v]);throw new Error(`Could not find weights in manifest with names: ${m.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const c=s.reduce((m,g,v)=>(g&&m.push(v),m),[]),l=[];c.forEach(m=>{e[m].paths.forEach(g=>{const v=n+(n.endsWith("/")?"":"/")+g;l.push(v)})});const u=await t(l),d={};let h=0;return c.forEach(m=>{const g=e[m].paths.length,v=new qo(u.slice(h,h+g));i[m].forEach(w=>{const x=v.slice(w.groupOffset,w.groupOffset+w.sizeBytes),S=A8(x,[w.manifestEntry]);for(const k in S)d[k]=S[k]}),h+=g}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uRe="application/octet-stream",dRe="application/json";class RR{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=fe().platform.fetch,U(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&U(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=R8(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:dRe}),"model.json"),e.weightData!=null){const o=qo.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:uRe}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:fy(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return q$(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=XT(e.weightsManifest),s=()=>cRe(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=fRe(n),i=this.weightPathPrefix||r,o=[],a=[];for(const c of e)for(const l of c.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(l)):o.push(i+l+s);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=XT(e),s=await e9(n,this.loadOptions);return[r,s]}}RR.URL_SCHEME_REGEX=/^https?:\/\//;function fRe(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function nA(t){return t.match(RR.URL_SCHEME_REGEX)!=null}const n9=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>nA(r)):n=nA(t),n)return OR(t,e)}return null};Cn.registerSaveRouter(n9);Cn.registerLoadRouter(n9);function OR(t,e){return new RR(t,e)}function hRe(t,e){return OR(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H2{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class r9{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class pRe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function mRe(t,e,n,r){const s=arguments;return new pRe(s9(...s))}function s9(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new H2(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new H2({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new H2({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function gRe(t){return new r9(t)}function yRe(t){return new r9(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:qo,browserFiles:aRe,browserHTTPRequest:hRe,concatenateArrayBuffers:$8,copyModel:y2e,decodeWeights:A8,decodeWeightsStream:_8,encodeWeights:KT,fromMemory:mRe,fromMemorySync:s9,getLoadHandlers:r2e,getModelArtifactsForJSON:q$,getModelArtifactsForJSONSync:O8,getModelArtifactsInfoForJSON:fy,getSaveHandlers:P8,getWeightSpecs:XT,http:OR,isHTTPScheme:nA,listModels:m2e,loadWeights:lRe,moveModel:v2e,registerLoadRouter:n2e,registerSaveRouter:t2e,removeModel:g2e,weightsLoaderFactory:t9,withSaveHandler:gRe,withSaveHandlerSync:yRe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let du;function vRe(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(VT(zT,te.backendName)!=null){const g={pixels:t},v={numChannels:e};return te.runKernel(zT,g,v)}const[l,u]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)d=t.data;else if(i||s||a){if(du==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")du=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else du=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});du.canvas.width=l,du.canvas.height=u,du.drawImage(t,0,0,l,u),d=du.getImageData(0,0,l,u).data}let h;if(e===4)h=new Int32Array(d);else{const g=l*u;h=new Int32Array(g*e);for(let v=0;v<g;v++)for(let y=0;y<e;++y)h[v*e+y]=d[v*4+y]}return Rq(h,[u,l,e],"int32")}const bRe=J({fromPixels_:vRe});function PR(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(me(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,i=s[s.length-1];let o=1;for(let d=0;d<s.length-1;++d)o*=s[d];const a=t.shape,c=s.slice();c.pop();let l=1;for(let d=i;d<n;++d)l*=a[d],c.push(a[d]);const u=[...nt(t.shape).map(d=>d/l),1].slice(0,i);return[c,o,l,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rA=-2,wRe=-1;function DR(t,e,n){const r=t.shape.length;U(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),U(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)U(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function xRe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function FR(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function o9(t,e,n,r){const s=[...t];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<n;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function a9(t,e,n){return n<=t?n:n-(e-1)}function c9(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function IRe(t,e,n,r,s,i,o,a,c){const l=t.length;let u=new Array(l),d=new Array(l),h=new Array(l);if(e.length&&n>0){const m=e[0],g=n+1;u=l9(o,m,g,r,t),d=u9(a,m,g,s,t),h=o9(i,m,g,t)}else for(let m=0;m<l;m++)u[m]=f9(o,r,i,t,m,c),d[m]=h9(a,s,i,t,m,c),h[m]=d9(i,m,c);return{begin:u,end:d,strides:h}}function l9(t,e,n,r,s){const i=[...s],o=c9(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const c=a9(e,n,a);let l=r[c];t&1<<c&&(l=0),i[a]=l}return i}function u9(t,e,n,r,s){const i=[...s],o=c9(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const c=a9(e,n,a);let l=r[c];t&1<<c&&(l=Number.MAX_SAFE_INTEGER),i[a]=l}for(let a=0;a<i.length;a++){const c=s[a];i[a]<0&&(i[a]+=c),i[a]=td(0,i[a],s[a])}return i}function d9(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function f9(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const c=r[s];return o<0&&(o+=c),o=td(0,o,c-1),o}function h9(t,e,n,r,s,i){let o=e[s];const a=n[s]||1;(t&1<<s||i&1<<s||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const c=r[s];return o<0&&(o+=c),a>0?o=td(0,o,c):o=td(-1,o,c-1),o}function LR(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function BR(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function bS(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(o=>{U(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(s).fill(-1):typeof n=="number"?i=[n,...new Array(s-1).fill(-1)]:n.length<s?i=n.concat(new Array(s-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(U(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function MR(t,e,n,r,s,i,o,a,c){let l;if(r==null?(l=new Array(e.length),l.fill(1)):l=r,o!=null&&(o&o-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:l.slice(),beginMask:s,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:c};for(let S=0;S<d.dims;S++)u&&(1<<S&a)!==0&&d.numAddAxisAfterEllipsis++,1<<S&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};SRe(d,h);let m=!0,g=!0,v=!0;const y=[],w=[];for(let S=0;S<t.length;++S){if(h.strides[S]===0)throw Error(`strides[${S}] must be non-zero`);const k=!!(h.shrinkAxisMask&1<<S),E=t[S];if(E===-1){y.push(k?1:-1);continue}const A=[h.beginMask&1<<S,h.endMask&1<<S],R=[h.strides[S]>0?0:-1,h.strides[S]>0?E:E-1];if(k&&h.strides[S]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&h.strides[S]===1;const N=!!(h.beginMask&1<<S&&h.endMask&1<<S);if(h.beginValid&&h.endValid){if(k){const M=h.begin[S]<0?E+h.begin[S]:h.begin[S];if(h.begin[S]=M,h.end[S]=h.begin[S]+1,M<0||M>=E)throw Error(`slice index ${h.begin[S]} of dimension ${S} out of bounds.`)}else h.begin[S]=o4(h.begin[S],0,h.strides[S],E,A,R),h.end[S]=o4(h.end[S],1,h.strides[S],E,A,R);const _=h.strides[S]===1&&h.begin[S]===0&&h.end[S]===E;m=m&&_,g=g&&(S===0&&h.strides[S]===1||_)}else m=m&&h.strides[S]===1&&N,g=g&&(S===0&&h.strides[S]===1||N);let P,O=!1;if(h.beginValid&&h.endValid?(P=h.end[S]-h.begin[S],O=!0):k?(P=1,O=!0):N&&E>=0&&(h.strides[S]<0?P=-E:P=E,O=!0),O){let _;P===0||P<0!=h.strides[S]<0?_=0:_=Math.trunc(P/h.strides[S])+(P%h.strides[S]!==0?1:0),y.push(_)}else y.push(-1)}for(let S=0;S<h.finalShapeGatherIndices.length;++S){const k=h.finalShapeGatherIndices[S];k>=0?w.push(y[k]):k===rA&&w.push(1)}return{finalShapeSparse:w.filter((S,k)=>h.finalShapeGatherIndices[k]!==rA),finalShape:w,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:h.begin,end:h.end,strides:h.strides}}function SRe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(rA),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(wRe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function o4(t,e,n,r,s,i){if(s[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const kRe=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:DR,computeFlatOffset:BR,computeOutShape:FR,getNormalizedAxes:IRe,isSliceContinous:LR,maskToAxes:xRe,parseSliceParams:bS,sliceInfo:MR,startForAxis:f9,startIndicesWithElidedDims:l9,stopForAxis:h9,stopIndicesWithElidedDims:u9,stridesForAxis:d9,stridesWithElidedDims:o9},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ERe{static sgd(e){return new $R(e)}static momentum(e,n,r=!1){return new Zq(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,i=!1){return new Jq(e,n,r,s,i)}static adam(e=.001,n=.9,r=.999,s=null){return new Qq(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new Kq(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,i=0){return new Yq(e,n,r,s,i)}static adagrad(e,n=.1){return new Xq(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bf=ERe;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CRe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function p9(){return new Promise(t=>CRe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zR(t,e){const n=t[0].length;t.forEach((s,i)=>{U(s.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),U(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,i)=>{for(let o=0;o<n;o++)U(o===e||s[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function ba(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Eo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Eo||(Eo={}));function m9(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const i=n[s],o=r[r.length-n.length+s],a=r[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${i} but shape[${s+t}] = ${a}`)}else r[o]=i}return r}function g9(t){const e={FIRST_DIM_SIZE:Eo.FIRST_DIM_SIZE,VALUE_ROWIDS:Eo.VALUE_ROWIDS,ROW_LENGTHS:Eo.ROW_LENGTHS,ROW_SPLITS:Eo.ROW_SPLITS,ROW_LIMITS:Eo.ROW_LIMITS,ROW_STARTS:Eo.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function y9(t){return t.length===0?0:t[0]===Eo.FIRST_DIM_SIZE?t.length-1:t.length}function v9(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const i=t[s],o=e[s+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${i} but ragged tensor input.flatValues.shape[${s-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR=30;function wS(t){return t<=UR?t:LT(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VR(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wy(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)s=s.concat([t[o+1]/e[o],e[o]]);s=s.concat(t.slice(i+1))}return s}function xy(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):s.push(o);r.push(...s),r.push(0),r.push(...i)}return r}function Iy(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?s.push(e[i-1]*t[i]):s.push(t[i]/e[i-1]):s.push(t[i]);return s}function jR(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function HR(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xS=1.7580993408473768,IS=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WR=.3275911,GR=.254829592,qR=-.284496736,KR=1.421413741,XR=-1.453152027,QR=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vc(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function b9(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function w9(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function x9(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function YR(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function I9(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function S9(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const i=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:n,imag:r}}function k9(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W2="->",TRe=/->/g,a4=",",c4="...";function ZR(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(TRe,"").length)/W2.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${W2}").`);const[r,s]=t.split(W2);U(r.indexOf(c4)===-1,()=>`The ellipsis notation ("${c4}") is not supported yet.`);const i=r.split(a4),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<s.length;++h){const m=s[h];if(!i.some(g=>g.indexOf(m)!==-1))throw new Error(`Output subscripts contain the label ${m} not present in the input subscripts.`);a.indexOf(m)===-1&&a.push(m)}for(let h=0;h<r.length;++h){const m=r[h];a.indexOf(m)===-1&&m!==a4&&a.push(m)}const c=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);c[h]=[];for(let m=0;m<i[h].length;++m)c[h].push(a.indexOf(i[h][m]))}const l=a.length,u=s.length,d=[];for(let h=u;h<l;++h)d.push(h);return{allDims:a,summedDims:d,idDims:c}}function JR(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function eO(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const i=n[s].shape;for(let o=0;o<e[s].length;++o)r[e[s][o]]===void 0?r[e[s][o]]=i[o]:U(r[e[s][o]]===i[o],()=>`Expected dimension ${r[e[s][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function tO(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let o=0;o<s;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],c=ARe(e,a);for(const l of c)i.indexOf(l)===-1&&(r[o].push(l),i.push(l))}return{path:n,steps:r}}function nO(t){return t.every((e,n)=>e===n)}function ARe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function rO(t,e,n=0){let r=[];if(typeof e=="number")U(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);U(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,c)=>c>0?a+c:a);e[i]=t.shape[n]-o}U(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function C9(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function T9(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function N9(t,e){return`size ${t} must be non-negative, not ${e}`}function _9(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function $9(t,e){const n=me(t),r=me(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function R9(t,e){const n=me(t),r=me(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sA(){return"segment ids must be >= 0"}function O9(){return"segment ids are not increasing"}function P9(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function D9(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(t,e){let n=!1,r;for(t<=UR?(r=t,n=!0):r=LT(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=LT(t,r+1);return r}function L9(t,e,n){const r=[],s=t.length;for(let i=0;i<s;i++)i!==e?r.push(t[i]):r.push(n);return r}function sO(t,e,n,r){const s=e.shape.length,i=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let c=1,l=1,u=1;for(let d=0;d<r;++d)a.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:o,outputShape:a}}const NRe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:sO,computeOutShape:L9,segOpComputeOptimalWindowSize:F9},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bc(t){try{return t.map(e=>Sl(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function B9(t){return t.map(e=>dl(e))}const _Re=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:GR,ERF_A2:qR,ERF_A3:KR,ERF_A4:XR,ERF_A5:QR,ERF_P:WR,PARALLELIZE_THRESHOLD:UR,get RowPartitionType(){return Eo},SELU_SCALE:IS,SELU_SCALEALPHA:xS,applyActivation:yS,assertAndGetBroadcastShape:bt,assertAxesAreInnerMostDims:jr,assertParamsConsistent:zR,assignToTypedArray:I9,axesAreInnerMostDims:rR,calculateShapes:Ad,checkEinsumDimSizes:eO,checkPadOnDimRoundingMode:gs,combineLocations:hq,combineRaggedTensorToTensorShapes:m9,complexWithEvenIndex:w9,complexWithOddIndex:x9,computeConv2DInfo:Er,computeConv3DInfo:Ul,computeDefaultPad:Q$,computeDilation2DInfo:hy,computeOptimalWindowSize:wS,computeOutAndReduceShapes:Cr,computeOutShape:ba,computePool2DInfo:co,computePool3DInfo:Ec,convertConv2DDataFormat:Cc,decodeEinsumEquation:ZR,eitherStridesOrDilationsAreOne:Vr,expandShapeToKeepDim:Kn,exponent:k9,exponents:S9,fromStringArrayToUint8:B9,fromUint8ToStringArray:bc,getAxesPermutation:Pn,getBroadcastDims:Ih,getComplexWithIndex:YR,getEinsumComputePath:tO,getEinsumPermutation:JR,getFusedBiasGradient:gS,getFusedDyActivation:mS,getImageCenter:VR,getInnerMostAxes:Xn,getPermuted:xy,getRaggedRank:y9,getReductionAxes:gr,getReshaped:wy,getReshapedPermuted:Iy,getRowPartitionTypesHelper:g9,getSliceBeginCoords:jR,getSliceSize:HR,getSparseFillEmptyRowsIndicesDenseShapeMismatch:E9,getSparseFillEmptyRowsNegativeIndexErrorMessage:C9,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:T9,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:_9,getSparseReshapeInputOutputMismatchErrorMessage:R9,getSparseReshapeInputOutputMultipleErrorMessage:$9,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:A9,getSparseReshapeNegativeOutputDimErrorMessage:N9,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:D9,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:sA,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:O9,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:P9,getUndoAxesPermutation:Vl,isIdentityPermutation:nO,log:yEe,mergeRealAndImagArrays:vc,prepareAndValidate:PR,prepareSplitSize:rO,segment_util:NRe,shouldFuse:vS,slice_util:kRe,splitRealAndImagArrays:b9,stridesOrDilationsArePositive:ad,tupleValuesAreOne:Cl,upcastType:ni,validateDefaultValueShape:v9,validateInput:xR,validateUpdateShape:Oq,warn:gi},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */eRe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9={kernelName:G1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Zh(Fe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re={kernelName:y0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=on(Fe(n,"float32")),s=zr(Be(rt(1),r));return gn(We(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RRe={kernelName:v0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=zr(Be(on(Fe(n,"float32")),1));return We(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ORe={kernelName:Xh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{let a=t;const c=gr(n.shape,s);return c.length>0&&(a=Ke(a,c)),re(a,n.shape)},b:()=>{let a=t;const c=gr(r.shape,s);return c.length>0&&(a=Ke(a,c)),re(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PRe={kernelName:q1,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRe={kernelName:K1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Bt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FRe={kernelName:X1,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Bt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LRe={kernelName:b0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,zr(Be(rt(1),on(Fe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BRe={kernelName:w0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=zr(xe(rt(1),on(Fe(n,"float32"))));return We(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MRe={kernelName:S0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{const a=xe(on(n),on(r));let c=ee(t,We(r,a));const l=gr(n.shape,s);return l.length>0&&(c=Ke(c,l)),re(c,n.shape)},b:()=>{const a=xe(on(n),on(r));let c=gn(ee(t,We(n,a)));const l=gr(r.shape,s);return l.length>0&&(c=Ke(c,l)),re(c,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zRe={kernelName:x0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,xe(on(Fe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URe={kernelName:I0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,Be(rt(1),on(Fe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VRe(t,e,n,r,s,i){const o=V(t,"dy","avgPool3dGrad"),a=V(e,"input","avgPool3dGrad");let c=o,l=a,u=!1;a.rank===4&&(u=!0,c=re(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=re(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),U(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),U(l.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`),gs("avgPool3dGrad",s,i);const d={dy:c,input:l},h={filterSize:n,strides:r,pad:s,dimRoundingMode:i},m=te.runKernel(H_,d,h);return u?re(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const jRe=J({avgPool3dGrad_:VRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HRe={kernelName:Y1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>jRe(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WRe(t,e,n,r,s){const i=V(t,"dy","avgPoolGrad"),o=V(e,"input","avgPoolGrad");U(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,c=i,l=!1;o.rank===3&&(l=!0,a=re(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=re(i,[1,i.shape[0],i.shape[1],i.shape[2]])),U(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),U(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:c,input:a},d={filterSize:n,strides:r,pad:s},h=te.runKernel(j_,u,d);return l?re(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const GRe=J({avgPoolGrad_:WRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qRe={kernelName:Q1,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:i,pad:o}=n;return{x:()=>GRe(t,r,s,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KRe={kernelName:Z1,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>$t(t,s,!1,!0),b:()=>$t(r,t,!0,!1)}:!i&&o?{a:()=>$t(t,s,!1,!1),b:()=>$t(t,r,!0,!1)}:i&&!o?{a:()=>$t(s,t,!1,!0),b:()=>$t(r,t,!1,!1)}:{a:()=>$t(s,t,!0,!0),b:()=>$t(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XRe={kernelName:J1,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>aS(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QRe={kernelName:pEe,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,i=r.shape,o=Array.from(i);for(let c=s.length-1;c>=0;c--)if(s[c]===i[c])o[c]=1;else if(s[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const a=[];for(let c=0;c<o.length;c++)o[c]>1&&a.push(c);return{x:()=>Ke(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YRe={kernelName:k0,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZRe={kernelName:E0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JRe={kernelName:C0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=n;return{x:()=>Zr(Ta(jl(r,s),Cd(r,i)),t,Bt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eOe={kernelName:tI,inputsToSave:["x"],gradFunc:M9.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tOe={kernelName:nI,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(c=>c.shape),{axis:s}=n,i=Nt(s,e[0].shape)[0],o=r.map(c=>c[i]);return ei(t,o,i).map(c=>()=>c)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nOe={kernelName:rI,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:i,strides:o,pad:a,dataFormat:c}=n;return U(Cl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>Z$(r.shape,t,s,o,a,c),filter:()=>CR(r,t,s.shape,o,a,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rOe={kernelName:sI,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:c}=n;return{dy:()=>Tl(t,s,i,o,a,1,c),filter:()=>CR(t,r,s.shape,i,o,a,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sOe(t,e,n,r,s){let i=t;t.rank===4&&(i=re(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=re(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),U(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),U(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),U(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),U(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),U(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},c={strides:r,pad:s,filterShape:n};return te.runKernel(X_,a,c)}const iOe=J({conv3DBackpropFilter_:sOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oOe={kernelName:iI,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i}=n;U(Cl(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=e;return{x:()=>aq(o.shape,t,a,s,i),filter:()=>iOe(o,t,a.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aOe={kernelName:T0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(gn(gR(Fe(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cOe={kernelName:A0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(yR(Fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lOe={kernelName:oI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:i,reverse:o}=n;return{x:()=>{const a=Pn([s],r.rank);let c=tR(t,s,i,!o);return a!=null&&(c=Lt(c,a)),c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uOe={kernelName:aI,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:o}=n,a=r??[1,1];U(Cl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[c,l]=e;return U(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),U(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),U(c.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),U(Vr(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),gs("depthwiseConv2d",i,o),{x:()=>Vq(c.shape,t,l,s,i,a,o),filter:()=>Uq(c,t,l.shape,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dOe={kernelName:cI,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,i={x:r,filter:s,dy:t},o={x:r,filter:s,dy:t};return{x:()=>te.runKernel(BT,i,n),filter:()=>te.runKernel(MT,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fOe={kernelName:_0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>te.runKernel(i$,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hOe={kernelName:$0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ee(si(gn(on(n))),2/Math.sqrt(Math.PI));return{x:()=>ee(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pOe={kernelName:R0,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mOe={kernelName:uI,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>re(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gOe={kernelName:O0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,si(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yOe={kernelName:P0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vOe={kernelName:D0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{const a=We(t,Fe(r,"float32")),c=gr(n.shape,s);return c.length>0?re(Ke(a,c),n.shape):a},b:()=>{let a=ee(t,Fe(n,"float32"));const c=gr(r.shape,s);c.length>0&&(a=re(Ke(a,c),r.shape));const l=on(r);return gn(We(a,Fe(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bOe={kernelName:dI,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,i,o,a]=e,c=a??rt(1),l=gr(i.shape,s.shape),u=[];if(i.rank===1){for(let k=0;k<s.shape.length-1;++k)u.push(s.shape[k]);u.push(1)}const d=Be(s,i),h=ee(t,c),m=hR(xe(o,rt(r))),g=ee(ee(ee(m,m),m),rt(-.5));return{x:()=>i.rank===1?re(ee(ee(t,Qi(re(m,[1,1,1,i.shape[0]]),u)),c),s.shape):re(ee(ee(t,m),c),s.shape),mean:()=>{let k=ee(ee(m,rt(-1)),h);return i.rank===1&&(k=Ke(k,l)),re(k,i.shape)},variance:()=>{let k=ee(ee(g,d),h);return i.rank===1&&(k=Ke(k,l)),re(k,i.shape)},scale:()=>{const k=ee(d,m);let E=ee(t,k);return i.rank===1&&(E=Ke(E,l)),re(E,i.shape)},offset:()=>{let k=t;return i.rank===1&&(k=Ke(k,l)),re(k,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wOe={kernelName:fI,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:i,batchDims:o}=n,a=Nt(i,r.shape)[0],c=(l,u,d)=>()=>{const h=l.shape,m=u.size,g=h.slice(0,a),v=g.length,y=h.slice(i,h.length).slice(1),w=y.length,x=l4(0,v),S=l4(v+1,v+1+w),k=u4([g,[m],y]),E=re(d,k),A=re(u,[m]),R=u4([[v],x,S]),N=Lt(E,R);let P=SR(N,A,l.shape[a]);const O=Vl(R);return P=Lt(P,O),P};if(o===1){const l=r.shape[0],u=r.split(l,0);return{x:()=>ii(u.map((m,g)=>c(m,s.slice(g,1),t.slice(g,1))())).reshape(r.shape),indices:()=>s}}else return{x:c(r,s,t),indices:()=>s}}};function l4(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function u4(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xOe={kernelName:F0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Bt(n),b:()=>Bt(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IOe={kernelName:L0,gradFunc:t=>({x:()=>Fe(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SOe={kernelName:B0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kOe={kernelName:M0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EOe={kernelName:z0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const COe={kernelName:pI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,i=li(r,0);return{x:()=>Zr(i,t,ee(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TOe={kernelName:V0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,xe(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AOe={kernelName:U0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,Fe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NOe={kernelName:gEe,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const o=si(r);return Be(t,ee(Ke(t,s,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Oe(t,e,n,r=5,s=1,i=1,o=.5){const a={x:t,y:e,dy:n},c={depthRadius:r,bias:s,alpha:i,beta:o};return te.runKernel(h$,a,c)}const $Oe=J({localResponseNormalizationBackprop_:_Oe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ROe={kernelName:wI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:i,bias:o,alpha:a,beta:c}=n;return{x:()=>$Oe(r,s,t,i,o,a,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(t,e,n,r){return e.rank<n.rank&&(e=re(e,Kn(e.shape,r))),t.rank<n.rank&&(t=re(t,Kn(t.shape,r))),{x:()=>ee(t,Fe(Uo(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d4={kernelName:xI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,i=e[0],o=e[1],a=Nt(s,i.shape),c=z9(t,o,i,a);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OOe={kernelName:j0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ee(t,Fe(jl(n,r),"float32")),b:()=>ee(t,Fe(Lg(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(t,e,n,r,s,i,o){const a=V(t,"dy","maxPool3dGrad"),c=V(e,"input","maxPool3dGrad"),l=V(n,"output","maxPool3dGrad");let u=a,d=c,h=l,m=!1;c.rank===4&&(m=!0,u=re(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=re(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),h=re(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),U(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),U(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),U(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),gs("maxPool3dGrad",i,o);const g={dy:u,input:d,output:h},v={filterSize:r,strides:s,pad:i,dimRoundingMode:o},y=te.runKernel(m$,g,v);return m?re(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const DOe=J({maxPool3dGrad_:POe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FOe={kernelName:SI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:c}=n;return{x:()=>DOe(t,r,s,i,o,a,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LOe(t,e,n,r,s,i,o){const a=V(t,"dy","maxPoolGrad"),c=V(e,"input","maxPoolGrad"),l=V(n,"output","maxPoolGrad");U(c.rank===a.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${a.rank})`),U(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),U(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),gs("maxPoolGrad",i,o);const u={dy:a,input:c,output:l},d={filterSize:r,strides:s,pad:i,dimRoundingMode:o};return te.runKernel(p$,u,d)}const BOe=J({maxPoolGrad_:LOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MOe={kernelName:II,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>BOe(t,r,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zOe={kernelName:kI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,i=Nt(s,r.shape),a=Cr(r.shape,i)[1],c=me(a);return{x:()=>{const u=r.shape.slice();i.forEach(m=>{u[m]=1});const d=re(t,u);return We(ee(d,Zs(r.shape,"float32")),c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UOe={kernelName:EI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[i,o]=e,a=Nt(s,i.shape),c=z9(t,o,i,a);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VOe={kernelName:H0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ee(t,Fe(Cd(n,r),"float32")),b:()=>ee(t,Fe(li(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jOe={kernelName:CI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>at(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HOe={kernelName:W0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{const a=gr(n.shape,s);return a.length>0?re(Ke(t,a),n.shape):t},b:()=>{const a=ee(t,gn(vy(We(n,r)))),c=gr(r.shape,s);return c.length>0?re(Ke(a,c),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WOe={kernelName:G0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{const a=ee(t,Fe(r,"float32")),c=gr(n.shape,s);return c.length>0?re(Ke(a,c),n.shape):a},b:()=>{const a=ee(t,Fe(n,"float32")),c=gr(r.shape,s);return c.length>0?re(Ke(a,c),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GOe={kernelName:TI,gradFunc:t=>({x:()=>gn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qOe={kernelName:_I,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>cr(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KOe={kernelName:NI,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XOe={kernelName:$I,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return ao(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4={kernelName:RI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,i=s.map(o=>o[0]);return{x:()=>at(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QOe={kernelName:q0,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,i=n,o=r,a=bt(i.shape,o.shape);return{a:()=>{const u=Fe(o,"float32");let d=ee(t,ee(u,gc(i,Be(u,rt(1)))));const h=gr(i.shape,a);return h.length>0&&(d=Ke(d,h)),re(d,i.shape)},b:()=>{const u=li(i,0),d=Zr(u,Ei(i),Bt(i));let h=ee(t,ee(s,d));const m=gr(o.shape,a);return m.length>0&&(h=Ke(h,m)),re(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YOe={kernelName:OI,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=li(n,0);return{x:()=>Zr(s,t,ee(t,r)),alpha:()=>{let i=Zr(s,Bt(t),ee(t,n));const o=gr(r.shape,t.shape);return o.length>0&&(i=Ke(i,o)),re(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(t,e,n){const r=t.shape.slice();r[n]=1;const s=re(e,r),i=_x(t,n,!0,!1),o=_x(t,n,!0,!0),a=ee(i,o);return ee(s,a)}function JOe(t,e,n){const r=t.shape.length,s=r-n.length,i=Pn(n,r);let o=t;i!=null&&(o=Lt(t,i));const a=o.shape.slice(),l=a.splice(r-n.length,n.length).reduce((h,m)=>h*m,1);a.push(l);const u=o.reshape(a);let d=ZOe(u,e,s);if(d=d.reshape(o.shape),i!=null){const h=Vl(i);d=Lt(d,h)}return d}const ePe={kernelName:PI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let i=[];return s==null?i=r.shape.map((o,a)=>a):typeof s=="number"?i=[s]:i=s,{x:()=>JOe(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tPe={kernelName:N0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{const a=We(t,Fe(r,"float32")),c=gr(n.shape,s);return c.length>0?re(Ke(a,c),n.shape):a},b:()=>{let a=ee(t,Fe(n,"float32"));const c=gr(r.shape,s);c.length>0&&(a=re(Ke(a,c),r.shape));const l=on(r);return gn(We(a,Fe(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nPe={kernelName:K0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,gn(on(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rPe={kernelName:Q0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=ee(Cd(n,6),Zh(n));return{x:()=>ee(t,Fe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sPe={kernelName:X0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Fe(Zh(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iPe={kernelName:DI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>re(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oPe={kernelName:LI,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>te.runKernel(T$,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aPe={kernelName:FI,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>te.runKernel(C$,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cPe={kernelName:BI,gradFunc:(t,e,n)=>{const{dims:r}=n,s=Nt(r,t.shape);return{x:()=>oo(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lPe={kernelName:Y0,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uPe={kernelName:Z0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>gn(We(t,ee(gc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dPe={kernelName:MI,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Fe(Bt(n),"float32"),t:()=>ee(t,Fe(n,t.dtype)),e:()=>ee(t,Fe(sS(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fPe={kernelName:J0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=li(n,rt(0)),s=rt(xS),i=rt(IS),o=ee(t,i),a=ee(ee(t,s),si(Fe(n,"float32")));return Zr(r,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe={kernelName:ry,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,ee(n,Be(rt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pPe={kernelName:ny,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mPe={kernelName:ey,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(JI(Fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gPe={kernelName:ty,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(eR(Fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yPe={kernelName:zI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:i}=n,o=r.shape,[a,c]=bS(r,s,i),l=[];for(let u=0;u<t.rank;u++)l.push([a[u],o[u]-a[u]-c[u]]);return{x:()=>Hl(t,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vPe={kernelName:HI,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,i=!0,o=ee(t,r);return{logits:()=>Be(o,ee(Ke(o,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bPe={kernelName:sy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,Po(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h4={kernelName:VI,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>YI(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4={kernelName:jI,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>zn(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wPe={kernelName:iy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,ee(zr(Fe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xPe={kernelName:F$,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(t,ee(Fe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IPe={kernelName:oy,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=rt(2);return{a:()=>ee(t,ee(s,Be(n,r))),b:()=>ee(t,ee(s,Be(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPe={kernelName:dy,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kPe={kernelName:ay,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=bt(n.shape,r.shape);return{a:()=>{let a=t;const c=gr(n.shape,s);return c.length>0&&(a=Ke(a,c)),re(a,n.shape)},b:()=>{let a=t;const c=gr(r.shape,s);return c.length>0&&(a=Ke(a,c)),re(gn(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPe={kernelName:UI,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:i}=n;Nt(i,r.shape).forEach(l=>{s[l]=1});const a=re(t,s),c=ee(a,Zs(r.shape,"float32"));return{x:()=>c}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CPe={kernelName:cy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>We(t,on(JI(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TPe={kernelName:ly,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ee(Be(rt(1),on(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const APe={kernelName:uy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let o=Bt(r);if(r.rank===1)for(let a=0;a<s[0];++a)o=xe(o,at(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let c=0;c<s[1];++c)o=xe(o,at(t,[a*r.shape[0],c*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let c=0;c<s[1];++c)for(let l=0;l<s[2];++l)o=xe(o,at(t,[a*r.shape[0],c*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let c=0;c<s[1];++c)for(let l=0;l<s[2];++l)for(let u=0;u<s[3];++u)o=xe(o,at(t,[a*r.shape[0],c*r.shape[1],l*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NPe={kernelName:qf,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,i=Vl(s);return{x:()=>Lt(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Pe={kernelName:GI,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>ii(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Pe={kernelName:qI,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>RPe(t,n)}}};function RPe(t,e){const n=Tc(e,Bt(e)),r=by(t,n);let s=jl(e,rt(0,"int32"));const i=r.rank-s.rank;for(let a=0;a<i;++a)s=Qr(s,a+1);s=Ta(s,Zs(r.shape,"bool"));const o=Bt(r);return Zr(s,r,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OPe={kernelName:KI,gradFunc:t=>({x:()=>Bt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PPe=[M9,$Re,RRe,ORe,PRe,DRe,FRe,LRe,BRe,MRe,zRe,URe,HRe,qRe,KRe,XRe,QRe,YRe,ZRe,JRe,eOe,tOe,rOe,nOe,oOe,aOe,cOe,lOe,uOe,dOe,tPe,fOe,hOe,pOe,mOe,gOe,vOe,yOe,bOe,wOe,xOe,IOe,SOe,kOe,EOe,COe,TOe,AOe,NOe,ROe,d4,d4,OOe,FOe,MOe,zOe,UOe,VOe,jOe,HOe,WOe,GOe,qOe,KOe,XOe,f4,f4,QOe,YOe,ePe,nPe,rPe,sPe,iPe,oPe,aPe,cPe,lPe,uPe,dPe,fPe,hPe,pPe,mPe,gPe,yPe,vPe,bPe,h4,h4,p4,p4,wPe,IPe,xPe,SPe,kPe,EPe,CPe,TPe,APe,NPe,_Pe,$Pe,OPe];for(const t of PPe)vEe(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.abs=function(){return this.throwIfDisposed(),ar(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.acos=function(){return this.throwIfDisposed(),j8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.acosh=function(){return this.throwIfDisposed(),H8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.add=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.all=function(t,e){return this.throwIfDisposed(),X$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.any=function(t,e){return this.throwIfDisposed(),Nx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.argMax=function(t){return this.throwIfDisposed(),xh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.argMin=function(t){return this.throwIfDisposed(),W8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,()=>"The array must have only 1 element."),re(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asType=function(t){return this.throwIfDisposed(),Fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as1D=function(){return this.throwIfDisposed(),re(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as2D=function(t,e){return this.throwIfDisposed(),re(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),re(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),re(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),re(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asin=function(){return this.throwIfDisposed(),G8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asinh=function(){return this.throwIfDisposed(),q8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atan=function(){return this.throwIfDisposed(),K8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atan2=function(t){return this.throwIfDisposed(),X8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atanh=function(){return this.throwIfDisposed(),Q8(this)};ve().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),QI(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),YI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),py(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Qf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cast=function(t){return this.throwIfDisposed(),Fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.ceil=function(){return this.throwIfDisposed(),nq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ri(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Yt&&(t=[t]),zn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv1d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Y$(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),J$(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),Tl(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cos=function(){return this.throwIfDisposed(),JI(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cosh=function(){return this.throwIfDisposed(),eR(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),_x(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),tR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),lq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.depthwiseConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),my(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),uq(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.divNoNan=function(t){return this.throwIfDisposed(),dq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.div=function(t){return this.throwIfDisposed(),We(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.dot=function(t){return this.throwIfDisposed(),fq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.elu=function(){return this.throwIfDisposed(),gy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.equal=function(t){return this.throwIfDisposed(),Uo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.erf=function(){return this.throwIfDisposed(),nR(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),mq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.exp=function(){return this.throwIfDisposed(),si(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.expandDims=function(t){return this.throwIfDisposed(),Qr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.expm1=function(){return this.throwIfDisposed(),gq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.fft=function(){return this.throwIfDisposed(),hS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.flatten=function(){return this.throwIfDisposed(),re(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.floor=function(){return this.throwIfDisposed(),vy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.floorDiv=function(t){return this.throwIfDisposed(),K$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.gather=function(t,e,n){return this.throwIfDisposed(),by(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.greaterEqual=function(t){return this.throwIfDisposed(),jl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.greater=function(t){return this.throwIfDisposed(),li(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.ifft=function(){return this.throwIfDisposed(),zg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.irfft=function(){return this.throwIfDisposed(),bR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isFinite=function(){return this.throwIfDisposed(),yq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isInf=function(){return this.throwIfDisposed(),vq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isNaN=function(){return this.throwIfDisposed(),bq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.leakyRelu=function(t){return this.throwIfDisposed(),tS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.lessEqual=function(t){return this.throwIfDisposed(),Cd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.less=function(t){return this.throwIfDisposed(),Lg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),wq(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSigmoid=function(){return this.throwIfDisposed(),xq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSoftmax=function(t){return this.throwIfDisposed(),iR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),rS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.log=function(){return this.throwIfDisposed(),Ei(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.log1p=function(){return this.throwIfDisposed(),nS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ta(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalNot=function(){return this.throwIfDisposed(),sS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalOr=function(t){return this.throwIfDisposed(),oR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalXor=function(t){return this.throwIfDisposed(),Iq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),$t(this,t,e,n)};ve().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),iS(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.max=function(t,e){return this.throwIfDisposed(),no(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.maximum=function(t){return this.throwIfDisposed(),Tc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mean=function(t,e){return this.throwIfDisposed(),Mn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.min=function(t,e){return this.throwIfDisposed(),Fg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.minimum=function(t){return this.throwIfDisposed(),ld(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),kq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mod=function(t){return this.throwIfDisposed(),Eq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mul=function(t){return this.throwIfDisposed(),ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.neg=function(){return this.throwIfDisposed(),gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.norm=function(t,e,n){return this.throwIfDisposed(),yy(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.notEqual=function(t){return this.throwIfDisposed(),Sh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),cR(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.onesLike=function(){return this.throwIfDisposed(),Ci(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.pad=function(t,e){return this.throwIfDisposed(),Hl(this,t,e)};ve().prototype.pool=function(t,e,n,r,s,i){return this.throwIfDisposed(),Cq(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.pow=function(t){return this.throwIfDisposed(),gc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.prelu=function(t){return this.throwIfDisposed(),cS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.prod=function(t,e){return this.throwIfDisposed(),Tq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reciprocal=function(){return this.throwIfDisposed(),Aq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.relu=function(){return this.throwIfDisposed(),Ra(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.relu6=function(){return this.throwIfDisposed(),dR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reshapeAs=function(t){return this.throwIfDisposed(),re(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reshape=function(t){return this.throwIfDisposed(),re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Wq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Gq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reverse=function(t){return this.throwIfDisposed(),oo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.rfft=function(){return this.throwIfDisposed(),pS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.round=function(){return this.throwIfDisposed(),fR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.rsqrt=function(){return this.throwIfDisposed(),hR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.selu=function(){return this.throwIfDisposed(),pR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.separableConv2d=function(t,e,n,r,s,i){return this.throwIfDisposed(),mR(this,t,e,n,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sigmoid=function(){return this.throwIfDisposed(),Po(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sign=function(){return this.throwIfDisposed(),Nq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sin=function(){return this.throwIfDisposed(),gR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sinh=function(){return this.throwIfDisposed(),yR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.slice=function(t,e){return this.throwIfDisposed(),at(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.softmax=function(t){return this.throwIfDisposed(),fS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.softplus=function(){return this.throwIfDisposed(),Yh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),aS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.split=function(t,e){return this.throwIfDisposed(),ei(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sqrt=function(){return this.throwIfDisposed(),zr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.square=function(){return this.throwIfDisposed(),on(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.squaredDifference=function(t){return this.throwIfDisposed(),wR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.squeeze=function(t){return this.throwIfDisposed(),Do(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Yt?[this,t]:[this,...t];return ii(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.step=function(t){return this.throwIfDisposed(),Zh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.stridedSlice=function(t,e,n,r,s,i,o,a){return this.throwIfDisposed(),_q(this,t,e,n,r,s,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sub=function(t){return this.throwIfDisposed(),Be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sum=function(t,e){return this.throwIfDisposed(),Ke(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tan=function(){return this.throwIfDisposed(),$q(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tanh=function(){return this.throwIfDisposed(),cd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tile=function(t){return this.throwIfDisposed(),Qi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toBool=function(){return this.throwIfDisposed(),Fe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toFloat=function(){return this.throwIfDisposed(),Fe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toInt=function(){return this.throwIfDisposed(),Fe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.topk=function(t,e){return this.throwIfDisposed(),Pq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.transpose=function(t){return this.throwIfDisposed(),Lt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unique=function(t){return this.throwIfDisposed(),Dq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),SR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unstack=function(t){return this.throwIfDisposed(),ao(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.where=function(t,e){return this.throwIfDisposed(),Zr(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.zerosLike=function(){return this.throwIfDisposed(),Bt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ia extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ia.prototype)}}class Zi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Zi.prototype)}}class se extends Error{constructor(e){super(e),Object.setPrototypeOf(this,se.prototype)}}class It extends Error{constructor(e){super(e),Object.setPrototypeOf(this,It.prototype)}}class iO extends Error{constructor(e){super(e),Object.setPrototypeOf(this,iO.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class U9{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dd(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function oa(t,e){if(!t)throw new iO(e)}function m4(t,e){let n=0;for(const r of t)r===e&&n++;return n}function xs(t){return t.length===1?t[0]:t}function Qt(t){return Array.isArray(t)?t:[t]}function Za(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function wu(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Mi={};function oO(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function iA(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>iA(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:iA(r))}}}function Sy(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Mi)o=Mi[i];else if(o=e[i],o==null)throw new se(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new se(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,c;if(o in n?[a,c]=n[o]:o in Mi?[a,c]=Mi.className:o in e&&([a,c]=e[o]),a==null)throw new se(`Unknown ${r}: ${o}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){const l={};for(const m of Object.keys(Mi))l[m]=Mi[m];for(const m of Object.keys(n))l[m]=n[m];const u=i.config;u.customObjects=l;const d=Object.assign({},Mi);for(const m of Object.keys(n))Mi[m]=n[m];iA(i.config);const h=c(a,i.config,n,s);return Mi=Object.assign({},d),h}else{const l=Object.assign({},Mi);for(const d of Object.keys(n))Mi[d]=n[d];const u=new a(i.config);return Mi=Object.assign({},l),u}}}function DPe(t,e){return t<e?-1:t>e?1:0}function yb(t,e){return-1*DPe(t,e)}function fl(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function FPe(t){if(t==null)throw new se(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Nd(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new se(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function aO(t,e,n=0,r=1/0){return oa(n>=0),oa(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function Sr(t,e){Array.isArray(t)?(U(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>Sr(n,`element ${r+1} of ${e}`))):U(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${V9(t)}.`)}function V9(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>V9(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function LPe(t,e,n){let r=n!=null?n():ws(),s;return(...o)=>{const a=n!=null?n():ws();return a-r<e||(r=a,s=t(...o)),s}}function j9(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let BPe=0;function H9(){return BPe++}const vb={};function SS(t=""){return t in vb||(vb[t]=0),vb[t]+=1,t+vb[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const MPe=["channelsFirst","channelsLast"],zPe=["nearest","bilinear"],UPe=["valid","same","causal"],VPe=["max","avg"],jPe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wf=new Map;function Qn(t){Nd(MPe,"DataFormat",t)}function HPe(t){Nd(zPe,"InterpolationFormat",t)}function _i(t){Nd(UPe,"PaddingMode",t)}function W9(t){Nd(VPe,"PoolMode",t)}const jm=[],g4="/";function Mu(t,e){jm.push(t);try{const n=e();return jm.pop(),n}catch(n){throw jm.pop(),n}}function WPe(){return jm.length===0?"":jm.join(g4)+g4}function G9(t){if(!K9(t))throw new Error("Not a valid tensor name: '"+t+"'");return WPe()+t}function q9(t){if(!K9(t))throw new Error("Not a valid tensor name: '"+t+"'");wf.has(t)||wf.set(t,0);const e=wf.get(t);if(wf.set(t,wf.get(t)+1),e>0){const n=`${t}_${e}`;return wf.set(n,1),n}else return t}const GPe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function K9(t){return!!t.match(GPe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qPe(t){return t===parseInt(t.toString(),10)}function hl(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function Eh(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Al(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Vo(t,e){if(e<t)throw new se(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let G2;function lr(){return G2==null&&(G2=T8().epsilon()),G2}function jo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wa(t,e){return Fe(t,e)}function ky(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),re(t,n)}function KPe(t,e){return ae(()=>{if(t.shape.length!==2)throw new se(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=ky(t,1);return oA(n,[1,e,1])})}function XPe(t){const e=[hl(t.shape)];return re(t,e)}function QPe(t){if(t.rank<=1)throw new se(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],hl(t.shape,1)];return re(t,e)}function zu(t,e,n){return ae(()=>{switch(t.rank){case 1:return uS(t,e,n);case 2:return vR(t,[e,0],[n,t.shape[1]]);case 3:return dS(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Mg(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return at(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return at(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new se(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function q2(t,e,n){return ae(()=>{switch(t.rank){case 1:return uS(t,e,n);case 2:return vR(t,[0,e],[t.shape[0],n]);case 3:return dS(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Mg(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new se(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function bb(t,e,n,r){return ae(()=>{switch(t.rank){case 1:return uS(t,e,n);case 2:switch(r){case 1:return zu(t,e,n);case 2:return q2(t,e,n);default:throw new se(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return zu(t,e,n);case 2:return dS(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return q2(t,e,n);default:throw new se(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return zu(t,e,n);case 2:return Mg(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Mg(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return q2(t,e,n);default:throw new se(`The axis is not within the rank of the tensor ${r}`)}default:throw new se(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function cO(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),zn(t,e)}function y4(t,e){switch(t.rank){case 1:return rq([t,e]);case 2:return ZI([t,e],0);case 3:return sq([t,e],0);case 4:return iq([t,e],0);default:throw new se(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function oA(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new se(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Qi(t,e)}function kS(t,e=0,n=1,r,s){return uR(t,e,n,r,s)}function xa(t,e,n,r){if(t.rank<2||e.rank<2)throw new It(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new It(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return tA({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?aA(t.rank,r,jo()):null,activation:n});{const s=t.shape.slice(),i=s.pop();t=re(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),c=o.pop(),l=[...o,a],u=Array.from({length:e.rank},(g,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=re(Lt(e,u),[c,-1]);const d=[...s,...l];return re(tA({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?aA(t.rank,r,jo()):null,activation:n}),d)}}function X9(t,e,n){return ae(()=>(Array.isArray(e)?e=Ir(e,"int32"):e=Fe(e,"int32"),by(t,e,n)))}function Ey(t){return ee(t,t)}function aA(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new se(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?re(e,[1,r[0],1,1,1]):re(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?re(e,[1,1,1,1,r[0]]):re(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?re(e,[1,r[0],1,1]):re(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?re(e,[1,1,1,r[0]]):re(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?re(e,[1,r[0],1]):re(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?re(e,[1,1,r[0]]):re(e,[1].concat(r))}else if(t<3)return e;throw new se(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ko(t,e,n){return ae(()=>(n==null&&(n=jo()),Qn(n),xe(t,aA(t.rank,e,n))))}function YPe(t,e=1){if(e!==1)throw new It(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return gy(t)}function ZPe(t){return ae(()=>We(t,xe(ar(t),1)))}function Q9(t,e,n,r){return ae(()=>Bq(t,e,n,r))}function JPe(t){return ae(()=>{const e=xe(.5,ee(.2,t));return ri(e,0,1)})}function Cy(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const eDe=["fanIn","fanOut","fanAvg"],tDe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nDe(t){Nd(eDe,"FanMode",t)}function rDe(t){Nd(tDe,"Distribution",t)}class lo extends ep{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Y9 extends lo{apply(e,n){return cr(e,n)}}Y9.className="Zeros";Ie(Y9);class lO extends lo{apply(e,n){return Zs(e,n)}}lO.className="Ones";Ie(lO);class Z9 extends lo{constructor(e){if(super(),typeof e!="object")throw new se(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new se(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return ae(()=>ee(rt(this.value),Zs(e,n)))}getConfig(){return{value:this.value}}}Z9.className="Constant";Ie(Z9);class J9 extends lo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Td(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}J9.className="RandomUniform";Ie(J9);class e7 extends lo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new It(`randomNormal does not support dType ${n}.`);return kS(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}e7.className="RandomNormal";Ie(e7);class t7 extends lo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new It(`truncatedNormal does not support dType ${n}.`);return IR(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}t7.className="TruncatedNormal";Ie(t7);class n7 extends lo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return ae(()=>{if(e.length!==2||e[0]!==e[1])throw new se("Identity matrix initializer can only be used for 2D square matrices.");return ee(this.gain,sR(e[0]))})}getConfig(){return{gain:this.gain}}}n7.className="Identity";Ie(n7);function sDe(t,e="channelsLast"){let n,r;if(Qn(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=hl(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=hl(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=hl(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class oi extends lo{constructor(e){if(super(),e.scale<0)throw new se(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,nDe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,rDe(this.distribution),this.seed=e.seed}apply(e,n){const r=sDe(e),s=r[0],i=r[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,s):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(s+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new It(`${this.getClassName()} does not support dType ${n}.`);return IR(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Td(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}oi.className="VarianceScaling";Ie(oi);class uO extends oi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return oi.className}}uO.className="GlorotUniform";Ie(uO);class dO extends oi{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return oi.className}}dO.className="GlorotNormal";Ie(dO);class fO extends oi{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return oi.className}}fO.className="HeNormal";Ie(fO);class hO extends oi{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return oi.className}}hO.className="HeUniform";Ie(hO);class pO extends oi{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return oi.className}}pO.className="LeCunNormal";Ie(pO);class mO extends oi{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return oi.className}}mO.className="LeCunUniform";Ie(mO);class r7 extends lo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return ae(()=>{if(e.length<2)throw new It("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=me(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(s,r),Math.min(s,r)],a=kS(o,0,1,n,this.seed),c=qq.qr(a,!1);let l=c[0];const d=c[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return l=ee(l,d.sign()),r<s&&(l=l.transpose()),ee(rt(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}r7.className="Orthogonal";Ie(r7);const v4={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function b4(t,e={}){return Sy(t,Ki.getMap().classNameMap,e,"initializer")}function $n(t){return oO(t)}function xn(t){if(typeof t=="string"){const e=t in v4?v4[t]:t;if(e==="GlorotNormal")return new dO;if(e==="GlorotUniform")return new uO;if(e==="HeNormal")return new fO;if(e==="HeUniform")return new hO;if(e==="LeCunNormal")return new pO;if(e==="LeCunUniform")return new mO;{const n={};return n.className=e,n.config={},b4(n)}}else return t instanceof lo?t:b4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cA(t){return Array.isArray(t)&&Array.isArray(t[0])}function $x(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function ut(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new se(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ht(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new se(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rx(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const w4="Variable";class iDe{constructor(e,n="float32",r=w4,s=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=H9(),r=r??w4,this.originalName=G9(r),this.name=q9(this.originalName),this.trainable_=s,this.constraint=i,this.val=Fq(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),oDe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function oDe(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function lA(t){return t.map(e=>e.read())}function gO(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ur{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Aa{constructor(e,n,r,s,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=a,this.id=H9(),o!=null&&(this.originalName=G9(o),this.name=q9(this.originalName)),this.rank=n.length}}let aDe=0,ES=class{constructor(e,n){this.callArgs=n,this.id=aDe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},cDe=0;class _t extends ep{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=cDe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=Za(r)+"_"+SS(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Zi(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new se(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return xs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return xs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ia(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ia(`Layer ${this.name} is not connected, no input to return.`);return xs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ia(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ia(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return xs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Qt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=Qt(this.inputSpec);if(n.length!==r.length)throw new se(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let s=0;s<n.length;s++){const i=n[s],o=r[s];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new se(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new se(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new se(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new se(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const c=i.shape;for(const l in o.axes){const u=Number(l),d=o.axes[l],h=u>=0?c[u]:c[c.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new se(`Input ${s} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${c}.`)}}if(o.shape!=null)for(let c=0;c<o.shape.length;++c){const l=o.shape[c],u=i.shape[c];if(l!=null&&u!=null&&l!==u)throw new se(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=Qt(e),s=dDe(e),i=fDe(e);if(s===i)throw new se("Arguments to apply() must be all SymbolicTensors or all Tensors");return Mu(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Qt(e))o.push(a.shape);this.build(xs(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=Qt(o),c=[];for(let l of a)r.indexOf(l)!==-1&&(l=l.clone()),c.push(l);if(o=xs(c),this.activityRegularizer!=null)throw new It("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=lDe(e),a=this.computeOutputShape(o);let c;const l=uDe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?c=a.map((u,d)=>new Aa(l,u,this,Qt(e),n,this.name,d)):c=new Aa(l,a,this,Qt(e),n,this.name),this.addInboundNode(e,c,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new It("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ia(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ia(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Zi(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Rx(this.weights)}build(e){this.built=!0}getWeights(e=!1){return lA(e?this.trainableWeights:this.weights)}setWeights(e){ae(()=>{const n=this.weights;if(n.length!==e.length)throw new se(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=lA(n);for(let i=0;i<s.length;++i){const o=s[i],a=n[i],c=e[i];if(!Dt(o.shape,c.shape))throw new se(`Layer weight shape ${o.shape} not compatible with provided weight shape ${c.shape}`);r.push([a,c])}gO(r)})}addWeight(e,n,r,s,i,o,a,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new se(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=c!=null?c():xn("zeros"));const l=s.apply(n,r),u=new iDe(l,r,e,o,a);return l.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Qt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const s=this.computeMask(e,r),i=Qt(n),o=Qt(s);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,r,s,i,o,a=null){const c=Qt(e);n=Qt(n),r=Qt(r),s=Qt(s),i=$x(i),o=$x(o);const l=[],u=[],d=[];for(const h of c)l.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new ES({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:d,inputTensors:c,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function lDe(t){t=Qt(t);const e=[];for(const n of t)e.push(n.shape);return xs(e)}function uDe(t){return"float32"}function s7(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const o=r.inputTensors[i],a=r.inboundLayers[i],c=r.nodeIndices[i],l=s7(o,a,c);for(const u of l)s.indexOf(u)===-1&&s.push(u)}return s}}}function dDe(t){let e=!0;for(const n of Qt(t))if(!(n instanceof Aa)){e=!1;break}return e}function fDe(t){let e=!0;for(const n of Qt(t))if(n instanceof Aa){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ty extends _t{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:SS("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new se("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new se("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new se("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new Aa(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new ES({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new se(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Ty.className="InputLayer";Ie(Ty);function hDe(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new se("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Ty({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pDe(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Fe(e,t.dtype)}catch{throw new se(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class al{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof al)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=pDe(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new se(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Aa){if(this.id2Value[e.id]==null)throw new se(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new se(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Aa){if(this.id2Value[e.id]==null)throw new se(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new se(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Tt(this.id2Mask)}}const Ox=new U9,Px=new U9;function mDe(t){Ox?.setMaxEntries(t),Px?.setMaxEntries(t)}function Tm(t,e,n,r){const s=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(g=>g.name),c=[],l=e.names();for(const g of a)l.indexOf(g)!==-1?c.push(e.getValue(g)):c.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Ox.get(u),h;if(d==null){const g=gDe(o,e);d=g.sorted,h=g.recipientCounts,Ox.put(u,d),Px.put(u,h)}h={},s||Object.assign(h,Px.get(u));const m=new al(e);for(let g=0;g<d.length;++g){const v=d[g],y=v.sourceLayer;if(y instanceof Ty)continue;const w=[],x=[],S=[];let k=!1;for(const P of v.inputs){const O=m.getValue(P),_=m.getMask(P);w.push(O),x.push(_),_!=null&&(k=!0),s||(h[P.name]--,h[P.name]===0&&!e.hasKey(P)&&a.indexOf(P.name)===-1&&!O.isDisposed&&P.sourceLayer.stateful!==!0&&S.push(O))}k&&(n=n||{},n.mask=x[0]);const E=Qt(y.apply(w,n));let A=null;y.supportsMasking&&(A=y.computeMask(w,x));const R=vDe(v),N=Array.isArray(R)?R:[R];for(let P=0;P<N.length;++P){m.hasKey(N[P])||m.add(N[P],E[P],Array.isArray(A)?A[0]:A);const O=a.indexOf(N[P].name);O!==-1&&(c[O]=E[P])}s||Tt(S)}return m.disposeMasks(),i?c:c[0]}function gDe(t,e){U(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=x4(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of t){const{sorted:o,recipientMap:a}=x4(i,e);for(const c of o)s.has(c.name)||(n.push(c),s.add(c.name));for(const c in a)r[c]==null&&(r[c]=new Set),a[c].forEach(l=>r[c].add(l))}}return{sorted:n,recipientCounts:yDe(r)}}function yDe(t){const e={};for(const n in t)e[n]=t[n].size;return e}function x4(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const c=o[o.length-1]===i.length-1;if(a.inputs.length===0||c)i.pop(),r.push(a),n.add(a.name),c&&o.pop();else{o.push(i.length-1);for(const l of a.inputs)s[l.name]==null&&(s[l.name]=new Set),s[l.name].add(a.name),!n.has(l.name)&&i.push(l)}}return{sorted:r,recipientMap:s}}function vDe(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bDe=fe();bDe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,mDe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yO(t,e){return ae(()=>zr(Ke(ee(t,t),e,!0)))}class Ay extends ep{getConfig(){return{}}}class i7 extends Ay{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ae(()=>{const n=yO(e,this.axis),r=ri(n,0,this.maxValue);return ee(e,We(r,xe(lr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}i7.className="MaxNorm";Ie(i7);class o7 extends Ay{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ae(()=>We(e,xe(lr(),yO(e,this.axis))))}getConfig(){return{axis:this.axis}}}o7.className="UnitNorm";Ie(o7);class a7 extends Ay{apply(e){return Ra(e)}}a7.className="NonNeg";Ie(a7);class c7 extends Ay{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ae(()=>{const n=yO(e,this.axis),r=xe(ee(this.rate,ri(n,this.minValue,this.maxValue)),ee(1-this.rate,n));return ee(e,We(r,xe(lr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}c7.className="MinMaxNorm";Ie(c7);const I4={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hr(t){return oO(t)}function S4(t,e={}){return Sy(t,Ki.getMap().classNameMap,e,"constraint")}function pr(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in I4?I4[t]:t,config:{}};return S4(n)}else return t instanceof Ay?t:S4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function fu(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const i=t[s];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(s),r.push(o)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)t[n[i]]=s[i][0];Tt(r)}}function l7(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var k4;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(k4||(k4={}));const wDe=125;class Ug{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class xDe{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class IDe extends Ug{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const i=n[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let o;s in this.totals?o=this.totals[s]:this.totals[s]=0;const a=ae(()=>xe(this.totals[s],ee(i,r)));this.totals[s]=a,o?.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ae(()=>{const s=ee(We(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),xr(n[r])}))}}class SDe extends Ug{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const c=o[a];e.push(c.data()),n.push(i),r.push(a)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=s[i][0]}}class kDe extends Ug{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||p9,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=wDe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");DT(this.yieldEvery)&&(this.maybeWait=LPe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await fu(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await fu(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await fu(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await fu(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await fu(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):DT(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await fu(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await fu(e),await this.trainEnd(e))}}function u7(t,e){return t==null&&(t={}),t instanceof Ug?[t]:Array.isArray(t)&&t[0]instanceof Ug?t:Qt(t).map(r=>new kDe(r,e))}class Vi{constructor(){}static registerCallbackConstructor(e,n){U(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Vi.checkForDuplicate(n),Vi.constructors[e]==null&&(Vi.constructors[e]=[]),Vi.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Vi.constructors)Vi.constructors[+n].forEach(s=>{if(s===e)throw new se("Duplicate callback constructor.")})}static clear(){Vi.constructors={}}static createCallbacks(e){const n=[];for(const r in Vi.constructors){const s=+r;e>=s&&n.push(...Vi.constructors[s])}return n.map(r=>new r)}}Vi.constructors={};function d7(t,e,n,r,s,i,o,a,c){const l=new SDe,u=[new IDe,...Vi.createCallbacks(e)];t!=null&&u.push(...t),u.push(l);const d=new xDe(u);return d.setParams({epochs:n,initialEpoch:r,samples:s,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:c}),{callbackList:d,history:l}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ac(t,e={},n=!1){return Sy(t,Ki.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dx(t,e){return ae(()=>{t.dtype!=="float32"&&(t=Fe(t,"float32"));const n=Ke(Ey(t),e,!0),r=Qh(n.shape,lr()),s=zr(Tc(n,r));return We(t,s)})}function CS(t,e){return ae(()=>Mn(Ey(Be(e,t)),-1))}function vO(t,e){return ae(()=>Mn(ar(Be(e,t)),-1))}function bO(t,e){return ae(()=>{const n=Be(t,e),r=ri(ar(t),lr(),Number.MAX_VALUE),s=ar(We(n,r));return ee(100,Mn(s,-1))})}function EDe(t,e){return ae(()=>{const n=ri(e,lr(),Number.MAX_VALUE),r=Ei(xe(1,n)),s=ri(t,lr(),Number.MAX_VALUE),i=Ei(xe(1,s));return Mn(Ey(Be(r,i)),-1)})}function CDe(t,e){return ae(()=>{const n=Tc(0,Be(1,ee(t,e)));return Mn(Ey(n),-1)})}function TDe(t,e){return ae(()=>{const n=Tc(0,Be(1,ee(t,e)));return Mn(n,-1)})}function ADe(t,e){return ae(()=>{const n=Ke(ee(t,e),-1),r=no(ee(Be(1,t),e),-1);return Tc(0,xe(1,Be(r,n)))})}function NDe(t,e){return ae(()=>{const n=Math.log(2),r=Be(e,t),s=Be(xe(r,Yh(ee(-2,r))),n);return Mn(s,-1)})}function Vg(t,e,n=!1){return ae(()=>{if(n)e=fS(e);else{const r=Ke(e,e.shape.length-1,!0);e=We(e,r)}return e=ri(e,lr(),1-lr()),gn(Ke(ee(Fe(t,"float32"),Ei(e)),e.shape.length-1))})}function Fx(t,e,n=!1){return ae(()=>{const r=Fe(vy(XPe(t)),"int32");e=ri(e,lr(),1-lr());const s=e.shape,i=re(cR(r,s[s.length-1]),s);return Vg(i,e,n)})}function _De(t,e){if(!Dt(t.shape,e.shape))throw new se(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return ae(()=>{const n=Ra(e),r=gn(ar(e));return xe(Be(n,ee(e,t)),nS(si(r)))})}function TS(t,e){return ae(()=>{let n;return n=ri(e,lr(),1-lr()),n=Ei(We(n,Be(1,n))),Mn(_De(t,n),-1)})}function $De(t,e){return ae(()=>{const n=ri(t,lr(),1),r=ri(e,lr(),1);return Ke(ee(t,Ei(We(n,r))),-1)})}function RDe(t,e){return ae(()=>{const n=Ei(xe(lr(),e));return Mn(Be(e,ee(t,n)),-1)})}function f7(t,e){return ae(()=>{const n=Dx(t,-1),r=Dx(e,-1),s=ee(n,r);return gn(Ke(s,-1))})}const Lx={meanSquaredError:CS,meanAbsoluteError:vO,meanAbsolutePercentageError:bO,meanSquaredLogarithmicError:EDe,squaredHinge:CDe,hinge:TDe,categoricalHinge:ADe,logcosh:NDe,categoricalCrossentropy:Vg,sparseCategoricalCrossentropy:Fx,binaryCrossentropy:TS,kullbackLeiblerDivergence:$De,poisson:RDe,cosineProximity:f7};function K2(t){if(typeof t=="string"){if(t in Lx)return Lx[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new se(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h7(t,e){return ae(()=>{const n=ee(.5,Ci(e)),r=wa(li(e,n),t.dtype);return Mn(Uo(t,r),-1)})}function p7(t,e){return ae(()=>wa(Uo(xh(t,-1),xh(e,-1)),"float32"))}function ODe(t,e){return ae(()=>Fe(Ke(Ta(Uo(t,1),Uo(e,1))),"float32"))}function PDe(t,e){return ae(()=>Fe(Ke(Ta(Uo(t,0),Uo(e,1))),"float32"))}function DDe(t,e){return ae(()=>{const n=ODe(t,e),r=PDe(t,e),s=xe(n,r);return Fe(Zr(li(s,0),We(n,s),0),"float32")})}function FDe(t,e){return TS(t,e)}function LDe(t,e){return t.rank===e.rank&&(t=Do(t,[t.rank-1])),e=xh(e,-1),e.dtype!==t.dtype&&(e=Fe(e,t.dtype)),Fe(Uo(t,e),"float32")}const BDe=CS,MDe=CS,zDe=vO,UDe=vO,VDe=bO,jDe=bO,m7=Vg,HDe=f7,g7=Fx,Bx={binaryAccuracy:h7,categoricalAccuracy:p7,precision:DDe,categoricalCrossentropy:m7,sparseCategoricalCrossentropy:g7,mse:BDe,MSE:MDe,mae:zDe,MAE:UDe,mape:VDe,MAPE:jDe,cosine:HDe};function WDe(t){if(typeof t=="string"&&t in Bx)return Bx[t];if(typeof t!="string"&&t!=null)return t;throw new se(`Unknown metric ${t}`)}function wb(t){if(oa(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Lx))if(Lx[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Bx))if(Bx[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GDe(t){const e={Adagrad:()=>bf.adagrad(.01),Adadelta:()=>bf.adadelta(1,.95,lr()),Adam:()=>bf.adam(.001,.9,.999,lr()),Adamax:()=>bf.adamax(.002,.9,.999,lr(),0),RMSProp:()=>bf.rmsprop(.001,.9,0,lr()),SGD:()=>bf.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new se(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const E4=1*1024*1024;function C4(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!uA(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>E4&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${E4}.`)}}function uA(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!uA(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!uA(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qDe(t,e,n,r=console.log){const s=XDe(t),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!s){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}r("_".repeat(e)),Mx(i,n,r),r("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)s?QDe(a[u],n,r):YDe(a[u],n,o,r),r((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=KDe(t),l=Rx(t.nonTrainableWeights);r(`Total params: ${c+l}`),r(`Trainable params: ${c}`),r(`Non-trainable params: ${l}`),r("_".repeat(e))}function KDe(t){let e;return t.collectedTrainableWeights!=null?e=Rx(t.collectedTrainableWeights):e=Rx(t.trainableWeights),e}function XDe(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let i=!1;for(const o of s.inboundNodes)if(r.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Mx(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function QDe(t,e,n){let r,s;try{s=t.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,s,r,t.countParams().toString()];Mx(a,e,n)}function YDe(t,e,n,r){let s,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const m=d.inboundLayers[h].name,g=d.nodeIndices[h],v=d.tensorIndices[h];o.push(`${m}[${g}][${v}]`)}const a=t.name,c=t.getClassName(),l=o.length===0?"":o[0],u=[`${a} (${c})`,i,s,t.countParams().toString(),l];Mx(u,e,r);for(let d=1;d<o.length;++d)Mx(["","","","",o[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function y7(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function dA(t,e){if(t===null)return null;if(typeof t=="string")return wu(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];y7(e,s,i)?n.push(i):n.push(dA(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const i=wu(r);n[i]=dA(s,i)}}return n}}function fA(t,e){if(t==null)return null;if(typeof t=="string")return Za(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const i=t[s];y7(e,s,i)?n.push(i):n.push(fA(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],i=Za(r);(r==="name"||r==="className")&&typeof s=="string"?n[i]=s:n[i]=fA(s,r)}return n}}/** @license See the LICENSE file. */const v7="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZDe=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Io extends _t{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=SS(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],fl(this.inputs).length!==this.inputs.length)throw new se(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);fl(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const S=x.sourceLayer,k=x.nodeIndex,E=x.tensorIndex;this.outputLayers.push(S),this.outputLayersNodeIndices.push(k),this.outputLayersTensorIndices.push(E)}for(const x of this.inputs){const S=x.sourceLayer,k=x.nodeIndex,E=x.tensorIndex;oa(k===0,"input layer has >1 nodes"),oa(E===0,"input layer has >1 tensors"),this.inputLayers.push(S),this.inputLayersNodeIndices.push(k),this.inputLayersTensorIndices.push(E)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const S=this.inputLayers[x];if(!(S instanceof Ty))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${S.getClassName()}.`);this.inputNames.push(S.name),this.feedInputShapes.push(S.batchInputShape),this.feedInputNames.push(S.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},r={},s={},i={},o={},a=[],c=(x,S,k,E,A,R)=>{(E==null||A==null||R==null)&&(E=x.sourceLayer,A=x.nodeIndex,R=x.tensorIndex);const N=E.inboundNodes[A];if(k.indexOf(N)!==-1)throw new Zi(`The tensor ${x.name} at layer "${E.name}" is part of a cycle.`);if(S.indexOf(N)!==-1)return;this.containerNodes.add(Io.nodeKey(E,A)),E.id in o||(o[E.id]=Object.keys(o).length),k.indexOf(N)===-1&&k.push(N);const P=N.inboundLayers.length;for(let O=0;O<P;O++){const _=N.inputTensors[O],M=N.inboundLayers[O],G=N.nodeIndices[O],q=N.tensorIndices[O];c(_,S,k,M,G,q)}for(S.push(N);k.indexOf(N)>=0;)k.splice(k.indexOf(N),1);a.push(N)},l=[],u=[];for(const x of this.outputs)c(x,l,u);const d=a.slice().reverse();for(const x of d){r[x.id]=x,x.id in n||(n[x.id]=0);let S=n[x.id];const k=s[x.outboundLayer.id]==null?0:s[x.outboundLayer.id];S=Math.max(S,k),s[x.outboundLayer.id]=S,i[x.outboundLayer.id]=x.outboundLayer,n[x.id]=S;for(let E=0;E<x.inboundLayers.length;E++){const A=x.inboundLayers[E],R=x.nodeIndices[E],N=A.inboundNodes[R],P=n[N.id]==null?0:n[N.id];n[N.id]=Math.max(S+1,P),r[N.id]=N}}const h={};for(const x in n){const S=n[x];S in h||(h[S]=[]),h[S].push(r[x])}const m={};for(const x in s){const S=s[x];S in m||(m[S]=[]),m[S].push(i[x])}let g=Object.keys(m).map(x=>parseInt(x,10)).sort(yb);this.layers=[];for(const x of g){const S=m[x];S.sort((k,E)=>{const A=o[k.id],R=o[E.id];return A<R?-1:A>R?1:0});for(const k of S)k instanceof Io&&this.internalContainerRefs.push(k),this.layers.push(k)}this.layersByDepth=m,g=Object.keys(h).map(x=>parseInt(x,10)).sort(yb);const v=this.inputs.slice(),y=[];for(const x of g)for(const S of h[x]){const k=S.outboundLayer;if(k!=null){for(const E of S.inputTensors)if(v.indexOf(E)===-1)throw new Zi(`Graph disconnected: cannot obtain value for tensor ${E} at layer "${k.name}". The following previous layers were accessed without issue: ${y}`);for(const E of S.outputTensors)v.push(E);y.push(k.name)}}this.nodesByDepth=h;const w=this.layers.map(x=>x.name);for(const x of w){const S=w.filter(k=>k===x).length;if(S!==1)throw new Zi(`The name "${x}" is used ${S} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new ES({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new se("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;const i=ZDe(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[c,l]of a.weights.entries()){const u=i?`${l.name.split("/").slice(0,-1).join("/")+"/"}${c}`:l.originalName;if(r[u]!=null)throw new se(`Duplicate weight name: ${u}`);r[u]=l,s++}const o=[];for(const a in e){let c=a;if(r[a]==null){const l=a.split("/");c=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[c]!=null)o.push([r[c],e[a]]);else if(n)throw new se(`Provided weight data has no target variable: ${a}`);delete r[c]}if(n){const a=[];for(const c in r)a.push(c);if(a.length>0)throw new se(`${a.length} of ${s} weights are not set: ${a}`)}gO(o)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),s=["vars","layer_checkpoint_dependencies"],i=r.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!s.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${v7}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=fA(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return ae(()=>{e=Qt(e);const r=new al;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return Tm(this.outputs,r,n)})}computeMask(e,n){return ae(()=>{e=Qt(e);let r;return n==null?r=dd(null,e.length):r=Qt(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=$x(e);if(n.length!==this.inputLayers.length)throw new se(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const c=this.inputLayers[a],l=n[a],u=c.name+"_0_0";r[u]=l}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(yb);if(s.length>1)for(const a of s){const c=this.nodesByDepth[a];for(const l of c){const u=l.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(u.id)!==-1)continue;const d=[];for(let v=0;v<l.inboundLayers.length;v++){const y=l.inboundLayers[v],w=l.nodeIndices[v],x=l.tensorIndices[v],S=`${y.name}_${w}_${x}`,k=r[S];d.push(k)}const h=u.computeOutputShape(xs(d)),m=$x(h),g=u.inboundNodes.indexOf(l);for(let v=0;v<m.length;v++){const y=`${u.name}_${g}_${v}`;r[y]=m[v]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const c=this.outputLayers[a],l=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${c.name}_${l}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const c=o[a];oa(c in r),i.push(r[c])}return xs(i)}runInternalGraph(e,n){n==null&&(n=dd(null,e.length));const r={};for(let c=0;c<this.inputs.length;++c){const l=this.inputs[c],u=e[c],d=n[c];r[l.id]=[u,d]}const s=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(yb);for(const c of s){const l=this.nodesByDepth[c];for(const u of l){const d=u.outboundLayer,h=u.inputTensors,m=u.outputTensors,g=new Array;for(const v of h)v.id in r&&g.push(r[v.id]);if(g.length===h.length){let v={},y,w,x,S;if(u.callArgs!=null&&(v=u.callArgs),g.length===1){const[k,E]=g[0];v.mask==null&&(v.mask=E),x=Qt(d.call(k,v)),S=Qt(d.computeMask(k,E)),y=[k],w=[E]}else y=g.map(k=>k[0]),w=g.map(k=>k[1]),v.mask==null&&(v.mask=w),x=Qt(d.call(y,v)),S=Qt(d.computeMask(y,w));if(d.activityRegularizer)throw new It("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let k=0;k<m.length;++k){const E=m[k],A=x[k],R=S[k];r[E.id]=[A,R]}}}}const i=[],o=[],a=[];for(const c of this.outputs){oa(c.id in r,`Could not compute output ${c.name} : ${c.id}`);const[l,u]=r[c.id];a.push(l.shape),i.push(l),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof Io?1:0;for(let i=0;i<s.inboundNodes.length;i++){const o=Io.nodeKey(s,i);this.containerNodes.has(o)&&(n[o]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new se("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new se(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new se(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ae(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=Io.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),c=o.getConfig(),l=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],m=Io.nodeKey(o,d);let g={};if(this.containerNodes.has(m)){if(h.callArgs)try{JSON.stringify(h.callArgs),g=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),g={}}if(h.inboundLayers.length>0){const v=[];for(let y=0;y<h.inboundLayers.length;y++){const w=h.inboundLayers[y],x=h.nodeIndices[y],S=h.tensorIndices[y],k=Io.nodeKey(w,x);let E=n[k];E==null&&(E=0),v.push([w.name,E,S,g])}l.push(v)}}}const u={};u.name=o.name,u.className=a,u.config=c,u.inboundNodes=l,r.push(u)}e.layers=r;const s=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],c=this.inputLayersNodeIndices[o],l=Io.nodeKey(a,c);if(!this.containerNodes.has(l))continue;let u=n[l];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];s.push([a.name,u,d])}e.inputLayers=s;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],c=this.outputLayersNodeIndices[o],l=Io.nodeKey(a,c);if(!this.containerNodes.has(l))continue;let u=n[l];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,r={},s=!1){const i={},o={};function a(y,w){y.name in o?o[y.name].push(w):o[y.name]=[w]}function c(y,w){const x=[];let S;for(const k of w){const E=k[0],A=k[1],R=k[2];if(S=k[3]==null?{}:k[3],!(E in i)){a(y,w);return}const N=i[E];if(N.inboundNodes.length<=A){a(y,w);return}const P=N.inboundNodes[A];x.push(P.outputTensors[R])}x.length>0&&y.apply(xs(x),S)}function l(y){const w=y.name,x=ac(y,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(s),i[w]=x,y.inboundNodes.forEach(k=>{if(!(k instanceof Array))throw new se(`Corrupted configuration, expected array for nodeData: ${k}`);a(x,k)})}const u=n.name,d=n.layers;for(const y of d)l(y);for(;!FPe(o);)for(const y of d){const w=i[y.name];if(w.name in o){const x=o[w.name];delete o[w.name];for(const S of x)c(w,S)}}const h=[],m=[],g=n.inputLayers;for(const y of g){const w=y[0],x=y[1],S=y[2];oa(w in i);const E=i[w].inboundNodes[x].outputTensors;h.push(E[S])}const v=n.outputLayers;for(const y of v){const w=y[0],x=y[1],S=y[2];oa(w in i);const E=i[w].inboundNodes[x].outputTensors;m.push(E[S])}return new e({inputs:h,outputs:m,name:u})}get stateful(){if(this._stateful)throw new se("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ae(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JDe(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(i=>{i in t?s.push(t[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function b7(t,e){return JDe(t,e,"classWeight")}async function w7(t,e,n,r){if(n!=null){const s=ae(()=>{if(t.shape.length===1)return oc(t);if(t.shape.length===2){if(t.shape[1]>1)return xh(t,1);if(t.shape[1]===1)return re(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Tt(s);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),Ir(o,"float32")}else return null}function eFe(t,e){return ee(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tFe=32;function x7(t,e){let n,r;const s=e;n=s.xs,r=s.ys,U(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=T4("input",t.inputNames,n),o=T4("output",t.outputNames,r),a=i[0].shape[0];U(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),U(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let c=0;c<i.length;c++)U(i[c].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[c]} has ${i[c].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let c=0;c<o.length;c++)U(o[c].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[c]} has ${o[c].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function T4(t,e,n){if(n instanceof Yt)return[n];if(Array.isArray(n))return U(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new se(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function nFe(t){if(t.length===3)throw new It("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function rFe(t,e,n){const r=n.batchesPerEpoch!=null;if(U(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),U(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),U(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),U(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),U(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let i,o;if(s)if(A4(n.validationData))U(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=nFe(n.validationData);i=y.xs,o=y.ys}const a=t.makeTrainFunction(),c=t.getDedupedMetricsNames();let l;s?l=c.slice().concat(c.map(y=>"val_"+y)):l=c.slice();const u=u7(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:m}=d7(u,d,n.epochs,null,null,sFe(e,n),null,s,l);h.setModel(t),t.history=m,await h.onTrainBegin(),t.stopTraining_=!1;let g=n.initialEpoch==null?0:n.initialEpoch,v=await e.iterator();for(;g<n.epochs;){const y={};await h.onEpochBegin(g);let w=0,x=0;for(r||(v=await e.iterator());!r||w<n.batchesPerEpoch;){const S=await v.next();if(r&&S.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(S.value!=null){const{xs:k,ys:E}=x7(t,S.value),A={};A.batch=x,A.size=k[0].shape[0],await h.onBatchBegin(x,A);const R=[];if(n.classWeight!=null){const O=b7(n.classWeight,t.outputNames);for(let _=0;_<O.length;++_)R.push(await w7(E[_],null,O[_]))}const N=k.concat(E).concat(R),P=a(N);Tt(N);for(let O=0;O<c.length;++O){const _=c[O],M=P[O];A[_]=M,xr(M)}await h.onBatchEnd(x,A),l7(A),x++,w++}if(r?w>=n.batchesPerEpoch:S.done){if(s){let k;A4(n.validationData)?k=Qt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):k=Qt(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?tFe:n.validationBatchSize,verbose:0}));for(let E=0;E<t.metricsNames.length;++E)y[`val_${t.metricsNames[E]}`]=k[E]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(g,y),g++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function sFe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function A4(t){return typeof t.iterator=="function"}function iFe(t){return typeof t.next=="function"}async function oFe(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let i=[];if(n.verbose>0)throw new It("Verbose mode is not implemented yet.");U(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=iFe(e)?e:await e.iterator();let a=0,c=0;for(;!r||c<n.batches;){const l=await o.next();if(i=ae(()=>{if(l.value){const{xs:u,ys:d}=x7(t,l.value),h=u.concat(d),m=ae(()=>s(h));if(Tt(h),c===0)for(let v=0;v<m.length;++v)i.push(rt(0));const g=h[0].shape[0];for(let v=0;v<m.length;++v){const y=m[v],w=i[v];i[v]=ae(()=>xe(i[v],ee(g,y))),c>0&&Tt(w)}Tt(m),a+=g,++c}return i}),l.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<i.length;++l){const u=i[l];i[l]=We(i[l],a),Tt(u)}return xs(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function X2(t){U(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function hm(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>zu(r,e,n-e)):zu(t,e,n-e)}function hA(t,e){return ae(()=>t==null?null:Array.isArray(t)?t.map(n=>hA(n,e)):X9(t,e.dtype==="int32"?e:Fe(e,"int32")))}function Q2(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function I7(t){const e=[];t instanceof Yt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(ky(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function xo(t,e){if(t==null)return;const n=[];if(e instanceof Yt)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const i=e[s];n.push(i.id)}const r=[];if(t instanceof Yt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const i=t[s];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aFe(t){return t instanceof Yt}function pA(t){return Array.isArray(t)}function N4(t){return!aFe(t)&&!pA(t)}function _4(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(pA(t)&&t.length>0)o=!0;else if(N4(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new se(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(N4(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new se(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(pA(t)){if(t=t,t.length!==e.length)throw new se(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new se(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=I7(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new se(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let c=0;c<n[o].length;++c){if(c===0&&!r)continue;const l=a.shape[c],u=n[o][c];if(u!=null&&u>=0&&l!==u)throw new se(`${s} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function cFe(t,e,n){const r=fl(t.map(i=>i.shape[0]));r.sort();const s=fl(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new se(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(s.length>1)throw new se(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!Dt(r,s))throw new se(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function lFe(t,e,n){const r=[CS,TS,Vg];for(let s=0;s<t.length;++s){const i=t[s],o=e[s],a=n[s];if(o!=null){if(o===Vg&&i.shape[i.shape.length-1]===1)throw new se(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){const c=i.shape.slice(1),l=a.slice(1);for(let u=0;u<c.length;++u){const d=c[u],h=l[u];if(h!=null&&d!==h)throw new se(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function $4(t,e,n,r=!0,s=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new se(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new se(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new se(`Error when checking ${s}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let c=0;c<n[o].length;++c){if(c===0&&!r)continue;const l=a.shape[c],u=n[o][c];if(u!=null&&u!==l)throw new se(`Error when checking ${s}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function uFe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let i=n.hasOwnProperty(s)?n[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const dFe="layers-model";class Yf extends Io{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new se("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");qDe(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=GDe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Wl))throw new se("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new se(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(K2(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new se(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>K2(a))}else{const o=K2(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],c=this.outputNames[o];this.feedOutputNames.push(c),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Mu("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const s=uFe(e.metrics,this.outputNames),i=(o,a,c)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([c,o])};Mu("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(r.indexOf(o)!==-1)continue;const a=s[o];(l=>{let d,h,m;for(const g of l){if(typeof g=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(g)!==-1){const y=this.internalOutputShapes[o];y[y.length-1]===1||this.lossFunctions[o]===TS?["accuracy","acc"].indexOf(g)!==-1?h=h7:["crossentropy","ce"].indexOf(g)!==-1&&(h=FDe):this.lossFunctions[o]===Fx?["accuracy","acc"].indexOf(g)!==-1?h=LDe:["crossentropy","ce"].indexOf(g)!==-1&&(h=g7):["accuracy","acc"].indexOf(g)!==-1?h=p7:["crossentropy","ce"].indexOf(g)!==-1&&(h=m7);let w;["accuracy","acc"].indexOf(g)!==-1?w="acc":["crossentropy","ce"].indexOf(g)!==-1&&(w="ce"),m=h,d=""+w}else m=WDe(g),d=""+wb(g);let v;Mu(d,()=>{v=m}),i(o,d,v)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;X2(s);const o=this.standardizeUserDataXY(e,n,!0,s);try{const a=o[0].concat(o[1]);this.makeTestFunction();const c=this.testFunction,l=this.testLoop(c,a,s,r.verbose,r.steps);return xs(l)}finally{xo(o[0],e),xo(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),oFe(this,e,n)}checkNumSamples(e,n,r,s="steps"){let i;if(r!=null){if(i=null,n!=null)throw new se(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new se(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new se("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],i=this.retrieveSymbolicTensors(s),o=new al;if(e instanceof Yt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new se(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)o.add(this.inputs[c],e[c])}else for(const c of this.inputs){const l=e[c.name];if(l==null)throw new se(`No value is provided for the model's input ${c.name}`);o.add(c,l)}const a=Tm(i,o);return r?a:a[0]}retrieveSymbolicTensors(e){const n=dd(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const c=o.indexOf(e[a]);if(c!==-1&&(n[a]=i[c],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((i,o)=>{i==null&&s.push(e[o])}),new se(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return ae(()=>{const s=this.checkNumSamples(e);if(r)throw new It("Verbose predictLoop() is not implemented yet.");const i=Q2(s,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)ae(()=>{const l=i[a][0],u=i[a][1],d=hm(e,l,u),h=[];if(Array.isArray(d))for(let g=0;g<d.length;++g)h.push({key:this.inputs[g],value:d[g]});else h.push({key:this.inputs[0],value:d});const m=new al(h);return Tm(this.outputs,m)}).forEach((l,u)=>o[u].push(l));return xs(o.map(a=>zn(a,0)))})}predict(e,n={}){const r=I7(e);$4(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return X2(s),this.predictLoop(r,s)}finally{xo(r,e)}}predictOnBatch(e){$4(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new Zi("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===Fx?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=_4(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=_4(n,this.feedOutputNames,i,!1,"target"),cFe(e,n),lFe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new se(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,i=!0,o){const[a,c]=this.standardizeUserDataXY(e,n,i,o);if(r!=null)throw new Error("sample weight is not supported yet.");let l=null;if(s!=null){const u=b7(s,this.outputNames);l=[];for(let d=0;d<u.length;++d)l.push(await w7(c[d],null,u[d]))}return[a,c,l]}testLoop(e,n,r,s=0,i){return ae(()=>{const o=this.checkNumSamples(n,r,i,"steps"),a=[];if(s>0)throw new It("Verbose mode is not implemented yet.");if(i!=null)throw new It("steps mode in testLoop() is not implemented yet");{const c=Q2(o,r),l=Ir(Vo(0,o));for(let u=0;u<c.length;++u){const d=c[u][0],h=c[u][1],m=zu(l,d,h-d),g=hA(n,m),v=e(g);if(u===0)for(let y=0;y<v.length;++y)a.push(rt(0));for(let y=0;y<v.length;++y){const w=v[y];a[y]=xe(a[y],ee(h-d,w))}}for(let u=0;u<a.length;++u)a[u]=We(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(m4(e,s)>1){const o=m4(e.slice(0,r),s);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let v=0;v<this.inputs.length;++v)d.push({key:this.inputs[v],value:r[v]});const h=new al(d),m=Tm(this.outputs,h,{training:!0});let g;for(let v=0;v<this.lossFunctions.length;++v){const y=this.lossFunctions[v];let w=y(s[v],m[v]);i[v]!=null&&(w=eFe(w,i[v]));const x=Mn(w);n.push(x),v===0?g=w:g=xe(g,w)}for(let v=0;v<this.metricsTensors.length;++v){let y;if(this.outputs.length>1&&v<this.outputs.length)y=n[v];else{const w=this.metricsTensors[v][0],x=this.metricsTensors[v][1];y=Mn(w(s[x],m[x]))}xr(y),o.push(y)}return g=Mn(g),this.calculateLosses().forEach(v=>{g=xe(g,v)}),g},c=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,c)].concat(o)}}makeTestFunction(){this.testFunction=e=>ae(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let l=0;l<this.inputs.length;++l)o.push({key:this.inputs[l],value:s[l]});const a=new al(o),c=Tm(this.outputs,a);for(let l=0;l<this.lossFunctions.length;++l){const u=this.lossFunctions[l],d=Mn(u(i[l],c[l]));l===0?r=d:r=xe(r,d),n.push(r)}for(let l=0;l<this.metricsTensors.length;++l){const u=this.metricsTensors[l][0],d=this.metricsTensors[l][1],h=Mn(u(i[d],c[d]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,o,a,c,l,u,d,h;try{const m=r.batchSize==null?32:r.batchSize;X2(m);const v=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,m);s=v[0],i=v[1],h=v[2];let y=!1,w;if(r.validationData!=null&&r.validationData.length>0){if(y=!0,r.validationData.length===2)c=r.validationData[0],l=r.validationData[1];else throw r.validationData.length===3?new It("validationData including sample weights is not supported yet."):new se(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const O=await this.standardizeUserData(c,l,null,null,!0,m);u=O[0],d=O[1],w=u.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){y=!0;const P=Math.floor(s[0].shape[0]*(1-r.validationSplit)),O=s[0].shape[0];u=hm(s,P,O),o=s,s=hm(s,0,P),d=hm(i,P,O),a=i,i=hm(i,0,P),w=u.concat(d)}else r.validationSteps!=null&&(y=!0);const x=s.concat(i).concat(h);this.checkTrainableWeightsConsistency();const S=this.makeTrainFunction(),k=this.getDedupedMetricsNames();let E,A;y?(this.makeTestFunction(),E=this.testFunction,A=k.slice().concat(k.map(P=>"val_"+P))):(E=null,w=[],A=k.slice());const R=u7(r.callbacks,r.yieldEvery);return await this.fitLoop(S,x,k,m,r.epochs,r.verbose,R,E,w,r.shuffle,A,r.initialEpoch,null,null)}finally{this.isTraining=!1,xo(s,e),xo(i,n),xo(o,e),xo(a,n),xo(u,c),xo(d,l),h!=null&&Tt(h)}}async fitLoop(e,n,r,s,i,o,a,c,l,u,d,h,m,g){s==null&&(s=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let v=!1;if(c!=null&&l!=null&&(v=!0),g!=null&&(v=!0,m==null))throw new se("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,s,m,"steps_per_epoch");let w;y!=null&&(w=Vo(0,y)),o==null&&(o=1);const{callbackList:x,history:S}=d7(a,o,i,h,y,m,s,v,d);x.setModel(this),this.history=S,await x.onTrainBegin(),this.stopTraining_=!1;for(let k=h;k<i;++k){await x.onEpochBegin(k);const E={};if(m!=null)throw new It("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new It("batch shuffling is not implemneted yet");u&&eEe(w);const A=Ir(w),R=Q2(y,s);for(let N=0;N<R.length;++N){const P={};if(await x.onBatchBegin(N,P),ae(()=>{const O=R[N][0],_=R[N][1],M=zu(A,O,_-O);P.batch=N,P.size=_-O;const G=hA(n,M),q=e(G);for(let D=0;D<r.length;++D){const L=r[D],K=q[D];P[L]=K,xr(K)}if(N===R.length-1&&v){const D=this.testLoop(c,l,s);for(let L=0;L<r.length;++L){const K=r[L],j=D[L];xr(j),E["val_"+K]=j}}}),await x.onBatchEnd(N,P),l7(P),this.stopTraining_)break}A.dispose()}if(await x.onEpochEnd(k,E),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return rFe(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],i=r[1],a=this.makeTrainFunction()(s.concat(i)),c=[];for(const l of a){const u=await l.data();c.push(u[0])}return Tt(a),xo(r[0],e),xo(r[1],n),xs(c)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let o=0;o<s.length;++o)r&&!s[o].trainable||n.push({name:s[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=HM().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-HM().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Za(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Za(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=Za(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Za(wb(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Za(wb(e)));{const e={};for(const n in this.metrics)e[n]=Za(wb(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=dA(e.optimizer_config),r=ac(n);let s;if(typeof e.loss=="string")s=wu(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(o=>wu(o));else if(e.loss!=null){s={};for(const o in e.loss)s[o]=wu(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>wu(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=wu(e.metrics[o])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const l=P8(e);if(l.length===0)throw new se(`Cannot find any save handlers for URL '${e}'`);if(l.length>1)throw new se(`Found more than one (${l.length}) save handlers for URL '${e}'`);e=l[0]}if(e.save==null)throw new se("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await KT(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:dFe,generatedBy:`TensorFlow.js tfjs-layers v${v7}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const l="optimizer",{data:u,specs:d}=await KT(await this.optimizer.getWeights(),l);r.specs.push(...d),r.data=$8([r.data,u])}return this.userDefinedMetadata!=null&&(C4(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){C4(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Yf.className="Model";Ie(Yf);class S7 extends Yf{}S7.className="Functional";Ie(S7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jg extends Yf{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:SS("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new se(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof jg||e instanceof Yf;let r;if(n){if(r=e,r.outputs.length!==1)throw new se("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new se("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new se("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=hDe({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new se(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new se("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=s7(this.outputs[0])}this.inboundNodes=[],new ES({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:dd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ht(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Yf({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new Zi("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new Zi("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new Zi("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new Zi("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new se("Legacy serialization format not supported yet.");i=n}else U(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof jg))throw new It(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const c of i){const u=ac(c,void 0,s);s&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new se("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new se("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}jg.className="Sequential";Ie(jg);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let es=class extends ep{getConfig(){return{}}};class k7 extends es{apply(e,n=1){return YPe(e,n)}}k7.className="elu";Ie(k7);class E7 extends es{apply(e){return pR(e)}}E7.className="selu";Ie(E7);class C7 extends es{apply(e){return Ra(e)}}C7.className="relu";Ie(C7);class T7 extends es{apply(e){return ae(()=>ld(6,Ra(e)))}}T7.className="relu6";Ie(T7);class A7 extends es{apply(e){return e}}A7.className="linear";Ie(A7);class N7 extends es{apply(e){return Po(e)}}N7.className="sigmoid";Ie(N7);class _7 extends es{apply(e){return JPe(e)}}_7.className="hardSigmoid";Ie(_7);class $7 extends es{apply(e){return Yh(e)}}$7.className="softplus";Ie($7);class R7 extends es{apply(e){return ZPe(e)}}R7.className="softsign";Ie(R7);class O7 extends es{apply(e){return cd(e)}}O7.className="tanh";Ie(O7);let wO=class extends es{apply(e,n=-1){return fS(e,n)}};wO.className="softmax";Ie(wO);class P7 extends es{apply(e,n=-1){return iR(e,n)}}P7.className="logSoftmax";Ie(P7);class D7 extends es{apply(e){return ae(()=>ae(()=>{const n=Math.sqrt(2),r=ee(.5,xe(1,nR(We(e,n))));return ee(e,r)}))}}D7.className="gelu";Ie(D7);class F7 extends es{apply(e){return ae(()=>ee(.5,ee(e,xe(1,cd(ee(zr(We(2,Math.PI)),xe(e,ee(.044715,gc(e,3)))))))))}}F7.className="gelu_new";Ie(F7);class L7 extends es{apply(e){return ae(()=>ee(e,cd(Yh(e))))}}L7.className="mish";Ie(L7);class B7 extends es{apply(e,n=1){return ae(()=>ee(Po(ee(e,n)),e))}}B7.className="swish";Ie(B7);function Nl(t){return t.getClassName()}function Y2(t,e={}){return Sy(t,Ki.getMap().classNameMap,e,"activation")}function _l(t){if(t==null){const e={};return e.className="linear",e.config={},Y2(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Y2(e)}else return t instanceof es?t:Y2(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fFe(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class M7 extends ep{}class z7 extends M7{constructor(e){super(),fFe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ae(()=>{let n=cr([1]);return this.hasL1&&(n=xe(n,Ke(ee(this.l1,ar(e))))),this.hasL2&&(n=xe(n,Ke(ee(this.l2,Ey(e))))),re(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}z7.className="L1L2";Ie(z7);const R4={l1l2:"L1L2"};function an(t){return oO(t)}function O4(t,e={}){return Sy(t,Ki.getMap().classNameMap,e,"regularizer")}function In(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in R4?R4[t]:t,config:{}};return O4(n)}else return t instanceof M7?t:O4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class U7 extends _t{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=ut(e);let r=Ra(e);return this.maxValue!=null&&(r=ri(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}U7.className="ReLU";Ie(U7);class V7 extends _t{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=ut(e);return tS(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}V7.className="LeakyReLU";Ie(V7);class j7 extends _t{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=xn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=In(e.alphaRegularizer),this.alphaConstraint=pr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new se(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ht(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new ur({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=ut(e),cS(e,this.alpha.read())}getConfig(){const e={alphaInitializer:$n(this.alphaInitializer),alphaRegularizer:an(this.alphaRegularizer),alphaConstraint:hr(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}j7.className="PReLU";Ie(j7);let H7=class extends _t{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new It(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=ut(e);return gy(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};H7.className="ELU";Ie(H7);class W7 extends _t{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=ut(e);return ee(r,Fe(li(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}W7.className="ThresholdedReLU";Ie(W7);class G7 extends _t{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new wO().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return ae(()=>{let r=ut(e);const s=n.mask;if(s!=null){const i=ee(Be(Zs(r.shape),Fe(s,r.dtype)),rt(-1e9));r=xe(r,i)}return this.axis instanceof Array?this.axis.length>1?si(Be(r,rS(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}G7.className="Softmax";Ie(G7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zf(t,e,n){if(typeof t=="number")return dd(t,e);if(t.length!==e)throw new se(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!qPe(s))throw new se(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function Fo(t,e,n,r,s=1){if(t==null)return t;const i=e+(e-1)*(s-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+r-1)/r)}function aa(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+Al([n-e,0]);else if(r==="same")t=t*e;else throw new se(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xO(t,e){return ae(()=>(Qn(e),e==="channelsFirst"?Lt(t,[0,2,3,1]):t))}function q7(t,e){return ae(()=>(Qn(e),e==="channelsFirst"?Lt(t,[0,2,3,4,1]):t))}function hFe(t,e,n,r=1,s="valid",i,o=1){return ae(()=>{if(i==null&&(i=jo()),Qn(i),t.shape.length!==3)throw new se(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new se(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new se(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Lt(t,[0,2,1])),s==="causal")throw new It("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Y$(t,e,r,s==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ko(a,n)),a})}function P4(t,e,n,r=[1,1],s="valid",i,o,a=null){return ae(()=>{if(i==null&&(i=jo()),Qn(i),t.rank!==3&&t.rank!==4)throw new se(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new se(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let c=xO(t,i);if(s==="causal")throw new It("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=zq({x:c,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(c=Lt(c,[0,3,1,2])),c})}function pFe(t,e,n,r=[1,1,1],s="valid",i,o){return ae(()=>{if(i==null&&(i=jo()),Qn(i),t.rank!==4&&t.rank!==5)throw new se(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new se(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=q7(t,i);if(s==="causal")throw new It("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=oq(a,e,r,s==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ko(a,n)),i==="channelsFirst"&&(a=Lt(a,[0,4,1,2,3])),a})}class AS extends _t{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",AS.verifyArgs(n),this.rank=e,Sr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new It(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Zf(n.kernelSize,e,"kernelSize"),this.strides=Zf(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,_i(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Qn(this.dataFormat),this.activation=_l(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=xn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=pr(n.biasConstraint),this.biasRegularizer=In(n.biasRegularizer),this.activityRegularizer=In(n.activityRegularizer),this.dilationRate=Zf(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new se(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new se(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new se(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(oa("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!aO(e.kernelSize,"number",1,3))throw new se(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Nl(this.activation),useBias:this.useBias,biasInitializer:$n(this.biasInitializer),biasRegularizer:an(this.biasRegularizer),activityRegularizer:an(this.activityRegularizer),biasConstraint:hr(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class tp extends AS{constructor(e,n){super(e,n),this.kernel=null,tp.verifyArgs(n),this.filters=n.filters,Sr(this.filters,"filters"),this.kernelInitializer=xn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=pr(n.kernelConstraint),this.kernelRegularizer=In(n.kernelRegularizer)}build(e){e=Ht(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new se(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return ae(()=>{e=ut(e);let r;const s=this.bias==null?null:this.bias.read(),i=j9(this.activation.getClassName());if(i!=null&&this.rank===2)r=P4(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=hFe(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=P4(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=pFe(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new It("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ht(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const o=Fo(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:$n(this.kernelInitializer),kernelRegularizer:an(this.kernelRegularizer),kernelConstraint:hr(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new se(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Ny extends tp{constructor(e){super(2,e),Ny.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!aO(e.kernelSize,"number",1,2))throw new se(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Ny.className="Conv2D";Ie(Ny);class _y extends tp{constructor(e){super(3,e),_y.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new se(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}_y.className="Conv3D";Ie(_y);class K7 extends Ny{constructor(e){if(super(e),this.inputSpec=[new ur({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new se(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ht(e),e.length!==4)throw new se("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new se("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ur({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return ae(()=>{let r=ut(e);if(r.shape.length!==4)throw new se(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const c=s[o],l=s[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],m=this.strides[1],g=aa(c,h,u,this.padding),v=aa(l,m,d,this.padding),y=[i,g,v,this.filters];this.dataFormat!=="channelsLast"&&(r=Lt(r,[0,2,3,1]));let w=J$(r,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=Lt(w,[0,3,1,2])),this.bias!=null&&(w=Ko(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=Ht(e);const n=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],c=this.strides[0],l=this.strides[1];return n[r]=this.filters,n[s]=aa(n[s],c,o,this.padding),n[i]=aa(n[i],l,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}K7.className="Conv2DTranspose";Ie(K7);class X7 extends _y{constructor(e){if(super(e),this.inputSpec=[new ur({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new se(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ht(e),e.length!==5)throw new se("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new se("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ur({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return ae(()=>{let r=ut(e);if(r.shape.length!==5)throw new se(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let o,a,c;this.dataFormat==="channelsFirst"?(c=2,o=3,a=4):(c=1,o=2,a=3);const l=s[c],u=s[o],d=s[a],h=this.kernelSize[0],m=this.kernelSize[1],g=this.kernelSize[2],v=this.strides[0],y=this.strides[1],w=this.strides[2],x=aa(l,v,h,this.padding),S=aa(u,y,m,this.padding),k=aa(d,w,g,this.padding),E=[i,x,S,k,this.filters];this.dataFormat!=="channelsLast"&&(r=Lt(r,[0,2,3,4,1]));let A=cq(r,this.kernel.read(),E,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(A=Lt(A,[0,4,1,2,3])),this.bias!==null&&(A=Ko(A,this.bias.read(),this.dataFormat)),this.activation!==null&&(A=this.activation.apply(A)),A})}computeOutputShape(e){e=Ht(e);const n=e.slice();let r,s,i,o;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,o=4):(r=4,s=1,i=2,o=3);const a=this.kernelSize[0],c=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[s]=aa(n[s],u,a,this.padding),n[i]=aa(n[i],d,c,this.padding),n[o]=aa(n[o],h,l,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}X7.className="Conv3DTranspose";Ie(X7);class Q7 extends tp{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new se("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new se("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new se(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=xn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=In(n.depthwiseRegularizer),this.depthwiseConstraint=pr(n.depthwiseConstraint),this.pointwiseInitializer=xn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=In(n.pointwiseRegularizer),this.pointwiseConstraint=pr(n.pointwiseConstraint)}build(e){if(e=Ht(e),e.length<this.rank+2)throw new se(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new se(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new ur({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return ae(()=>{e=ut(e);let r;if(this.rank===1)throw new It("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Lt(e,[0,2,3,1])),r=mR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ko(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Lt(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=$n(this.depthwiseInitializer),e.pointwiseInitializer=$n(this.pointwiseInitializer),e.depthwiseRegularizer=an(this.depthwiseRegularizer),e.pointwiseRegularizer=an(this.pointwiseRegularizer),e.depthwiseConstraint=hr(this.depthwiseConstraint),e.pointwiseConstraint=hr(this.pointwiseConstraint),e}}Q7.className="SeparableConv";class Y7 extends Q7{constructor(e){super(2,e)}}Y7.className="SeparableConv2D";Ie(Y7);class NS extends tp{constructor(e){super(1,e),NS.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!aO(e.kernelSize,"number",1,1))throw new se(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}NS.className="Conv1D";Ie(NS);class Z7 extends _t{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return ae(()=>{if(e=ut(e),this.dataFormat==="channelsLast"){const r=bb(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return bb(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=bb(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return bb(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}Z7.className="Cropping2D";Ie(Z7);class J7 extends _t{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,HPe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return ae(()=>{let r=ut(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=Lt(r,[0,2,3,1]);const i=this.size[0]*s[2],o=this.size[1]*s[3],a=this.interpolation==="nearest"?Yi.resizeNearestNeighbor(r,[i,o]):Yi.resizeBilinear(r,[i,o]);return Lt(a,[0,3,1,2])}else{const i=this.size[0]*s[1],o=this.size[1]*s[2];return this.interpolation==="nearest"?Yi.resizeNearestNeighbor(r,[i,o]):Yi.resizeBilinear(r,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}J7.className="UpSampling2D";Ie(J7);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mFe(t,e,n=[1,1],r="valid",s,i){return ae(()=>{s==null&&(s=jo()),Qn(s);let o=xO(t,s);if(t.rank!==4)throw new se(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new se(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=my(o,e,n,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(o=Lt(o,[0,3,1,2])),o})}class eK extends AS{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=xn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=pr(e.depthwiseConstraint),this.depthwiseRegularizer=In(e.depthwiseRegularizer)}build(e){if(e=Ht(e),e.length<4)throw new se(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new se(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ae(()=>{e=ut(e);let r=mFe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ko(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ht(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Fo(n,this.kernelSize[0],this.padding,this.strides[0]),o=Fo(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,o]:[e[0],i,o,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=$n(this.depthwiseInitializer),e.depthwiseRegularizer=an(this.depthwiseRegularizer),e.depthwiseConstraint=hr(this.depthwiseRegularizer),e}}eK.className="DepthwiseConv2D";Ie(eK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tK(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new se("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function nK(t,e,n,r=!1,s,i,o=!1,a=!1){return ae(()=>{const c=e.shape.length;if(c<3)throw new se(`Input should be at least 3D, but is ${c}D.`);const l=[1,0].concat(Vo(2,c));e=Lt(e,l),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=Fe(Fe(s,"bool"),"float32"),s.rank===c-1&&(s=Qr(s,-1)),s=Lt(s,l)),r&&(e=oo(e,0),s!=null&&(s=oo(s,0)));const u=[];let d,h=n;const m=e.shape[0],g=ao(e);let v;s!=null&&(v=ao(s));for(let w=0;w<m;++w){const x=g[w],S=ae(()=>t(x,h));if(s==null)d=S[0],h=S[1];else{const k=ae(()=>{const E=v[w],A=Be(Ci(E),E),R=xe(ee(S[0],E),ee(h[0],A)),N=h.map((P,O)=>xe(ee(S[1][O],E),ee(P,A)));return{output:R,newStates:N}});d=k.output,h=k.newStates}a&&u.push(d)}let y;return a&&(y=ii(u,1)),[d,y,h]})}class Gl extends _t{constructor(e){super(e);let n;if(e.cell==null)throw new se("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new kO({cells:e.cell}):n=e.cell,n.stateSize==null)throw new se("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new ur({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Vo(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){cA(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[s].concat(i)}else return s}computeMask(e,n){return ae(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new It("Constants support is not implemented in RNN yet.");cA(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new ur({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Dt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new se(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new ur({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){ae(()=>{if(!this.stateful)throw new ia("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new se("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>cr([r,s])):this.states_=[cr([r,this.cell.stateSize])];else if(e==null)Tt(this.states_),this.keptStates!=null&&(Tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>cr([r,s])):this.states_[0]=cr([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new se(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Tt(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,o];if(!Dt(i.shape,a))throw new se(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>xr(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=tK(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let o=[],a=[];if(r!=null){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(const l of r)this.stateSpec.push(new ur({shape:l.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,o=o.concat(s),this.numConstants=s.length),o[0]instanceof Aa){const l=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(l,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ae(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let i=n==null?null:n.initialState;e=ut(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new se(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},l=nK((g,v)=>{const y=this.cell.call([g].concat(v),a);return[y[0],y.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),u=l[0],d=l[1],h=l[2];this.stateful&&this.resetStates(h,s);const m=this.returnSequences?d:u;return this.returnState?[m].concat(h):m})}getInitialState(e){return ae(()=>{let n=cr(e.shape);return n=Ke(n,[1,2]),n=ky(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?oA(n,[1,r]):n):this.cell.stateSize>1?[oA(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Gl.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,i=ac(s,r);return new e(Object.assign(n,{cell:i}))}}Gl.className="RNN";Ie(Gl);class _S extends _t{}class IO extends _S{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Sr(this.units,"units"),this.activation=_l(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=In(e.kernelRegularizer),this.recurrentRegularizer=In(e.recurrentRegularizer),this.biasRegularizer=In(e.biasRegularizer),this.kernelConstraint=pr(e.kernelConstraint),this.recurrentConstraint=pr(e.recurrentConstraint),this.biasConstraint=pr(e.biasConstraint),this.dropout=Eh([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Eh([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ht(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ae(()=>{if(e=e,e.length!==2)throw new se(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$l({ones:()=>Ci(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$l({ones:()=>Ci(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=xa(ee(e,o),this.kernel.read()):i=xa(e,this.kernel.read()),this.bias!=null&&(i=Ko(i,this.bias.read())),a!=null&&(r=ee(r,a));let c=xe(i,xa(r,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Nl(this.activation),useBias:this.useBias,kernelInitializer:$n(this.kernelInitializer),recurrentInitializer:$n(this.recurrentInitializer),biasInitializer:$n(this.biasInitializer),kernelRegularizer:an(this.kernelRegularizer),recurrentRegularizer:an(this.recurrentRegularizer),biasRegularizer:an(this.biasRegularizer),activityRegularizer:an(this.activityRegularizer),kernelConstraint:hr(this.kernelConstraint),recurrentConstraint:hr(this.recurrentConstraint),biasConstraint:hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}IO.className="SimpleRNNCell";Ie(IO);class rK extends Gl{constructor(e){e.cell=new IO(e),super(e)}call(e,n){return ae(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return new e(n)}}rK.className="SimpleRNN";Ie(rK);class SO extends _S{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new se("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Sr(this.units,"units"),this.activation=_l(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=_l(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=In(e.kernelRegularizer),this.recurrentRegularizer=In(e.recurrentRegularizer),this.biasRegularizer=In(e.biasRegularizer),this.kernelConstraint=pr(e.kernelConstraint),this.recurrentConstraint=pr(e.recurrentConstraint),this.biasConstraint=pr(e.biasConstraint),this.dropout=Eh([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Eh([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ht(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ae(()=>{if(e=e,e.length!==2)throw new se(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$l({ones:()=>Ci(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$l({ones:()=>Ci(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,c,l;0<this.dropout&&this.dropout<1&&(e=ee(e,i[0]));let u=xa(e,this.kernel.read());this.useBias&&(u=Ko(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,o[0]));const d=this.recurrentKernel.read(),[h,m]=ei(d,[2*this.units,this.units],d.rank-1),g=xa(s,h),[v,y,w]=ei(u,3,u.rank-1),[x,S]=ei(g,2,g.rank-1);a=this.recurrentActivation.apply(xe(v,x)),c=this.recurrentActivation.apply(xe(y,S));const k=xa(ee(c,s),m);l=this.activation.apply(xe(w,k));const E=xe(ee(a,s),ee(xe(1,gn(a)),l));return[E,E]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Nl(this.activation),recurrentActivation:Nl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$n(this.kernelInitializer),recurrentInitializer:$n(this.recurrentInitializer),biasInitializer:$n(this.biasInitializer),kernelRegularizer:an(this.kernelRegularizer),recurrentRegularizer:an(this.recurrentRegularizer),biasRegularizer:an(this.biasRegularizer),activityRegularizer:an(this.activityRegularizer),kernelConstraint:hr(this.kernelConstraint),recurrentConstraint:hr(this.recurrentConstraint),biasConstraint:hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}SO.className="GRUCell";Ie(SO);class sK extends Gl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new SO(e),super(e)}call(e,n){return ae(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}sK.className="GRU";Ie(sK);class $S extends _S{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Sr(this.units,"units"),this.activation=_l(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=_l(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=In(e.kernelRegularizer),this.recurrentRegularizer=In(e.recurrentRegularizer),this.biasRegularizer=In(e.biasRegularizer),this.kernelConstraint=pr(e.kernelConstraint),this.recurrentConstraint=pr(e.recurrentConstraint),this.biasConstraint=pr(e.biasConstraint),this.dropout=Eh([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Eh([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ht(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;s=new(n=class extends lo{apply(c,l){const u=i.apply([o]),d=new lO().apply([o]),h=i.apply([o*2]);return y4(y4(u,d),h)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return ae(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new se(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$l({ones:()=>Ci(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$l({ones:()=>Ci(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let c,l,u,d;0<this.dropout&&this.dropout<1&&(e=ee(e,o[0]));let h=xa(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=ee(s,a[0])),h=xe(h,xa(s,this.recurrentKernel.read())),this.useBias&&(h=Ko(h,this.bias.read()));const[m,g,v,y]=ei(h,4,h.rank-1);c=this.recurrentActivation.apply(m),l=this.recurrentActivation.apply(g),u=xe(ee(l,i),ee(c,this.activation.apply(v))),d=this.recurrentActivation.apply(y);const w=ee(d,this.activation.apply(u));return[w,w,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Nl(this.activation),recurrentActivation:Nl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$n(this.kernelInitializer),recurrentInitializer:$n(this.recurrentInitializer),biasInitializer:$n(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:an(this.kernelRegularizer),recurrentRegularizer:an(this.recurrentRegularizer),biasRegularizer:an(this.biasRegularizer),activityRegularizer:an(this.activityRegularizer),kernelConstraint:hr(this.kernelConstraint),recurrentConstraint:hr(this.recurrentConstraint),biasConstraint:hr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}$S.className="LSTMCell";Ie($S);class iK extends Gl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new $S(e),super(e)}call(e,n){return ae(()=>{this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}iK.className="LSTM";Ie(iK);class kO extends _S{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return ae(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const c=this.cells[a];r=s[a],a===0?o=[e[0]].concat(r):o=[o[0]].concat(r),o=c.call(o,n),i.push(o.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[o[0]].concat(r)})}build(e){cA(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{Mu(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const i of n.cells)s.push(ac(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return lA(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let o=0;o<r.weights.length;++o)n.push([r.weights[o],i[o]])}gO(n)}}kO.className="StackedRNNCells";Ie(kO);function $l(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):Q9(e(),n),a=()=>Cy(o,e,r);return!s||s<=1?xr(a().clone()):Array(s).fill(void 0).map(a).map(l=>xr(l.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var gFe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class oK extends Gl{constructor(e){if(e.unroll)throw new It("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new It("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new ur({ndim:5})]}call(e,n){return ae(()=>{if(this.cell.dropoutMask!=null&&(Tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new se("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return ae(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],o=cr(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){ae(()=>{if(!this.stateful)throw new ia("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new se("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>cr(i)):this.states_=[cr(i)];else if(e==null)Tt(this.states_),this.keptStates!=null&&(Tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>cr(i)):this.states_[0]=cr(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new se(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Tt(this.states_);for(let a=0;a<this.states_.length;++a){const c=e[a],l=i;if(!Dt(c.shape,l))throw new se(`State ${a} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${c.shape}`);this.states_[a]=c}}this.states_=this.states_.map(a=>xr(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:i,strides:o,dilationRate:a}=this.cell,c=n==="channelsFirst",l=e[c?3:2],u=e[c?4:3],d=Fo(l,s[0],i,o[0],a[0]),h=Fo(u,s[1],i,o[1],a[1]);return[...e.slice(0,2),...c?[r,d,h]:[d,h,r]]}}oK.className="ConvRNN2D";class EO extends $S{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Sr(this.filters,"filters"),this.kernelSize=Zf(r,2,"kernelSize"),this.kernelSize.forEach(c=>Sr(c,"kernelSize")),this.strides=Zf(s||1,2,"strides"),this.strides.forEach(c=>Sr(c,"strides")),this.padding=i||"valid",_i(this.padding),this.dataFormat=o||"channelsLast",Qn(this.dataFormat),this.dilationRate=Zf(a||1,2,"dilationRate"),this.dilationRate.forEach(c=>Sr(c,"dilationRate"))}build(e){var n;e=Ht(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new se(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,o=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const l=this.biasInitializer,u=this.filters;c=new(n=class extends lo{apply(h,m){const g=l.apply([u]),v=Zs([u]),y=l.apply([u*2]);return cO([g,v,y])}},n.className="CustomInit",n)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return ae(()=>{if(e.length!==3)throw new se(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$l({ones:()=>Ci(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,l=(X,H,Y)=>!H||!H[Y]?X:ee(H[Y],X);let u=l(s,c,0),d=l(s,c,1),h=l(s,c,2),m=l(s,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$l({ones:()=>Ci(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const g=this.recurrentDropoutMask;let v=l(i,g,0),y=l(i,g,1),w=l(i,g,2),x=l(i,g,3);const S=3,[k,E,A,R]=ei(this.kernel.read(),a,S),[N,P,O,_]=this.useBias?ei(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,k,N,this.padding),d=this.inputConv(d,E,P,this.padding),h=this.inputConv(h,A,O,this.padding),m=this.inputConv(m,R,_,this.padding);const[M,G,q,D]=ei(this.recurrentKernel.read(),a,S);v=this.recurrentConv(v,M),y=this.recurrentConv(y,G),w=this.recurrentConv(w,q),x=this.recurrentConv(x,D);const L=this.recurrentActivation.apply(xe(u,v)),K=this.recurrentActivation.apply(xe(d,y)),j=xe(ee(K,o),ee(L,this.activation.apply(xe(h,w)))),W=ee(this.recurrentActivation.apply(xe(m,x)),this.activation.apply(j));return[W,W,j]})}getConfig(){const e=super.getConfig(),{units:n}=e,r=gFe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),s)}inputConv(e,n,r,s){const i=Tl(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ko(i,r,this.dataFormat):i}recurrentConv(e,n){return Tl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}EO.className="ConvLSTM2DCell";Ie(EO);class aK extends oK{constructor(e){const n=new EO(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}aK.className="ConvLSTM2D";Ie(aK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class CO extends _t{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,i=this.getNoiseShape(r);return Cy(()=>Q9(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}CO.className="Dropout";Ie(CO);class cK extends CO{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}cK.className="SpatialDropout1D";Ie(cK);class lK extends _t{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Sr(this.units,"units"),this.activation=_l(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=xn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=xn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=pr(e.kernelConstraint),this.biasConstraint=pr(e.biasConstraint),this.kernelRegularizer=In(e.kernelRegularizer),this.biasRegularizer=In(e.biasRegularizer),this.activityRegularizer=In(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ht(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ht(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e),s=j9(this.activation.getClassName());let i;return s!=null?i=xa(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=xa(r,this.kernel.read()),this.bias!=null&&(i=Ko(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Nl(this.activation),useBias:this.useBias,kernelInitializer:$n(this.kernelInitializer),biasInitializer:$n(this.biasInitializer),kernelRegularizer:an(this.kernelRegularizer),biasRegularizer:an(this.biasRegularizer),activityRegularizer:an(this.activityRegularizer),kernelConstraint:hr(this.kernelConstraint),biasConstraint:hr(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}lK.className="Dense";Ie(lK);class uK extends _t{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ht(e);for(const n of e.slice(1))if(n==null)throw new se(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],hl(e,1)]}call(e,n){return ae(()=>{this.invokeCallHook(e,n);let r=ut(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=Lt(r,s)}return QPe(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}uK.className="Flatten";Ie(uK);class dK extends _t{constructor(e){super(e),this.supportsMasking=!0,this.activation=_l(e.activation)}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e);return this.activation.apply(r)})}getConfig(){const e={activation:Nl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}dK.className="Activation";Ie(dK);class fK extends _t{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return ae(()=>(e=ut(e),KPe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}fK.className="RepeatVector";Ie(fK);class hK extends _t{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let i=1,o=null;for(let c=0;c<s.length;++c){const l=s[c];if(this.isUnknown(l))if(o===null)o=c;else throw new se("Can only specifiy one unknown dimension.");else i*=l}const a=hl(e);if(o!==null){if(i===0||a%i!==0)throw new se(r);s[o]=a/i}else if(a!==i)throw new se(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return re(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}hK.className="Reshape";Ie(hK);class pK extends _t{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Vo(1,e.dims.length+1);if(!Dt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new ur({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ht(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return Lt(ut(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}pK.className="Permute";Ie(pK);class mK extends _t{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=ut(e);return Nx(Sh(r,this.maskValue),-1)}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e),o=Nx(Sh(r,this.maskValue),-1,!0);return ee(r,Fe(o,r.dtype))})}}mK.className="Masking";Ie(mK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gK extends _t{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Qt(e.inputLength))}this.inputDim=e.inputDim,Sr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Sr(this.outputDim,"outputDim"),this.embeddingsInitializer=xn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=In(e.embeddingsRegularizer),this.activityRegularizer=In(e.activityRegularizer),this.embeddingsConstraint=pr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return ae(()=>this.maskZero?(e=ut(e),Sh(e,Bt(e))):null)}computeOutputShape(e){if(e=Ht(e),this.inputLength==null)return[...e,this.outputDim];const n=Qt(this.inputLength);if(n.length!==e.length-1)throw new se(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const i=n[s],o=e[s+1];if(i!=null&&o!=null&&i!==o)throw new se(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=o),r++}}return[e[0],...n,this.outputDim]}call(e,n){return ae(()=>{this.invokeCallHook(e,n);let r=ut(e);r.dtype!=="int32"&&(r=wa(r,"int32"));const s=X9(this.embeddings.read(),re(r,[r.size]));return re(s,Ht(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:$n(this.embeddingsInitializer),embeddingsRegularizer:an(this.embeddingsRegularizer),activityRegularizer:an(this.activityRegularizer),embeddingsConstraint:hr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}gK.className="Embedding";Ie(gK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _d extends _t{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new It}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const i=e[e.length-n.length+s],o=n[s];if(i==null||o==null||i<0||o<0)r.push(null);else if(i===1)r.push(o);else if(o===1)r.push(i);else{if(i!==o)throw new se("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ht(e)]),e=e,e.length<2)throw new se(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=fl(n),n.length>1)throw new se(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&fl(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return ae(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=Al(s);for(let o of e){const a=o.rank;for(let c=0;c<i-a;++c)o=ky(o,1);r.push(o)}return this.mergeFunction(r)}else{let i=!1;for(const c of e){const l=c.rank;if(l==null){const u=c.shape,d=u[0],h=u.slice(1).concat([d]);let m=re(c,[d].concat(hl(u.slice(1))));m=Lt(m,[1,0]),m=re(m,h),r.push(m),i=!0}else if(l>1){const u=Vo(1,l).concat([0]);r.push(Lt(c,u)),i=!0}else r.push(c)}let o=this.mergeFunction(r);const a=o.rank;if(i){if(a==null){const c=o.shape,l=c.length,u=c[l-1],d=[u].concat(c.slice(0,c.length-1));o=re(Lt(re(o,[-1,u]),[1,0]),d)}else if(a>1){const c=[a-1].concat(Vo(0,a-1));o=Lt(o,c)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=fl(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return ae(()=>{if(n==null)return null;if(!Array.isArray(n))throw new se("`mask` should be an Array");if(!Array.isArray(e))throw new se("`inputs` should be an Array");if(n.length!==e.length)throw new se(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:Qr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=Ta(r,n[s]);return r})}}class yK extends _d{constructor(e){super(e)}mergeFunction(e){return ae(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=xe(n,e[r]);return n})}}yK.className="Add";Ie(yK);class vK extends _d{constructor(e){super(e)}mergeFunction(e){return ae(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ee(n,e[r]);return n})}}vK.className="Multiply";Ie(vK);class bK extends _d{constructor(e){super(e)}mergeFunction(e){return ae(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=xe(n,e[r]);return ee(1/e.length,n)})}}bK.className="Average";Ie(bK);class wK extends _d{constructor(e){super(e)}mergeFunction(e){return ae(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Tc(n,e[r]);return n})}}wK.className="Maximum";Ie(wK);class xK extends _d{constructor(e){super(e)}mergeFunction(e){return ae(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=ld(n,e[r]);return n})}}xK.className="Minimum";Ie(xK);class IK extends _d{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new se("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let o=!1;for(const a of r)if(Dt(a,i)){o=!0;break}o||r.push(i)}if(r.length>1)throw new se("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ae(()=>cO(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new se("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new se("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new se("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new se(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return ae(()=>{let r=!0;if(n.forEach(o=>{if(o!=null){r=!1;return}}),r)return null;const s=[];for(let o=0;o<e.length;++o)n[o]==null?s.push(Fe(Ci(e[o]),"bool")):n[o].rank<e[o].rank?s.push(Qr(n[o],-1)):s.push(n[o]);const i=zn(s,this.axis);return X$(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}IK.className="Concatenate";Ie(IK);function pm(t,e){for(;t<0;)t+=e;return t}function yFe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new It("batchDot is not implemented for tensors of 4D or higher rank yet");if(U(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),U(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new It("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const i=n;return ae(()=>{let o;if(r>s){o=r-s;const c=[];for(let l=0;l<o;++l)c.push(1);e=re(e,e.shape.concat(c))}else if(s>r){o=s-r;const c=[];for(let l=0;l<o;++l)c.push(1);t=re(t,t.shape.concat(c))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Ke(ee(t,e),i[0]):a=Ke(ee(Lt(t,[1,0]),e),i[1]);else{const c=i[0]!==t.shape.length-1,l=i[1]===e.shape.length-1;a=$t(t,e,c,l)}if(o>0){let c;r>s?c=r+s-3:c=r-1;const l=[];for(let u=c;u<c+o;++u)l.push(u);a=Do(a,l)}return a.shape.length===1&&(a=Qr(a,1)),a})}class SK extends _d{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){U(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new It("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new se(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new se(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,o)=>pm(i,e[o].shape.length)):s=[pm(this.axes,n.shape.length),pm(this.axes,r.shape.length)],this.normalize&&(n=Dx(n,s[0]),r=Dx(r,s[1])),yFe(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[pm(this.axes,e.length),pm(this.axes,n.length)],r}computeOutputShape(e){U(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new It("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}SK.className="Dot";Ie(SK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kK extends _t{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e);return Cy(()=>xe(kS(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}kK.className="GaussianNoise";Ie(kK);class EK extends _t{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ae(()=>{this.invokeCallHook(e,n);const r=ut(e);return this.rate>0&&this.rate<1?Cy(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return ee(r,kS(r.shape,1,i))},()=>r,n.training||!1):r})}}EK.className="GaussianDropout";Ie(EK);class CK extends _t{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ut(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ae(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Cy(()=>{const i=ut(e),a=-1.6732632423543772*1.0507009873554805;let c=jl(Td(r),this.rate);c=wa(c,"float32");const l=((1-this.rate)*(1+this.rate*a**2))**-.5,u=-l*a*this.rate,d=xe(ee(i,c),ee(xe(c,-1),a));return xe(ee(d,l),u)},()=>ut(e),n.training||!1)}return e})}}CK.className="AlphaDropout";Ie(CK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hg(t,e,n,r,s,i=.001){let o;if(t.rank===2)o=Z8(t,e,n,r,s,i);else if(t.rank===3)o=J8(t,e,n,r,s,i);else if(t.rank===4)o=eq(t,e,n,r,s,i);else throw new It(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function vFe(t,e,n,r,s=.001){return ae(()=>{const i=oS(t,r),o=i.mean,a=i.variance;return[Hg(t,o,a,n,e,s),o,a]})}function bFe(t,e,n,r,s=.001){return ae(()=>{const i=oS(t,r),o=i.mean,a=i.variance,c=[];for(const g of Vo(0,t.rank))r.indexOf(g)!==-1?c.push(1):c.push(t.shape[g]);const l=re(o,c),u=re(a,c),d=e==null?null:re(e,c),h=n==null?null:re(n,c);return[Hg(t,l,u,h,d,s),o,a]})}function wFe(t,e,n,r,s=.001){return Dt(r.slice().sort(),Vo(0,t.rank-1))?vFe(t,e,n,r,s):bFe(t,e,n,r,s)}class TK extends _t{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=xn(e.betaInitializer||"zeros"),this.gammaInitializer=xn(e.gammaInitializer||"ones"),this.movingMeanInitializer=xn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=xn(e.movingVarianceInitializer||"ones"),this.betaConstraint=pr(e.betaConstraint),this.gammaConstraint=pr(e.gammaConstraint),this.betaRegularizer=In(e.betaRegularizer),this.gammaRegularizer=In(e.gammaRegularizer)}build(e){e=Ht(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new se(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new ur({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return ae(()=>{const r=n.training==null?!1:n.training,s=ut(e),i=s.shape,o=i.length,a=Vo(0,o),c=this.axis>=0?this.axis:this.axis+o;a.splice(c,1);const l=dd(1,o);l[c]=i[c];const u=a.slice();u.sort();const d=!Dt(u,Vo(0,o).slice(0,o-1)),h=()=>{if(d){const x=re(this.movingMean.read(),l),S=re(this.movingVariance.read(),l),k=this.center?re(this.beta.read(),l):null,E=this.scale?re(this.gamma.read(),l):null;return Hg(s,x,S,k,E,this.epsilon)}else return Hg(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[m,g,v]=wFe(s,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(x,S,k)=>{ae(()=>{const E=1-k,A=x.read(),R=ee(Be(A,S),E);x.write(Be(A,R))})};return(()=>{y(this.movingMean,g,this.momentum),y(this.movingVariance,v,this.momentum)})(),m})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$n(this.betaInitializer),gammaInitializer:$n(this.gammaInitializer),movingMeanInitializer:$n(this.movingMeanInitializer),movingVarianceInitializer:$n(this.movingVarianceInitializer),betaRegularizer:an(this.betaRegularizer),gammaRegularizer:an(this.gammaRegularizer),betaConstraint:hr(this.betaConstraint),gammaConstraint:hr(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}TK.className="BatchNormalization";Ie(TK);class AK extends _t{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=xn(e.betaInitializer||"zeros"),this.gammaInitializer=xn(e.gammaInitializer||"ones"),this.betaRegularizer=In(e.betaRegularizer),this.gammaRegularizer=In(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ht(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==fl(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=ut(e),s=r.shape,i=s.length;return ae(()=>{let{mean:a,variance:c}=oS(r,this.axis,!0);const l=dd(1,i);for(const v of this.axis)l[v]=s[v];const u=v=>v!=null&&v.shape.length!==i?re(v,l):v;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const m=[],g=[];for(let v=0;v<i;++v)this.axis.indexOf(v)!==-1?(m.push(s[v]),g.push(1)):(m.push(1),g.push(s[v]));return a=Qi(a,m),c=Qi(c,m),d!=null&&(d=Qi(d,g)),h!=null&&(h=Qi(h,g)),Hg(r,a,c,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$n(this.betaInitializer),gammaInitializer:$n(this.gammaInitializer),betaRegularizer:an(this.betaRegularizer),gammaRegularizer:an(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}AK.className="LayerNormalization";Ie(AK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xFe(t,e,n){return ae(()=>{if(t.rank!==4)throw new se(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new se("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=jo()),n!=="channelsLast"&&n!=="channelsFirst")throw new se(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],Hl(t,r)})}class NK extends _t{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?jo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new se(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new se(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new se(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new ur({ndim:4})]}computeOutputShape(e){e=Ht(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return ae(()=>xFe(ut(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}NK.className="ZeroPadding2D";Ie(NK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RS(t,e,n,r,s,i){return ae(()=>{Qn(s),W9(i),_i(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=jo()),i==null&&(i="max"),t=xO(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=iS(t,e,n,a):o=QI(t,e,n,a),s==="channelsFirst"&&(o=Lt(o,[0,3,1,2])),o})}function _K(t,e,n,r,s,i){return ae(()=>{Qn(s),W9(i),_i(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=jo()),i==null&&(i="max"),t=q7(t,s);let o;const a=r==="same"?"same":"valid";return i==="max"?o=Sq(t,e,n,a):o=Y8(t,e,n,a),s==="channelsFirst"&&(o=Lt(o,[0,4,1,2,3])),o})}class $K extends _t{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new se(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Sr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new se(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Sr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,_i(this.padding),this.inputSpec=[new ur({ndim:3})]}computeOutputShape(e){e=Ht(e);const n=Fo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return ae(()=>{this.invokeCallHook(e,n),e=ky(ut(e),2);const r=this.poolingFunction(ut(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Do(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class RK extends $K{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),RS(e,n,r,s,i,"max")}}RK.className="MaxPooling1D";Ie(RK);class OK extends $K{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),RS(e,n,r,s,i,"avg")}}OK.className="AveragePooling1D";Ie(OK);class PK extends _t{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new se(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Sr(this.poolSize,"poolSize"),Sr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qn(this.dataFormat),_i(this.padding),this.inputSpec=[new ur({ndim:4})]}computeOutputShape(e){e=Ht(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Fo(n,this.poolSize[0],this.padding,this.strides[0]),r=Fo(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return ae(()=>(this.invokeCallHook(e,n),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class DK extends PK{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),RS(e,n,r,s,i,"max")}}DK.className="MaxPooling2D";Ie(DK);class FK extends PK{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),RS(e,n,r,s,i,"avg")}}FK.className="AveragePooling2D";Ie(FK);class LK extends _t{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new se(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Sr(this.poolSize,"poolSize"),Sr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qn(this.dataFormat),_i(this.padding),this.inputSpec=[new ur({ndim:5})]}computeOutputShape(e){e=Ht(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Fo(n,this.poolSize[0],this.padding,this.strides[0]),r=Fo(r,this.poolSize[1],this.padding,this.strides[1]),s=Fo(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return ae(()=>(this.invokeCallHook(e,n),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class BK extends LK{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),_K(e,n,r,s,i,"max")}}BK.className="MaxPooling3D";Ie(BK);class MK extends LK{constructor(e){super(e)}poolingFunction(e,n,r,s,i){return Qn(i),_i(s),_K(e,n,r,s,i,"avg")}}MK.className="AveragePooling3D";Ie(MK);class zK extends _t{constructor(e){super(e),this.inputSpec=[new ur({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new It}}class UK extends zK{constructor(e){super(e||{})}call(e,n){return ae(()=>{const r=ut(e);return Mn(r,1)})}}UK.className="GlobalAveragePooling1D";Ie(UK);class VK extends zK{constructor(e){super(e||{})}call(e,n){return ae(()=>{const r=ut(e);return no(r,1)})}}VK.className="GlobalMaxPooling1D";Ie(VK);class jK extends _t{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qn(this.dataFormat),this.inputSpec=[new ur({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new It}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class HK extends jK{call(e,n){return ae(()=>{const r=ut(e);return this.dataFormat==="channelsLast"?Mn(r,[1,2]):Mn(r,[2,3])})}}HK.className="GlobalAveragePooling2D";Ie(HK);class WK extends jK{call(e,n){return ae(()=>{const r=ut(e);return this.dataFormat==="channelsLast"?no(r,[1,2]):no(r,[2,3])})}}WK.className="GlobalMaxPooling2D";Ie(WK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GK extends _t{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,i=ac(s,r);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class qK extends GK{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ht(e),e.length<3)throw new se(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ht(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return ae(()=>(e=ut(e),nK((o,a)=>[ut(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}qK.className="TimeDistributed";Ie(qK);function IFe(t){Nd(jPe,"BidirectionalMergeMode",t)}const SFe="concat";class KK extends GK{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=ac(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=ac(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?SFe:e.mergeMode,IFe(this.mergeMode),e.weights)throw new It("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):xs(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const i=tK(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const o=[],a=[];if(r!=null){const l=r.length;if(l%2>0)throw new se("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push(...r);const u=r.map(d=>new ur({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,l/2),this.backwardLayer.stateSpec=u.slice(l/2),a.push(...u)}if(s!=null)throw new It("Support for constants in Bidirectional layers is not implemented yet.");const c=o[0]instanceof Aa;for(const l of o)if(l instanceof Aa!==c)throw new se("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const l=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(l,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ae(()=>{const r=n.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const c=r.slice(0,r.length/2),l=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:c})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:l}))}let o;this.returnState&&(Array.isArray(s)&&(o=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=oo(i,1));let a;return this.mergeMode==="concat"?a=cO([s,i]):this.mergeMode==="sum"?a=xe(s,i):this.mergeMode==="ave"?a=ee(.5,xe(s,i)):this.mergeMode==="mul"?a=ee(s,i):this.mergeMode==null&&(a=[s,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Mu(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Mu(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=ac(n.layer);if(delete n.layer,n.numConstants!=null)throw new It("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}KK.className="Bidirectional";Ie(KK);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XK extends _t{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ae(()=>(e=ut(e),e.dtype!=="float32"&&(e=wa(e,"float32")),xe(ee(e,this.scale),this.offset)))}}XK.className="Rescaling";Ie(XK);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:kFe,cropAndResize:EFe}=Yi;class QK extends _t{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,i,o,a,c){return ae(()=>{let l,u=!1;const d=n/o,h=r/a,m=(s+n)/o,g=(i+r)/a,v=[d,h,m,g],y=[];e.rank===3?(u=!0,l=ii([e])):l=e;for(let E=0;E<l.shape[0];E++)y.push(v);const w=Oo(y,[y.length,4]),x=kh(0,y.length,1,"int32"),k=EFe(l,w,x,[s,i],"nearest");return wa(u?ut(ao(k)):k,c)})}upsize(e,n,r,s){return ae(()=>{const i=kFe(e,[n,r]);return wa(i,s)})}call(e,n){return ae(()=>{const r=ut(e),s=r.dtype,i=r.shape,o=i[i.length-3],a=i[i.length-2];let c=0;o!==this.height&&(c=Math.floor((o-this.height)/2));let l=0;return a!==this.width&&(l=Math.floor((a-this.width)/2),l===0&&(l=1)),c>=0&&l>=0?this.centerCrop(r,c,l,this.height,this.width,o,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ht(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}QK.className="CenterCrop";Ie(QK);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CFe(t,e,n,r){let s=ut(t);if(s.dtype!=="int32"&&(s=wa(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Qr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Qr(s,-1)),s.rank>2)throw new se(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const o=["multiHot","oneHot"].includes(e),a=s;let c;if(typeof r<"u"&&e==="count"?c=eA(a,r,n,o):c=eA(a,[],n,o),e!=="tfIdf")return c;if(r)return ee(c,r);throw new se("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class YK extends _t{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ht(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return ae(()=>{e=ut(e),e.dtype!=="int32"&&(e=wa(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new se(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=ut(n.countWeights)}const s=no(e),i=Fg(e),o=li(this.numTokens,s).bufferSync().get(0),a=jl(i,0).bufferSync().get(0);if(!(o&&a))throw new se(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return CFe(e,this.outputMode,this.numTokens,r)})}}YK.className="CategoryEncoding";Ie(YK);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const TFe=["bilinear","nearest"],D4=new Set(TFe);class ZK extends _t{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(D4.has(e.interpolation))this.interpolation=e.interpolation;else throw new se(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ht(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ae(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Yi.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Yi.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...D4]} are supported`)})}}ZK.className="Resizing";Ie(ZK);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class JK{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}JK.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eX extends _t{constructor(e){super(e),this.randomGenerator=new JK(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}eX.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const AFe=["bilinear","nearest"],F4=new Set(AFe);class tX extends eX{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new se(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new se(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new se(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(F4.has(r))this.interpolation=r;else throw new se(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ht(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return ae(()=>{const r=ut(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=Td([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Yi.resizeBilinear(e,o);case"nearest":return Yi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...F4]} are supported`)}})}}tX.className="RandomWidth";Ie(tX);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NFe=fe();NFe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ms;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ms||(Ms={}));var L4;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(L4||(L4={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Fe={};function nX(t){return _Fe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(t,e,n,r,s){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,c=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,l=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return Or(e.inputNames[l],n,r,s);if(i.type==="tensors"){const h=e.inputs.slice(a,c);return e.inputNames.slice(a,c).filter((g,v)=>{var y;return((y=h[v])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(g=>Or(g,n,r,s))}const u=Or(e.inputNames[l],n,r,s),d=u.dataSync();return i.type==="number"?d[0]:to(u.shape,d)}const o=e.attrParams[t];return o&&o.value}function Or(t,e,n,r){const[s,i]=Us(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[zx(s,a)]);return o!==void 0?e[zx(s,o)][i]:void 0}function B4(t,e,n){return e[zx(t,n.currentContextId)]}function Ja(t,e){const[n,r,s]=Us(t,e);return[zx(n,e&&e.currentContextId),r,s]}function zx(t,e){return e?`${t}-${e}`:t}function Us(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const i=r[0],o=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[i,a,o]}return n&&e.parseNodeNameCache.set(t,s),s}function ew(t,e,n){let r=$("pad",t,e,n);if(r==="explicit"){r=$("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)s[i][0]=r[i*2],s[i][1]=r[i*2+1];return s}return r}function ec(t){return t.kept?t:oc(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Fe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RFe=Object.freeze(Object.defineProperty({__proto__:null,json:$Fe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OFe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],PFe=Object.freeze(Object.defineProperty({__proto__:null,json:OFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DFe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],FFe=Object.freeze(Object.defineProperty({__proto__:null,json:DFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LFe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],BFe=Object.freeze(Object.defineProperty({__proto__:null,json:LFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MFe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],zFe=Object.freeze(Object.defineProperty({__proto__:null,json:MFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UFe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],VFe=Object.freeze(Object.defineProperty({__proto__:null,json:UFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jFe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],HFe=Object.freeze(Object.defineProperty({__proto__:null,json:jFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WFe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],GFe=Object.freeze(Object.defineProperty({__proto__:null,json:WFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qFe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],KFe=Object.freeze(Object.defineProperty({__proto__:null,json:qFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XFe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],QFe=Object.freeze(Object.defineProperty({__proto__:null,json:XFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YFe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],ZFe=Object.freeze(Object.defineProperty({__proto__:null,json:YFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JFe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],e3e=Object.freeze(Object.defineProperty({__proto__:null,json:JFe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3e=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],n3e=Object.freeze(Object.defineProperty({__proto__:null,json:t3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3e=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],s3e=Object.freeze(Object.defineProperty({__proto__:null,json:r3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],o3e=Object.freeze(Object.defineProperty({__proto__:null,json:i3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a3e=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],c3e=Object.freeze(Object.defineProperty({__proto__:null,json:a3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l3e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],u3e=Object.freeze(Object.defineProperty({__proto__:null,json:l3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3e=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],f3e=Object.freeze(Object.defineProperty({__proto__:null,json:d3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h3e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],p3e=Object.freeze(Object.defineProperty({__proto__:null,json:h3e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M4{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[RFe,PFe,FFe,BFe,zFe,VFe,HFe,GFe,KFe,QFe,ZFe,e3e,n3e,s3e,o3e,c3e,u3e,f3e,p3e],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],i=[],o=[],a=r.reduce((v,y)=>(v[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?s.push(v[y.name]):y.op==="Const"?i.push(v[y.name]):(y.input==null||y.input.length===0)&&o.push(v[y.name]),v),{});let c=[];const l=[];let u={},d={};n!=null&&(u=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(v=>{const y=a[v];y.inputNames.forEach((w,x)=>{const[S,,k]=Ja(w),E=a[S];if(E.outputs!=null){const A=E.outputs.indexOf(k);if(A!==-1){const R=`${S}:${A}`;y.inputNames[x]=R}}y.inputs.push(E),E.children.push(y)})}),Object.keys(d).length===0?h.forEach(v=>{const y=a[v];y.children.length===0&&l.push(y)}):Object.keys(d).forEach(v=>{const[y]=Ja(v),w=a[y];w!=null&&(w.signatureKey=d[v],l.push(w))}),Object.keys(u).length>0?Object.keys(u).forEach(v=>{const[y]=Ja(v),w=a[y];w&&(w.signatureKey=u[v],c.push(w))}):c=s;let m={};e.library!=null&&e.library.function!=null&&(m=e.library.function.reduce((v,y)=>(v[y.signature.name]=this.mapFunction(y),v),{}));const g={nodes:a,inputs:c,outputs:l,weights:i,placeholders:s,signature:n,functions:m};return o.length>0&&(g.initNodes=o),g}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=nX(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,i)=>(s[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,i)=>{const o=i.type;let a;switch(i.type){case"string":a=mA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=mA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=IA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=IA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=yA(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=yA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=xA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=xA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=gA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=gA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=kA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=kA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=wA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=wA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=SA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=SA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=vA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=vA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=bA(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=bA(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=z4(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=z4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return s[i.name]={value:a,type:o},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let i={};n!=null&&(i=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&s.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=Ja(d.name),m={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:TO(d.type),type:"dtype"}},children:[]};m.signatureKey=d.name,o.push(m),i[h]=m}),Object.keys(i).forEach(d=>{const h=i[d];h.inputNames.forEach((m,g)=>{const[v,,y]=Ja(m),w=i[v];if(w.outputs!=null){const x=w.outputs.indexOf(y);if(x!==-1){const S=`${v}:${x}`;h.inputNames[g]=S}}h.inputs.push(w),w.children.push(h)})});const l=e.ret;e.signature.outputArg.forEach(d=>{const[h,m]=Ja(l[d.name]),g=i[h];g!=null&&(g.defaultOutput=m,a.push(g))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:s,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function m3e(t){const e=fe().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function rX(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):m3e(t);return e?n:n.toLowerCase()}function mA(t,e,n,r=!1){const s=t[e];return s!=null?rX(s.s,r):n}function gA(t,e,n){const r=t[e];return r?r.b:n}function yA(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function TO(t){switch(typeof t=="string"&&(t=Ms[t]),t){case Ms.DT_FLOAT:case Ms.DT_HALF:return"float32";case Ms.DT_INT32:case Ms.DT_INT64:case Ms.DT_INT8:case Ms.DT_UINT8:return"int32";case Ms.DT_BOOL:return"bool";case Ms.DT_DOUBLE:return"float32";case Ms.DT_STRING:return"string";case Ms.DT_COMPLEX64:case Ms.DT_COMPLEX128:return"complex64";default:return null}}function z4(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function vA(t,e,n){const r=t[e];return r&&r.type?TO(r.type):n}function bA(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>TO(s)):n}function sX(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function wA(t,e,n){const r=t[e];return r&&r.shape?sX(r.shape):n}function xA(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function IA(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(i=>rX(i,r)):n}function SA(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>sX(s)):n}function kA(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g3e{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,i)=>(s[i]=this.getAttr(i),s),{}))}getInput(e){return Or(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Or(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return yA(this.node.rawAttrs,e,n);if(r.s!=null)return mA(this.node.rawAttrs,e,n);if(r.b!=null)return gA(this.node.rawAttrs,e,n);if(r.shape!=null)return wA(this.node.rawAttrs,e,n);if(r.type!=null)return vA(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return xA(this.node.rawAttrs,e,n);if(r.list.s!=null)return IA(this.node.rawAttrs,e,n);if(r.list.shape!=null)return SA(this.node.rawAttrs,e,n);if(r.list.b!=null)return kA(this.node.rawAttrs,e,n);if(r.list.type!=null)return bA(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hr=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:E8,abs:ar,acos:j8,acosh:H8,add:xe,addN:O2e,all:X$,any:Nx,argMax:xh,argMin:W8,asin:G8,asinh:q8,atan:K8,atan2:X8,atanh:Q8,avgPool:QI,avgPool3d:Y8,basicLSTMCell:nCe,batchNorm:py,batchNorm2d:Z8,batchNorm3d:J8,batchNorm4d:eq,batchToSpaceND:YI,bincount:tq,bitwiseAnd:dCe,booleanMaskAsync:XNe,broadcastArgs:hCe,broadcastTo:Qf,buffer:kt,cast:Fe,ceil:nq,clipByValue:ri,clone:oc,complex:kl,concat:zn,concat1d:rq,concat2d:ZI,concat3d:sq,concat4d:iq,conv1d:Y$,conv2d:Tl,conv2dTranspose:J$,conv3d:oq,conv3dTranspose:cq,cos:JI,cosh:eR,cosineWindow:ER,cumprod:_x,cumsum:tR,denseBincount:eA,depthToSpace:lq,depthwiseConv2d:my,diag:FCe,dilation2d:uq,div:We,divNoNan:dq,dot:fq,dropout:Bq,einsum:Rf,elu:gy,enclosingPowerOfTwo:Mq,ensureShape:GCe,equal:Uo,erf:nR,euclideanNorm:mq,exp:si,expandDims:Qr,expm1:gq,eye:sR,fft:hS,fill:Qh,floor:vy,floorDiv:K$,fused:y_e,gather:by,gatherND:i_e,greater:li,greaterEqual:jl,ifft:zg,imag:eS,image:Yi,inTopKAsync:l_e,irfft:bR,isFinite:yq,isInf:vq,isNaN:bq,leakyRelu:tS,less:Lg,lessEqual:Cd,linalg:qq,linspace:vTe,localResponseNormalization:wq,log:Ei,log1p:nS,logSigmoid:xq,logSoftmax:iR,logSumExp:rS,logicalAnd:Ta,logicalNot:sS,logicalOr:oR,logicalXor:Iq,losses:K$e,lowerBound:PTe,matMul:$t,max:no,maxPool:iS,maxPool3d:Sq,maxPoolWithArgmax:BTe,maximum:Tc,mean:Mn,meshgrid:UTe,min:Fg,minimum:ld,mirrorPad:kq,mod:Eq,moments:oS,movingAverage:ZNe,mul:ee,multiRNNCell:qTe,multinomial:XTe,neg:gn,norm:yy,notEqual:Sh,oneHot:cR,ones:Zs,onesLike:Ci,op:J,outerProduct:eAe,pad:Hl,pad1d:rAe,pad2d:iAe,pad3d:aAe,pad4d:lAe,pool:Cq,pow:gc,prelu:cS,print:V8,prod:Tq,raggedGather:yAe,raggedRange:bAe,raggedTensorToTensor:xAe,rand:SAe,randomGamma:WAe,randomNormal:uR,randomStandardNormal:KAe,randomUniform:Td,randomUniformInt:YAe,range:kh,real:Bg,reciprocal:Aq,relu:Ra,relu6:dR,reshape:re,reverse:oo,reverse1d:sNe,reverse2d:oNe,reverse3d:cNe,reverse4d:uNe,rfft:pS,round:fR,rsqrt:hR,scalar:rt,scatterND:e_e,searchSorted:aR,selu:pR,separableConv2d:mR,setdiff1dAsync:gNe,sigmoid:Po,sign:Nq,signal:q$e,sin:gR,sinh:yR,slice:at,slice1d:uS,slice2d:vR,slice3d:dS,slice4d:Mg,softmax:fS,softplus:Yh,spaceToBatchND:aS,sparse:X$e,sparseToDense:r_e,spectral:G$e,split:ei,sqrt:zr,square:on,squaredDifference:wR,squeeze:Do,stack:ii,step:Zh,stridedSlice:_q,string:Q$e,sub:Be,sum:Ke,tan:$q,tanh:cd,tensor:Oo,tensor1d:Ir,tensor2d:Bu,tensor3d:Rq,tensor4d:FNe,tensor5d:LNe,tensor6d:BNe,tensorScatterUpdate:zNe,tile:Qi,topk:Pq,transpose:Lt,truncatedNormal:IR,unique:Dq,unsortedSegmentSum:SR,unstack:ao,upperBound:GNe,variable:Fq,where:Zr,whereAsync:Lq,zeros:cr,zerosLike:Bt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3e=(t,e,n,r=Hr)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add($("a",t,e,n),$("b",t,e,n))];case"AddN":return[r.addN($("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod($("a",t,e,n),$("b",t,e,n))];case"Mul":return[r.mul($("a",t,e,n),$("b",t,e,n))];case"RealDiv":case"Div":return[r.div($("a",t,e,n),$("b",t,e,n))];case"DivNoNan":return[r.divNoNan($("a",t,e,n),$("b",t,e,n))];case"FloorDiv":return[r.floorDiv($("a",t,e,n),$("b",t,e,n))];case"Sub":return[r.sub($("a",t,e,n),$("b",t,e,n))];case"Minimum":return[r.minimum($("a",t,e,n),$("b",t,e,n))];case"Maximum":return[r.maximum($("a",t,e,n),$("b",t,e,n))];case"Pow":return[r.pow($("a",t,e,n),$("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3e=(t,e,n,r=Hr)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs($("x",t,e,n))];case"Acos":return[r.acos($("x",t,e,n))];case"Acosh":return[r.acosh($("x",t,e,n))];case"Asin":return[r.asin($("x",t,e,n))];case"Asinh":return[r.asinh($("x",t,e,n))];case"Atan":return[r.atan($("x",t,e,n))];case"Atan2":return[r.atan2($("x",t,e,n),$("y",t,e,n))];case"Atanh":return[r.atanh($("x",t,e,n))];case"Ceil":return[r.ceil($("x",t,e,n))];case"Complex":return[r.complex($("real",t,e,n),$("imag",t,e,n))];case"Cos":return[r.cos($("x",t,e,n))];case"Cosh":return[r.cosh($("x",t,e,n))];case"Elu":return[r.elu($("x",t,e,n))];case"Erf":return[r.erf($("x",t,e,n))];case"Exp":return[r.exp($("x",t,e,n))];case"Expm1":return[r.expm1($("x",t,e,n))];case"Floor":return[r.floor($("x",t,e,n))];case"Log":return[r.log($("x",t,e,n))];case"Log1p":return[r.log1p($("x",t,e,n))];case"Imag":return[r.imag($("x",t,e,n))];case"Neg":return[r.neg($("x",t,e,n))];case"Reciprocal":return[r.reciprocal($("x",t,e,n))];case"Real":return[r.real($("x",t,e,n))];case"Relu":return[r.relu($("x",t,e,n))];case"Round":return[r.round($("x",t,e,n))];case"Selu":return[r.selu($("x",t,e,n))];case"Sigmoid":return[r.sigmoid($("x",t,e,n))];case"Sin":return[r.sin($("x",t,e,n))];case"Sign":return[r.sign($("x",t,e,n))];case"Sinh":return[r.sinh($("x",t,e,n))];case"Softplus":return[r.softplus($("x",t,e,n))];case"Sqrt":return[r.sqrt($("x",t,e,n))];case"Square":return[r.square($("x",t,e,n))];case"Tanh":return[r.tanh($("x",t,e,n))];case"Tan":return[r.tan($("x",t,e,n))];case"ClipByValue":return[r.clipByValue($("x",t,e,n),$("clipValueMin",t,e,n),$("clipValueMax",t,e,n))];case"Relu6":return[r.relu6($("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Or(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu($("x",t,e,n),$("alpha",t,e,n))];case"Prelu":return[r.prelu($("x",t,e,n),$("alpha",t,e,n))];case"IsNan":return[r.isNaN(Or(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Or(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Or(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){U(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],i=e[r];U(s<0||i<0||s===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function U4(t){return!(typeof t=="number"||t.some(e=>e<0))}function mm(t,e,n){let r=EA(t,n);const s=!U4(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(i=>{r=EA(i.shape,r)}),!U4(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function EA(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],i=e[r];if(s>=0&&i>=0&&s!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b3e{constructor(e,n,r,s,i,o,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=rt(0),xr(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Hi(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,xr(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return Oo([],[0].concat(this.elementShape));const r=this.readMany(e);return Hi(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),ii(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Oo([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return Hi(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),zn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,ao(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(c=>(r+=c,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];ae(()=>{n=re(n,[1,r,i]);for(let c=0;c<e.length;++c){const u=[0,c===0?0:s[c-1],0],d=[1,e[c],i];o[c]=re(at(n,u,d),this.elementShape)}return o});const a=[];for(let c=0;c<e.length;c++)a[c]=c;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fd{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e?.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);Hi(n,i.shape,"TensorList shape mismatch: "),xr(i)}),this.idTensor=rt(0),this.maxNumElements=s,xr(this.idTensor)}copy(){return new fd([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Hi(e,this.elementShape,"TensorList shape mismatch: ");const s=mm(this.elementShape,this.tensors,e);return ae(()=>{const i=this.tensors.map(o=>re(o,s));return ii(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=mm(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,Hi(s.shape,e,"TensorList shape mismatch: "),re(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Hi(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");xr(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new fd([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Hi(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=mm(this.elementShape,this.tensors,n);return re(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Hi(this.elementShape,n.shape,"TensorList shape mismatch: "),xr(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Hi(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=mm(this.elementShape,this.tensors,r);return e.length===0?Oo([],[0].concat(s)):ae(()=>{const i=e.map(o=>re(this.tensors[o],s));return ii(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Hi(this.elementShape,n,"TensorList shape mismatch: ");const r=mm(this.elementShape,this.tensors,n);return this.size()===0?Oo([],[0].concat(r)):ae(()=>{const s=this.tensors.map(i=>re(i,r));return zn(s,0)})}}function w3e(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);Hi(s,e,"TensorList shape mismatch: ");const i=ao(t);return new fd(i,e,r)}function x3e(t,e,n,r){return new fd([],t,e,r)}function I3e(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const i=new fd([],n,t.dtype,r),o=ao(t,0);return e.forEach((a,c)=>{i.setItem(a,o[c])}),i}function S3e(t,e,n){let r=0;const s=e.map(u=>(r+=u,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=EA(i,n),a=r===0?0:t.size/r,c=ae(()=>{const u=[];t=re(t,[1,r,a]);for(let d=0;d<e.length;++d){const m=[0,d===0?0:s[d-1],0],g=[1,e[d],a];u[d]=re(at(t,m,g),o)}return t.dispose(),u}),l=new fd([],n,t.dtype,e.length);for(let u=0;u<c.length;u++)l.setItem(u,c[u]);return l}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k3e=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=$("thenBranch",t,e,n),s=$("elseBranch",t,e,n),i=$("cond",t,e,n),o=$("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=$("body",t,e,n),s=$("cond",t,e,n),i=$("args",t,e,n),o=await n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let c=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let l=i;for(;c[0];){const u=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const d=l.map(m=>m.id);u.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&d.indexOf(m.id)===-1&&m.dispose()});const h=await n.functionMap[s].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);c=await h[0].data(),h.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&d.indexOf(m.id)===-1&&m.dispose()})}return l}case"LoopCond":{const r=$("pred",t,e,n);return[ec(r)]}case"Switch":{const r=$("pred",t,e,n);let s=$("data",t,e,n);return s.kept||(s=ec(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>Or(s,e,n)!==void 0);if(r){const s=Or(r,e,n);return[ec(s)]}return}case"Enter":{const r=$("frameName",t,e,n),s=$("tensor",t,e,n);return n.enterFrame(r),[ec(s)]}case"Exit":{const r=$("tensor",t,e,n);return n.exitFrame(),[ec(r)]}case"NextIteration":{const r=$("tensor",t,e,n);return n.nextIteration(),[ec(r)]}case"TensorArrayV3":{const r=$("size",t,e,n),s=$("dtype",t,e,n),i=$("elementShape",t,e,n),o=$("dynamicSize",t,e,n),a=$("clearAfterRead",t,e,n),c=$("identicalElementShapes",t,e,n),l=$("name",t,e,n),u=new b3e(l,s,r,i,c,o,a);return n.addTensorArray(u),[u.idTensor,rt(1)]}case"TensorArrayWriteV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n),i=$("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(s,i),[o.idTensor]}case"TensorArrayReadV3":{const r=$("tensorArrayId",t,e,n),s=$("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),i=$("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,i)]}case"TensorArrayScatterV3":{const r=$("tensorArrayId",t,e,n),s=$("indices",t,e,n),i=$("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(s,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),i=$("dtype",t,e,n);return[s.concat(i)]}case"TensorArraySplitV3":{const r=$("tensorArrayId",t,e,n),s=$("tensor",t,e,n),i=$("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,s),[o.idTensor]}case"TensorArraySizeV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[rt(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=$("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),i=$("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(s,i),[o.idTensor]}case"TensorListGetItem":{const r=$("tensorListId",t,e,n),s=$("index",t,e,n),i=$("elementShape",t,e,n),o=$("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=$("indices",t,e,n),s=$("tensor",t,e,n),i=$("elementShape",t,e,n),o=$("numElements",t,e,n),a=I3e(s,r,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=$("elementShape",t,e,n),s=$("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=$(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,c=x3e(r,s,o,a);return n.addTensorList(c),[c.idTensor]}case"TensorListGather":{const r=$("tensorListId",t,e,n),s=$("indices",t,e,n),i=$("elementShape",t,e,n),o=$("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,o,i)]}case"TensorListStack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),i=$("elementDType",t,e,n),o=$("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,i,o)]}case"TensorListFromTensor":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),i=$("elementDType",t,e,n),o=w3e(r,s,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id),i=$("dtype",t,e,n),o=$("elementShape",t,e,n);return[s.concat(i,o)]}case"TensorListPushBack":{const r=$("tensorListId",t,e,n),s=$("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(s),[i.idTensor]}case"TensorListPopBack":{const r=$("tensorListId",t,e,n),s=$("elementShape",t,e,n),i=$("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,i)]}case"TensorListSplit":{const r=$("tensor",t,e,n),s=$("elementShape",t,e,n),i=$("lengths",t,e,n),o=S3e(r,i,s);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=$("tensorListId",t,e,n),s=n.getTensorList(r.id);return[rt(s.size(),"int32")]}case"TensorListResize":{const r=$("tensorListId",t,e,n),s=$("size",t,e,n),o=n.getTensorList(r.id).resize(s);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(t,e,n){const[r,s]=$("fusedOps",t,e,n),i=r==="biasadd",o=!i,a=s==="prelu",c=r==="fusedbatchnorm",l=$("numArgs",t,e,n);if(i){if(a&&l!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&l!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=$("strides",t,e,n),d=ew(t,e,n),h=$("dataFormat",t,e,n).toUpperCase(),m=$("dilations",t,e,n);let[g,v]=$("args",t,e,n);o&&(v=g,g=void 0);const y=$("leakyreluAlpha",t,e,n);return{stride:u,pad:d,dataFormat:h,dilations:m,biasArg:g,preluArg:v,activationFunc:s,leakyreluAlpha:y}}const E3e=(t,e,n,r=Hr)=>{switch(t.op){case"Conv1D":{const s=$("stride",t,e,n),i=$("pad",t,e,n),o=$("dataFormat",t,e,n).toUpperCase(),a=$("dilation",t,e,n);return[r.conv1d($("x",t,e,n),$("filter",t,e,n),s,i,o,a)]}case"Conv2D":{const s=$("strides",t,e,n),i=ew(t,e,n),o=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv2d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:d}=V4(t,e,n);return[r.fused.conv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:o,dilations:a,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:d}=V4(t,e,n);return[r.fused.depthwiseConv2d({x:$("x",t,e,n),filter:$("filter",t,e,n),strides:[s[1],s[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=$("outputShape",t,e,n),i=$("strides",t,e,n),o=ew(t,e,n);return[r.conv2dTranspose($("x",t,e,n),$("filter",t,e,n),s,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=$("strides",t,e,n),i=ew(t,e,n),o=$("dilations",t,e,n),a=$("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d($("input",t,e,n),$("filter",t,e,n),[s[1],s[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("dataFormat",t,e,n).toUpperCase(),a=$("dilations",t,e,n);return[r.conv3d($("x",t,e,n),$("filter",t,e,n),[s[1],s[2],s[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("kernelSize",t,e,n);return[r.avgPool($("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("kernelSize",t,e,n);return[r.maxPool($("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("kernelSize",t,e,n),a=$("includeBatchInIndex",t,e,n),{result:c,indexes:l}=r.maxPoolWithArgmax($("x",t,e,n),[o[1],o[2]],[s[1],s[2]],i,a);return[c,l]}case"AvgPool3D":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("kernelSize",t,e,n);return[r.avgPool3d($("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("kernelSize",t,e,n);return[r.maxPool3d($("x",t,e,n),[o[1],o[2],o[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=$("strides",t,e,n),i=$("pad",t,e,n),o=$("dilations",t,e,n),a=s[1],c=s[2],l=o[1],u=o[2];return[r.dilation2d($("x",t,e,n),$("filter",t,e,n),[a,c],i,[l,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3e=(t,e,n,r=Hr)=>{switch(t.op){case"Fill":{const s=$("shape",t,e,n),i=$("dtype",t,e,n),o=$("value",t,e,n);return[r.fill(s,o,i)]}case"LinSpace":{const s=$("start",t,e,n),i=$("stop",t,e,n),o=$("num",t,e,n);return[r.linspace(s,i,o)]}case"Multinomial":{const s=$("logits",t,e,n),i=$("numSamples",t,e,n),o=$("seed",t,e,n);return[r.multinomial(s,i,o)]}case"OneHot":{const s=$("indices",t,e,n),i=$("depth",t,e,n),o=$("onValue",t,e,n),a=$("offValue",t,e,n),c=$("dtype",t,e,n);return[r.oneHot(s,i,o,a,c)]}case"Ones":return[r.ones($("shape",t,e,n),$("dtype",t,e,n))];case"OnesLike":return[r.onesLike($("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal($("shape",t,e,n),$("dtype",t,e,n),$("seed",t,e,n))];case"RandomUniform":return[r.randomUniform($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt($("shape",t,e,n),$("minval",t,e,n),$("maxval",t,e,n),$("seed",t,e,n))];case"Range":{const s=$("start",t,e,n),i=$("stop",t,e,n),o=$("step",t,e,n);return[r.range(s,i,o,$("dtype",t,e,n))]}case"TruncatedNormal":{const s=$("shape",t,e,n),i=$("mean",t,e,n),o=$("stdDev",t,e,n),a=$("seed",t,e,n);return[r.truncatedNormal(s,i,o,$("dtype",t,e,n),a)]}case"Zeros":return[r.zeros($("shape",t,e,n),$("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2(t,e,n){const r=$("boxes",t,e,n),s=$("scores",t,e,n),i=$("maxOutputSize",t,e,n),o=$("iouThreshold",t,e,n),a=$("scoreThreshold",t,e,n),c=$("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:c}}const T3e=async(t,e,n,r,s=Hr)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:c,scoreThreshold:l,softNmsSigma:u}=Z2(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(i,o,a,c,l,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:c,scoreThreshold:l}=Z2(t,e,n),u=$("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(i,o,a,c,l,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:c,scoreThreshold:l}=Z2(t,e,n);return[await s.image.nonMaxSuppressionAsync(i,o,a,c,l)]}case"Where":{const i=s.cast($("condition",t,e,n),"bool"),o=[await s.whereAsync(i)];return i.dispose(),o}case"ListDiff":return s.setdiff1dAsync($("x",t,e,n),$("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A3e=(t,e,n,r=Hr)=>{switch(t.op){case"LowerBound":{const s=$("sortedSequence",t,e,n),i=$("values",t,e,n);return[r.lowerBound(s,i)]}case"TopKV2":{const s=$("x",t,e,n),i=$("k",t,e,n),o=$("sorted",t,e,n),a=r.topk(s,i,o);return[a.values,a.indices]}case"UpperBound":{const s=$("sortedSequence",t,e,n),i=$("values",t,e,n);return[r.upperBound(s,i)]}case"Unique":{const s=$("x",t,e,n),i=r.unique(s);return[i.values,i.indices]}case"UniqueV2":{const s=$("x",t,e,n),i=$("axis",t,e,n),o=r.unique(s,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3e=(t,e,n,r=Hr)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=$("default",t,e,n);return[Or(t.name,e,n)||s];case"Placeholder":return[Or(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=$("x",t,e,n);return[ec(u)]}case"IdentityN":return $("x",t,e,n).map(u=>ec(u));case"Snapshot":const i=$("x",t,e,n);return[ec(i)];case"Shape":return[r.tensor1d($("x",t,e,n).shape,"int32")];case"ShapeN":return $("x",t,e,n).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar($("x",t,e,n).size,"int32")];case"Rank":return[r.scalar($("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=$("x",t,e,n),a=$("data",t,e,n),c=$("message",t,e,n),l=$("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _3e{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=rt(0),this.tensorMap=new Map,xr(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return rt(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),ae(()=>{const s=ao(n),i=r.length,o=s.length;U(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const c=r[a],l=s[a];xr(l),this.tensorMap.set(c,l)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return ae(()=>{const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=this.findWithDefault(o,n);s.push(a)}return ii(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $3e=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const i=$("keyDType",t,e,n),o=$("valueDType",t,e,n),a=new _3e(i,o);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=$("tableHandle",t,e,n,r),i=$("keys",t,e,n),o=$("values",t,e,n);return[await r.getHashTableById(s.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const s=$("tableHandle",t,e,n,r),i=$("keys",t,e,n),o=$("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=$("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R3e=(t,e,n,r=Hr)=>{switch(t.op){case"ResizeBilinear":{const s=$("images",t,e,n),i=$("size",t,e,n),o=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const s=$("images",t,e,n),i=$("size",t,e,n),o=$("alignCorners",t,e,n),a=$("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[i[0],i[1]],o,a)]}case"CropAndResize":{const s=$("image",t,e,n),i=$("boxes",t,e,n),o=$("boxInd",t,e,n),a=$("cropSize",t,e,n),c=$("method",t,e,n),l=$("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,i,o,a,c,l)]}case"ImageProjectiveTransformV3":{const s=$("images",t,e,n),i=$("transforms",t,e,n),o=$("outputShape",t,e,n),a=$("fillValue",t,e,n),c=$("interpolation",t,e,n),l=$("fillMode",t,e,n);return[r.image.transform(s,i,c.toLowerCase(),l.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O3e=(t,e,n,r=Hr)=>{switch(t.op){case"Equal":return[r.equal($("a",t,e,n),$("b",t,e,n))];case"NotEqual":return[r.notEqual($("a",t,e,n),$("b",t,e,n))];case"Greater":return[r.greater($("a",t,e,n),$("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual($("a",t,e,n),$("b",t,e,n))];case"Less":return[r.less($("a",t,e,n),$("b",t,e,n))];case"LessEqual":return[r.lessEqual($("a",t,e,n),$("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd($("a",t,e,n),$("b",t,e,n))];case"LogicalNot":return[r.logicalNot($("a",t,e,n))];case"LogicalOr":return[r.logicalOr($("a",t,e,n),$("b",t,e,n))];case"Select":case"SelectV2":return[r.where($("condition",t,e,n),$("a",t,e,n),$("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd($("a",t,e,n),$("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3e=(t,e,n,r=Hr)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul($("a",t,e,n),$("b",t,e,n),$("transposeA",t,e,n),$("transposeB",t,e,n))];case"Einsum":return[r.einsum($("equation",t,e,n),...$("tensors",t,e,n))];case"Transpose":return[r.transpose($("x",t,e,n),$("perm",t,e,n))];case"_FusedMatMul":const[s,i]=$("fusedOps",t,e,n),o=s==="biasadd",a=i==="prelu",c=$("numArgs",t,e,n),l=$("leakyreluAlpha",t,e,n);if(o){if(a&&c!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&c!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=$("args",t,e,n);return[r.fused.matMul({a:$("a",t,e,n),b:$("b",t,e,n),transposeA:$("transposeA",t,e,n),transposeB:$("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart($("a",t,e,n),$("numLower",t,e,n),$("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3e=(t,e,n,r=Hr)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm($("x",t,e,n),$("axis",t,e,n),$("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm($("x",t,e,n),$("mean",t,e,n),$("variance",t,e,n),$("offset",t,e,n),$("scale",t,e,n),$("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization($("x",t,e,n),$("radius",t,e,n),$("bias",t,e,n),$("alpha",t,e,n),$("beta",t,e,n))];case"Softmax":return[r.softmax($("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F3e=(t,e,n,r=Hr)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:i}=r.raggedGather($("paramsNestedSplits",t,e,n),$("paramsDenseValues",t,e,n),$("indices",t,e,n),$("outputRaggedRank",t,e,n));return s.concat(i)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:i}=r.raggedRange($("starts",t,e,n),$("limits",t,e,n),$("splits",t,e,n));return[s,i]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor($("shape",t,e,n),$("values",t,e,n),$("defaultValue",t,e,n),$("rowPartitionTensors",t,e,n),$("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3e=(t,e,n,r=Hr)=>{switch(t.op){case"Max":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.max($("x",t,e,n),a,c)]}case"Mean":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.mean($("x",t,e,n),a,c)]}case"Min":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.min($("x",t,e,n),a,c)]}case"Sum":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.sum($("x",t,e,n),a,c)]}case"All":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.all($("x",t,e,n),a,c)]}case"Any":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.any($("x",t,e,n),a,c)]}case"ArgMax":{const a=$("axis",t,e,n);return[r.argMax($("x",t,e,n),a)]}case"ArgMin":{const a=$("axis",t,e,n);return[r.argMin($("x",t,e,n),a)]}case"Prod":{const a=$("axis",t,e,n),c=$("keepDims",t,e,n);return[r.prod($("x",t,e,n),a,c)]}case"Cumprod":{const a=$("axis",t,e,n),c=$("exclusive",t,e,n),l=$("reverse",t,e,n);return[r.cumprod($("x",t,e,n),a,c,l)]}case"Cumsum":{const a=$("axis",t,e,n),c=$("exclusive",t,e,n),l=$("reverse",t,e,n);return[r.cumsum($("x",t,e,n),a,c,l)]}case"Bincount":const s=$("x",t,e,n),i=$("weights",t,e,n),o=$("size",t,e,n);return[r.bincount(s,i,o)];case"DenseBincount":{const a=$("x",t,e,n),c=$("weights",t,e,n),l=$("size",t,e,n),u=$("binaryOutput",t,e,n);return[r.denseBincount(a,c,l,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B3e=(t,e,n,r=Hr)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=$("n",t,e,n),i=$("axis",t,e,n);let o=$("tensors",t,e,n);return o=o.slice(0,s),[r.concat(o,i)]}case"Gather":{const s=$("x",t,e,n),i=$("indices",t,e,n);return[r.gather(s,r.cast(i,"int32"),0)]}case"GatherV2":{const s=$("axis",t,e,n),i=$("batchDims",t,e,n),o=$("x",t,e,n),a=$("indices",t,e,n);return[r.gather(o,r.cast(a,"int32"),s,i)]}case"Reverse":{const s=$("dims",t,e,n),i=[];for(let a=0;a<s.length;a++)s[a]&&i.push(a);const o=$("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const s=$("axis",t,e,n),i=$("x",t,e,n);return[r.reverse(i,s)]}case"Slice":{const s=$("begin",t,e,n),i=$("size",t,e,n);return[r.slice($("x",t,e,n),s,i)]}case"StridedSlice":{const s=$("begin",t,e,n),i=$("end",t,e,n),o=$("strides",t,e,n),a=$("beginMask",t,e,n),c=$("endMask",t,e,n),l=$("ellipsisMask",t,e,n),u=$("newAxisMask",t,e,n),d=$("shrinkAxisMask",t,e,n),h=$("x",t,e,n);return[r.stridedSlice(h,s,i,o,a,c,l,u,d)]}case"Pack":return ae(()=>{const s=$("axis",t,e,n),i=$("tensors",t,e,n),o=i[0].shape,a=r.squeeze(i[0]).shape,c=i.map(l=>{const u=Dt(l.shape,o);if(!u&&!Dt(r.squeeze(l).shape,a))throw new Error("the input tensors shape does not match");return u?l:r.reshape(l,o)});return[r.stack(c,s)]});case"Unpack":{const s=$("axis",t,e,n),i=$("tensor",t,e,n);return r.unstack(i,s)}case"Tile":{const s=$("reps",t,e,n);return[r.tile($("x",t,e,n),s)]}case"Split":case"SplitV":{const s=$("axis",t,e,n),i=$("numOrSizeSplits",t,e,n),o=$("x",t,e,n);return r.split(o,i,s)}case"ScatterNd":{const s=$("indices",t,e,n),i=$("values",t,e,n),o=$("shape",t,e,n);return[r.scatterND(s,i,o)]}case"GatherNd":{const s=$("x",t,e,n),i=$("indices",t,e,n);return[r.gatherND(s,i)]}case"SparseToDense":{const s=$("sparseIndices",t,e,n),i=$("outputShape",t,e,n),o=$("sparseValues",t,e,n),a=$("defaultValue",t,e,n);return[r.sparseToDense(s,o,i,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const s=$("indices",t,e,n),i=$("values",t,e,n),o=$("tensor",t,e,n);return[r.tensorScatterUpdate(o,s,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3e=(t,e,n,r=Hr)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows($("indices",t,e,n),$("values",t,e,n),$("denseShape",t,e,n),$("defaultValue",t,e,n));return[s,i,o,a]}case"SparseReshape":{const{outputIndices:s,outputShape:i}=r.sparse.sparseReshape($("inputIndices",t,e,n),$("inputShape",t,e,n),$("newShape",t,e,n));return[s,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum($("data",t,e,n),$("indices",t,e,n),$("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z3e=(t,e,n,r=Hr)=>{switch(t.op){case"FFT":return[r.fft($("x",t,e,n))];case"IFFT":return[r.ifft($("x",t,e,n))];case"RFFT":return[r.rfft($("x",t,e,n))];case"IRFFT":return[r.irfft($("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U3e=(t,e,n,r=Hr)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace($("input",t,e,n),$("pattern",t,e,n),$("rewrite",t,e,n),$("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:i}=r.string.stringNGrams($("data",t,e,n),$("dataSplits",t,e,n),$("separator",t,e,n),$("nGramWidths",t,e,n),$("leftPad",t,e,n),$("rightPad",t,e,n),$("padWidth",t,e,n),$("preserveShortSequences",t,e,n));return[s,i]}case"StringSplit":{const{indices:s,values:i,shape:o}=r.string.stringSplit($("input",t,e,n),$("delimiter",t,e,n),$("skipEmpty",t,e,n));return[s,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast($("input",t,e,n),$("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3e=(t,e,n,r=Hr)=>{switch(t.op){case"Cast":return[r.cast($("x",t,e,n),$("dtype",t,e,n))];case"ExpandDims":{const s=$("axis",t,e,n);return[r.expandDims($("x",t,e,n),s)]}case"Squeeze":{const s=$("axis",t,e,n);return[r.squeeze($("x",t,e,n),s)]}case"Reshape":return[r.reshape($("x",t,e,n),$("shape",t,e,n))];case"EnsureShape":return[r.ensureShape($("x",t,e,n),$("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad($("x",t,e,n),$("padding",t,e,n),$("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad($("x",t,e,n),$("padding",t,e,n),$("constantValue",t,e,n))];case"SpaceToBatchND":{const s=$("blockShape",t,e,n),i=$("paddings",t,e,n);return[r.spaceToBatchND($("x",t,e,n),s,i)]}case"BatchToSpaceND":{const s=$("blockShape",t,e,n),i=$("crops",t,e,n);return[r.batchToSpaceND($("x",t,e,n),s,i)]}case"DepthToSpace":{const s=$("blockSize",t,e,n),i=$("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace($("x",t,e,n),s,i)]}case"BroadcastTo":return[r.broadcastTo($("x",t,e,n),$("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs($("s0",t,e,n),$("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4(t,e,n,r,s=ae){const i=((o,a,c)=>{switch(o.category){case"arithmetic":return s(()=>y3e(o,a,c));case"basic_math":return s(()=>v3e(o,a,c));case"control":return k3e(o,a,c);case"convolution":return s(()=>E3e(o,a,c));case"creation":return s(()=>C3e(o,a,c));case"dynamic":return T3e(o,a,c);case"evaluation":return s(()=>A3e(o,a,c));case"image":return s(()=>R3e(o,a,c));case"graph":return s(()=>N3e(o,a,c));case"logical":return s(()=>O3e(o,a,c));case"matrices":return s(()=>P3e(o,a,c));case"normalization":return s(()=>D3e(o,a,c));case"ragged":return s(()=>F3e(o,a,c));case"reduction":return s(()=>L3e(o,a,c));case"slice_join":return s(()=>B3e(o,a,c));case"sparse":return s(()=>M3e(o,a,c));case"spectral":return s(()=>z3e(o,a,c));case"string":return s(()=>U3e(o,a,c));case"transformation":return s(()=>V3e(o,a,c));case"hash_table":return $3e(o,a,c,r);case"custom":const l=nX(o.op);if(l&&l.customExecutor)return l.customExecutor(new g3e(o,a,c));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return nd(i)?i.then(o=>[].concat(o)):[].concat(i)}class H4{constructor(e={},n={},r={},s={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4(t,e,n,r){const s=new Set,i=[];let o=null,a=null;const c=new Set,l=new Set(Object.keys(t).map(h=>Us(h)[0]));r=r||[];const u=new Set(r.map(h=>Us(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((xu(h)||Q3e(h)||Y3e(h))&&o==null&&(o=h,a=o.children.map(m=>m.name).filter(m=>s.has(m))),s.add(h.name),n[h.name]==null&&!l.has(h.name)&&!u.has(h.name)){if(h.inputs.length===0){i.push(h.name);continue}h.inputs.forEach(m=>{c.has(m.name)||(c.add(m.name),d.push(m))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:i,dynamicNode:o,syncInputs:a}}function j3e(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(y=>Us(y)[0]).map(y=>t.nodes[y]),i=t.initNodes||[],o=y=>n.has(typeof y=="string"?y:y.name);function a(y){return[...new Map(y.map(w=>[w.name,w])).values()]}const c=a([...s,...t.weights,...i]).filter(o),l=a([...c,...Object.values(t.nodes)]).filter(o),u=new Map(l.map(y=>[y.name,y])),d={};for(const y of l){d[y.name]=d[y.name]||0;for(const w of y.children)o(w)||(d[w.name]=Number.POSITIVE_INFINITY),d[w.name]=(d[w.name]||0)+1}const h=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),m=[...h];for(;h.length>0;){const y=h.pop(),w=u.get(y);for(const x of w.children.filter(o))--d[x.name]===0&&(m.push(x.name),h.push(x.name))}const g=m.map(y=>u.get(y)),v=H3e(g,c);return W3e(v,c),v}function H3e(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),s=new Set(r);for(;r.length>0;){const o=r.pop(),a=n.get(o);for(const c of a.children)!n.has(c.name)||s.has(c.name)||(s.add(c.name),r.push(c.name))}return t.filter(o=>s.has(o.name))}class xb extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function W3e(t,e){const n=new Map(t.map((a,c)=>[a.name,c])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const c of a.children.filter(o)){if(!n.has(c.name))throw new xb(`Child ${c.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(c.name))throw new xb(`Node ${a.name} is scheduled to run after its child ${c.name}.`)}if(!s(a))for(const c of a.inputs){if(!n.has(c.name))throw new xb(`Input ${c.name} of node ${a.name} is unreachable.`);if(n.get(c.name)>n.get(a.name))throw new xb(`Node ${a.name} is scheduled to run before its input ${c.name}.`)}}}function G3e(t){const e=new Map(t.map((a,c)=>[a.name,c])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,c)=>xu(a)?n:c),s=a=>{const c=r[e.get(a.name)];return c??-1},i=t.map((a,c)=>a.children.map(s).reduce((l,u)=>Math.max(l,u),r[c])),o=new Map;for(let a=0;a<t.length;++a){const c=i[a];if(c===n)continue;const l=t[a],u=t[c];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(l)}return o}const q3e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),K3e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),X3e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function xu(t){return q3e.has(t.op)}function Q3e(t){return K3e.has(t.op)}function Y3e(t){return X3e.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ux{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Ux(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),s=n.map(i=>i.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=W4(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(s.length>0){const l=n.map(d=>d.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${l}] from the provided inputs [${u}]. Missing the following inputs: [${s}]`)}const a=j3e(this.graph,r),c=G3e(a);return{orderedNodes:a,nodeLiveUntilMap:c}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return xr(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(h=>this.graph.nodes[Us(h)[0]]),i=n.map(h=>Us(h)[0]),o=new Set(i);let a=i.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const c=this.getCompilationKey(s,a);let l=this.compiledMap.get(c);l==null&&(l=this.compile(e,a),this.compiledMap.set(c,l));try{this.keepIntermediateTensors=fe().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const u={},d={};return ae(()=>{const h=new H4(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),m=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[x,S]=Us(w,h),k=[];k[S]=e[w],m[x]=k,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(k))});const g=this.getFrozenTensorIds(m),{orderedNodes:v,nodeLiveUntilMap:y}=l;for(const w of v){if(m[w.name])continue;const x=j4(w,m,h,this._resourceManager);if(nd(x))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);m[w.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,m,h,g,o,y.get(w.name))}return this.parent==null&&h.dispose(g),n.map(w=>Or(w,m,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,i,o,a){if(!(xu(n)||o.has(e))){for(const c of r[e])c!=null&&(a[c.id]=(a[c.id]||0)+n.children.length);for(const c of n.inputs){if(xu(c))continue;const l=B4(c.name,r,s);if(l!=null)for(const u of l){if(!u||u.kept||i.has(u.id))continue;const d=a[u.id];d===1?(u.dispose(),delete a[u.id]):d!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,i,o){function a(c){return xu(c)||i.has(c.name)}if(!(xu(e)||o==null))for(const c of o){if(a(c))continue;const l=B4(c.name,n,r);for(const u of l)!u||u.kept||s.has(u.id)||u.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},i={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=fe().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new H4(this.weightMap,s,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,r),c=n.map(h=>Or(h,a,o)),l=c.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id),d=new Set([...l,...u,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(m=>{m&&!m.isDisposed&&!d.has(m.id)&&m.dispose()})}),this.parent==null&&o.dispose(d),c}async executeFunctionAsync(e,n,r){const s=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const i=Object.keys(e),o=i.map(k=>this.graph.nodes[Us(k)[0]]),a=r.map(k=>Us(k)[0]),c=new Set(a);let l=a.map(k=>this.graph.nodes[k]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:h,syncInputs:m}=W4(e,l,this.weightMap,this._initNodes),g=[...o,...this.graph.weights,...this._initNodes||[]].map(k=>({node:k,contexts:n.currentContext})),v=Object.assign({},this.weightMap);Object.keys(e).forEach(k=>{const[E,A]=Us(k),R=[];R[A]=e[k],v[E]=R});const y={},w=this.getFrozenTensorIds(v),x={};for(;g.length>0;){const k=this.processStack(o,g,n,v,x,w,c,y,u);await Promise.all(k)}h==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const S=l.filter(k=>!xu(k)&&!Or(k.name,v,n)).map(k=>k.name);if(S.length>0){let k="";throw h!=null&&(k=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${S}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${k}`)}return v}processStack(e,n,r,s,i,o,a,c,l){const u=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&$("isConstant",d.node,s,r)&&([h]=Ja(d.node.name,r)),s[d.node.name]==null){const m=j4(d.node,s,r,this._resourceManager);h||([h]=Ja(d.node.name,r));const g=r.currentContext;nd(m)?u.push(m.then(v=>(s[h]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(v)),r.currentContext=g,this.checkTensorForDisposal(h,d.node,s,r,o,a,c),this.processChildNodes(d.node,n,r,s,i,l),v))):(s[h]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(m)),this.checkTensorForDisposal(h,d.node,s,r,o,a,c),this.processChildNodes(d.node,n,r,s,i,l))}else this.processChildNodes(d.node,n,r,s,i,l)}return u}processChildNodes(e,n,r,s,i,o){e.children.forEach(a=>{const[c]=Ja(a.name,r);i[c]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(l=>!!Or(l,s,r))&&(i[c]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(l=>!!Or(l,s,r))&&(i[c]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=Us(n),i=this.graph.nodes[s];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===r.shape.length&&r.shape.every((c,l)=>o[l]===-1||o[l]===c);U(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&U(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const i in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[i];o!=null?s[o.name]=e[i]:s[i]=e[i]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=Us(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const i=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=Us(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class Z3e{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3e="?tfjs-format=file",eLe="model.json";class tLe{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=i9){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new Z3e}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return nd(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await _8(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(s=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Ux(M4.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=M4.Instance.transformGraph(e.modelInitializer);this.initializer=new Ux(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof Yt?[e]:e,r={};return n.forEach((s,i)=>r[this.structuredOutputKeys[i]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof Yt)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((i,o)=>{var a,c,l;const u=(l=(c=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||c===void 0?void 0:c[o])===null||l===void 0?void 0:l.resourceId;return u!=null?i[o]=this.resourceIdToCapturedInput[u]:i[o]=e[s++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Tt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function G4(t,e={},n=i9){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=nLe(t));const r=new tLe(t,e,n);return await r.load(),r}function nLe(t){return t.endsWith("/")||(t=t+"/"),`${t}${eLe}${J3e}`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var q4;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(q4||(q4={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xe(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&U(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rLe=kR;class OS extends L_{nextDataId(){return OS.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new n8(this,na())}write(e,n,r){this.firstUse&&(this.firstUse=!1,fe().get("IS_NODE")&&gi(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&g0(r[0])){const i=r.map(o=>dl(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,i){this.data.set(e,{values:n,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return vc(s,i)}return aEe(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Sl(s));return kt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return kt(e.shape,e.dtype,n)}makeOutput(e,n,r){return na().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=ws();return e(),{kernelMs:ws()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Xe([e],"where");const n=this.readSync(e.dataId);return rLe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}OS.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const sLe=t=>{const{x:e}=t.inputs,n=t.backend;Xe(e,"abs");let r=new Float32Array(me(e.shape));const s=n.data.get(e.dataId).values;return r=iX(s),n.makeOutput(r,e.shape,e.dtype)},iLe={kernelName:G1,backendName:"cpu",kernelFunc:sLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yn(t){return(e,n,r,s,i)=>{const o=bt(e,n),a=o.length,c=nt(o),l=me(o),u=Mr(i,l),d=e.length,h=n.length,m=nt(e),g=nt(n),v=Ih(e,o),y=Ih(n,o);if(v.length+y.length===0)for(let w=0;w<u.length;++w)u[w]=t(r[w%r.length],s[w%s.length]);else for(let w=0;w<u.length;++w){const x=Kh(w,a,c),S=x.slice(-d);v.forEach(R=>S[R]=0);const k=va(S,d,m),E=x.slice(-h);y.forEach(R=>E[R]=0);const A=va(E,h,g);u[w]=t(r[k],s[A])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),c=n.data.get(a.dataId);return c.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(s.shape,"float32",o)},a}const oLe={kernelName:q_,backendName:"cpu",kernelFunc:Xs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(t,e,n="float32"){if(n==="complex64"){const s=Vx(t,e,"float32"),i=Vx(t,e,"float32");return Xs({inputs:{real:s,imag:i},backend:t})}const r=Jr(me(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const aLe={kernelName:L0,backendName:"cpu",kernelFunc:Na};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hd(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const cLe={kernelName:E$,backendName:"cpu",kernelFunc:hd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Ed([0],n),[i,o]=Yn((a,c)=>a!==c?1:0)(e,[],t,s,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Rl(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return Na({inputs:{x:s},backend:n});const u=Vx(n,s.shape,s.dtype),d=Rl({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),h=Xs({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(s.dtype==="complex64"){const u=hd({inputs:{input:s},backend:n}),d=Rl({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!s8(s.dtype,i)){const u=Na({inputs:{x:s},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(s.dataId).values,[a,c,l]=oX(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,c,l)}const lLe={kernelName:k0,backendName:"cpu",kernelFunc:Rl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(t,e,n,r){return n==null?({inputs:s,backend:i})=>{const{a:o,b:a}=s,c=i;Xe([o,a],t);const l=c.data.get(o.dataId).values,u=c.data.get(a.dataId).values,d=o.dtype==="string"?bc(l):l,h=o.dtype==="string"?bc(u):u,m=r||o.dtype,[g,v]=e(o.shape,a.shape,d,h,m);return c.makeTensorInfo(v,m,g)}:({inputs:s,backend:i})=>{const{a:o,b:a}=s,c=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const l=Rl({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),u=c.data.get(l.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,m=c.data.get(d.dataId).values,g=c.data.get(h.dataId).values,v=Rl({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),y=c.data.get(v.dataId),w=y.complexTensorInfos.real,x=y.complexTensorInfos.imag,S=c.data.get(w.dataId).values,k=c.data.get(x.dataId).values,[E,A,R]=n(o.shape,a.shape,m,g,S,k),N=c.makeTensorInfo(R,"float32",E),P=c.makeTensorInfo(R,"float32",A),O=Xs({inputs:{real:N,imag:P},backend:c});return c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(N),c.disposeIntermediateTensorInfo(P),O}else{const l=c.data.get(o.dataId).values,u=c.data.get(a.dataId).values,d=r||o.dtype,[h,m]=e(o.shape,a.shape,l,u,d);return c.makeTensorInfo(m,d,h)}}}function AO(t){return(e,n,r,s,i,o)=>{const a=bt(e,n),c=me(a),l=a.length,u=nt(a),d=Mr("float32",c),h=Mr("float32",c),m=Ih(e,a),g=Ih(n,a),v=vc(r,s),y=vc(i,o),w=e.length,x=nt(e),S=n.length,k=nt(n);if(m.length+g.length===0)for(let E=0;E<d.length;E++){const A=E%v.length,R=E%y.length,N=t(v[A*2],v[A*2+1],y[R*2],y[R*2+1]);d[E]=N.real,h[E]=N.imag}else for(let E=0;E<d.length;E++){const A=Kh(E,l,u),R=A.slice(-w);m.forEach(M=>R[M]=0);const N=va(R,w,x),P=A.slice(-S);g.forEach(M=>P[M]=0);const O=va(P,S,k),_=t(v[N*2],v[N*2+1],y[O*2],y[O*2+1]);d[E]=_.real,h[E]=_.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=Yn(((t,e)=>t+e)),uLe=AO(((t,e,n,r)=>({real:t+n,imag:e+r}))),Ch=yr(Xh,aX,uLe),dLe={kernelName:Xh,backendName:"cpu",kernelFunc:Ch};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(t,e,n,r,s){const i=me(r),o=Jr(s,n);for(let a=0;a<t.length;a++){const c=t[a];if(c<0)throw new Error("Input x must be non-negative!");c>=s||(i>0?o[c]+=e[a]:o[c]+=1)}return o}function cX(t,e,n,r=!1){const s=t.shape[0],i=t.shape[1],o=kt([s,n],e.dtype);for(let a=0;a<s;a++)for(let c=0;c<i;c++){const l=t.get(a,c);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?o.set(1,a,l):e.size>0?o.set(o.get(a,l)+e.get(a,c),a,l):o.set(o.get(a,l)+1,a,l))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=Yn(((t,e)=>t&e)),fLe=yr(eI,lX),hLe={kernelName:eI,backendName:"cpu",kernelFunc:fLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t){return(e,n,r)=>{const s=qn(n,e.length);for(let i=0;i<e.length;++i)s[i]=t(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(t,e,n){const r=Oa(e);return ql(t,r,n)}function ql(t,e,n){return({inputs:r,attrs:s,backend:i})=>{const{x:o}=r;Xe(o,t);const a=i,c=a.data.get(o.dataId).values;let l;if(o.dtype==="string"){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");l=bc(c)}else l=c;const u=n||o.dtype,d=e(l,u,s);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX=Oa(t=>Math.ceil(t)),pLe=ql(E0,uX),mLe={kernelName:E0,backendName:"cpu",kernelFunc:pLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dX(t,e,n,r){const s=qn(n,me(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const a=me(o.shape);s.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?bc(o.vals):o.vals;let c=0;for(let l=0;l<o.shape[0];++l){const u=l*e[1]+i;for(let d=0;d<o.shape[1];++d)s[u+d]=a[c++]}i+=o.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX=Yn((t,e)=>t===e?1:0),hX=yr(lI,fX,null,"bool"),gLe={kernelName:lI,backendName:"cpu",kernelFunc:hX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=Oa(t=>Math.exp(t)),mX=ql(R0,pX,"float32"),yLe={kernelName:R0,backendName:"cpu",kernelFunc:mX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=Oa(t=>Math.expm1(t)),vLe=ql(O0,gX),bLe={kernelName:O0,backendName:"cpu",kernelFunc:vLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX=Oa(t=>Math.floor(t)),wLe=ql(P0,yX),xLe={kernelName:P0,backendName:"cpu",kernelFunc:wLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX=Yn((t,e)=>Math.floor(t/e)),ILe=yr(D0,vX,null,"int32"),SLe={kernelName:D0,backendName:"cpu",kernelFunc:ILe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bX(t,e,n,r,s,i,o,a,c){const l=kt([r,i],n);for(let u=0;u<r;u++){const d=[];let h=0;for(let m=0;m<s;m++){const g=t[u*s+m];h+=g*o[m],d.push(g)}if(h<0||h>=c/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let m=0;m<i;m++)l.values[u*i+m]=e.get(...e.indexToLoc(h*i+m))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(t,e,n){const r=kt(n,t.dtype);for(let s=0;s<r.size;++s){const o=r.indexToLoc(s).slice(),a=o[0],c=o[2],l=e.locToIndex([a,c]);o[2]=e.values[l];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(r.values[s]=t.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX=Yn((t,e)=>t>e?1:0),kLe=yr(hI,xX,null,"bool"),ELe={kernelName:hI,backendName:"cpu",kernelFunc:kLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX=Yn((t,e)=>t>=e?1:0),CLe=yr(F0,IX,null,"bool"),TLe={kernelName:F0,backendName:"cpu",kernelFunc:CLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX=Yn((t,e)=>t<e?1:0),ALe=yr(mI,SX,null,"bool"),NLe={kernelName:mI,backendName:"cpu",kernelFunc:ALe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX=Yn((t,e)=>t<=e?1:0),_Le=yr(gI,kX,null,"bool"),$Le={kernelName:gI,backendName:"cpu",kernelFunc:_Le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EX(t,e,n){const r=(e-t)/(n-1),s=Jr(n,"float32");s[0]=t;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CX=Oa(t=>Math.log(t)),RLe=ql(U0,CX),OLe={kernelName:U0,backendName:"cpu",kernelFunc:RLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(t,e,n,r){const s=Mr(r,me(n));for(let i=0;i<s.length;++i){const o=i*e;let a=t[o];for(let c=0;c<e;++c){const l=t[o+c];(Number.isNaN(l)||l>a)&&(a=l)}s[i]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX=Yn(((t,e)=>Math.max(t,e))),PLe=yr(j0,AX),DLe={kernelName:j0,backendName:"cpu",kernelFunc:PLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX=Yn(((t,e)=>Math.min(t,e))),FLe=yr(H0,NX),LLe={kernelName:H0,backendName:"cpu",kernelFunc:FLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _O=Yn(((t,e)=>t*e)),BLe=AO(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n}))),PS=yr(G0,_O,BLe),MLe={kernelName:G0,backendName:"cpu",kernelFunc:PS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _X(t,e,n){const r=Bl(-1,n);return _O([],e,r,t,n)}function zLe(t){const{inputs:e,backend:n}=t,{x:r}=e;Xe(r,"neg");const s=n.data.get(r.dataId).values,[i,o]=_X(s,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const ULe={kernelName:TI,backendName:"cpu",kernelFunc:zLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X=Yn(((t,e)=>t!==e?1:0)),VLe=yr(AI,$X,null,"bool"),jLe={kernelName:AI,backendName:"cpu",kernelFunc:VLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(t,e,n,r,s){const i=e.length,o=me(e),a=nt(e),c=nt(s),l=Mr(n,me(s));for(let u=0;u<o;++u){const d=Kh(u,i,a),h=new Array(d.length);for(let g=0;g<h.length;g++)h[g]=d[r[g]];const m=va(h,i,c);l[m]=t[u]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ns(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:i}=n;Xe(s,"transpose");const o=s.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=s.shape[i[d]];const c=r.data.get(s.dataId).values,l=$O(c,s.shape,s.dtype,i,a);return{dataId:r.write(l,a,s.dtype),shape:a,dtype:s.dtype}}const HLe={kernelName:qf,backendName:"cpu",kernelFunc:Ns};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RX(t,e,n,r){const[s,i]=Cr(t,r),o=ni(e,"int32"),a=Jr(me(s),o),c=me(i);for(let l=0;l<a.length;++l){const u=l*c;let d=1;for(let h=0;h<c;++h)d*=n[u+h];a[l]=d}return{outVals:a,outShape:s,outDtype:o}}function WLe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Xe(s,"prod");const a=s.shape.length,c=Nt(i,s.shape),l=Pn(c,a);let u=c,d=s;const h=[];l!=null&&(d=Ns({inputs:{x:s},backend:n,attrs:{perm:l}}),h.push(d),u=Xn(u.length,a));const m=n.data.get(d.dataId).values,{outVals:g,outShape:v,outDtype:y}=RX(d.shape,d.dtype,m,u);let w=v;return o&&(w=Kn(v,c)),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(w,y,g)}const GLe={kernelName:PI,backendName:"cpu",kernelFunc:WLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qLe(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const i=Kh(s,e.length,nt(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function KLe(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function XLe(t,e,n,r){const s=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);KLe(n,r);let c=1;for(let l=0;l<e.length-1;++l){c*=e[l];const u=e[l+1];for(let d=1;d<c+1;++d)a[l].push(d*u)}for(let l=0;l<t.length;++l){let u=t[l],d=t[l]+1;for(let h=0;h<n.length;++h){const m=n[h],g=h+e.length-1;if(g>=0){const v=a[g],y=v[v.length-1]-m[u];for(let w=u;w<d;++w)a[g].push(m[w+1]+y)}u=m[u],d=m[d]}d!==u&&(s.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:s,numValues:i}}function QLe(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=qn("int32",r);e.push(s),t[n].forEach((i,o)=>s[o]=i)}return e}function K4(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function YLe(t,e,n,r,s,i){const o=K4(e,2)[1],a=K4(i,2)[1];let c=0;for(const l of n)for(let u=l[0];u<l[1];++u){for(let d=0;d<r;++d)s[c*a+d]=t[u*o+d];++c}}function ZLe(t,e,n,r,s){const i=e.slice();i[0]=s;const o=qn(n,me(i)),a=t.length,c=a===0?0:a/e[0];return YLe(t,e,r,c,o,i),[o,i]}function OX(t,e,n,r,s,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(qLe(i,o,c),r.length===0)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:u,valueSlices:d,numValues:h}=XLe(i,o,t,l),m=QLe(u),g=ZLe(n,r,s,d,h);return[m,g[0],g[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X4=2147483647;function PX(t,e,n,r,s,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,c=s.length===0,l=o.length===0,u=[];a||u.push(e[0]),c||u.push(s[0]),l||u.push(o[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=qn("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const w=a?t[0]:t[y],x=c?r[0]:r[y],S=l?i[0]:i[y];if(S===0)throw new Error("Requires delta != 0");let k;if(S>0&&x<w||S<0&&x>w)k=0;else if(k=Math.ceil(Math.abs((x-w)/S)),k>X4)throw new Error(`Requires ((limit - start) / delta) <= ${X4}`);h[y+1]=h[y]+k}const m=h[d],g=qn(n,m);let v=0;for(let y=0;y<d;++y){const w=h[y+1]-h[y];let x=a?t[0]:t[y];const S=l?i[0]:i[y];for(let k=0;k<w;++k)g[v++]=x,x+=S}return[h,g]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zi=Eo;class jx{constructor(e,n,r,s,i,o,a,c,l,u){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=c,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=g9(u),this.raggedRank=y9(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===zi.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===zi.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case zi.VALUE_ROWIDS:return jx.getMaxWidthValueRowID(n);case zi.ROW_SPLITS:return jx.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${zi[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==s&&(s=a,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Y4(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;v9(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=m9(this.raggedRank,s,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),i=[];let o=0;for(let a=0;a<s;++a,o+=n)i.push(o);for(let a=s;a<e;++a)i.push(-1);return U(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,s){const i=e.length,o=[];for(let a=0;a<i-1;++a){const c=e[a+1]-e[a];let l=Math.min(s,c),u=n[a];u===-1&&(l=0);for(let d=0;d<l;++d)o.push(u),u+=r;for(let d=0;d<c-l;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,s){const i=e.length,o=[];if(i===0)return[];let a=0,c=e[0];if(c>=n.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${n.length}`);let l=n[c];o.push(l);for(let u=1;u<i;++u){const d=e[u];if(d===c)l>=0&&(++a,a<s?l+=r:l=-1);else{if(a=0,c=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);l=n[d]}o.push(l)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,s){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case zi.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,s);case zi.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,s);default:throw new Error(`Unsupported partition type: ${zi[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case zi.FIRST_DIM_SIZE:return e[0];case zi.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case zi.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${zi[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let c=s.length-2;c>=0;--c)s[c]=s[c+1]*r[c+1];const i=Y4(r,!1),o=qn(this.valuesDType,me(i));if(s[0]*r[0]>0){let c=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let l=1;l<=this.raggedRank;++l)c=this.calculateOutputIndex(l-1,c,s[l],r[l]);this.setOutput(this.raggedRank,c,o,i)}return[i,o]}setOutput(e,n,r,s){if(r.length===0)return;const i=this.values,o=r;let a=s.slice();a=a.slice(e+1);const c=me(a),l=n.length;let u=this.defaultValue;if(u.length!==c&&u.length!==1){const g=this.defaultValueShape;ae(()=>{const v=re(u,g);u=Qf(v,a).dataSync()})}let d=0,h=0,m=0;for(let g=0;g<=l;++g){let v=g<l?n[g]:-1;if(v===m){++m;continue}if(h<m){const y=i.subarray(d*c),w=o.subarray(h*c),x=(m-h)*c;Q4(w,y,x)}if(g>=l){const y=r.length;v=Math.floor(y/c)}if(v>m)if(this.defaultValue.length===1)o.subarray(m*c,v*c).fill(this.defaultValue[0]),m=v;else for(;v>m;){const y=o.slice(m*c);Q4(y,u,c),++m}v<0?(d=g+1,h=m):(d=g,h=m,m=h+1)}}}function Q4(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function Y4(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function DX(t,e,n,r,s,i,o,a,c,l){return new jx(t,e,n,r,s,i,o,a,c,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t,e,n,r){const s=t===e,i=t<e&&n<0,o=e<t&&n>1;if(s||i||o)return Jr(0,r);const a=Math.abs(Math.ceil((e-t)/n)),c=Jr(a,r);e<t&&n===1&&(n=-1),c[0]=t;for(let l=1;l<c.length;l++)c[l]=c[l-1]+n;return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX=Oa(t=>1/Math.sqrt(t)),JLe=ql(Z0,LX),eBe={kernelName:Z0,backendName:"cpu",kernelFunc:JLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(t,e,n,r,s,i,o,a,c,l){const u=[r/s,s],d=t.values,h=e.values;if(r===0)return kt(n,e.dtype);const m=c instanceof fr?c:kt(u,e.dtype);typeof c=="string"||typeof c=="number"?m.values.fill(c):typeof c=="boolean"&&m.values.fill(+c);for(let g=0;g<i;g++){const v=[];let y=0;for(let w=0;w<o;w++){const x=d[g*o+w];v.push(x),y+=x*a[w]}if(y<0||y>=r/s)throw new Error(`Invalid indices: ${v} does not index into ${n}`);for(let w=0;w<s;w++)l?m.values[y*s+w]+=h[g*s+w]:m.values[y*s+w]=e.rank===0?h[0]:h[g*s+w]}return m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe=Oa(t=>1/(1+Math.exp(-t))),BX=Jt(ry,t=>1/(1+Math.exp(-t))),nBe={kernelName:ry,backendName:"cpu",kernelFunc:BX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MX(t,e,n,r,s){const i=LR(r,e,n),o=me(n),a=nt(r);if(i){const d=BR(e,a);return s==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const c=s==="string"?bc(t):t,l=kt(r,s,c),u=kt(n,s);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),m=h.map((g,v)=>g+e[v]);u.set(l.get(...m),...h)}return s==="string"?B9(u.values):u.values}function pd(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r;Xe(s,"slice");const[a,c]=bS(s,i,o);DR(s,a,c);const l=n.data.get(s.dataId).values,u=MX(l,a,c,s.shape,s.dtype);return n.makeTensorInfo(c,s.dtype,u)}const rBe={kernelName:zI,backendName:"cpu",kernelFunc:pd};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(t,e,n,r,s,i,o){const a=e[0],c=i[0],l=new Array(c),u=new Array(a),d=e[1];if(c===0){if(a!==0)throw new Error(E9(a));const y=qn(n,0),w=qn(s,0);return[y,[0,d],w,l,u]}let h=!0,m=0;const g=new Array(c).fill(0);for(let y=0;y<a;++y){const w=t[y*d];if(w<0)throw new Error(C9(y,w));if(w>=c)throw new Error(T9(y,w,c));++g[w],h=h&&w>=m,m=w}let v=!0;for(let y=0;y<c;++y){const w=g[y]===0;l[y]=w,v=v&&!w,g[y]=Math.max(g[y],1),y>0&&(g[y]+=g[y-1])}if(v&&h){const y=t,w=r;for(let x=0;x<a;++x)u[x]=x;return[y,[a,d],w,l,u]}else{const y=g[c-1],w=qn(n,y*d),x=qn(s,y),S=new Array(c).fill(0);for(let k=0;k<a;++k){const E=t[k*d],A=S[E],R=(E===0?0:g[E-1])+A;S[E]++;for(let N=0;N<d;++N)w[R*d+N]=t[k*d+N];x[R]=r[k],u[k]=R}for(let k=0;k<c;++k)if(S[k]===0){const A=k===0?0:g[k-1];w[A*d+0]=k;for(let R=1;R<d;++R)w[A*d+R]=0;x[A]=o}return[w,[y,d],x,l,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UX(t,e,n,r,s){const i=me(r),o=e[0],a=s.length,c=[];let l=1,u=-1;for(let y=0;y<a;++y){const w=s[y];if(w===-1){if(u!==-1)throw new Error(A9(u,y));u=y,c.push(1)}else{if(w<0)throw new Error(N9(y,w));l*=w,c.push(w)}}if(u!==-1){if(l<=0)throw new Error(_9());const y=Math.trunc(i/l);if(l*y!==i)throw new Error($9(r,c));c[u]=y}if(me(c)!==i)throw new Error(R9(r,c));const h=r.length,m=[];if(h>0){m[h-1]=1;for(let y=h-2;y>=0;--y)m[y]=m[y+1]*r[y+1]}const g=[];if(a>0){g[a-1]=1;for(let y=a-2;y>=0;--y)g[y]=g[y+1]*c[y+1]}const v=qn(n,o*a);for(let y=0;y<o;++y){let w=0;for(let x=0;x<h;++x)w+=t[y*h+x]*m[x];for(let x=0;x<a;++x)v[y*a+x]=Math.trunc(w/g[x]),w%=g[x]}return[v,[o,a],c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(t,e,n,r,s,i=!1,o=0){const a=r.length,c=[e[0],t.length/e[0]],l=c[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(sA());const h=e.slice();h[0]=d;const m=h.reduce((S,k)=>S*k,1),g=qn(n,m);if(a===0)return d>0&&g.fill(o),[g,h];if(d<=0)throw new Error(sA());let v=0,y=1,w=0,x=s[v];for(;;){let S=0;if(y<a){if(S=s[y],x===S){++y;continue}if(x>=S)throw new Error(O9())}if(x<0||x>=d)throw new Error(P9(x,d));x>w&&g.fill(o,w*l,x*l);for(let k=v;k<y;++k){const E=r[k];if(E<0||E>=c[0])throw new Error(D9(k,r[k],c[0]));for(let A=0;A<l;A++)g[x*l+A]+=t[E*l+A]}if(i)for(let k=0;k<l;k++)g[x*l+k]/=y-v;if(v=y,++y,w=x+1,x=S,y>a)break}return w<d&&g.fill(o,w*l,d*l),[g,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sBe=Oa(t=>Math.sqrt(t)),iBe=Jt(iy,t=>Math.sqrt(t)),oBe={kernelName:iy,backendName:"cpu",kernelFunc:iBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX=Yn(((t,e)=>{const n=t-e;return n*n})),aBe=yr(oy,VX),cBe={kernelName:oy,backendName:"cpu",kernelFunc:aBe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX=Oa((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),lBe=ql(WI,jX),uBe={kernelName:WI,backendName:"cpu",kernelFunc:lBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(t,e,n,r){const s=kt(t,e.dtype);for(let i=0;i<s.size;i++){const o=s.indexToLoc(i),a=new Array(o.length);for(let c=0;c<a.length;c++)a[c]=o[c]*n[c]+r[c];s.set(e.get(...a),...o)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dBe{constructor(e,n,r,s,i,o){this.separator=dl(e),this.nGramWidths=n,this.leftPad=dl(r),this.rightPad=dl(s),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,i,o){for(let a=0;a<i;++a){const c=this.getPadWidth(o),l=Math.max(0,c-a),u=Math.max(0,c-(i-(a+1))),d=o-(l+u),h=n+(l>0?0:a-c);let m=0;m+=l*this.leftPad.length;for(let x=0;x<d;++x)m+=e[h+x].length;m+=u*this.rightPad.length;const g=l+u+d-1;m+=g*this.separator.length,r[s+a]=new Uint8Array(m);const v=r[s+a];let y=0;const w=x=>x.forEach(S=>v[y++]=S);for(let x=0;x<l;++x)w(this.leftPad),w(this.separator);for(let x=0;x<d-1;++x)w(e[h+x]),w(this.separator);if(d>0){w(e[h+d-1]);for(let x=0;x<u;++x)w(this.separator),w(this.rightPad)}else{for(let x=0;x<u-1;++x)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let c=n[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let l=1;l<s;++l){let u=n[l]>=c;if(u=u&&n[l]<=r,!u)throw new Error(`Invalid split value ${n[l]}, must be in [${c}, ${r}]`);c=n[l]}if(c!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${c}`)}const i=s-1,o=qn("int32",s);if(r===0||s===0){const c=new Array(r);for(let l=0;l<=i;++l)o[l]=0;return[c,o]}o[0]=0;for(let c=1;c<=i;++c){const l=n[c]-n[c-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(l,d)}),this.preserveShort&&l>0&&u===0&&(u=1),o[c]=o[c-1]+u}const a=new Array(o[i]);for(let c=0;c<i;++c){const l=n[c];let u=o[c];if(this.nGramWidths.forEach(d=>{const h=n[c+1]-n[c],m=this.getNumNGrams(h,d);this.createNGrams(e,l,a,u,m,d),u+=m}),this.preserveShort&&u===o[c]){const d=n[c+1]-n[c];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,l,a,u,1,h)}}return[a,o]}}function WX(t,e,n,r,s,i,o,a){return new dBe(n,r,s,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fBe(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&r.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(s,i);(!n||o.length!==0)&&r.push(o),s=i+1}}function GX(t,e,n){const r=t.length,s=[];let i=0,o=0;const a=new Array(r);for(let h=0;h<r;++h){const m=s.length;fBe(t[h],e,n,s);const g=s.length-m;a[h]=g,i+=g,o=Math.max(o,g)}const c=qn("int32",i*2),l=new Array(i),u=[r,o];let d=0;for(let h=0;h<r;++h)for(let m=0;m<a[h];++m)c[d*2]=h,c[d*2+1]=m,l[d]=s[d],++d;return[c,l,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qX(t,e){const n=qn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=EEe(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KX=Yn(((t,e)=>t-e)),hBe=AO(((t,e,n,r)=>({real:t-n,imag:e-r}))),OO=yr(ay,KX,hBe),pBe={kernelName:ay,backendName:"cpu",kernelFunc:OO};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XX(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=kt(n,t.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),o=new Array(t.rank);for(let c=0;c<o.length;c++)o[c]=i[c]%t.shape[c];const a=t.locToIndex(o);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Am=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function QX(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,c=e-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(a-u)/a)*Math.sign(c-a/2),h=Math.max(n,Math.floor(e-c*u/a+d)),m=Math.min(r,Math.floor(e+(a-c)*u/a+d));QX(t,e,h,m)}const s=t[e];let i=n,o=r;for(Nf(t,n,e),Am(t[r],s)>0&&Nf(t,n,r);i<o;){for(Nf(t,i,o),i++,o--;Am(t[i],s)<0;)i=i+1;for(;Am(t[o],s)>0;)o=o-1}Am(t[n],s)===0?Nf(t,n,o):(o=o+1,Nf(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function YX(t,e,n,r,s){const i=e[e.length-1],[o,a]=[t.length/i,i],c=Mr(n,o*r),l=Mr("int32",o*r);for(let d=0;d<o;d++){const h=d*a,m=t.subarray(h,h+a);let g=new Array(m.length);m.forEach((x,S)=>g[S]={value:x,index:S}),r<g.length&&(QX(g,r),g=g.slice(0,r)),s&&g.sort(Am);const v=d*r,y=c.subarray(v,v+r),w=l.subarray(v,v+r);for(let x=0;x<r;x++)y[x]=g[x].value,w[x]=g[x].index}const u=e.slice();return u[u.length-1]=r,[kt(u,n,c),kt(u,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(t,e,n,r){const s=Nt(e,n)[0],i=[1,n[0],1];for(let g=0;g<s;g++)i[0]*=n[g];i[1]=n[s];for(let g=s+1;g<n.length;g++)i[2]*=n[g];const o=new Map,a=new Int32Array(n[s]),c=new fr(i,r,t),l=[],u=i[0]===1&&i[2]===1;for(let g=0;g<n[s];g++){let v;if(u)v=t[g].toString();else{const w=[];for(let x=0;x<i[0];x++)for(let S=0;S<i[2];S++)w.push(c.get(x,g,S));v=w.join(",")}const y=o.get(v);if(y!=null)a[g]=y;else{const w=o.size;o.set(v,w),a[g]=w,l.push(g)}}const d=i.slice();d[1]=o.size;const h=new fr(d,r);l.forEach((g,v)=>{for(let y=0;y<i[0];y++)for(let w=0;w<i[2];w++)h.set(c.get(y,g,w),y,v,w)});const m=n.slice();return m[s]=d[1],{outputValues:h.values,outputShape:m,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mBe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:aX,bincountImpl:NO,bincountReduceImpl:cX,bitwiseAndImpl:lX,castImpl:oX,ceilImpl:uX,concatImpl:dX,equalImpl:fX,expImpl:pX,expm1Impl:gX,floorDivImpl:vX,floorImpl:yX,gatherNdImpl:bX,gatherV2Impl:wX,greaterEqualImpl:IX,greaterImpl:xX,lessEqualImpl:kX,lessImpl:SX,linSpaceImpl:EX,logImpl:CX,maxImpl:TX,maximumImpl:AX,minimumImpl:NX,multiplyImpl:_O,negImpl:_X,notEqualImpl:$X,prodImpl:RX,raggedGatherImpl:OX,raggedRangeImpl:PX,raggedTensorToTensorImpl:DX,rangeImpl:FX,rsqrtImpl:LX,scatterImpl:Ru,sigmoidImpl:tBe,simpleAbsImpl:iX,sliceImpl:MX,sparseFillEmptyRowsImpl:zX,sparseReshapeImpl:UX,sparseSegmentReductionImpl:RO,sqrtImpl:sBe,squaredDifferenceImpl:VX,staticRegexReplaceImpl:jX,stridedSliceImpl:HX,stringNGramsImpl:WX,stringSplitImpl:GX,stringToHashBucketFastImpl:qX,subImpl:KX,tileImpl:XX,topKImpl:YX,transposeImpl:$O,uniqueImpl:ZX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */C8("cpu",()=>new OS,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX=Jt(_0,t=>t>=0?t:Math.exp(t)-1),gBe={kernelName:_0,backendName:"cpu",kernelFunc:JX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r;Xe([s],"leakyRelu");const o=me(s.shape),a=n.data.get(s.dataId).values,c=Mr("float32",o);for(let l=0;l<a.length;l++)c[l]=a[l]<0?i*a[l]:a[l];return n.makeTensorInfo(s.shape,"float32",c)}const yBe={kernelName:pI,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vBe=Yn((t,e)=>t<0?e*t:t);function tQ(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;Xe([r,s],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,[a,c]=vBe(r.shape,s.shape,i,o,"float32");return n.makeTensorInfo(c,"float32",a)}const bBe={kernelName:OI,backendName:"cpu",kernelFunc:tQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ=Jt(X0,t=>Math.max(0,t)),wBe={kernelName:X0,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQ=Jt(Q0,t=>Math.min(Math.max(0,t),6)),xBe={kernelName:Q0,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(t,e,n,r,s){if(n==="linear")return Na({inputs:{x:e},backend:t});if(n==="relu")return nQ({inputs:{x:e},backend:t});if(n==="elu")return JX({inputs:{x:e},backend:t});if(n==="relu6")return rQ({inputs:{x:e},backend:t});if(n==="prelu")return tQ({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return eQ({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return BX({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=me(s.shape),a=r8(i,o),c=me(a);U(o===c,()=>`The new shape (${a}) has ${c} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const l=n.data.get(s.dataId);if(l.complexTensorInfos!=null){const u=l.complexTensorInfos.real,d=l.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const IBe={kernelName:DI,backendName:"cpu",kernelFunc:fn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;Xe([s,i],"matMul");const c=s.shape.length,l=i.shape.length,u=o?s.shape[c-2]:s.shape[c-1],d=a?i.shape[l-1]:i.shape[l-2],h=o?s.shape[c-1]:s.shape[c-2],m=a?i.shape[l-2]:i.shape[l-1],g=s.shape.slice(0,-2),v=i.shape.slice(0,-2),y=me(g),w=me(v),S=bt(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,m]);U(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const k=o?[y,u,h]:[y,h,u],E=a?[w,m,d]:[w,d,m],A=fn({inputs:{x:s},backend:n,attrs:{shape:k}}),R=fn({inputs:{x:i},backend:n,attrs:{shape:E}}),N=o?A.shape[1]:A.shape[2],P=o?A.shape[2]:A.shape[1],O=a?R.shape[1]:R.shape[2],_=Math.max(y,w),M=n.data.get(A.dataId).values,G=n.data.get(R.dataId).values,q=nt(A.shape),D=nt(R.shape),[L,K,j]=o?[q[0],1,q[1]]:[q[0],q[1],1],[W,X,H]=a?[1,D[1],D[0]]:[D[1],1,D[0]],Y=P*O,ce=kt([_,P,O],A.dtype),de=ce.values,ge=n.blockSize;for(let be=0;be<_;be++){const we=be%y,Ae=be%w;for(let _e=0;_e<P;_e+=ge){const je=Math.min(_e+ge,P);for(let st=0;st<O;st+=ge){const dt=Math.min(st+ge,O);for(let yt=0;yt<N;yt+=ge){const Mt=Math.min(yt+ge,N);for(let Ft=_e;Ft<je;Ft++)for(let Pt=st;Pt<dt;Pt++){let Xt=0;for(let en=yt;en<Mt;en++){const ns=M[we*L+Ft*K+en*j],Z=G[en*W+Pt*X+Ae*H];Xt+=ns*Z}de[be*Y+(Ft*O+Pt)]+=Xt}}}}}return n.disposeIntermediateTensorInfo(A),n.disposeIntermediateTensorInfo(R),n.makeTensorInfo(S,ce.dtype,ce.values)}const SBe={kernelName:Z1,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kBe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;let h,m,g;const v=[];h=sQ({inputs:{a:s,b:i},attrs:{transposeA:c,transposeB:l},backend:n}),o&&(m=Ch({inputs:{a:h,b:o},backend:n}),v.push(h),h=m),u&&(g=Hx(n,h,u,a,d),v.push(h),h=g);for(const w of v)n.disposeIntermediateTensorInfo(w);return h}const EBe={kernelName:Sx,backendName:"cpu",kernelFunc:kBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CBe=Jt(y0,t=>Math.acos(t)),TBe={kernelName:y0,backendName:"cpu",kernelFunc:CBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ABe=Jt(v0,t=>Math.acosh(t)),NBe={kernelName:v0,backendName:"cpu",kernelFunc:ABe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Be(t){const{inputs:e,backend:n}=t,r=e;Xe(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),i=kt(r[0].shape,r[0].dtype),o=i.values;for(let a=0;a<r.length;a++){const c=s[a];for(let l=0;l<o.length;l++)o[l]+=c[l]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const $Be={kernelName:q1,backendName:"cpu",kernelFunc:_Be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Xe(s,"all");const a=Nt(i,s.shape);let c=a;const l=Pn(c,s.shape.length);let u=s;l!=null&&(u=Ns({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xn(c.length,s.shape.length)),jr("all",c,u.shape.length);const[d,h]=Cr(u.shape,c),m=me(h),g=Jr(me(d),u.dtype),v=n.data.get(u.dataId).values;for(let w=0;w<g.length;++w){const x=w*m;let S=v[x];for(let k=0;k<m;++k){const E=v[x+k];S=S&&E}g[w]=S}l!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,g);if(o){const w=Kn(d,a),x=fn({inputs:{x:y},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(y),x}return y}const OBe={kernelName:U_,backendName:"cpu",kernelFunc:RBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Xe(s,"any");const a=Nt(i,s.shape);let c=a;const l=Pn(c,s.shape.length);let u=s;l!=null&&(u=Ns({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xn(c.length,s.shape.length)),jr("any",c,u.shape.length);const[d,h]=Cr(u.shape,c),m=me(h),g=Jr(me(d),u.dtype),v=n.data.get(u.dataId).values;for(let w=0;w<g.length;++w){const x=w*m;let S=v[x];for(let k=0;k<m;++k){const E=v[x+k];S=S||E}g[w]=S}l!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,g);if(o){const w=Kn(d,a),x=fn({inputs:{x:y},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(y),x}return y}const DBe={kernelName:V_,backendName:"cpu",kernelFunc:PBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;Xe(s,"argMax");let o=Nt(i,s.shape);const a=Pn(o,s.shape.length);let c=s;const l=[];a!=null&&(c=Ns({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(c),o=Xn(o.length,c.shape.length)),o=[o[0]],jr("argMax",o,c.shape.length);const[u,d]=Cr(c.shape,o),h=me(u),m=Jr(h,"int32"),g=me(d),v=n.data.get(c.dataId).values;for(let y=0;y<m.length;++y){const w=y*g;let x=v[w],S=0;for(let k=0;k<g;++k){const E=v[w+k];E>x&&(x=E,S=k)}m[y]=S}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",m)}const LBe={kernelName:K1,backendName:"cpu",kernelFunc:FBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;Xe(s,"argMin");let o=Nt(i,s.shape);const a=Pn(o,s.shape.length);let c=s;const l=[];a!=null&&(c=Ns({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(c),o=Xn(o.length,c.shape.length)),o=[o[0]],jr("argMin",o,c.shape.length);const[u,d]=Cr(c.shape,o),h=me(u),m=Jr(h,"int32"),g=me(d),v=n.data.get(c.dataId).values;for(let y=0;y<m.length;++y){const w=y*g;let x=v[w],S=0;for(let k=0;k<g;++k){const E=v[w+k];E<x&&(x=E,S=k)}m[y]=S}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",m)}const MBe={kernelName:X1,backendName:"cpu",kernelFunc:BBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zBe=Jt(b0,t=>Math.asin(t)),UBe={kernelName:b0,backendName:"cpu",kernelFunc:zBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VBe=Jt(w0,t=>Math.asinh(t)),jBe={kernelName:w0,backendName:"cpu",kernelFunc:VBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HBe=Jt(x0,t=>Math.atan(t)),WBe={kernelName:x0,backendName:"cpu",kernelFunc:HBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GBe=Yn((t,e)=>Math.atan2(t,e)),qBe=yr(S0,GBe),KBe={kernelName:S0,backendName:"cpu",kernelFunc:qBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XBe=Jt(I0,t=>Math.atanh(t)),QBe={kernelName:I0,backendName:"cpu",kernelFunc:XBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PO(t,e,n,r,s,i){const o=s.strideHeight,a=s.strideWidth,c=s.dilationHeight,l=s.dilationWidth,u=s.effectiveFilterHeight,d=s.effectiveFilterWidth,h=s.padInfo.top,m=s.padInfo.left,g=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=kt(s.outShape,n),y=v.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3],x=s.outShape[2]*s.outShape[3],S=s.outShape[3];for(let k=0;k<s.batchSize;++k){const E=k*w,A=k*r[0];for(let R=0;R<s.inChannels;++R)for(let N=0;N<s.outHeight;++N){const P=N*o-h,O=Math.max(0,P),_=Math.min(s.inHeight,u+P),M=E+N*x;for(let G=0;G<s.outWidth;++G){const q=G*a-m,D=Math.max(0,q),L=Math.min(s.inWidth,d+q);let K=g,j=0,W=0;for(let H=O;H<_;H+=c){const Y=A+H*r[1];for(let ce=D;ce<L;ce+=l){const de=Y+ce*r[2],ge=t[de+R];i==="max"&&ge>K?K=ge:i==="avg"&&(j+=ge,W++)}if(isNaN(K))break}const X=M+G*S+R;y[X]=i==="avg"?j/W:K}}}return v}function iQ(t,e,n,r,s=!1,i=!1){const o=kt(r.outShape,"int32"),a=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,m=r.padInfo.top,g=r.padInfo.left,v=kt(e,n,t);for(let y=0;y<r.batchSize;++y)for(let w=0;w<r.inChannels;++w)for(let x=0;x<r.outHeight;++x){const S=x*a-m;let k=S;for(;k<0;)k+=l;const E=Math.min(r.inHeight,d+S);for(let A=0;A<r.outWidth;++A){const R=A*c-g;let N=R;for(;N<0;)N+=u;const P=Math.min(r.inWidth,h+R);let O=Number.NEGATIVE_INFINITY,_=-1;for(let M=k;M<E;M+=l){const G=M-S;for(let q=N;q<P;q+=u){const D=q-R,L=v.get(y,M,q,w);L>O&&(O=L,s?_=i?((y*r.inHeight+M)*r.inWidth+q)*r.inChannels+w:(M*r.inWidth+q)*r.inChannels+w:_=G*h+D)}}o.set(_,y,x,A,w)}}return o}function oQ(t,e,n,r,s,i){const o=s.strideDepth,a=s.strideHeight,c=s.strideWidth,l=s.dilationDepth,u=s.dilationHeight,d=s.dilationWidth,h=s.effectiveFilterDepth,m=s.effectiveFilterHeight,g=s.effectiveFilterWidth,v=s.padInfo.front,y=s.padInfo.top,w=s.padInfo.left,x=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=kt(s.outShape,n),k=S.values,E=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],A=s.outShape[2]*s.outShape[3]*s.outShape[4],R=s.outShape[3]*s.outShape[4],N=s.outShape[4];for(let P=0;P<s.batchSize;++P){const O=P*E,_=P*r[0];for(let M=0;M<s.inChannels;++M)for(let G=0;G<s.outDepth;++G){const q=G*o-v;let D=q;for(;D<0;)D+=l;const L=Math.min(s.inDepth,h+q),K=O+G*A;for(let j=0;j<s.outHeight;++j){const W=j*a-y;let X=W;for(;X<0;)X+=u;const H=Math.min(s.inHeight,m+W),Y=K+j*R;for(let ce=0;ce<s.outWidth;++ce){const de=ce*c-w;let ge=de;for(;ge<0;)ge+=d;const be=Math.min(s.inWidth,g+de),we=Y+ce*N;let Ae=x,_e=0,je=0;for(let dt=D;dt<L;dt+=l){const yt=_+dt*r[1];for(let Mt=X;Mt<H;Mt+=u){const Ft=yt+Mt*r[2];for(let Pt=ge;Pt<be;Pt+=d){const Xt=Ft+Pt*r[3],en=t[Xt+M];if(i==="max"&&en>Ae?Ae=en:i==="avg"&&(_e+=en,je++),isNaN(Ae))break}if(isNaN(Ae))break}if(isNaN(Ae))break}const st=we+M;k[st]=i==="avg"?_e/Math.max(je,1):Ae}}}}return S}function YBe(t,e){const n=kt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,m=e.padInfo.top,g=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let y=0;y<e.inChannels;++y)for(let w=0;w<e.outDepth;++w){const x=w*r-h;let S=x;for(;S<0;)S+=o;const k=Math.min(e.inDepth,l+x);for(let E=0;E<e.outHeight;++E){const A=E*s-m;let R=A;for(;R<0;)R+=a;const N=Math.min(e.inHeight,u+A);for(let P=0;P<e.outWidth;++P){const O=P*i-g;let _=O;for(;_<0;)_+=c;const M=Math.min(e.inWidth,d+O);let G=Number.NEGATIVE_INFINITY,q=-1;for(let D=S;D<k;D+=o){const L=D-x;for(let K=R;K<N;K+=a){const j=K-A;for(let W=_;W<M;W+=c){const X=W-O,H=t.get(v,D,K,W,y);H>=G&&(G=H,q=L*u*d+j*u+X)}}}n.set(q,v,w,E,P,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Xe(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:c}=r,l=1;U(Vr(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const u=co(s.shape,i,o,l,a,c);let d;if(u.filterWidth===1&&u.filterHeight===1&&Dt(u.inShape,u.outShape))d=Na({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,m=nt(s.shape),g=PO(h,s.shape,s.dtype,m,u,"avg");d=n.makeTensorInfo(u.outShape,s.dtype,g.values)}return d}const JBe={kernelName:Q1,backendName:"cpu",kernelFunc:ZBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:c,dataFormat:l}=r;Xe(s,"avgPool3d");const u=Ec(s.shape,i,o,1,a,c,l),d=n.data.get(s.dataId).values,h=oQ(d,s.shape,s.dtype,nt(s.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const tMe={kernelName:Y1,backendName:"cpu",kernelFunc:eMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:c,dimRoundingMode:l}=r;Xe([s,i],"avgPool3DGrad");const u=Ec(i.shape,o,a,1,c,l),d=u.strideDepth,h=u.strideHeight,m=u.strideWidth,g=u.filterDepth,v=u.filterHeight,y=u.filterWidth,w=u.dilationDepth,x=u.dilationHeight,S=u.dilationWidth,k=u.effectiveFilterDepth,E=u.effectiveFilterHeight,A=u.effectiveFilterWidth,R=k-1-u.padInfo.front,N=A-1-u.padInfo.left,P=E-1-u.padInfo.top,O=kt(i.shape,"float32"),_=1/(g*v*y),M=n.bufferSync(s);for(let G=0;G<u.batchSize;++G)for(let q=0;q<u.inChannels;++q)for(let D=0;D<u.inDepth;++D)for(let L=0;L<u.inHeight;++L)for(let K=0;K<u.inWidth;++K){const j=D-R,W=L-P,X=K-N;let H=0;for(let Y=0;Y<k;Y+=w){const ce=(j+Y)/d;if(!(ce<0||ce>=u.outDepth||Math.floor(ce)!==ce))for(let de=0;de<E;de+=x){const ge=(W+de)/h;if(!(ge<0||ge>=u.outHeight||Math.floor(ge)!==ge))for(let be=0;be<A;be+=S){const we=(X+be)/m;if(we<0||we>=u.outWidth||Math.floor(we)!==we)continue;const Ae=M.get(G,ce,ge,we,q);H+=Ae}}}O.set(H*_,G,D,L,K,q)}return n.makeTensorInfo(O.shape,O.dtype,O.values)}const rMe={kernelName:H_,backendName:"cpu",kernelFunc:nMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;Xe([s,i],"avgPoolGrad");const{filterSize:a,strides:c,pad:l}=r,u=co(o.shape,a,c,1,l),d=u.strideHeight,h=u.strideWidth,m=u.filterHeight,g=u.filterWidth,v=u.dilationHeight,y=u.dilationWidth,w=u.effectiveFilterHeight,x=u.effectiveFilterWidth,S=x-1-u.padInfo.left,k=w-1-u.padInfo.top,E=kt(o.shape,"float32"),A=1/(m*g),R=n.data.get(s.dataId).values,N=kt(s.shape,"float32",R);for(let P=0;P<u.batchSize;++P)for(let O=0;O<u.inChannels;++O)for(let _=0;_<u.inHeight;++_)for(let M=0;M<u.inWidth;++M){const G=_-k,q=M-S;let D=0;for(let L=0;L<w;L+=v){const K=(G+L)/d;if(!(K<0||K>=u.outHeight||Math.floor(K)!==K))for(let j=0;j<x;j+=y){const W=(q+j)/h;if(W<0||W>=u.outWidth||Math.floor(W)!==W)continue;const X=N.get(P,K,W,O);D+=X}}E.set(D*A,P,_,M,O)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const iMe={kernelName:j_,backendName:"cpu",kernelFunc:sMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:i,offset:o,mean:a,variance:c}=e;U(a.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Xe([s,a,c,i,o],"batchNorm");let{varianceEpsilon:l}=r;l==null&&(l=.001);const u=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(c.dataId).values,m=i?n.data.get(i.dataId).values:new Float32Array([1]),g=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(u.length),y=g.length,w=m.length,x=h.length,S=d.length;let k=0,E=0,A=0,R=0;for(let N=0;N<u.length;++N)v[N]=g[k++]+(u[N]-d[E++])*m[A++]/Math.sqrt(h[R++]+l),k>=y&&(k=0),E>=S&&(E=0),A>=w&&(A=0),R>=x&&(R=0);return n.makeTensorInfo(s.shape,s.dtype,v)}const aMe={kernelName:dI,backendName:"cpu",kernelFunc:oMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;Xe([s],"batchToSpaceND");const a=i.reduce((w,x)=>w*x),c=wy(s.shape,i,a),l=xy(c.length,i.length),u=Iy(s.shape,i,a),d=jR(o,i.length),h=HR(u,o,i.length),m=fn({inputs:{x:s},backend:n,attrs:{shape:c}}),g=Ns({inputs:{x:m},backend:n,attrs:{perm:l}}),v=fn({inputs:{x:g},backend:n,attrs:{shape:u}}),y=pd({inputs:{x:v},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}const lMe={kernelName:J1,backendName:"cpu",kernelFunc:cMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,l=NO(a,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}const dMe={kernelName:W_,backendName:"cpu",kernelFunc:uMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values,a=bt(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const hMe={kernelName:G_,backendName:"cpu",kernelFunc:fMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pMe=Jt(C0,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),mMe={kernelName:C0,backendName:"cpu",kernelFunc:pMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gMe=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(me(e.shape)),s=n.data.get(e.dataId),i=s.complexTensorInfos.real,o=s.complexTensorInfos.imag,a=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values;for(let l=0;l<a.length;l++){const u=a[l],d=c[l];r[l]=Math.hypot(u,d)}return n.makeOutput(r,e.shape,"float32")},yMe={kernelName:tI,backendName:"cpu",kernelFunc:gMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Th(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,i)}const vMe={kernelName:d$,backendName:"cpu",kernelFunc:Th};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ah(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Nt(s,e[0].shape)[0],o=e.map(v=>v.shape);zR(o,i);let a=ba(e.map(v=>v.shape),i);if(me(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const c=e.filter(v=>me(v.shape)>0);if(c.length===1)return Na({inputs:{x:c[0]},backend:n});if(c[0].dtype==="complex64"){const v=c.map(k=>hd({inputs:{input:k},backend:n})),y=c.map(k=>Th({inputs:{input:k},backend:n})),w=Ah({inputs:v,backend:n,attrs:{axis:i}}),x=Ah({inputs:y,backend:n,attrs:{axis:i}}),S=Xs({inputs:{real:w,imag:x},backend:n});return v.forEach(k=>n.disposeIntermediateTensorInfo(k)),y.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(x),S}const l=c.map(v=>{const w=[-1,me(v.shape.slice(i))];return fn({inputs:{x:v},backend:n,attrs:{shape:w}})}),u=l.map(v=>({vals:n.data.get(v.dataId).values,shape:v.shape}));a=ba(l.map(v=>v.shape),1);const d=l[0].shape[0]===1,h=dX(u,a,e[0].dtype,d),m=ba(c.map(v=>v.shape),i),g=n.makeTensorInfo(m,e[0].dtype,h);return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const bMe={kernelName:nI,backendName:"cpu",kernelFunc:Ah};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:c,dilations:l,dimRoundingMode:u}=r;Xe([s,i],"conv2d");const d=Cc(c),h=Er(s.shape,i.shape,o,l,a,u,!1,d),m=h.filterHeight,g=h.filterWidth,v=h.dilationHeight,y=h.dilationWidth,w=h.padInfo.left,x=h.padInfo.top,S=h.dataFormat==="channelsLast",k=new fr(h.outShape,s.dtype),E=nt(s.shape),A=nt(i.shape),R=E[0],N=S?E[1]:E[2],P=S?E[2]:1,O=S?1:E[1],_=k.strides[0],M=S?k.strides[1]:k.strides[2],G=S?k.strides[2]:1,q=S?1:k.strides[1],D=n.data.get(s.dataId).values,L=n.data.get(i.dataId).values,K=k.values;for(let j=0;j<h.batchSize;++j){const W=j*R,X=j*_;for(let H=0;H<h.outHeight;++H){const Y=X+H*M,ce=H*h.strideHeight-x;for(let de=0;de<m;++de){const ge=ce+de*v;if(ge<0||ge>=h.inHeight)continue;const be=de*A[0],we=W+ge*N;for(let Ae=0;Ae<h.outWidth;++Ae){const _e=Y+Ae*G,je=Ae*h.strideWidth-w;for(let st=0;st<g;++st){const dt=je+st*y;if(dt<0||dt>=h.inWidth)continue;const yt=be+st*A[1],Mt=we+dt*P;let Ft=yt;for(let Pt=0;Pt<h.inChannels;++Pt){const Xt=D[Mt+Pt*O];for(let en=0;en<h.outChannels;++en)K[_e+en*q]+=Xt*L[Ft+en];Ft+=h.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,K)}const wMe={kernelName:rI,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:u}=r;Xe([s,i],"conv2dBackpropFilter");const d=Cc(c),h=Er(s.shape,u,o,1,a,l,!1,d),{strideHeight:m,strideWidth:g,filterHeight:v,filterWidth:y}=h,w=h.dataFormat==="channelsLast",x=new fr(h.filterShape,"float32"),S=h.padInfo.left,k=h.padInfo.top,E=n.data.get(s.dataId).values,A=n.data.get(i.dataId).values,R=new fr(s.shape,s.dtype,E),N=new fr(i.shape,i.dtype,A);for(let P=0;P<v;++P){const O=Math.max(0,Math.ceil((k-P)/m)),_=Math.min(h.outHeight,(h.inHeight+k-P)/m);for(let M=0;M<y;++M){const G=Math.max(0,Math.ceil((S-M)/g)),q=Math.min(h.outWidth,(h.inWidth+S-M)/g);for(let D=0;D<h.inChannels;++D)for(let L=0;L<h.outChannels;++L){let K=0;for(let j=0;j<h.batchSize;++j)for(let W=O;W<_;++W){const X=P+W*m-k;for(let H=G;H<q;++H){const Y=M+H*g-S;w?K+=R.get(j,X,Y,D)*N.get(j,W,H,L):K+=R.get(j,D,X,Y)*N.get(j,L,W,H)}}x.set(K,P,M,D,L)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const IMe={kernelName:K_,backendName:"cpu",kernelFunc:xMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:c,dataFormat:l,dimRoundingMode:u}=r;Xe([s,i],"conv2dBackpropInput");const d=nt(i.shape),h=nt(s.shape);let m=Cc(l);const g=Er(o,i.shape,a,1,c,u,!1,m),v=new fr(g.inShape,"float32"),y=v.values,w=n.data.get(s.dataId).values,x=n.data.get(i.dataId).values,[S,k,E]=d,{batchSize:A,filterHeight:R,filterWidth:N,inChannels:P,inHeight:O,inWidth:_,outChannels:M,outHeight:G,outWidth:q,strideHeight:D,strideWidth:L}=g;m=g.dataFormat;const K=R-1-g.padInfo.top,j=N-1-g.padInfo.left,W=m==="channelsLast",X=v.strides[0],H=W?v.strides[1]:v.strides[2],Y=W?v.strides[2]:1,ce=W?1:v.strides[1],de=h[0],ge=W?h[1]:h[2],be=W?h[2]:1,we=W?1:h[1];for(let Ae=0;Ae<A;++Ae)for(let _e=0;_e<P;++_e)for(let je=0;je<O;++je){const st=je-K,dt=Math.max(0,Math.ceil(st/D)),yt=Math.min(G,(R+st)/D);for(let Mt=0;Mt<_;++Mt){const Ft=Mt-j,Pt=Math.max(0,Math.ceil(Ft/L)),Xt=Math.min(q,(N+Ft)/L);let en=0;for(let Z=dt;Z<yt;++Z){const le=Z*D-st;for(let ye=Pt;ye<Xt;++ye){const De=ye*L-Ft,Ne=de*Ae+ge*Z+be*ye,Ee=S*(R-1-le)+k*(N-1-De)+E*_e;for(let Ge=0;Ge<M;++Ge){const xt=w[Ne+we*Ge],Ct=x[Ee+Ge];en+=xt*Ct}}}const ns=X*Ae+H*je+Y*Mt+ce*_e;y[ns]=en}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const kMe={kernelName:sI,backendName:"cpu",kernelFunc:SMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:c}=r;Xe([s,i],"conv3d");const l=Ul(s.shape,i.shape,o,c,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:m,dilationHeight:g,dilationWidth:v,padInfo:y}=l,w=y.front,x=y.left,S=y.top,k=new fr(l.outShape,s.dtype),E=n.data.get(s.dataId).values,A=n.data.get(i.dataId).values,R=k.values,N=nt(s.shape),P=nt(i.shape);for(let O=0;O<l.batchSize;++O){const _=O*N[0],M=O*k.strides[0];for(let G=0;G<l.outDepth;++G){const q=M+G*k.strides[1],D=G*l.strideDepth-w;for(let L=0;L<u;++L){const K=D+L*m;if(K<0||K>=l.inDepth)continue;const j=L*P[0],W=_+K*N[1];for(let X=0;X<l.outHeight;++X){const H=q+X*k.strides[2],Y=X*l.strideHeight-S;for(let ce=0;ce<d;++ce){const de=Y+ce*g;if(de<0||de>=l.inHeight)continue;const ge=j+ce*P[1],be=W+de*N[2];for(let we=0;we<l.outWidth;++we){const Ae=H+we*l.outChannels,_e=we*l.strideWidth-x;for(let je=0;je<h;++je){const st=_e+je*v;if(st<0||st>=l.inWidth)continue;const dt=ge+je*P[2],yt=be+st*l.inChannels;let Mt=dt;for(let Ft=0;Ft<l.inChannels;++Ft){const Pt=E[yt+Ft];for(let Xt=0;Xt<l.outChannels;++Xt)R[Ae+Xt]+=Pt*A[Mt+Xt];Mt+=l.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const CMe={kernelName:iI,backendName:"cpu",kernelFunc:EMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:c}=r;Xe([s,i],"conv3dBackpropFilterV2");const l=nt(s.shape),u=nt(i.shape),d=Ul(s.shape,c,o,1,a),h=d.strideDepth,m=d.strideHeight,g=d.strideWidth,v=d.filterDepth,y=d.filterHeight,w=d.filterWidth,x=new fr(d.filterShape,"float32"),S=x.values,[k,E,A,R]=x.strides,N=n.data.get(i.dataId).values,[P,O,_,M]=u,G=n.data.get(s.dataId).values,[q,D,L,K]=l,j=d.padInfo.front,W=d.padInfo.left,X=d.padInfo.top;for(let H=0;H<v;++H){const Y=Math.max(0,Math.ceil((j-H)/h)),ce=Math.min(d.outDepth,(d.inDepth+j-H)/h),de=H*k;for(let ge=0;ge<y;++ge){const be=Math.max(0,Math.ceil((X-ge)/m)),we=Math.min(d.outHeight,(d.inHeight+X-ge)/m),Ae=ge*E+de;for(let _e=0;_e<w;++_e){const je=Math.max(0,Math.ceil((W-_e)/g)),st=Math.min(d.outWidth,(d.inWidth+W-_e)/g),dt=_e*A+Ae;for(let yt=0;yt<d.inChannels;++yt){const Mt=yt*R+dt;for(let Ft=0;Ft<d.outChannels;++Ft){let Pt=0;for(let Xt=0;Xt<d.batchSize;++Xt){const en=Xt*q,ns=Xt*P;for(let Z=Y;Z<ce;++Z){const ye=(H+Z*h-j)*D+en,De=Z*O+ns;for(let Ne=be;Ne<we;++Ne){const Ge=(ge+Ne*m-X)*L+ye,xt=Ne*_+De;for(let Ct=je;Ct<st;++Ct){const $s=(_e+Ct*g-W)*K+Ge,Tr=Ct*M+xt;Pt+=G[$s+yt]*N[Tr+Ft]}}}}S[Mt+Ft]=Pt}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const AMe={kernelName:X_,backendName:"cpu",kernelFunc:TMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:c}=r;Xe([s],"conv3dBackpropInputV2");const l=nt(s.shape),u=nt(i.shape),d=Ul(c,i.shape,a,1,o),h=new fr(d.inShape,"float32"),m=h.values,[g,v,y,w]=h.strides,x=n.data.get(s.dataId).values,[S,k,E,A]=l,R=n.data.get(i.dataId).values,[N,P,O,_]=u,{batchSize:M,filterDepth:G,filterHeight:q,filterWidth:D,inChannels:L,inDepth:K,inHeight:j,inWidth:W,outChannels:X,outDepth:H,outHeight:Y,outWidth:ce,strideDepth:de,strideHeight:ge,strideWidth:be}=d,we=G-1-d.padInfo.front,Ae=q-1-d.padInfo.top,_e=D-1-d.padInfo.left;for(let je=0;je<M;++je)for(let st=0;st<L;++st)for(let dt=0;dt<K;++dt){const yt=dt-we,Mt=Math.max(0,Math.ceil(yt/de)),Ft=Math.min(H,(G+yt)/de);for(let Pt=0;Pt<j;++Pt){const Xt=Pt-Ae,en=Math.max(0,Math.ceil(Xt/ge)),ns=Math.min(Y,(q+Xt)/ge);for(let Z=0;Z<W;++Z){const le=Z-_e,ye=Math.max(0,Math.ceil(le/be)),De=Math.min(ce,(D+le)/be);let Ne=0;for(let Ee=Mt;Ee<Ft;++Ee){const Ge=Ee*de-yt;for(let xt=en;xt<ns;++xt){const Ct=xt*ge-Xt;for(let Zn=ye;Zn<De;++Zn){const $s=Zn*be-le,Tr=S*je+k*Ee+E*xt+A*Zn,up=N*(G-1-Ge)+P*(q-1-Ct)+O*(D-1-$s)+_*st;for(let fo=0;fo<X;++fo){const _c=x[Tr+fo],dp=R[up+fo];Ne+=_c*dp}}}}m[g*je+v*dt+y*Pt+w*Z+st]=Ne}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const _Me={kernelName:Q_,backendName:"cpu",kernelFunc:NMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Me=Jt(T0,t=>Math.cos(t)),RMe={kernelName:T0,backendName:"cpu",kernelFunc:$Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OMe=Jt(A0,t=>Math.cosh(t)),PMe={kernelName:A0,backendName:"cpu",kernelFunc:OMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DMe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:c,extrapolationValue:l}=r,[u,d,h,m]=s.shape,g=i.shape[0],[v,y]=a,w=kt([g,v,y,m],"float32"),x=n.data.get(i.dataId).values,S=n.data.get(o.dataId).values,k=n.data.get(s.dataId).values,E=nt(s.shape),A=nt(w.shape);for(let R=0;R<g;R++){const N=R*4,P=x[N],O=x[N+1],_=x[N+2],M=x[N+3],G=S[R];if(G>=u)continue;const q=v>1?(_-P)*(d-1)/(v-1):0,D=y>1?(M-O)*(h-1)/(y-1):0;for(let L=0;L<v;L++){const K=v>1?P*(d-1)+L*q:.5*(P+_)*(d-1);if(K<0||K>d-1){for(let j=0;j<y;j++)for(let W=0;W<m;W++){const X=W+j*A[2]+L*A[1]+R*A[0];w.values[X]=l}continue}if(c==="bilinear"){const j=Math.floor(K),W=Math.ceil(K),X=K-j;for(let H=0;H<y;H++){const Y=y>1?O*(h-1)+H*D:.5*(O+M)*(h-1);if(Y<0||Y>h-1){for(let be=0;be<m;be++){const we=be+H*A[2]+L*A[1]+R*A[0];w.values[we]=l}continue}const ce=Math.floor(Y),de=Math.ceil(Y),ge=Y-ce;for(let be=0;be<m;be++){let we=be+ce*E[2]+j*E[1]+G*E[0];const Ae=k[we];we=be+de*E[2]+j*E[1]+G*E[0];const _e=k[we];we=be+ce*E[2]+W*E[1]+G*E[0];const je=k[we];we=be+de*E[2]+W*E[1]+G*E[0];const st=k[we],dt=Ae+(_e-Ae)*ge,yt=je+(st-je)*ge;we=be+H*A[2]+L*A[1]+R*A[0],w.values[we]=dt+(yt-dt)*X}}}else for(let j=0;j<y;++j){const W=y>1?O*(h-1)+j*D:.5*(O+M)*(h-1);if(W<0||W>h-1){for(let Y=0;Y<m;Y++){const ce=Y+j*A[2]+L*A[1]+R*A[0];w.values[ce]=l}continue}const X=Math.round(W),H=Math.round(K);for(let Y=0;Y<m;Y++){const ce=Y+X*E[2]+H*E[1]+G*E[0],de=Y+j*A[2]+L*A[1]+R*A[0];w.values[de]=k[ce]}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const FMe={kernelName:Z_,backendName:"cpu",kernelFunc:DMe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;Xe(s,"cumprod");const c=Pn([i],s.shape.length);let l=s;c!=null&&(l=Ns({inputs:{x:s},backend:n,attrs:{perm:c}}));const u=Xn(1,s.shape.length)[0];if(u!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);const d=ni(l.dtype,"int32"),h=M_(me(l.shape),d),m=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],v=a?(w,x)=>w+g-x-1:(w,x)=>w+x;for(let w=0;w<m.length;w+=g)for(let x=0;x<g;x++){const S=v(w,x);if(x===0)h[S]=o?1:m[S];else{const k=v(w,x-1);h[S]=o?m[k]*h[k]:m[S]*h[k]}}const y=n.makeTensorInfo(l.shape,d,h);if(c!=null){const w=Vl(c),x=Ns({inputs:{x:y},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(l),x}return y}const BMe={kernelName:Y_,backendName:"cpu",kernelFunc:LMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;Xe(s,"cumsum");const c=Pn([i],s.shape.length);let l=s;c!=null&&(l=Ns({inputs:{x:s},backend:n,attrs:{perm:c}}));const u=Xn(1,s.shape.length)[0];if(u!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);const d=ni(l.dtype,"int32"),h=Jr(me(l.shape),d),m=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],v=a?(w,x)=>w+g-x-1:(w,x)=>w+x;for(let w=0;w<m.length;w+=g)for(let x=0;x<g;x++){const S=v(w,x);if(x===0)h[S]=o?0:m[S];else{const k=v(w,x-1);h[S]=o?m[k]+h[k]:m[S]+h[k]}}const y=n.makeTensorInfo(l.shape,d,h);if(c!=null){const w=Vl(c),x=Ns({inputs:{x:y},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(l),x}return y}const zMe={kernelName:oI,backendName:"cpu",kernelFunc:MMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const c=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=NO(c,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(s.shape.length===2){const c=n.bufferSync(s),l=n.bufferSync(i),u=cX(c,l,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const VMe={kernelName:J_,backendName:"cpu",kernelFunc:UMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r;U(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=s.shape[0],c=s.shape[1],l=s.shape[2],u=s.shape[3],d=c*i,h=l*i,m=u/(i*i),g=n.data.get(s.dataId).values,v=new Float32Array(a*d*h*m);let y=0;for(let w=0;w<a;++w)for(let x=0;x<d;++x){const S=Math.floor(x/i),k=x%i;for(let E=0;E<h;++E){const A=Math.floor(E/i),R=E%i,N=(k*i+R)*m;for(let P=0;P<m;++P){const _=P+N+u*(A+l*(S+c*w));v[y++]=g[_]}}}return n.makeTensorInfo([a,d,h,m],s.dtype,v)}const HMe={kernelName:e$,backendName:"cpu",kernelFunc:jMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:c,dimRoundingMode:l}=r;Xe([s,i],"depthwiseConv2DNative");const u=nt(s.shape),d=nt(i.shape);let h=c;h==null&&(h=[1,1]),U(Vr(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const m=Er(s.shape,i.shape,o,h,a,l,!0),{filterHeight:g,filterWidth:v,dilationHeight:y,dilationWidth:w,padInfo:x}=m,S=x.left,k=x.top,E=m.outChannels/m.inChannels,A=new fr(m.outShape,s.dtype),R=n.data.get(s.dataId).values,N=n.data.get(i.dataId).values,P=A.values;for(let O=0;O<m.batchSize;++O){const _=O*u[0],M=O*A.strides[0];for(let G=0;G<m.outHeight;++G){const q=M+G*A.strides[1],D=G*m.strideHeight-k;for(let L=0;L<g;++L){const K=D+L*y;if(K<0||K>=m.inHeight)continue;const j=L*d[0],W=_+K*u[1];for(let X=0;X<m.outWidth;++X){const H=q+X*A.strides[2],Y=X*m.strideWidth-S;for(let ce=0;ce<v;++ce){const de=Y+ce*w;if(de<0||de>=m.inWidth)continue;const ge=j+ce*d[1],be=W+de*m.inChannels;let we=H,Ae=ge;for(let _e=0;_e<m.inChannels;++_e){const je=R[be+_e];for(let st=0;st<E;++st)P[we+st]+=je*N[Ae+st];we+=E,Ae+=E}}}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const WMe={kernelName:aI,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,filterShape:u}=r;Xe([s,i],"depthwiseConv2dNativeBackpropFilter");const d=Er(s.shape,u,o,a,c,l,!0),{strideHeight:h,strideWidth:m,filterHeight:g,filterWidth:v}=d,y=new fr(d.filterShape,"float32"),w=d.padInfo.left,x=d.padInfo.top,S=d.outChannels/d.inChannels,k=n.data.get(s.dataId).values,E=new fr(s.shape,s.dtype,k),A=n.data.get(i.dataId).values,R=new fr(i.shape,i.dtype,A);for(let N=0;N<g;++N){const P=Math.max(0,Math.ceil((x-N)/h)),O=Math.min(d.outHeight,(d.inHeight+x-N)/h);for(let _=0;_<v;++_){const M=Math.max(0,Math.ceil((w-_)/m)),G=Math.min(d.outWidth,(d.inWidth+w-_)/m);for(let q=0;q<d.outChannels;++q){const D=Math.trunc(q/S),L=q%S;let K=0;for(let j=0;j<d.batchSize;++j)for(let W=P;W<O;++W){const X=N+W*h-x;for(let H=M;H<G;++H){const Y=_+H*m-w;K+=E.get(j,X,Y,D)*R.get(j,W,H,q)}}y.set(K,N,_,D,L)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const qMe={kernelName:t$,backendName:"cpu",kernelFunc:GMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KMe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,inputShape:u}=r;Xe([s,i],"depthwiseConv2DNativeBackpropInput");const d=nt(s.shape),h=nt(i.shape),m=Er(u,i.shape,o,a,c,l,!0),g=new fr(m.inShape,"float32"),v=g.values,[y,w,x]=g.strides,S=n.data.get(s.dataId).values,[k,E,A]=d,R=n.data.get(i.dataId).values,[N,P,O]=h,{batchSize:_,filterHeight:M,filterWidth:G,inChannels:q,inHeight:D,inWidth:L,outChannels:K,outHeight:j,outWidth:W,strideHeight:X,strideWidth:H}=m,Y=M-1-m.padInfo.top,ce=G-1-m.padInfo.left,de=K/q;for(let ge=0;ge<_;++ge)for(let be=0;be<q;++be)for(let we=0;we<D;++we){const Ae=we-Y,_e=Math.max(0,Math.ceil(Ae/X)),je=Math.min(j,(M+Ae)/X);for(let st=0;st<L;++st){const dt=st-ce,yt=Math.max(0,Math.ceil(dt/H)),Mt=Math.min(W,(G+dt)/H);let Ft=0;for(let Pt=_e;Pt<je;++Pt){const Xt=Pt*X-Ae;for(let en=yt;en<Mt;++en){const ns=en*H-dt,Z=k*ge+E*Pt+A*en,le=N*(M-1-Xt)+P*(G-1-ns)+O*be;for(let ye=0;ye<de;++ye){const De=be*de+ye,Ne=S[Z+De],Ee=R[le+ye];Ft+=Ne*Ee}}}v[y*ge+w*we+x*st+be]=Ft}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const XMe={kernelName:n$,backendName:"cpu",kernelFunc:KMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QMe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=me(r.shape),i=n.data.get(r.dataId).values,o=kt([s,s],r.dtype),a=o.values;for(let l=0;l<i.length;l++)a[l*s+l]=i[l];const c=[...r.shape,...r.shape];return n.makeTensorInfo(c,o.dtype,o.values)}const YMe={kernelName:r$,backendName:"cpu",kernelFunc:QMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZMe={kernelName:cI,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:i,pad:o,dilations:a}=n,c=e,l=c.data.get(r.dataId).values,u=r.shape.length,d=c.data.get(s.dataId).values,h=s.shape.length,{batchSize:m,inHeight:g,inWidth:v,inChannels:y,outHeight:w,outWidth:x,padInfo:S,strideHeight:k,strideWidth:E,filterHeight:A,filterWidth:R,dilationHeight:N,dilationWidth:P,outShape:O}=hy(r.shape,s.shape,i,o,"NHWC",a),_=me(O),M=O.length,G=qn(r.dtype,_);for(let D=0;D<m;++D)for(let L=0;L<w;++L){const K=L*k-S.top;for(let j=0;j<x;++j){const W=j*E-S.left;for(let X=0;X<y;++X){let H=Number.MIN_SAFE_INTEGER;for(let ce=0;ce<A;++ce){const de=K+ce*N;if(de>=0&&de<g)for(let ge=0;ge<R;++ge){const be=W+ge*P;if(be>=0&&be<v){const we=va([D,de,be,X],u,nt(r.shape)),Ae=va([ce,ge,X],h,nt(s.shape)),_e=l[we]+d[Ae];_e>H&&(H=_e)}}}const Y=va([D,L,j,X],M,nt(O));G[Y]=H}}}return{dataId:c.write(Ed(G,r.dtype),O,r.dtype),shape:O,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JMe={kernelName:MT,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:c}=n,l=e,u=to(r.shape,l.data.get(r.dataId).values),d=to(s.shape,l.data.get(s.dataId).values),{batchSize:h,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:w,padInfo:x,strideHeight:S,strideWidth:k,filterHeight:E,filterWidth:A,dilationHeight:R,dilationWidth:N,outShape:P}=hy(r.shape,s.shape,o,a,"NHWC",c);U(i.rank===P.length,()=>`Error in ${MT}, dy must have the same rank as output ${P.length}, but got ${i.rank}`);const O=to(P,l.data.get(i.dataId).values),_=o8(s.shape,s.dtype);for(let G=0;G<h;++G)for(let q=0;q<y;++q){const D=q*S-x.top;for(let L=0;L<w;++L){const K=L*k-x.left;for(let j=0;j<v;++j){let W=Number.MIN_SAFE_INTEGER,X=0,H=0;for(let Y=0;Y<E;++Y){const ce=D+Y*R;if(ce>=0&&ce<m)for(let de=0;de<A;++de){const ge=K+de*N;if(ge>=0&&ge<g){const be=u[G][ce][ge][j]+d[Y][de][j];be>W&&(W=be,X=Y,H=de)}}}_[X][H][j]+=O[G][q][L][j]}}}return{dataId:l.write(Ed(_,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e4e={kernelName:BT,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:i}=t,{strides:o,pad:a,dilations:c}=n,l=e,u=to(r.shape,l.data.get(r.dataId).values),d=to(s.shape,l.data.get(s.dataId).values),{batchSize:h,inHeight:m,inWidth:g,inChannels:v,outHeight:y,outWidth:w,padInfo:x,strideHeight:S,strideWidth:k,filterHeight:E,filterWidth:A,dilationHeight:R,dilationWidth:N,outShape:P}=hy(r.shape,s.shape,o,a,"NHWC",c);U(i.rank===P.length,()=>`Error in ${BT}, dy must have the same rank as output ${P.length}, but got ${i.rank}`);const O=to(P,l.data.get(i.dataId).values),_=o8(r.shape,r.dtype);for(let G=0;G<h;++G)for(let q=0;q<y;++q){const D=q*S-x.top;for(let L=0;L<w;++L){const K=L*k-x.left;for(let j=0;j<v;++j){let W=Number.MIN_SAFE_INTEGER,X=D<0?0:D,H=K<0?0:K;for(let Y=0;Y<E;++Y){const ce=D+Y*R;if(ce>=0&&ce<m)for(let de=0;de<A;++de){const ge=K+de*N;if(ge>=0&&ge<g){const be=u[G][ce][ge][j]+d[Y][de][j];be>W&&(W=be,X=ce,H=ge)}}}_[G][X][H][j]+=O[G][q][L][j]}}}return{dataId:l.write(Ed(_,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4e(t){const{inputs:e,backend:n,attrs:r}=t,{image:s}=e,{canvas:i,options:o}=r,{contextOptions:a,imageOptions:c}=o||{},l=c?.alpha||1,u=a?.contextType||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,a?.contextAttributes||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,m]=s.shape.slice(0,2),g=s.shape.length===2?1:s.shape[2],v=n.data.get(s.dataId).values,y=s.dtype==="float32"?255:1,w=new Uint8ClampedArray(m*h*4);for(let S=0;S<h*m;++S){const k=[0,0,0,255*l];for(let A=0;A<g;A++){const R=v[S*g+A];if(s.dtype==="float32"){if(R<0||R>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${R}.`)}else if(s.dtype==="int32"&&(R<0||R>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${R}.`);g===1?(k[0]=R*y,k[1]=R*y,k[2]=R*y):k[A]=R*y}const E=S*4;w[E+0]=Math.round(k[0]),w[E+1]=Math.round(k[1]),w[E+2]=Math.round(k[2]),w[E+3]=Math.round(k[3])}i.width=m,i.height=h;const x=new ImageData(w,m,h);return d.putImageData(x,0,0),s}const n4e={kernelName:mEe,backendName:"cpu",kernelFunc:t4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $y(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Xe(s,"sum");let a;s.dtype==="bool"?a=Rl({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=Na({inputs:{x:s},backend:n});const c=a.shape.length,l=Nt(i,a.shape),u=Pn(l,c);let d=l,h=a;u!=null&&(h=Ns({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Xn(d.length,c)),jr("sum",d,h.shape.length);const[m,g]=Cr(h.shape,d),v=ni(h.dtype,"int32");let y=Vx(n,m,v);const w=me(g),x=n.data.get(y.dataId).values,S=n.data.get(h.dataId).values;for(let k=0;k<x.length;++k){const E=k*w;let A=0;for(let R=0;R<w;++R)A+=S[E+R];x[k]=A}if(o){const k=Kn(y.shape,l),E=y;y=fn({inputs:{x:y},backend:n,attrs:{shape:k}}),n.disposeIntermediateTensorInfo(E)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),y}const r4e={kernelName:UI,backendName:"cpu",kernelFunc:$y};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4e(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:c}=ZR(s,i.length);eO(o.length,c,i);const{path:l,steps:u}=tO(a,c),d=u.length;let h=null,m=o.length;const g=[];for(let v=0;v<d;++v){for(const y of u[v]){const{permutationIndices:w,expandDims:x}=JR(m,c[y]);let S;nO(w)?S=i[y]:(S=Ns({inputs:{x:i[y]},backend:n,attrs:{perm:w}}),g.push(S));const k=S.shape.slice();for(let E=0;E<x.length;++E)k.splice(x[E],0,1);Dt(S.shape,k)||(S=fn({inputs:{x:S},backend:n,attrs:{shape:k}}),g.push(S)),h===null?h=S:(h=PS({inputs:{a:S,b:h},backend:n}),g.push(h))}v<d-1&&(l[v]>=0&&(h=$y({inputs:{x:h},backend:n,attrs:{axis:l[v]-(o.length-m),keepDims:!1}}),g.push(h)),m--)}for(const v of g)v!==h&&n.disposeIntermediateTensorInfo(v);return h}const i4e={kernelName:s$,backendName:"cpu",kernelFunc:s4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4e(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;Xe([r,s],"eluGrad");const i=new Float32Array(me(s.shape)),o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let c=0;c<o.length;++c){const l=o[c];l>=0?i[c]=a[c]:i[c]=a[c]*(l+1)}return n.makeTensorInfo(s.shape,"float32",i)}const a4e={kernelName:i$,backendName:"cpu",kernelFunc:o4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c4e=WR,l4e=GR,u4e=qR,d4e=KR,f4e=XR,h4e=QR,p4e=Jt($0,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+c4e*n);return e*(1-((((h4e*r+f4e)*r+d4e)*r+u4e)*r+l4e)*r*Math.exp(-n*n))}),m4e={kernelName:$0,backendName:"cpu",kernelFunc:p4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:i}=r,o=s.shape.length,a=s.shape.slice();let c=i;return i<0&&(U(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+i+1),a.splice(c,0,1),fn({inputs:{x:s},backend:n,attrs:{shape:a}})}const g4e={kernelName:uI,backendName:"cpu",kernelFunc:Wx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4e=Yn((t,e)=>t/e),DO=yr(N0,y4e),CA={kernelName:N0,backendName:"cpu",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(t,e,n){const r=t.shape,s=r[0],i=r[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,l=[s,i],u=me(l),d=Mr("float32",u),h=Mr("float32",u);for(let y=0;y<s;y++){const w=pd({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,i]}}),x=pd({inputs:{x:c},backend:n,attrs:{begin:[y,0],size:[1,i]}}),S=Xs({inputs:{real:w,imag:x},backend:n}),{real:k,imag:E}=v4e(S,e,n),A=vc(k,E);for(let R=0;R<i;R++){const N=YR(A,R);d[y*i+R]=N.real,h[y*i+R]=N.imag}n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(S)}const m=n.makeTensorInfo(l,"float32",d),g=n.makeTensorInfo(l,"float32",h),v=Xs({inputs:{real:m,imag:g},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}function v4e(t,e,n){const r=me(t.shape),s=n.data.get(t.dataId),i=n.data.get(s.complexTensorInfos.real.dataId).values,o=n.data.get(s.complexTensorInfos.imag.dataId).values;if(b4e(r)){const a=TA(i,o,r,e,n),c=[t.shape[0],t.shape[1]];if(e){const l=n.makeTensorInfo(c,"float32",a.real),u=n.makeTensorInfo(c,"float32",a.imag),d=n.makeTensorInfo([],"float32",Bl(r,"float32")),h=Na({inputs:{x:d},backend:n}),m=CA.kernelFunc({inputs:{a:l,b:d},backend:n}),g=CA.kernelFunc({inputs:{a:u,b:h},backend:n}),v=n.data.get(m.dataId).values,y=n.data.get(g.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),{real:v,imag:y}}return a}else{const a=vc(i,o),c=w4e(a,r,e);return b9(c)}}function b4e(t){return(t&t-1)===0}function TA(t,e,n,r,s){if(n===1)return{real:t,imag:e};const i=vc(t,e),o=n/2,a=w9(i),c=a.real,l=a.imag,u=[c.length],d=s.makeTensorInfo(u,"float32",c),h=s.makeTensorInfo(u,"float32",l),m=Xs({inputs:{real:d,imag:h},backend:s}),g=x9(i),v=g.real,y=g.imag,w=[v.length],x=s.makeTensorInfo(w,"float32",v),S=s.makeTensorInfo(w,"float32",y),k=Xs({inputs:{real:x,imag:S},backend:s}),E=TA(c,l,o,r,s),A=E.real,R=E.imag,N=[A.length],P=s.makeTensorInfo(N,"float32",A),O=s.makeTensorInfo(N,"float32",R),_=Xs({inputs:{real:P,imag:O},backend:s}),M=TA(v,y,o,r,s),G=M.real,q=M.imag,D=[G.length],L=s.makeTensorInfo(D,"float32",G),K=s.makeTensorInfo(D,"float32",q),j=Xs({inputs:{real:L,imag:K},backend:s}),W=S9(n,r),X=[W.real.length],H=s.makeTensorInfo(X,"float32",W.real),Y=s.makeTensorInfo(X,"float32",W.imag),ce=Xs({inputs:{real:H,imag:Y},backend:s}),de=PS({inputs:{a:ce,b:j},backend:s}),ge=Ch({inputs:{a:_,b:de},backend:s}),be=OO({inputs:{a:_,b:de},backend:s}),we=hd({inputs:{input:ge},backend:s}),Ae=hd({inputs:{input:be},backend:s}),_e=Th({inputs:{input:ge},backend:s}),je=Th({inputs:{input:be},backend:s}),st=Ah({inputs:[we,Ae],backend:s,attrs:{axis:0}}),dt=Ah({inputs:[_e,je],backend:s,attrs:{axis:0}}),yt=s.data.get(st.dataId).values,Mt=s.data.get(dt.dataId).values;return s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(m),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(k),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(O),s.disposeIntermediateTensorInfo(_),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(j),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(Y),s.disposeIntermediateTensorInfo(ce),s.disposeIntermediateTensorInfo(de),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(be),s.disposeIntermediateTensorInfo(we),s.disposeIntermediateTensorInfo(_e),s.disposeIntermediateTensorInfo(Ae),s.disposeIntermediateTensorInfo(je),s.disposeIntermediateTensorInfo(st),s.disposeIntermediateTensorInfo(dt),{real:yt,imag:Mt}}function w4e(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,o=0;for(let a=0;a<e;a++){const c=k9(s*a,e,n),l=YR(t,a);i+=l.real*c.real-l.imag*c.imag,o+=l.real*c.imag+l.imag*c.real}n&&(i/=e,o/=e),I9(r,i,o,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4e(t){const{inputs:e,backend:n}=t,{input:r}=e,s=me(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=fn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),c=lQ(a,!1,n),l=fn({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),l}const I4e={kernelName:o$,backendName:"cpu",kernelFunc:x4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FO(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:i}=n,o=i||qh(s),a=qn(o,me(r));return k4e(a,s,o),e.makeTensorInfo(r,o,a)}const S4e={kernelName:a$,backendName:"cpu",kernelFunc:FO};function k4e(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E4e={kernelName:c$,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,i=Mr(r.dtype,me(r.shape)),[o,a,c,l]=r.shape,u=s.data.get(r.dataId).values;for(let h=0;h<o;h++){const m=h*c*a*l;for(let g=0;g<a;g++){const v=g*(c*l);for(let y=0;y<c;y++){const w=y*l;for(let x=0;x<l;x++){const S=Math.round(c-y-1),k=m+v+w+x;let E=u[k];if(S>=0&&S<c){const A=S*l,R=m+v+A+x;E=u[R]}i[k]=E}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:m,leakyreluAlpha:g}=r;let v=aQ({inputs:{x:s,filter:i},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=v;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const w=fn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=Ch({inputs:{a:v,b:w},backend:n}),n.disposeIntermediateTensorInfo(w)}else v=Ch({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(y)}if(m){const y=v;if(u==="NCHW"&&m==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const w=fn({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});v=Hx(n,v,m,w,g),n.disposeIntermediateTensorInfo(w)}else v=Hx(n,v,m,a,g);n.disposeIntermediateTensorInfo(y)}return v}const T4e={kernelName:kx,backendName:"cpu",kernelFunc:C4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:m,leakyreluAlpha:g}=r;let v=cQ({inputs:{x:s,filter:i},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=v;v=Ch({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(y)}if(m){const y=v;v=Hx(n,v,m,a,g),n.disposeIntermediateTensorInfo(y)}return v}const N4e={kernelName:Ex,backendName:"cpu",kernelFunc:A4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=me(r.shape),o=s.shape,a=o[o.length-1],[c,l,u,d]=PR(r,s);if(l===0)return n.makeTensorInfo(c,r.dtype,[]);const h=n.data.get(s.dataId).values,m=n.bufferSync(r),g=bX(h,m,r.dtype,l,a,u,d,r.shape,i);return n.makeTensorInfo(c,r.dtype,g.values)}const $4e={kernelName:l$,backendName:"cpu",kernelFunc:_4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r;Xe([s,i],"gatherV2");const c=Nt(o,s.shape)[0],l=n.data.get(i.dataId).values,u=s.shape[c];for(let k=0;k<l.length;++k){const E=l[k];U(E<=u-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=me(i.shape),m=sO(s,i,c,d),g=fn({inputs:{x:s},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),v=fn({inputs:{x:i},backend:n,attrs:{shape:[m.batchSize,h/m.batchSize]}}),y=[m.batchSize,m.outerSize,h/m.batchSize,m.sliceSize],w=n.bufferSync(v),x=n.bufferSync(g),S=wX(x,w,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.makeTensorInfo(m.outputShape,S.dtype,S.values)}const O4e={kernelName:fI,backendName:"cpu",kernelFunc:R4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4e(t){const{inputs:e,backend:n}=t,{input:r}=e,s=me(r.shape),i=r.shape[r.shape.length-1],o=s/i,a=fn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),c=lQ(a,!0,n),l=fn({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),l}const D4e={kernelName:u$,backendName:"cpu",kernelFunc:P4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4e=Jt(B0,t=>Number.isFinite(t)?1:0,"bool"),L4e={kernelName:B0,backendName:"cpu",kernelFunc:F4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B4e=Jt(M0,t=>Math.abs(t)===1/0?1:0,"bool"),M4e={kernelName:M0,backendName:"cpu",kernelFunc:B4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4e=Jt(z0,t=>Number.isNaN(t)?1:0,"bool"),U4e={kernelName:z0,backendName:"cpu",kernelFunc:z4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=EX(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const j4e={kernelName:f$,backendName:"cpu",kernelFunc:V4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4e=Jt(V0,t=>Math.log1p(t)),W4e={kernelName:V0,backendName:"cpu",kernelFunc:H4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4e=Yn((t,e)=>t&&e),q4e=yr(yI,G4e,null,"bool"),K4e={kernelName:yI,backendName:"cpu",kernelFunc:q4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X4e=Jt(vI,t=>t?0:1,"bool"),Q4e={kernelName:vI,backendName:"cpu",kernelFunc:X4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4e=Yn((t,e)=>t||e),Z4e=yr(bI,Y4e,null,"bool"),J4e={kernelName:bI,backendName:"cpu",kernelFunc:Z4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:c}=r;Xe(s,"LRN");const l=s.shape[3],u=l-1,d=n.data.get(s.dataId).values,h=me(s.shape),m=new Float32Array(h);function g(v){const y=v%l;let w=v-y+Math.max(0,y-i);const x=v-y+Math.min(y+i,u);let S=0;for(;w<=x;w++){const k=d[w];S+=k*k}return S}for(let v=0;v<h;v++){const y=g(v),w=d[v]*Math.pow(o+a*y,-c);m[v]=w}return n.makeTensorInfo(s.shape,s.dtype,m)}const tze={kernelName:wI,backendName:"cpu",kernelFunc:eze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:c,alpha:l,beta:u}=r;Xe(o,"LRNGrad");const d=me(o.shape),h=o.shape[3],m=n.data.get(o.dataId).values,g=n.data.get(s.dataId).values,v=n.data.get(i.dataId).values,y=new Float32Array(d),w=d;for(let x=0;x<w;x++){const S=x%h,k=x-S+Math.max(0,S-a),E=x-S+Math.min(h,S+a+1);let A=0;for(let R=k;R<E;R++)A+=Math.pow(g[R],2);A=l*A+c;for(let R=k;R<E;R++){let N=-2*l*u*g[R]*v[x]/A;x===R&&(N+=Math.pow(A,-u)),N*=m[x],y[R]+=N}}return n.makeTensorInfo(o.shape,s.dtype,y)}const rze={kernelName:h$,backendName:"cpu",kernelFunc:nze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=n;let c=s.shape;const l=c.length,u=Nt(i,c);let d=u;const h=Pn(d,l);let m=a.data.get(s.dataId).values;if(h!=null){const k=new Array(l);for(let E=0;E<k.length;E++)k[E]=c[h[E]];m=$O(m,c,s.dtype,h,k),d=Xn(d.length,l),c=k}Xe(s,"max"),jr("max",d,l);const[g,v]=Cr(c,d),y=me(v),w=TX(m,y,g,s.dtype),x=a.write(w,g,s.dtype);let S=g;return o&&(S=Kn(g,u)),{dataId:x,shape:S,dtype:s.dtype}}const sze={kernelName:xI,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ize(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Xe(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:c}=r,l=1;U(Vr(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const u=co(s.shape,i,o,l,a,c);let d;if(u.filterWidth===1&&u.filterHeight===1&&Dt(u.inShape,u.outShape))d=Na({inputs:{x:s},backend:n});else{const h=n.data.get(s.dataId).values,m=nt(s.shape),g=PO(h,s.shape,s.dtype,m,u,"max");d=n.makeTensorInfo(u.outShape,s.dtype,g.values)}return d}const oze={kernelName:II,backendName:"cpu",kernelFunc:ize};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:c,dataFormat:l}=r;Xe(s,"maxPool3d");const u=Ec(s.shape,i,o,1,a,c,l),d=n.data.get(s.dataId).values,h=oQ(d,s.shape,s.dtype,nt(s.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const cze={kernelName:SI,backendName:"cpu",kernelFunc:aze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lze(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,{filterSize:o,strides:a,pad:c,dimRoundingMode:l}=r;Xe([s,i],"maxPool3DGrad");const u=Ec(i.shape,o,a,1,c,l),d=n.bufferSync(i),h=YBe(d,u),m=u.strideDepth,g=u.strideHeight,v=u.strideWidth,y=u.dilationDepth,w=u.dilationHeight,x=u.dilationWidth,S=u.effectiveFilterDepth,k=u.effectiveFilterHeight,E=u.effectiveFilterWidth,A=S-1-u.padInfo.front,R=E-1-u.padInfo.left,N=k-1-u.padInfo.top,P=kt(i.shape,"float32"),O=n.bufferSync(s);for(let _=0;_<u.batchSize;++_)for(let M=0;M<u.inChannels;++M)for(let G=0;G<u.inDepth;++G)for(let q=0;q<u.inHeight;++q)for(let D=0;D<u.inWidth;++D){const L=G-A,K=q-N,j=D-R;let W=0;for(let X=0;X<S;X+=y){const H=(L+X)/m;if(!(H<0||H>=u.outDepth||Math.floor(H)!==H))for(let Y=0;Y<k;Y+=w){const ce=(K+Y)/g;if(!(ce<0||ce>=u.outHeight||Math.floor(ce)!==ce))for(let de=0;de<E;de+=x){const ge=(j+de)/v;if(ge<0||ge>=u.outWidth||Math.floor(ge)!==ge)continue;const be=S*k*E-1-h.get(_,H,ce,ge,M),we=X*k*E+Y*E+de,Ae=be===we?1:0;if(Ae===0)continue;const _e=O.get(_,H,ce,ge,M);W+=_e*Ae}}}P.set(W,_,G,q,D,M)}return n.makeTensorInfo(P.shape,P.dtype,P.values)}const uze={kernelName:m$,backendName:"cpu",kernelFunc:lze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dze(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;Xe([i,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=co(a.shape,c,l,1,u,d),m=n.data.get(a.dataId).values,g=kt(h.outShape,a.dtype,iQ(m,a.shape,a.dtype,h).values),v=h.strideHeight,y=h.strideWidth,w=h.dilationHeight,x=h.dilationWidth,S=h.effectiveFilterHeight,k=h.effectiveFilterWidth,E=k-1-h.padInfo.left,A=S-1-h.padInfo.top,R=kt(a.shape,"float32"),N=n.data.get(s.dataId).values,P=kt(s.shape,"float32",N);for(let O=0;O<h.batchSize;++O)for(let _=0;_<h.inChannels;++_)for(let M=0;M<h.inHeight;++M)for(let G=0;G<h.inWidth;++G){const q=M-A,D=G-E;let L=0;for(let K=0;K<S;K+=w){const j=(q+K)/v;if(!(j<0||j>=h.outHeight||Math.floor(j)!==j))for(let W=0;W<k;W+=x){const X=(D+W)/y;if(X<0||X>=h.outWidth||Math.floor(X)!==X)continue;const H=S*k-1-g.get(O,j,X,_),Y=K*k+W,ce=H===Y?1:0;if(ce===0)continue;const de=P.get(O,j,X,_);L+=de*ce}}R.set(L,O,M,G,_)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const fze={kernelName:p$,backendName:"cpu",kernelFunc:dze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hze(t,e,n,r,s){const i=nt(e),o=PO(t,e,n,i,s,"max"),a=iQ(t,e,n,s,!0,r);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pze={kernelName:g$,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,c=n;Xe(r,"MaxPoolWithArgmax");const l=c.data.get(r.dataId).values,u=co(r.shape,s,i,[1,1],o),[d,h]=hze(l,r.shape,r.dtype,a,u),m=c.write(d,u.outShape,r.dtype),g=c.write(h,u.outShape,r.dtype);return[{dataId:m,shape:u.outShape,dtype:r.dtype},{dataId:g,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=Nt(i,s.shape),l=Cr(s.shape,a)[1],u=me(l),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const m=Rl({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});d.push(m);const g=DO({inputs:{a:m,b:h},backend:n});d.push(g);const v=$y({inputs:{x:g},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),v}const gze={kernelName:kI,backendName:"cpu",kernelFunc:mze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;Xe(s,"min");const a=Nt(i,s.shape);let c=a;const l=Pn(c,s.shape.length);let u=s;l!=null&&(u=Ns({inputs:{x:s},backend:n,attrs:{perm:l}}),c=Xn(c.length,s.shape.length)),jr("min",c,u.shape.length);const[d,h]=Cr(u.shape,c),m=me(h),g=Jr(me(d),u.dtype),v=n.data.get(u.dataId).values;for(let w=0;w<g.length;++w){const x=w*m;let S=v[x];for(let k=0;k<m;++k){const E=v[x+k];(Number.isNaN(E)||E<S)&&(S=E)}g[w]=S}l!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,g);if(o){const w=Kn(d,a),x=fn({inputs:{x:y},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(y),x}return y}const vze={kernelName:EI,backendName:"cpu",kernelFunc:yze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,mode:o}=r;Xe(s,"mirrorPad");const a=i.map((S,k)=>S[0]+s.shape[k]+S[1]),c=i.map(S=>S[0]),l=i.map((S,k)=>S[0]+s.shape[k]),u=o==="reflect"?0:1,d=n.data.get(s.dataId).values,h=s.shape.length,m=nt(s.shape),g=me(a),v=a.length,y=nt(a),w=Mr(s.dtype,g);for(let S=0;S<g;S++){let k=Kh(S,v,y);for(let A=0;A<v;A++)k[A]<c[A]?k[A]=c[A]*2-k[A]-u:k[A]>=l[A]&&(k[A]=(l[A]-1)*2-k[A]+u);k=k.map((A,R)=>A-c[R]);const E=va(k,h,m);w[S]=d[E]}return{dataId:n.write(w,a,s.dtype),shape:a,dtype:s.dtype}}const wze={kernelName:CI,backendName:"cpu",kernelFunc:bze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xze=Yn(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),Ize=yr(W0,xze),Sze={kernelName:W0,backendName:"cpu",kernelFunc:Ize};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=s.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const c=Nt([a],s.shape),l=uQ({inputs:{x:s},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),u=Kn(l.shape,c),d=fn({inputs:{x:l},backend:n,attrs:{shape:u}}),h=OO({inputs:{a:s,b:d},backend:n}),m=mX({inputs:{x:h},backend:n}),g=$y({inputs:{x:m},backend:n,attrs:{axis:c,keepDims:!1}}),v=fn({inputs:{x:g},backend:n,attrs:{shape:u}}),y=DO({inputs:{a:m,b:v},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),y}const kze={kernelName:HI,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eze(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r;Xe(s,"multinomial");const c=a?s:dQ({inputs:{logits:s},backend:n,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],d=n.data.get(c.dataId).values,h=[l,i],m=Jr(me(h),"int32");for(let g=0;g<l;++g){const v=g*u,y=new Float32Array(u-1);y[0]=d[v];for(let S=1;S<y.length;++S)y[S]=y[S-1]+d[v+S];const w=lS.alea(o.toString()),x=g*i;for(let S=0;S<i;++S){const k=w();m[x+S]=y.length;for(let E=0;E<y.length;E++)if(k<y[E]){m[x+S]=E;break}}}return a||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(h,"int32",m)}const Cze={kernelName:y$,backendName:"cpu",kernelFunc:Eze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tze=TR;function Aze(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c}=r;Xe(s,"NonMaxSuppression");const l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=Tze(l,u,o,a,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Nze={kernelName:v$,backendName:"cpu",kernelFunc:Aze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ze=AR;function $ze(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=r;Xe(s,"NonMaxSuppressionPadded");const u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:m}=_ze(u,d,o,a,c,l);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}const Rze={kernelName:b$,backendName:"cpu",kernelFunc:$ze};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oze=NR;function Pze(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=r;Xe(s,"NonMaxSuppressionWithScore");const u=n.data.get(s.dataId).values,d=n.data.get(i.dataId).values,h=o,m=a,g=c,v=l,{selectedIndices:y,selectedScores:w}=Oze(u,d,h,m,g,v);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const Dze={kernelName:w$,backendName:"cpu",kernelFunc:Pze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fze(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:c}=r;Xe(s,"oneHot");const l=me(s.shape),u=new Float32Array(l*o);u.fill(c);const d=n.data.get(s.dataId).values;for(let h=0;h<l;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...s.shape,o],i,u)}const Lze={kernelName:_I,backendName:"cpu",kernelFunc:Fze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=hd({inputs:{input:r},backend:n}),i=Gx({inputs:{x:s},backend:n}),o=Th({inputs:{input:r},backend:n}),a=Gx({inputs:{x:o},backend:n}),c=Xs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}else return FO({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Bze={kernelName:KI,backendName:"cpu",kernelFunc:Gx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=hd({inputs:{input:r},backend:n}),i=fQ({inputs:{x:s},backend:n}),o=Th({inputs:{input:r},backend:n}),a=Gx({inputs:{x:o},backend:n}),c=Xs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}else return FO({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const Mze={kernelName:NI,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Wx({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{ci(i,u.shape,"All tensors passed to stack must have matching shapes"),U(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],c=e.map(u=>{const d=Wx({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(d),d}),l=Ah({inputs:c,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),l}const zze={kernelName:$I,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uze(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;Xe(s,"pad");const a=i.map((x,S)=>x[0]+s.shape[S]+x[1]),c=i.map(x=>x[0]),l=n.data.get(s.dataId).values,u=me(s.shape),d=s.shape.length,h=nt(s.shape),m=me(a),g=a.length,v=nt(a),y=Mr(s.dtype,m);o!==0&&y.fill(o);for(let x=0;x<u;x++){const k=Kh(x,d,h).map((A,R)=>A+c[R]),E=va(k,g,v);y[E]=l[x]}return{dataId:n.write(y,a,s.dtype),shape:a,dtype:s.dtype}}const pQ={kernelName:RI,backendName:"cpu",kernelFunc:Uze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vze=Yn((t,e)=>Math.pow(t,e)),jze=yr(q0,Vze),Hze={kernelName:q0,backendName:"cpu",kernelFunc:jze};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wze(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,c=s.map(w=>n.data.get(w.dataId).values),l=s.map(w=>w.shape),u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[h,m,g]=OX(c,l,u,i.shape,i.dtype,d,o.shape),v=h.map(w=>n.makeTensorInfo([w.length],"int32",w)),y=n.makeTensorInfo(g,i.dtype,m);return v.concat([y])}const Gze={kernelName:x$,backendName:"cpu",kernelFunc:Wze};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qze(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,[l,u]=PX(o,r.shape,r.dtype,a,s.shape,c,i.shape),d=n.makeTensorInfo([l.length],"int32",l),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const Kze={kernelName:I$,backendName:"cpu",kernelFunc:qze};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xze(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:c}=r,l=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(y=>n.data.get(y.dataId).values),m=a.map(y=>y.shape),[g,v]=DX(l,s.shape,u,i.shape,i.dtype,d,o.shape,h,m,c);return n.makeTensorInfo(g,i.dtype,v)}const Qze={kernelName:S$,backendName:"cpu",kernelFunc:Xze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yze(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:i,step:o}=n,a=FX(r,s,o,i);return e.makeTensorInfo([a.length],i,a)}const Zze={kernelName:k$,backendName:"cpu",kernelFunc:Yze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jze=Jt(K0,t=>1/t),eUe={kernelName:K0,backendName:"cpu",kernelFunc:Jze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tUe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;Xe(s,"resizeBilinear");const c=nt(s.shape),[l,u]=a,[d,h,m,g]=s.shape,v=n.data.get(s.dataId).values,y=new Float32Array(me([d,l,u,g])),w=[i&&l>1?h-1:h,i&&u>1?m-1:m],x=[i&&l>1?l-1:l,i&&u>1?u-1:u];let S=0;const k=w[0]/x[0],E=w[1]/x[1];for(let A=0;A<d;A++)for(let R=0;R<l;R++){let N;o?N=k*(R+.5)-.5:N=k*R;const P=Math.max(0,Math.floor(N)),O=N-P,_=Math.min(h-1,Math.ceil(N)),M=A*c[0]+P*c[1],G=A*c[0]+_*c[1];for(let q=0;q<u;q++){let D;o?D=E*(q+.5)-.5:D=E*q;const L=Math.max(0,Math.floor(D)),K=D-L,j=Math.min(m-1,Math.ceil(D)),W=M+L*c[2],X=G+L*c[2],H=M+j*c[2],Y=G+j*c[2];for(let ce=0;ce<g;ce++){const de=v[W+ce],ge=v[X+ce],be=v[H+ce],we=v[Y+ce],Ae=de+(be-de)*K,_e=ge+(we-ge)*K,je=Ae+(_e-Ae)*O;y[S++]=je}}}return n.makeTensorInfo([d,l,u,g],"float32",y)}const nUe={kernelName:LI,backendName:"cpu",kernelFunc:tUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rUe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;Xe([i,s],"resizeBilinearGrad");const a=nt(s.shape),[c,l,u,d]=s.shape,[,h,m]=i.shape,g=new Float32Array(c*l*u*d),v=[o&&h>1?l-1:l,o&&m>1?u-1:u],y=[o&&h>1?h-1:h,o&&m>1?m-1:m],w=v[0]/y[0],x=v[1]/y[1],S=n.data.get(i.dataId).values;let k=0;for(let E=0;E<c;E++){const A=E*a[0];for(let R=0;R<h;R++){const N=R*w,P=Math.floor(N),O=Math.min(Math.ceil(N),l-1),_=A+P*a[1],M=A+O*a[1],G=N-P,q=1-G;for(let D=0;D<m;D++){const L=D*x,K=Math.floor(L),j=Math.min(Math.ceil(L),u-1),W=L-K,X=1-W,H=_+K*a[2],Y=_+j*a[2],ce=M+K*a[2],de=M+j*a[2],ge=q*X,be=q*W,we=G*X,Ae=G*W;for(let _e=0;_e<d;_e++){const je=S[k++];g[H+_e]+=je*ge,g[Y+_e]+=je*be,g[ce+_e]+=je*we,g[de+_e]+=je*Ae}}}}return n.makeTensorInfo([c,u,l,d],"float32",g)}const sUe={kernelName:T$,backendName:"cpu",kernelFunc:rUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iUe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r;Xe(s,"resizeNearestNeighbor");const c=nt(s.shape),[l,u]=a,[d,h,m,g]=s.shape,v=n.data.get(s.dataId).values,y=new Float32Array(d*l*u*g),w=[i&&l>1?h-1:h,i&&u>1?m-1:m],x=[i&&l>1?l-1:l,i&&u>1?u-1:u],S=w[0]/x[0],k=w[1]/x[1];let E=0;for(let A=0;A<d;A++){const R=A*c[0];for(let N=0;N<l;N++){const P=o?S*(N+.5):S*N;let O=Math.min(h-1,i?Math.round(P):Math.floor(P));o&&(O=Math.max(0,O));const _=R+O*c[1];for(let M=0;M<u;M++){const G=o?k*(M+.5):k*M;let q=Math.min(m-1,i?Math.round(G):Math.floor(G));o&&(q=Math.max(0,q));const D=_+q*c[2];for(let L=0;L<g;L++){const K=v[D+L];y[E++]=K}}}}return n.makeTensorInfo([d,l,u,g],s.dtype,y)}const oUe={kernelName:FI,backendName:"cpu",kernelFunc:iUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aUe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r;Xe([i,s],"resizeNearestNeighborGrad");const a=nt(s.shape),c=nt(i.shape),[l,u,d,h]=s.shape,[,m,g]=i.shape,v=new Float32Array(l*u*d*h),y=n.data.get(i.dataId).values,w=[o&&m>1?u-1:u,o&&g>1?d-1:d],x=[o&&m>1?m-1:m,o&&g>1?g-1:g],S=w[0]/x[0],k=w[1]/x[1],E=1/S,A=1/k,R=Math.ceil(E)*2+2,N=Math.ceil(A)*2+2;for(let P=0;P<l;P++){const O=P*a[0];for(let _=0;_<u;_++){const M=O+_*a[1],G=Math.floor(_*E),q=Math.floor(G-R/2);for(let D=0;D<d;D++){const L=M+D*a[2],K=Math.floor(D*A),j=Math.floor(K-N/2);for(let W=0;W<h;W++){let X=0;for(let H=0;H<R;H++){const Y=H+q;if(Y<0||Y>=m)continue;const ce=O+Y*c[1],de=Y*S,ge=Math.min(u-1,o?Math.round(de):Math.floor(de));if(_===ge)for(let be=0;be<N;be++){const we=be+j;if(we<0||we>=g)continue;const Ae=ce+we*c[2],_e=we*k,je=Math.min(d-1,o?Math.round(_e):Math.floor(_e));D===je&&(X+=y[Ae+W])}}v[L+W]=X}}}}return n.makeTensorInfo(s.shape,s.dtype,v)}const cUe={kernelName:C$,backendName:"cpu",kernelFunc:aUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r;Xe(s,"reverse");const o=s.shape.length,a=Nt(i,s.shape);if(o===0)return Na({inputs:{x:s},backend:n});const c=new fr(s.shape,s.dtype),l=n.bufferSync(s);for(let u=0;u<c.size;u++){const d=c.indexToLoc(u),h=d.slice();a.forEach(m=>h[m]=s.shape[m]-1-h[m]),c.set(l.get(...h),...d)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}const uUe={kernelName:BI,backendName:"cpu",kernelFunc:lUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dUe={kernelName:H$,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,c=Mr(r.dtype,me(r.shape)),[l,u,d,h]=r.shape,[m,g]=VR(o,u,d),v=255,y=Math.sin(s),w=Math.cos(s),x=a.data.get(r.dataId).values;for(let k=0;k<l;k++){const E=k*d*u*h;for(let A=0;A<u;A++){const R=A*(d*h);for(let N=0;N<d;N++){const P=N*h;for(let O=0;O<h;O++){const _=[l,A,N,O],M=_[2],G=_[1];let q=(M-m)*w-(G-g)*y,D=(M-m)*y+(G-g)*w;q=Math.round(q+m),D=Math.round(D+g);let L=i;if(typeof i!="number"&&(O===3?L=v:L=i[O]),q>=0&&q<d&&D>=0&&D<u){const j=D*(d*h),W=q*h,X=E+j+W+O;L=x[X]}const K=E+R+P+O;c[K]=L}}}}return{dataId:a.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fUe=Jt(Y0,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),hUe={kernelName:Y0,backendName:"cpu",kernelFunc:fUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pUe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Ad(i,s,o),h=!0,m=n.bufferSync(s),g=n.bufferSync(i),v=Ru(m,g,o,d,l,c,a,u,0,h);return n.makeTensorInfo(o,v.dtype,v.values)}const mUe={kernelName:A$,backendName:"cpu",kernelFunc:pUe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gUe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function yUe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function vUe(t,e,n,r,s,i){const o=qn("int32",n*s);for(let a=0;a<n;++a){const c=t.slice(a*r,(a+1)*r),l=a*s;for(let u=0;u<s;++u)o[l+u]=i==="left"?gUe(c,e[u+l]):yUe(c,e[u+l])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bUe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,l=vUe(a,c,s.shape[0],s.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",l)}const wUe={kernelName:_$,backendName:"cpu",kernelFunc:bUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xUe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e;Xe([r,s,i],"select");const o=r.shape.length,a=n.data.get(r.dataId).values,c=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=ni(s.dtype,i.dtype),d=Jr(me(s.shape),u);let h=0;const m=o===0||o>1||s.shape.length===1?1:me(s.shape.slice(1));for(let g=0;g<a.length;g++)for(let v=0;v<m;v++)a[g]===1?d[h++]=c[g]:d[h++]=l[g];return n.makeTensorInfo(s.shape,u,d)}const IUe={kernelName:MI,backendName:"cpu",kernelFunc:xUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SUe=xS,kUe=IS,EUe=Jt(J0,t=>t>=0?kUe*t:SUe*(Math.exp(t)-1)),CUe={kernelName:J0,backendName:"cpu",kernelFunc:EUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TUe=Jt(ny,t=>t<0?-1:t>0?1:0),AUe={kernelName:ny,backendName:"cpu",kernelFunc:TUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NUe=Jt(ey,t=>Math.sin(t)),_Ue={kernelName:ey,backendName:"cpu",kernelFunc:NUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ue=Jt(ty,t=>Math.sinh(t)),RUe={kernelName:ty,backendName:"cpu",kernelFunc:$Ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OUe=11920928955078125e-23,Z4=Math.log(OUe)+2,PUe=Jt(sy,t=>{const e=t>-Z4,n=t<Z4,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),DUe={kernelName:sy,backendName:"cpu",kernelFunc:PUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;Xe([s],"spaceToBatchND");const a=me(i),c=[[0,0]];c.push(...o);for(let A=1+i.length;A<s.shape.length;++A)c.push([0,0]);const l=pQ.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:c,constantValue:0}}),u=wy(l.shape,i,a,!1),d=xy(u.length,i.length,!1),h=Iy(l.shape,i,a,!1),v=fn({inputs:{x:l},backend:n,attrs:{shape:u}}),x=Ns({inputs:{x:v},backend:n,attrs:{perm:d}}),E=fn({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),E}const LUe={kernelName:VI,backendName:"cpu",kernelFunc:FUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BUe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(r.dataId).values,c=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,m,g,v]=zX(a,r.shape,r.dtype,c,s.dtype,l,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(y=>Number(y)))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const MUe={kernelName:$$,backendName:"cpu",kernelFunc:BUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zUe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,c=Array.from(n.data.get(i.dataId).values),[l,u,d]=UX(a,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const UUe={kernelName:R$,backendName:"cpu",kernelFunc:zUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VUe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,[l,u]=RO(o,r.shape,r.dtype,a,c,!0);return n.makeTensorInfo(u,r.dtype,l)}const jUe={kernelName:O$,backendName:"cpu",kernelFunc:VUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HUe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,c=n.data.get(i.dataId).values,[l,u]=RO(o,r.shape,r.dtype,a,c);return n.makeTensorInfo(u,r.dtype,l)}const WUe={kernelName:P$,backendName:"cpu",kernelFunc:HUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GUe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=Ad(i,s,a),m=!1,g=n.bufferSync(s);let v;switch(i.dtype){case"bool":{const y=n.bufferSync(i),w=!!n.data.get(o.dataId).values[0];v=Ru(g,y,a,h,u,l,c,d,w,m);break}case"float32":{const y=n.bufferSync(i),w=n.data.get(o.dataId).values[0];v=Ru(g,y,a,h,u,l,c,d,w,m);break}case"int32":{const y=n.bufferSync(i),w=n.data.get(o.dataId).values[0];v=Ru(g,y,a,h,u,l,c,d,w,m);break}case"string":{const y=n.bufferSync(i),w=Sl(n.data.get(o.dataId).values[0]);v=Ru(g,y,a,h,u,l,c,d,w,m);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,v.dtype,v.values)}const qUe={kernelName:D$,backendName:"cpu",kernelFunc:GUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Nt(o,s.shape)[0],c=rO(s,i,a),l=new Array(s.shape.length).fill(0),u=s.shape.slice();return c.map(d=>{const h=[...u];h[a]=d;const m=pd({inputs:{x:s},backend:n,attrs:{begin:l,size:h}});return l[a]+=d,m})}const XUe={kernelName:jI,backendName:"cpu",kernelFunc:KUe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QUe={kernelName:F$,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Xe(n,"square");const s=r.data.get(n.dataId).values,i=new Float32Array(s.length);for(let a=0;a<s.length;++a){const c=s[a];i[a]=c*c}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YUe=Jt(dy,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),ZUe={kernelName:dy,backendName:"cpu",kernelFunc:YUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r;Xe(s,"stridedSlice");const{finalShapeSparse:m,finalShape:g,isIdentity:v,sliceDim0:y,isSimpleSlice:w,begin:x,end:S,strides:k}=MR(s.shape,i,o,a,c,l,u,d,h);let E;if(v)E=fn({inputs:{x:s},backend:n,attrs:{shape:g}});else if(y||w){U(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const A=FR(x,S,k),R=pd({inputs:{x:s},backend:n,attrs:{begin:x,size:A}});E=fn({inputs:{x:R},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(R)}else{const A=n.bufferSync(s),R=HX(m,A,k,x);E=n.makeTensorInfo(g,R.dtype,R.values)}return E}const eVe={kernelName:L$,backendName:"cpu",kernelFunc:JUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tVe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,m=n.data.get(d.dataId).values,[g,v]=WX(h,m,s,i,o,a,c,l);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",v)]}const nVe={kernelName:B$,backendName:"cpu",kernelFunc:tVe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rVe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[l,u,d]=GX(a,c,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const sVe={kernelName:M$,backendName:"cpu",kernelFunc:rVe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iVe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=qX(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const oVe={kernelName:z$,backendName:"cpu",kernelFunc:iVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aVe=Jt(cy,t=>Math.tan(t)),cVe={kernelName:cy,backendName:"cpu",kernelFunc:aVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lVe=Jt(ly,t=>Math.tanh(t)),uVe={kernelName:ly,backendName:"cpu",kernelFunc:lVe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dVe(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:c,strides:l,outputSize:u}=Ad(i,s,r.shape),d=!1,h=n.bufferSync(s),m=n.bufferSync(i),g=n.bufferSync(r),v=Ru(h,m,r.shape,u,c,a,o,l,g,d);return n.makeTensorInfo(r.shape,v.dtype,v.values)}const fVe={kernelName:N$,backendName:"cpu",kernelFunc:dVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;Xe(s,"tile");const o=XX(n.bufferSync(s),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const pVe={kernelName:uy,backendName:"cpu",kernelFunc:hVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r;Xe(s,"topk");const a=n.data.get(s.dataId).values,[c,l]=YX(a,s.shape,s.dtype,i,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}const gVe={kernelName:U$,backendName:"cpu",kernelFunc:mVe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yVe(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:c,outputShape:l}=n,[u,d,h,m]=s.shape,[g,v]=l??[d,h],y=[u,g,v,m],w=nt(s.shape),x=w[0],S=w[1],k=w[2],E=nt(y),A=E[0],R=E[1],N=E[2],P=Mr(s.dtype,me(y));P.fill(c);const O=r.data.get(s.dataId).values,_=r.data.get(i.dataId).values;for(let G=0;G<u;++G){const q=i.shape[0]===1?_:_.subarray(G*8,G*8+8);for(let D=0;D<g;++D)for(let L=0;L<v;++L)for(let K=0;K<m;++K){let j;const W=q[6]*L+q[7]*D+1;if(W===0)continue;const X=(q[0]*L+q[1]*D+q[2])/W,H=(q[3]*L+q[4]*D+q[5])/W,Y=J4(X,h,a),ce=J4(H,d,a);switch(o){case"nearest":j=SVe(O,d,h,x,S,k,G,ce,Y,K,c);break;case"bilinear":j=kVe(O,d,h,x,S,k,G,ce,Y,K,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const de=G*A+D*R+L*N+K;P[de]=j}return r.makeTensorInfo(y,s.dtype,P)}return{dataId:r.write(P,y,s.dtype),shape:s.shape,dtype:s.dtype}}const vVe={kernelName:V$,backendName:"cpu",kernelFunc:yVe};function J4(t,e,n){switch(n){case"reflect":return bVe(t,e);case"wrap":return wVe(t,e);case"nearest":return IVe(t,e);case"constant":default:return xVe(t)}}function bVe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return td(0,n,e-1)}function wVe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return td(0,n,e-1)}function xVe(t,e){return t}function IVe(t,e){return td(0,t,e-1)}function Nm(t,e,n,r,s,i,o,a,c,l,u){const d=o*r+a*s+c*i+l;return 0<=a&&a<e&&0<=c&&c<n?t[d]:u}function SVe(t,e,n,r,s,i,o,a,c,l,u){const d=Math.round(a),h=Math.round(c);return Nm(t,e,n,r,s,i,o,d,h,l,u)}function kVe(t,e,n,r,s,i,o,a,c,l,u){const d=Math.floor(a),h=Math.floor(c),m=d+1,g=h+1,v=(g-c)*Nm(t,e,n,r,s,i,o,d,h,l,u)+(c-h)*Nm(t,e,n,r,s,i,o,d,g,l,u),y=(g-c)*Nm(t,e,n,r,s,i,o,m,h,l,u)+(c-h)*Nm(t,e,n,r,s,i,o,m,g,l,u);return(m-a)*v+(a-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EVe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Xe(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:a,outputShape:c,indices:l}=ZX(o,s,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const CVe={kernelName:j$,backendName:"cpu",kernelFunc:EVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TVe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s.shape.length,a=s.shape[i],c=new Array(o-1);let l=0;for(let m=0;m<o;m++)m!==i&&(c[l++]=s.shape[m]);const u=new Array(o).fill(0),d=s.shape.slice();d[i]=1;const h=new Array(a);for(let m=0;m<h.length;m++){u[i]=m;const g=pd({inputs:{x:s},backend:n,attrs:{begin:u,size:d}});h[m]=fn({inputs:{x:g},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(g)}return h}const AVe={kernelName:GI,backendName:"cpu",kernelFunc:TVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r;Xe(s,"unsortedSegmentSum");const a=s.shape.length,c=i.shape.length,l=[],u=[],d=a-c;let h=i;for(let g=0;g<d;++g){const v=Wx({inputs:{input:h},backend:n,attrs:{dim:g+1}});h=v,u.push(v)}for(let g=0;g<o;++g){const v=Bl(g,"int32"),y=n.makeTensorInfo([],"int32",v),w=hX({inputs:{a:y,b:h},backend:n}),x=Rl({inputs:{x:w},backend:n,attrs:{dtype:"float32"}}),S=PS({inputs:{a:x,b:s},backend:n}),k=$y({inputs:{x:S},backend:n,attrs:{axis:0,keepDims:!1}});l.push(k),u.push(y),u.push(w),u.push(x),u.push(S),u.push(k)}const m=hQ({inputs:l,backend:n,attrs:{axis:0}});return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const _Ve={kernelName:qI,backendName:"cpu",kernelFunc:NVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ve=[EBe,iLe,TBe,NBe,dLe,$Be,OBe,DBe,LBe,MBe,UBe,jBe,WBe,KBe,QBe,JBe,tMe,rMe,iMe,SBe,aMe,lMe,dMe,hLe,hMe,lLe,mLe,mMe,oLe,yMe,bMe,wMe,IMe,kMe,CMe,AMe,_Me,RMe,PMe,FMe,BMe,zMe,VMe,HMe,WMe,qMe,XMe,YMe,ZMe,JMe,e4e,n4e,i4e,gBe,a4e,gLe,m4e,yLe,g4e,bLe,I4e,S4e,E4e,xLe,SLe,T4e,N4e,$4e,O4e,ELe,TLe,aLe,D4e,vMe,L4e,M4e,U4e,yBe,NLe,$Le,j4e,OLe,W4e,K4e,Q4e,J4e,tze,rze,sze,DLe,oze,cze,uze,fze,pze,gze,vze,LLe,wze,Sze,Cze,MLe,ULe,Nze,Rze,Dze,jLe,Lze,Mze,zze,pQ,Hze,bBe,GLe,Gze,Kze,Qze,Zze,cLe,CA,eUe,wBe,xBe,IBe,nUe,sUe,oUe,cUe,uUe,dUe,hUe,eBe,mUe,wUe,IUe,CUe,nBe,AUe,_Ue,RUe,rBe,kze,DUe,LUe,MUe,UUe,jUe,WUe,qUe,XUe,oBe,QUe,cBe,uBe,ZUe,eVe,nVe,sVe,oVe,pBe,r4e,cVe,uVe,fVe,pVe,gVe,vVe,HLe,CVe,AVe,_Ve,Bze];for(const t of $Ve)l8(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iu={},Ib={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function RVe(t,e){Iu[t]=e}function Ho(t,e){if(!(t in Iu)||e!=null){const r=PVe(t,e);if(r!==null)Iu[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Iu[t];return n==null||n.isContextLost()?(delete Iu[t],Ho(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Iu[t])}function OVe(t){if(!fe().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function PVe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??OVe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Iu[t]},!1),fe().getBool("SOFTWARE_WEBGL_ENABLED")&&(Ib.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Ib)||n.getContext("experimental-webgl",Ib):n.getContext("webgl2",Ib)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Wg;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Wg||(Wg={}));var bi;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(bi||(bi={}));var Pr;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Pr||(Pr={}));function Ry(t,e){return[e,t]}function DVe(t,e){return t*e}function Sb(t){const e=me(t),n=Math.ceil(e/4);return PT(n)}function np(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function FVe(t,e){const[n,r]=np(t,e);return n*r*4}function LO(t,e){const n=t;let r,s,i,o,a,c,l,u,d,h;return fe().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,l=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,c=n.RGBA8):(r=t.RGBA,s=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,l=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,c=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(t,e){const n=e();return fe().getBool("DEBUG")&&LVe(t),n}function LVe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+UVe(t,e))}const BVe=596e-10,MVe=65504;function zVe(t){return!!(fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||BVe<Math.abs(t)&&Math.abs(t)<MVe)}function UVe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function kb(t,e){return Nc(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function VVe(t,e){const n=Nc(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ze(t,()=>t.shaderSource(n,e)),ze(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function jVe(t,e){const n=Nc(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ze(t,()=>t.shaderSource(n,e)),ze(t,()=>t.compileShader(n)),fe().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw mQ(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const HVe=/ERROR: [0-9]+:([0-9]+):/g;function mQ(t,e){const n=HVe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),i=s.length.toString().length+2,o=s.map((d,h)=>Gf((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const c=o.slice(0,r-1),l=o.slice(r-1,r),u=o.slice(r);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Gf(l[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function WVe(t){return Nc(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function GVe(t,e){if(ze(t,()=>t.linkProgram(e)),!fe().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function J2(t,e){if(ze(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function qVe(t,e){const n=Nc(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ze(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ze(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function KVe(t,e){const n=Nc(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ze(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ze(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function XVe(t){return Nc(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function QVe(t,e){const n=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function YVe(t){return Nc(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function ez(t,e,n,r,s,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(ze(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),ze(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,i,o)),ze(t,()=>t.enableVertexAttribArray(a)),!0)}function ZVe(t,e,n){rje(t,n),ze(t,()=>t.activeTexture(t.TEXTURE0+n)),ze(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function JVe(t,e,n){return Nc(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function eje(t,e,n){return t.getUniformLocation(e,n)}function tje(t,e,n,r){ze(t,()=>ZVe(t,e,r)),ze(t,()=>t.uniform1i(n,r))}function eC(t,e,n){ze(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ze(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function tz(t,e){ze(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ze(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Eb(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+nje(t,e))}function nje(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Nc(t,e,n){const r=ze(t,()=>e());if(r==null)throw new Error(n);return r}function rje(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Nh(t,e=2){return me(t.slice(0,t.length-e))}function _h(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Cb(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Nh(t),..._h(t)]),e}function sje(t,e=!1){let n=fe().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=fe().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&fe().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,c)=>c>=t.length-2?B_(t[c]):t[c]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Ll(t).newShape);let s=me(t),i=null;t.length<=1&&s<=n?i=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Nh(t);let c=2,l=2;t.length&&([c,l]=_h(t)),s=a*(c/2)*(l/2),i=PT(s).map(u=>u*2)}else i=PT(s);return i}function Tb(t){return t%2===0}function qx(t,e){if(t=t.slice(-2),e=e.slice(-2),Dt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||Tb(n)&&Tb(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Tb(t[0])&&Tb(e[0])}let tC,nC;function ije(t){if(tC==null){const e=Ho(t);tC=e.getParameter(e.MAX_TEXTURE_SIZE)}return tC}function oje(t){if(nC==null){const e=Ho(t);nC=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,nC)}function aje(t){if(t===0)return 0;let e;const n=Ho(t);return Ji(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Ji(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Ji(t,e){return t.getExtension(e)!=null}function nz(t){try{if(Ho(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function cje(t){if(t===0)return!1;const e=Ho(t);if(t===1){if(!Ji(e,"OES_texture_float"))return!1}else if(!Ji(e,"EXT_color_buffer_float"))return!1;return AA(e)}function lje(t){if(t===0)return!1;const e=Ho(t);if(t===1){if(!Ji(e,"OES_texture_float")||!Ji(e,"WEBGL_color_buffer_float"))return!1}else{if(Ji(e,"EXT_color_buffer_float"))return AA(e);const r="EXT_color_buffer_half_float";if(Ji(e,r)){const s=e.getExtension(r);return uje(e,s)}return!1}return AA(e)}function AA(t){const e=LO(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function uje(t,e){const n=LO(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),a}function dje(t){return t!==2?!1:Ho(t).fenceSync!=null}function Oy(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&U(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=fe();Ze.registerFlag("HAS_WEBGL",()=>Ze.getNumber("WEBGL_VERSION")>0);Ze.registerFlag("WEBGL_VERSION",()=>nz(2)?2:nz(1)?1:0);Ze.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ze.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ze.get("WEBGL_VERSION")===2);Ze.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ze.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ze.registerFlag("WEBGL_PACK",()=>Ze.getBool("HAS_WEBGL"));Ze.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_CLIP",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_REDUCE",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_CONV_IM2COL",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ze.getBool("WEBGL_PACK"));Ze.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>ije(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>oje(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ze.getNumber("WEBGL_VERSION");return t===0?0:aje(t)});Ze.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ze.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!I8());Ze.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>cje(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ze.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ze.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ze.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>lje(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_FENCE_API_ENABLED",()=>dje(Ze.getNumber("WEBGL_VERSION")));Ze.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ze.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ze.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ze.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>I8()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ze.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ze.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ze.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ze.registerFlag("WEBGL_EXP_CONV",()=>!1);Ze.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ze.getBool("IS_TEST"));Ze.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ze.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ze.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ze.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ys(){let t,e,n,r,s,i,o,a,c,l;return fe().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",i="outputColor",o="out vec4 outputColor;",a=fe().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:c,defineRound:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(t,e,n="index"){const r=nt(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / ${s}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s}`:`index -= ${t[i]} * ${s}`;return`${o}; ${a};`}).join("")}function DS(t,e,n="index"){const r=nt(e);return r.map((s,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function fje(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let i=n-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function hje(t,e,n="index"){const r=t.map((i,o)=>o),s=fje(r,e);return s.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${s[o]}`,c=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s[o]}`:`index -= ${t[o]} * ${s[o]}`;return`${a}; ${c};`}).join("")}function BO(t){const e=nt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function MO(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const gQ=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:yQ}=_Re;function pje(t,e,n){const r=[];if(t.forEach(m=>{const g=me(m.shapeInfo.logicalShape);if(m.shapeInfo.isUniform?r.push(`uniform float ${m.name}${g>1?`[${g}]`:""};`):(r.push(`uniform sampler2D ${m.name};`),r.push(`uniform int offset${m.name};`)),n.enableShapeUniforms){const{uniformShape:v}=zO(n.packedInputs,m.shapeInfo.logicalShape,m.shapeInfo.texShape);switch(v.length){case 1:r.push(`uniform int ${m.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${m.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${m.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${m.name}Shape;`);break}r.push(`uniform ivec2 ${m.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(m=>{r.push(`uniform ${m.type} ${m.name}${m.arrayIndex?`[${m.arrayIndex}]`:""};`)});const s=r.join(`
`),i=t.map(m=>mje(m,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=ys(),c=vje(a);let l,u,d=xje(a);return e.isPacked?(l=gje(e.logicalShape,o,n.enableShapeUniforms),u=wje(a)):(l=yje(e.logicalShape,o,n.enableShapeUniforms),u=bje(a)),n.packedInputs&&(d+=Eje),[d,c,u,s,l,i,n.userCode].join(`
`)}function rp(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Lje(t,e);case 1:return Mje(t,e);case 2:return Uje(t,e);case 3:return jje(t,e);case 4:return Wje(t,e);case 5:return Gje(t);case 6:return qje(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function vQ(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Fje(t);case 1:return Bje(t,e);case 2:return zje(t,e);case 3:return Vje(t,e);default:return Hje(t,e)}}function mje(t,e,n=!1,r){let s="";n?s+=vQ(t,r):s+=rp(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?s+=Kje(t,e):s+=Xje(t,e)),s}function gje(t,e,n){switch(t.length){case 0:return bQ();case 1:return Cje(t,e,n);case 2:return Pje(t,e,n);case 3:return Aje(t,e,n);default:return _je(t,e,n)}}function yje(t,e,n){switch(t.length){case 0:return bQ();case 1:return Tje(t,e,n);case 2:return Dje(t,e,n);case 3:return Nje(t,e,n);case 4:return $je(t,e,n);case 5:return Rje(t,e);case 6:return Oje(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function vje(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function bje(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function wje(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function xje(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Ije}
    ${Sje}
    ${kje}
  `}const Ije=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Sje=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,kje=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Eje=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function bQ(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Cje(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Tje(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Aje(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),i=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Nje(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${DS(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=$d(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function _je(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),i=s*Math.ceil(t[t.length-2]/2);let o=i,a="",c="b, r, c";for(let l=2;l<t.length-1;l++)o*=t[t.length-l-1],a=`
      int b${l} = index / ${o};
      index -= b${l} * ${o};
    `+a,c=`b${l}, `+c;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${c});
    }
  `}function $je(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${DS(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=$d(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Rje(t,e){const n=$d(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Oje(t,e){const n=$d(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Pje(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Dt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function Dje(t,e,n){return Dt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Rd(t){return`offset${t}`}function Fje(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ys();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Lje(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,i]=t.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Rd(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,c]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${c}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function Bje(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,i=ys();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Mje(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${sp(t)}
      }
    `;const s=t.shapeInfo.texShape,i=s[0],o=s[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Rd(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function zje(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],c=ys();if(i!=null&&Dt(n,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${c.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${c.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `;const l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${l[0]}, ${l[1]}, row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `}function Uje(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Dt(n,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=i[0],m=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${m}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:a}=Ll(n),c=o;if(c.length<n.length){const h=ip(t,c),m=["row","col"];return`
      ${rp(h,e)}
      float ${s}(int row, int col) {
        return ${s}(${op(m,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${sp(t)}
      }
    `;const l=i[0],u=i[1],d=Rd(r);return u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${l}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function Vje(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),m=[1,2],g=ip(t,h),v=["b","row","col"];return`
        ${vQ(g,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${op(v,m)});
        }
      `}const a=ys();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const c=o[0],l=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${l}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function jje(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:c}=Ll(n),l=a;if(l.length<n.length){const v=ip(t,l),y=["row","col","depth"];return`
        ${rp(v,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${op(y,c)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${sp(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],m=t.shapeInfo.flatOffset;if(h===i&&m==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===o&&m==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const g=Rd(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${g};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Hje(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=ys();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=c[0],u=c[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),m="int b, int row, int col",g=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let v=2;v<o-1;v++)m=`int b${v}, `+m,h*=i[o-v-1],g=`b${v} * ${h} + `+g;return`
    vec4 ${r}(${m}) {
      int index = ${g};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${l});
      return ${s.texture2D}(${n}, uv);
    }
  `}function Wje(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:c,keptDims:l}=Ll(n);if(c.length<n.length){const x=ip(t,c),S=["row","col","depth","depth2"];return`
      ${rp(x,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${op(S,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${sp(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],m=d[1],g=`int stride2 = ${r}Shape[3];`,v=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(m===a&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${g}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(m===i&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const w=Rd(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${v}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${w});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${m}, index + ${w});
      return sampleTexture(${r}, uv);
    }
  `}function Gje(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],i=e[3]*s,o=e[2]*i,a=e[1]*o,{newShape:c,keptDims:l}=Ll(e);if(c.length<e.length){const v=ip(t,c),y=["row","col","depth","depth2","depth3"];return`
      ${rp(v)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${op(y,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${s})) +
          depth3;
        ${sp(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],m=d[1];if(m===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Rd(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${s} + depth3 + ${g};
      vec2 uv = uvFromFlat(${h}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function qje(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:i}=Ll(e);if(s.length<e.length){const y=ip(t,s),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${rp(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${op(w,i)});
      }
    `}const o=e[5],a=e[4]*o,c=e[3]*a,l=e[2]*c,u=e[1]*l;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${l}, ${c}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${sp(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,m=h[0],g=h[1];if(g===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${c}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${n}, uv);
      }
    `;const v=Rd(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${l} + depth * ${c} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${v};
      vec2 uv = uvFromFlat(${m}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function sp(t){const e=t.name,n=me(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Kje(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=yQ(t.shapeInfo.logicalShape,e.logicalShape),c=rn(o),l=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${d[x+l]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((x,S)=>`coords.${d[S+l]}`).join(", ");let m="return outputValue;";const v=me(t.shapeInfo.logicalShape)===1,w=me(e.logicalShape)===1;if(i===1&&!v&&!w)m=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!w)o===1?m=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:m=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=i-2,S=i-1;a.indexOf(x)>-1&&a.indexOf(S)>-1?m="return vec4(outputValue.x);":a.indexOf(x)>-1?m="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(S)>-1&&(m="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${c} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${h});
      ${m}
    }
  `}function Xje(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===c&&t.shapeInfo.flatOffset==null&&Dt(o,i))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const l=rn(c),u=yQ(t.shapeInfo.logicalShape,e.logicalShape),d=c-a;let h;const m=["x","y","z","w","u","v"];a===0?h="":c<2&&u.length>=1?h="coords = 0;":h=u.map(v=>`coords.${m[v+d]} = 0;`).join(`
`);let g="";return c<2&&a>0?g="coords":g=t.shapeInfo.logicalShape.map((v,y)=>`coords.${m[y+d]}`).join(", "),`
    float ${s}() {
      ${l} coords = getOutputCoords();
      ${h}
      return get${r}(${g});
    }
  `}function rn(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function zO(t,e,n){const{newShape:r,keptDims:s}=Ll(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):r,c=!t&&i>1&&!Dt(e,n)&&r.length<i||o;return{useSqueezeShape:c,uniformShape:c?a:e,keptDims:s}}function ip(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function op(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qje(t,e,n,r){const s=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=s.map(u=>u.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=pje(s,o,e),c=jVe(t.gl,a),l=t.createProgram(c);return fe().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:a,webGLProgram:l,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(l),Object.assign({program:e,fragmentShader:c,source:a,webGLProgram:l,inShapeInfos:i,outShapeInfo:o},wQ(t,e,l)))}function wQ(t,e,n){const r=[],s=[];let i,o,a,c=null,l=null;l=t.getUniformLocation(n,"NAN",!1),fe().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),r.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:s,infLoc:c,nanLoc:l,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function rz(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,i=e[r],o=i.shape;if(!Dt(s,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,c=i.isUniform?null:i.texData.texShape;if(!Dt(a,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${c} must match`)})}function Yje(t,e,n,r,s){e.program.enableShapeUniforms||(rz(e.inShapeInfos,n),rz([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),fe().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<n.length;++c){const l=n[c],{uniform:u,offset:d,shape:h,texShape:m}=e.variablesLocations[c];if(h){const{uniformShape:g}=zO(e.program.packedInputs,l.shape,l.texData.texShape);switch(g.length){case 1:t.gl.uniform1iv(h,new Int32Array(g));break;case 2:t.gl.uniform2iv(h,new Int32Array(g));break;case 3:t.gl.uniform3iv(h,new Int32Array(g));break;case 4:t.gl.uniform4iv(h,new Int32Array(g));break}}if(m&&t.gl.uniform2i(m,l.texData.texShape[0],l.texData.texShape[1]),u!=null){if(l.isUniform){if(me(l.shape)<2)t.gl.uniform1f(u,l.uniformValues[0]);else{let g=l.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),t.gl.uniform1fv(u,g)}continue}l.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,u,c)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const c=nt(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let c=0;c<e.program.customUniforms.length;++c){const l=e.program.customUniforms[c],u=e.customUniformLocations[c],d=s[c];if(l.type==="float")t.gl.uniform1fv(u,d);else if(l.type==="vec2")t.gl.uniform2fv(u,d);else if(l.type==="vec3")t.gl.uniform3fv(u,d);else if(l.type==="vec4")t.gl.uniform4fv(u,d);else if(l.type==="int")t.gl.uniform1iv(u,d);else if(l.type==="ivec2")t.gl.uniform2iv(u,d);else if(l.type==="ivec3")t.gl.uniform3iv(u,d);else if(l.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}t.executeProgram()}function Zje(t,e,n){let r="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const c=o.texData.texShape,{useSqueezeShape:l,uniformShape:u,keptDims:d}=zO(t.packedInputs,o.shape,c);let h="",m="",g="";if(u.length===1&&t.packedInputs){const E=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];h=`${E[0]>1}_${E[1]>1}`}else if(u.length===2&&!t.packedInputs)m=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const E=nt(u);g=`${E[0]===c[1]}_${E[E.length-1]===c[1]}`}const v=o.shape.length,y=u.length===2&&Dt(o.shape,c),w=me(o.shape)===1,x=Ih(o.shape,n.shape),S=!t.packedInputs&&v===n.shape.length&&Dt(c,n.texData.texShape),k=t.packedInputs||u.length>2?"":`${c[0]>1}_${c[1]>1}`;r+=`${v}_${S}_${l?d:""}_${u.length}_${w}_${x}_${y}_${h}_${m}_${g}_${k}_${a}`}else{const c=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${c}_${a}`}});const s=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+s+`${fe().getNumber("WEBGL_VERSION")}`,i}function ts(t){return fe().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jje{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Wg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ys();this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?DS(["r","c","d"],e):$d(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e6e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Wg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ys();this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?DS(["r","c","d"],e):$d(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t6e{constructor(e){this.variableNames=["A"],this.outTexUsage=bi.DOWNLOAD;const n=ys();this.outputShape=e,this.userCode=`
      ${gQ}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n6e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=bi.DOWNLOAD;const n=ys();this.outputShape=e,this.userCode=`
      ${gQ}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6e={R:0,G:1,B:2,A:3};class sz{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ys();this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++){const c=r[a];o+=`
          if(offset == ${a}) {
            result = values[${r6e[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?MO():BO(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${o}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s6e{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ys();this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length);let s="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const c=o*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?MO():BO(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6e(t){const e=ys(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return VVe(t,n)}function o6e(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return qVe(t,e)}function a6e(t){const e=new Uint16Array([0,1,2,2,1,3]);return KVe(t,e)}function Py(t,e,n,r,s,i){QVe(e,n);const o=XVe(t),a=t.TEXTURE_2D;return ze(t,()=>t.bindTexture(a,o)),ze(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ze(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ze(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ze(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),fe().getNumber("WEBGL_VERSION")===1?ze(t,()=>t.texImage2D(a,0,r,e,n,0,s,i,null)):ze(t,()=>t.texStorage2D(a,1,r,e,n)),ze(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function xQ(t){return t.internalFormatFloat}function c6e(t,e,n,r){const[s,i]=Ry(e,n);return Py(t,s,i,xQ(r),r.textureFormatFloat,t.FLOAT)}function IQ(t){return t.internalFormatHalfFloat}function l6e(t,e,n,r){const[s,i]=Ry(e,n);return Py(t,s,i,IQ(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function SQ(t){return t.downloadTextureFormat}function u6e(t,e,n,r){const[s,i]=Ry(e,n);return Py(t,s,i,SQ(r),t.RGBA,t.UNSIGNED_BYTE)}function kQ(t){return t.internalFormatPackedFloat}function d6e(t,e,n,r){const[s,i]=np(e,n);return Py(t,s,i,kQ(r),t.RGBA,t.FLOAT)}function EQ(t){return t.internalFormatPackedHalfFloat}function f6e(t,e,n,r){const[s,i]=np(e,n);return Py(t,s,i,EQ(r),t.RGBA,r.textureTypeHalfFloat)}function h6e(t,e,n){return ze(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ez(t,e,"clipSpacePos",n,3,20,0)&&ez(t,e,"uv",n,2,20,12)}function p6e(t,e,n,r,s,i){ze(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,c;s instanceof Uint8Array?(o=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,c=t.RGBA):(o=new Float32Array(n*r*4),a=t.FLOAT,c=i.internalFormatPackedFloat),o.set(s),fe().getNumber("WEBGL_VERSION")===2?ze(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,o)):ze(t,()=>t.texImage2D(t.TEXTURE_2D,0,c,n,r,0,t.RGBA,a,o)),ze(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function m6e(t,e,n){ze(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?fe().getNumber("WEBGL_VERSION")===2?ze(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ze(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):fe().getNumber("WEBGL_VERSION")===2?ze(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ze(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ze(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function g6e(t,e,n,r){const s=t.createBuffer();ze(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return ze(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ze(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ze(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function y6e(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function v6e(t,e,n,r){const[s,i]=Ry(e,n),o=4,a=new Uint8Array(DVe(e*n,o));return ze(t,()=>t.readPixels(0,0,s,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function b6e(t,e,n,r,s,i,o,a){const c=t,l=new Float32Array(FVe(i,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}function w6e(t,e,n){const r=new Float32Array(e*n*4);return ze(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rC{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=fe().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,RVe(n,e)):this.gl=Ho(n),e=this.gl,fe().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>ze(i,()=>i.createVertexArray()),this.bindVertexArray=o=>ze(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>ze(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>ze(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ze(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>ze(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ze(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>ze(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),fe().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=kb(this.gl,i),Ji(this.gl,o))this.textureHalfFloatExtension=kb(this.gl,o);else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ji(this.gl,s))this.colorBufferHalfFloatExtension=kb(this.gl,s);else if(fe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ji(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ji(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=o6e(this.gl),this.indexBuffer=a6e(this.gl),this.framebuffer=YVe(this.gl),this.textureConfig=LO(this.gl,this.textureHalfFloatExtension)}get debug(){return fe().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ze(e,()=>e.finish()),ze(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ze(e,()=>e.deleteFramebuffer(this.framebuffer)),ze(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ze(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ze(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),c6e(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),l6e(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),u6e(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),m6e(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),p6e(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),f6e(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),d6e(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(tz(this.gl,this.framebuffer),this.outputTexture=null),ze(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>v6e(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,i,o){return b6e(this.gl,e,n,r,s,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return y6e(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=g6e(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(fe().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=s.clientWaitSync(i,0,0);return o===s.ALREADY_SIGNALED||o===s.CONDITION_SATISFIED},n=i}else fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>w6e(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=i6e(n));const r=WVe(n);ze(n,()=>n.attachShader(r,this.vertexShader)),ze(n,()=>n.attachShader(r,e)),GVe(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&J2(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ze(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),h6e(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ze(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&J2(this.gl,this.program),ze(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?JVe(this.gl,e,n):eje(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ze(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),tje(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,i]=np(n,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&J2(this.gl,this.program),Eb(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ze(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ze(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=kb(this.gl,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await PM(()=>this.disposed||this.isQueryAvailable(e,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=x6e(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in fe().platform&&(r=fe().platform.setTimeoutCustom.bind(fe().platform)),PM(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),eC(this.gl,e,this.framebuffer),this.debug&&Eb(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(eC(this.gl,this.outputTexture,this.framebuffer),this.debug&&Eb(this.gl)):tz(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;eC(s,e,this.framebuffer),this.debug&&Eb(s),this.outputTexture=e,ze(s,()=>s.viewport(0,0,n,r)),ze(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),ze(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function x6e(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:I6e,bincountImpl:CQ,bincountReduceImpl:S6e,bitwiseAndImpl:k6e,castImpl:E6e,ceilImpl:C6e,concatImpl:T6e,equalImpl:A6e,expImpl:N6e,expm1Impl:_6e,floorImpl:$6e,gatherNdImpl:R6e,gatherV2Impl:O6e,greaterImpl:P6e,greaterEqualImpl:D6e,lessImpl:F6e,lessEqualImpl:L6e,linSpaceImpl:B6e,logImpl:M6e,maxImpl:z6e,maximumImpl:U6e,minimumImpl:V6e,multiplyImpl:j6e,negImpl:H6e,notEqualImpl:W6e,prodImpl:G6e,raggedGatherImpl:q6e,raggedRangeImpl:K6e,raggedTensorToTensorImpl:X6e,rangeImpl:Q6e,rsqrtImpl:Y6e,scatterImpl:Z6e,sigmoidImpl:J6e,simpleAbsImpl:TQ,sliceImpl:e5e,sparseFillEmptyRowsImpl:t5e,sparseReshapeImpl:n5e,sparseSegmentReductionImpl:AQ,sqrtImpl:r5e,staticRegexReplaceImpl:s5e,stridedSliceImpl:i5e,stringNGramsImpl:o5e,stringSplitImpl:a5e,stringToHashBucketFastImpl:c5e,subImpl:l5e,tileImpl:u5e,topKImpl:d5e,transposeImpl:UO,uniqueImpl:f5e}=mBe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ds(t,e){return e===1?[t]:NQ(t,e)}function h5e(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p5e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ts(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ds("rc",this.rank),r=rn(this.rank),s=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Q{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${m5e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?MO():BO(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function m5e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?hje(["r","c","d"],"inputShape"):$d(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g5e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=oz(n,r),i=az(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=iz(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const c=this.freeTextures[i].pop();return this.usedTextures[i].push(c),c}let a;return s===Pr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Pr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Pr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Pr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Pr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const i=oz(r,s),o=az(n,i,s);o in this.freeTextures||(this.freeTextures[o]=[]);const a=iz(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),c=fe().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[o],u=l&&l.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function y5e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function iz(t,e,n,r,s){const i=v5e(e,r);let o;if(s){const[c,l]=np(t[0],t[1]);o=c*l}else{const[c,l]=Ry(t[0],t[1]);o=c*l}const a=y5e(n,i);return o*a}function v5e(t,e){switch(t){case Pr.PACKED_2X2_FLOAT32:return kQ(e);case Pr.PACKED_2X2_FLOAT16:return EQ(e);case Pr.UNPACKED_FLOAT32:return xQ(e);case Pr.UNPACKED_FLOAT16:return IQ(e);case Pr.PACKED_4X1_UNSIGNED_BYTE:return SQ(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function b5e(t){return fe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Pr.PACKED_2X2_FLOAT32:Pr.UNPACKED_FLOAT32:t?Pr.PACKED_2X2_FLOAT16:Pr.UNPACKED_FLOAT16}function oz(t,e){if(t===bi.UPLOAD)return Pr.PACKED_2X2_FLOAT32;if(t===bi.RENDER||t==null)return b5e(e);if(t===bi.DOWNLOAD||t===bi.PIXELS)return Pr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function az(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ma{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const uo="if (isnan(x)) return x;",w5e="return x;",cz="return abs(x);",x5e="return (x >= 0.0) ? x : (exp(x) - 1.0);",I5e=uo+`
  return (x < 0.0) ? 0.0 : x;
`,S5e=uo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,rl="return x;",k5e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5e="return x;",C5e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,T5e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,A5e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,N5e="return 1.0 / (1.0 + exp(-1.0 * x));";class cl{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _5e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length);const n=e.length,r=ds("rc",n),s=rn(n),i=h5e(n,r),o=r.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5e=kR,R5e=1e-7,O5e=1e-4,Ab={};function P5e(t){return t in Ab||(Ab[t]={}),Ab[t]}const D5e=fe().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),F5e=600;function L5e(){return fe().global.screen==null?1024:fe().global.screen.height*fe().global.screen.width*window.devicePixelRatio*F5e/1024/1024}class FS extends L_{nextDataId(){return FS.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!fe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof rC)n=e;else{const r=Ho(fe().getNumber("WEBGL_VERSION"),e);n=new rC(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Ho(fe().getNumber("WEBGL_VERSION"));n=new rC(r),this.binaryCache=P5e(fe().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new g5e(this.gpgpu),this.numMBBeforeWarning=L5e(),this.texData=new n8(this,na())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,i,o){const a=this.makeTensorInfo(n,r),c=this.texData.get(a.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[s,i]},c.texShape=[s,i];const l=Cb(n),u=new sz(l,!1,o),d=this.runWebGLProgram(u,[a],r,[[s,i]]);return d.shape=n,c.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((fe().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||fe().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:bi.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,i){if(fe().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:bi.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:o,shape:a,isPacked:c}=n;if(o!=null){let h;c?h=new cl(a,rl):h=new ma(a,rl);const m=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:s}],s),g=this.readSync(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const l=this.activeTimers!=null;let u;l&&(u=ws());let d;if(s==="complex64"){const h=this.readSync(i.real.dataId),m=this.readSync(i.imag.dataId);d=vc(h,m)}else d=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=ws()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const g=this.pendingRead.get(e);return new Promise(v=>g.push(v))}const n=this.texData.get(e),{values:r,shape:s,slice:i,dtype:o,complexTensorInfos:a,isPacked:c}=n;if(i!=null){let g;c?g=new cl(s,rl):g=new ma(s,rl);const v=this.runWebGLProgram(g,[{dataId:e,shape:s,dtype:o}],o),y=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(fe().getBool("DEBUG")&&!fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&fe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,u;if(o!=="complex64"&&fe().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const g=this.texData.get(u.dataId);l=this.gpgpu.createBufferFromTexture(g.texture.texture,...Sb(s))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const g=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),v=g[0],y=g[1];d=vc(v,y)}else if(l==null)d=this.getValuesFromTexture(e);else{const g=me(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(l,g)}if(u!=null&&this.disposeIntermediateTensorInfo(u),l!=null){const g=this.gpgpu.gl;ze(g,()=>g.deleteBuffer(l))}const h=this.convertAndCacheOnCPU(e,d),m=this.pendingRead.get(e);return this.pendingRead.delete(e),m.forEach(g=>g(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&na().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:i,slice:o,dtype:a,isPacked:c,texture:l}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let m;c?m=new cl(i,rl):m=new ma(i,rl);const g=this.runWebGLProgram(m,[{dataId:e,shape:i,dtype:a}],a),v=this.readToGPU(g,n);return this.disposeIntermediateTensorInfo(g),v}if(l==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=na().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Sl(s));return kt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return kt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!zVe(r))throw fe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),i=me(n);if(fe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),m=this.texData.get(h.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(m.texture.texture,...Sb(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),g}const o=fe().getBool("WEBGL_PACK")&&s===!0,a=o?Cb(n):n,c=o?new n6e(a):new t6e(a),l=this.runWebGLProgram(c,[{shape:a,dtype:r,dataId:e}],"float32"),u=this.texData.get(l.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),d}timerAvailable(){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=rd(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),o=rd(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(i);a.kernelMs=tEe(c),a.getExtraProfileInfo=()=>c.map((l,u)=>({name:o[u],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ws(),endMs:null}}endTimer(e){return fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ws(),e)}async getQueryTime(e){if(fe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:i,isPacked:o,slice:a}=this.texData.get(e),c=a&&a.origDataId||e,l=this.dataRefCount.get(c);l>1?this.dataRefCount.set(c,l-1):(this.dataRefCount.delete(c),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=D5e){return fe().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&me(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){gi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return $5e(e.shape,n)}packedUnaryOp(e,n,r){const s=new cl(e.shape,n),i=this.compileAndRun(s,[e],r);return na().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=TQ(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(fe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cz,e.dtype);const n=new ma(e.shape,cz),r=this.compileAndRun(n,[e]);return na().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&g0(r[0])){const i=r.map(o=>dl(o));s=this.write(i,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return na().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new _5e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new p5e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[Nh(e.shape),..._h(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Nh(n),..._h(n)],o=new _Q(i,r),a=!0,c=[r],l=this.runWebGLProgram(o,[s],e.dtype,c,a);return{dataId:l.dataId,shape:n,dtype:l.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:o}=r;if(n!=null){const h=me(i),m=n[0]*n[1]*4;U(h<=m,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Cb(i);let c;s?c=new e6e(a):c=new Jje(a);const l=!0,u=[n??Sb(a)],d=this.runWebGLProgram(c,[{shape:a,dtype:o,dataId:e}],o,u,l,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,s,i=!1,o){const a=this.makeTensorInfo(e.outputShape,r),c=this.texData.get(a.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===Wg.DENSE){const w=o??Sb(e.outputShape);c.texShape=w.map(x=>x*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),me(a.shape)===0)return c.values=Mr(a.dtype,0),a;const l=[],u=n.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(w.dataId);if(x.texture==null){if(!e.packedInputs&&me(w.shape)<=fe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!x.isPacked!=!!e.packedInputs)w=x.isPacked?this.unpackTensor(w):this.packTensor(w),l.push(w),x=this.texData.get(w.dataId);else if(x.isPacked&&!qx(x.shape,w.shape)){const S=w,k=w.shape;w.shape=x.shape,w=this.packedReshape(w,k),l.push(w),x=this.texData.get(w.dataId),S.shape=k}return{shape:w.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:c,isUniform:!1},h=Zje(e,u,d),m=this.getAndSaveBinary(h,()=>Qje(this.gpgpu,e,u,d)),g=this.activeTimers!=null;let v;g&&(v=this.startTimer()),fe().get("ENGINE_COMPILE_ONLY")||Yje(this.gpgpu,m,u,d,s),l.forEach(w=>this.disposeIntermediateTensorInfo(w)),g&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const y=fe().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const w=ws();w-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!fe().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){const w=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),w}return a}compileAndRun(e,n,r,s,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(fe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ae(()=>{if(!fe().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=fe().getBool("DEBUG");fe().set("DEBUG",!1);const n=this.abs(rt(1e-8)).dataSync()[0];if(fe().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?R5e:O5e}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:i,texture:o,usage:a,isPacked:c}=n;if(o!=null)return;const l=this.activeTimers!=null;let u;l&&(u=ws());let d=n.texShape;if(d==null&&(d=sje(r,c),n.texShape=d),i!=null){const h=Cb(r);let m,g=d[1],v=d[0];const y=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(c||!y)&&([g,v]=np(d[0],d[1])),c?m=new s6e(h,y):m=new sz(h,y);const w=y?[v,g]:d,x=this.makeTensorInfo(w,s),S=this.texData.get(x.dataId);y?S.usage=bi.PIXELS:S.usage=bi.UPLOAD,S.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,v,i);const k=[[v,g]],A=this.runWebGLProgram(m,[x],s,k,!0),R=this.texData.get(A.dataId);n.texShape=R.texShape,n.isPacked=R.isPacked,n.usage=R.usage,fe().get("ENGINE_COMPILE_ONLY")?this.disposeData(A.dataId):(n.texture=R.texture,n.values=null,this.texData.delete(A.dataId)),this.disposeIntermediateTensorInfo(x),l&&(this.uploadWaitMs+=ws()-u)}else{const h=this.acquireTexture(d,a,s,c);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=B5e(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*Ix(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await p9(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(mQ(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:c}=wQ(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=c}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:o,channels:a}=e,c=na().backend;if(!c.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=c.writeTexture(s,n,r,i,o,a);return na().makeTensorFromDataId(l,n,r,c)}}FS.nextDataId=0;function B5e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */S8()&&C8("webgl",()=>new FS,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VO=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class md{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=bt(n,r),this.enableShapeUniforms=ts(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Od=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class ap{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=bt(n,r);const i=this.outputShape.length;this.enableShapeUniforms=ts(i);let o="";if(s)if(i===0||me(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${rn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=ds("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const M5e={kernelName:L0,backendName:"webgl",kernelFunc:ai};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),a=ai({inputs:{x:r},backend:n}),c=ai({inputs:{x:s},backend:n});return o.complexTensorInfos={real:a,imag:c},i}const z5e={kernelName:q_,backendName:"webgl",kernelFunc:Kl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Q="return (a < 0.) ? b * a : a;",RQ=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function U5e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Bl(i,"float32")),a=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ap(RQ,s.shape,o.shape):new md($Q,s.shape,o.shape),c=n.runWebGLProgram(a,[s,o],"float32");return n.disposeIntermediateTensorInfo(o),c}const V5e={kernelName:pI,backendName:"webgl",kernelFunc:U5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ="return (a < 0.) ? b * a : a;",PQ=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function j5e(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,i=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ap(PQ,r.shape,s.shape):new md(OQ,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],"float32")}const H5e={kernelName:OI,backendName:"webgl",kernelFunc:j5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cp="if (isnan(x)) return x;";function zt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:i})=>{const{x:o}=s,a=i,c=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,c);return a.makeTensorInfo(o.shape,c,h)}const l=fe().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return l?u=new cl(o.shape,e):u=new ma(o.shape,t),a.runWebGLProgram(u,[o],c)}}function Wr({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:o,backend:a})=>{const{a:c,b:l}=o,u=a;if(r&&c.dtype==="complex64"){const g=u.texData.get(c.dataId),v=u.texData.get(l.dataId),[y,w]=[[g.complexTensorInfos.real,v.complexTensorInfos.real],[g.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(S=>{const[k,E]=S,A={dataId:k.dataId,dtype:k.dtype,shape:c.shape},R={dataId:E.dataId,dtype:E.dtype,shape:l.shape},N=new md(t,c.shape,l.shape);return u.runWebGLProgram(N,[A,R],ni(k.dtype,E.dtype))}),x=Kl({inputs:{real:y,imag:w},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(w),x}const d=i||ni(c.dtype,l.dtype);if((c.dtype==="string"||l.dtype==="string"||u.shouldExecuteOnCPU([c,l]))&&s!=null){const g=u.texData.get(c.dataId).values,v=u.texData.get(l.dataId).values,y=c.dtype==="string"?bc(g):g,w=c.dtype==="string"?bc(v):v,[x,S]=s(c.shape,l.shape,y,w,d),k=u.makeTensorInfo(S,d),E=u.texData.get(k.dataId);return E.values=x,k}const h=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let m;return h?m=new ap(e,c.shape,l.shape,n):m=new md(t,c.shape,l.shape),u.runWebGLProgram(m,[c,l],d)}}function Gg(t,e=!1){if(t==="linear")return e?E5e:w5e;if(t==="relu")return e?T5e:I5e;if(t==="elu")return e?C5e:x5e;if(t==="relu6")return e?A5e:S5e;if(t==="prelu")return e?PQ:OQ;if(t==="leakyrelu")return e?RQ:$Q;if(t==="sigmoid")return e?N5e:k5e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DQ{constructor(e,n,r,s=!1,i=!1,o=!1,a=null,c=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=ts(this.outputShape.length);const u=s?e[1]:e[2],d=Math.ceil(u/2),h=s?"i * 2, rc.y":"rc.y, i * 2",m=i?"rc.z, i * 2":"i * 2, rc.z",g=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",w="";a&&(c?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:l?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let S="rc.x",k="rc.x";e[0]<n[0]?S=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(k=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${S};
        int batchB = ${k};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${m});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${g[0]} * ${v[0]});
          result += (${g[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lz={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class uz{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=bt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dz="return a * b;";function jO(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=ni(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),c=n.texData.get(s.dataId),l=new uz(lz.REAL,r.shape,s.shape),u=new uz(lz.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:s.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:s.shape}],h=n.runWebGLProgram(l,d,"float32"),m=n.runWebGLProgram(u,d,"float32"),g=Kl({inputs:{real:h,imag:m},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),c=n.texData.get(s.dataId),[l,u]=j6e(r.shape,s.shape,a.values,c.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=l,d}let o;return fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new ap(dz,r.shape,s.shape):o=new md(dz,r.shape,s.shape),n.runWebGLProgram(o,[r,s],i)}const W5e={kernelName:G0,backendName:"webgl",kernelFunc:jO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5e(t,e,n){const r=[Nh(t.shape),..._h(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},i=[Nh(e),..._h(e)],o=new _Q(i,r),a=!0,c=[r],l=n.runWebGLProgram(o,[s],t.dtype,c,a);return{dataId:l.dataId,shape:e,dtype:l.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:i}=r,o=n,a=me(s.shape),c=r8(i,a),l=me(c);U(a===l,()=>`The new shape (${c}) has ${l} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(s.dataId);return u.isPacked&&!qx(s.shape,c)&&!(u.texture!==null&&qx(u.shape,c))?G5e(s,c,o):(o.incRef(s.dataId),{dataId:s.dataId,shape:c,dtype:s.dtype})}const q5e={kernelName:DI,backendName:"webgl",kernelFunc:Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fz{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];const a=Math.floor(r/4)*4,c=r%4;let l="sumValue += dot(values, ones);";if(n!=null){const d=1/n;l=`sumValue += dot(values * ${bh(d)?d.toPrecision(2):d}, ones);`}let u="";i%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${a};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K5e{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:o}=e;this.outputShape=[s,o];let a="0.0",c="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",c="min"):n==="max"&&(a="-1.0 / 1e-20",c="max");let l=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?l="sumValue":n==="prod"?l="prodValue":n==="all"?l="allValue":n==="any"&&(l="anyValue");const u=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,m="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");let g="";i%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=wS(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Pd(t,e,n,r){const s=X5e(t.shape);let i=t;for(let o=0;o<s.length;o++){const{inSize:a,windowSize:c,outSize:l}=s[o];let u,d;n==="mean"?u=o===0?new fz({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},a):new fz({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l}):u=new K5e({windowSize:c,inSize:a,batchSize:t.shape[0],outSize:l},n),d=i,i=r.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q5e{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const s=rn(this.rank),i=Y5e(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Y5e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z5e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[n[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=rn(this.rank),i=NQ("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,c=`++${i[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${c}) {
        result[1] = ${l};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${c}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(t,e,n){const r=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Z5e(t.shape,e):new Q5e(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5e(t,e,n,r){const s=e,i=t.shape.length,o=Nt(s,t.shape);let a=o;const c=Pn(a,i),l=c!=null;let u=t;l&&(u=LS(t,c,r),a=Xn(a.length,i)),jr("sum",a,i);const[d,h]=Cr(u.shape,a);let m=d;n&&(m=Kn(d,o));const g=me(h),y=me(t.shape)/g,w=Pe({inputs:{x:u},attrs:{shape:[y,g]},backend:r}),x=W$(t.dtype),S=Pd(w,x,"sum",r),k=Pe({inputs:{x:S},attrs:{shape:m},backend:r});return r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(S),l&&r.disposeIntermediateTensorInfo(u),k}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r;return J5e(s,i,o,n)}const eHe={kernelName:UI,backendName:"webgl",kernelFunc:BS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:i}=r,o=n,a=s.shape.length,c=new Array(a);for(let u=0;u<c.length;u++)c[u]=s.shape[i[u]];let l;if(o.shouldExecuteOnCPU([s])){const d=o.texData.get(s.dataId).values,h=UO(d,s.shape,s.dtype,i,c);l=o.makeTensorInfo(c,s.dtype);const m=o.texData.get(l.dataId);m.values=h}else l=LS(s,i,o);return l}const tHe={kernelName:qf,backendName:"webgl",kernelFunc:ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQ=1e3;function Kx({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:c=null}){const l=t.shape.length,u=e.shape.length,d=n?t.shape[l-2]:t.shape[l-1],h=r?e.shape[u-1]:e.shape[u-2],m=n?t.shape[l-1]:t.shape[l-2],g=r?e.shape[u-2]:e.shape[u-1],v=t.shape.slice(0,-2),y=e.shape.slice(0,-2),w=me(v),x=me(y),k=bt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([m,g]);U(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const E=n?[w,d,m]:[w,m,d],A=r?[x,g,h]:[x,h,g],R=Pe({inputs:{x:t},backend:s,attrs:{shape:E}}),N=Pe({inputs:{x:e},backend:s,attrs:{shape:A}}),P=[R,N],O=Math.max(w,x),_=n?R.shape[1]:R.shape[2],M=i!=null,G=o!=null,q=c==="leakyrelu",D=c!=null?Gg(c,!0):null,L=M||G||q||D!=null;let K;if((m===1||g===1)&&_>FQ&&L===!1){let W=R,X=N;n&&(W=ms({inputs:{x:R},backend:s,attrs:{perm:[0,2,1]}}),P.push(W)),r&&(X=ms({inputs:{x:N},backend:s,attrs:{perm:[0,2,1]}}),P.push(X));const H=g!==1,Y=g===1;let ce=W;H&&(ce=Pe({inputs:{x:W},backend:s,attrs:{shape:[O,_,1]}}),P.push(ce));const de=g===1?2:1;let ge=X;Y&&(ge=Pe({inputs:{x:X},backend:s,attrs:{shape:[O,1,_]}}),P.push(ge));const be=jO({inputs:{a:ce,b:ge},backend:s});K=BS({inputs:{x:be},backend:s,attrs:{axis:de,keepDims:!0}}),P.push(be)}else{const W=ni(t.dtype,e.dtype),X=new DQ(E,A,[O,m,g],n,r,M,D,G,q),H=[R,N];if(i!=null&&H.push(i),G&&H.push(o),q){const Y=s.makeTensorInfo([],"float32",Bl(a,"float32"));H.push(Y),P.push(Y)}K=s.runWebGLProgram(X,H,W)}const j=Pe({inputs:{x:K},backend:s,attrs:{shape:k}});P.push(K);for(const W of P)s.disposeIntermediateTensorInfo(W);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nHe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;return Kx({a:s,b:i,transposeA:c,transposeB:l,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const rHe={kernelName:Sx,backendName:"webgl",kernelFunc:nHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hz="return abs(x);";function sHe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=TQ(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let s;return fe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new cl(r.shape,hz):s=new ma(r.shape,hz),n.runWebGLProgram(s,[r],r.dtype)}const iHe={kernelName:G1,backendName:"webgl",kernelFunc:sHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oHe=uo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,aHe=zt({opSnippet:oHe}),cHe={kernelName:y0,backendName:"webgl",kernelFunc:aHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lHe=uo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,uHe=zt({opSnippet:lHe}),dHe={kernelName:v0,backendName:"webgl",kernelFunc:uHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pz="return a + b;",fHe=Wr({opSnippet:pz,packedOpSnippet:pz,supportsComplex:!0,cpuKernelImpl:I6e}),hHe={kernelName:Xh,backendName:"webgl",kernelFunc:fHe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pHe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mHe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tw(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return ai({inputs:{x:r[0]},backend:n});if(r.length>fe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(r.length/2),l=tw({inputs:r.slice(0,c),backend:n}),u=tw({inputs:r.slice(c),backend:n});return tw({inputs:[l,u],backend:n})}const s=r.map(c=>c.dtype).reduce((c,l)=>ni(c,l)),i=r.map(c=>c.shape),a=fe().getBool("WEBGL_PACK")?new mHe(r[0].shape,i):new pHe(r[0].shape,i);return n.runWebGLProgram(a,r,s)}const gHe={kernelName:q1,backendName:"webgl",kernelFunc:tw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,c=Nt(i,s.shape);let l=c;const u=Pn(l,a);let d=s;u!=null&&(d=ms({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Xn(l.length,a)),jr("all",l,a);const[h,m]=Cr(d.shape,l),g=me(m),v=Pe({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),y=Pd(v,v.dtype,"all",n);let w;if(o){const x=Kn(h,c);w=Pe({inputs:{x:y},backend:n,attrs:{shape:x}})}else w=Pe({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),w}const vHe={kernelName:U_,backendName:"webgl",kernelFunc:yHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,c=Nt(i,s.shape);let l=c;const u=Pn(l,a);let d=s;u!=null&&(d=ms({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Xn(l.length,a)),jr("any",l,a);const[h,m]=Cr(d.shape,l),g=me(m),v=Pe({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),y=Pd(v,v.dtype,"any",n);let w;if(o){const x=Kn(h,c);w=Pe({inputs:{x:y},backend:n,attrs:{shape:x}})}else w=Pe({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),w}const wHe={kernelName:V_,backendName:"webgl",kernelFunc:bHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xHe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IHe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,c=a.length,l=rn(c),u=ds("coords",c);let d,h;if(o===1){h=c+1;const N=rn(h);d=`
        ${N} sourceLocR = ${N}(${u.join()}, 0);
        ++${u[c-1]};
        ${N} sourceLocG = ${N}(${u.join()}, 0);
        ++${u[c-2]};
        ${N} sourceLocA = ${N}(${u.join()}, 0);
        --${u[c-1]};
        ${N} sourceLocB = ${N}(${u.join()}, 0);
        --${u[c-2]};`}else h=c,d=`
        ${l} sourceLocR = coords;
        ++${u[c-1]};
        ${l} sourceLocG = coords;
        ++${u[c-2]};
        ${l} sourceLocA = coords;
        --${u[c-1]};
        ${l} sourceLocB = coords;
        --${u[c-2]};`;const m=["x","y","z","w","u","v"].slice(0,h),g="."+m[h-1],v=m.map(N=>"int "+N),y=ds("sourceLocR",h-1).concat("inIdx.r"),w=ds("sourceLocG",h-1).concat("inIdx.g"),x=ds("sourceLocB",h-1).concat("inIdx.b"),S=ds("sourceLocA",h-1).concat("inIdx.a"),k=r==="max"?"greaterThan":"lessThan",E=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${S.join()})));`,A=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${S.join()}) : 0.)`,R=s?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${m.join()}),
                                          vec2(${m.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${m.join()}),
                               vec2(${m.slice(-2).join()}));
      }
      ${R}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${u[c-1]} < ${a[c-1]-1};
        bool hasNextRow = ${u[c-2]} < ${a[c-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${g}, sourceLocG${g},
          sourceLocB${g}, sourceLocA${g}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${A};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${E}
          vec4 candidate = ${A};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${k}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(t,e,n,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const o=wS(i),a={windowSize:o,inSize:i,batchSize:s,outSize:Math.ceil(i/o)},c=new xHe(a,n,r==null),l=[e];r!=null&&l.push(r);const u=t.runWebGLProgram(c,l,"int32");if(u.shape[1]===1)return u;const d=LQ(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function BQ(t,e,n,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],o=wS(i),a=new IHe(s,o,n,r==null),c=r==null?[e]:[e,r],l=t.runWebGLProgram(a,c,"int32");if(l.shape.length===e.shape.length){const u=BQ(t,e,n,l);return t.disposeIntermediateTensorInfo(l),u}return l}function MQ(t,e,n,r){const s=[n];if(jr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!fe().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let c=e;a&&(c=t.unpackTensor(e),i.push(c));const[l,u]=Cr(c.shape,s),d=me(u),h=Pe({inputs:{x:c},backend:t,attrs:{shape:[-1,d]}});i.push(h);const m=LQ(t,h,r);i.push(m);const g=Pe({inputs:{x:m},backend:t,attrs:{shape:l}});return i.forEach(v=>t.disposeIntermediateTensorInfo(v)),g}return BQ(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Nt(i,s.shape);const a=Pn(o,s.shape.length);let c=s;const l=[];a!=null&&(c=ms({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(c),o=Xn(o.length,c.shape.length)),jr("argMax",[o[0]],c.shape.length);const u=MQ(n,c,o[0],"max");return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const kHe={kernelName:K1,backendName:"webgl",kernelFunc:SHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i}=r;let o=Nt(i,s.shape);const a=Pn(o,s.shape.length);let c=s;const l=[];a!=null&&(c=ms({inputs:{x:s},backend:n,attrs:{perm:a}}),l.push(c),o=Xn(o.length,c.shape.length)),jr("argMin",[o[0]],c.shape.length);const u=MQ(n,c,o[0],"min");return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const CHe={kernelName:X1,backendName:"webgl",kernelFunc:EHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const THe=uo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,AHe=zt({opSnippet:THe}),NHe={kernelName:b0,backendName:"webgl",kernelFunc:AHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _He=uo+"return log(x + sqrt(x * x + 1.0));",$He=zt({opSnippet:_He}),RHe={kernelName:w0,backendName:"webgl",kernelFunc:$He};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OHe=uo+`
  return atan(x);
`,PHe=zt({opSnippet:OHe}),DHe={kernelName:x0,backendName:"webgl",kernelFunc:PHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FHe=VO+`
  return atan(a, b);
`,LHe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Od+`
  return result;
`,BHe=Wr({opSnippet:FHe,packedOpSnippet:LHe}),MHe={kernelName:S0,backendName:"webgl",kernelFunc:BHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zHe=uo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,UHe=zt({opSnippet:zHe}),VHe={kernelName:I0,backendName:"webgl",kernelFunc:UHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qg{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,m=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(v||(x="-1.0 / 1e-20"),r){this.userCode=`
        const ivec2 strides = ivec2(${a}, ${c});
        const ivec2 pads = ivec2(${m}, ${g});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?y:w:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const E=Math.floor(o/4)*4,A=o%4,R=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${c});
      const ivec2 pads = ivec2(${m}, ${g});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${E}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${R}
          }

          int xC = xCCorner + ${E};
          if (${A===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${A===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${A===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${R}
          }
        }
        setOutput(${k});
      }
    `}}class HO{constructor(e,n,r,s=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,c=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,m=e.effectiveFilterDepth,g=e.effectiveFilterHeight,v=e.effectiveFilterWidth,y=e.padInfo.front,w=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const S=n==="avg";let k="0.0";if(S||(k="-1.0 / 1e-20"),r){this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${c}, ${l});
        const ivec3 pads = ivec3(${y}, ${w}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${m};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${g};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${g} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let A=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(A="avgValue / max(count, 1.0)");const R=Math.floor(o/4)*4,N=o%4,P=`
      if (${S}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${c}, ${l});
      const ivec3 pads = ivec3(${y}, ${w}, ${x});
      const float initializationValue = ${k};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${k});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${m};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${g};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${R}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${P}
            }

            int xC = xCCorner + ${R};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${P}
            }
          }
        }
        setOutput(${A});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Oy(s,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:c}=r,l=1;U(Vr(o,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const u=co(s.shape,i,o,l,a,c);if(u.filterWidth===1&&u.filterHeight===1&&Dt(u.inShape,u.outShape))return ai({inputs:{x:s},backend:n});const d=new qg(u,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const HHe={kernelName:Q1,backendName:"webgl",kernelFunc:jHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WHe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:c,dataFormat:l}=r,u=[1,1,1],d=Ec(s.shape,i,o,u,a,c,l),h=new HO(d,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const GHe={kernelName:Y1,backendName:"webgl",kernelFunc:WHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qHe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=c-1-e.padInfo.top,d=l-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class KHe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=d-1-e.padInfo.front,v=h-1-e.padInfo.top,y=m-1-e.padInfo.left,w=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${g}, ${v}, ${y});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${m};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XHe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:c,pad:l,dimRoundingMode:u}=r,d=[1,1,1],h=Ec(o.shape,a,c,d,l,u),m=new KHe(h);return n.runWebGLProgram(m,[s],o.dtype)}const QHe={kernelName:H_,backendName:"webgl",kernelFunc:XHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YHe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i;Oy([s,i],"avgPoolGrad");const{filterSize:a,strides:c,pad:l}=r,u=co(o.shape,a,c,1,l),d=new qHe(u);return n.runWebGLProgram(d,[s],o.dtype)}const ZHe={kernelName:j_,backendName:"webgl",kernelFunc:YHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JHe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:i}=e,{transposeA:o,transposeB:a}=r;return Kx({a:s,b:i,transposeA:o,transposeB:a,backend:n})}const eWe={kernelName:Z1,backendName:"webgl",kernelFunc:JHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tWe{constructor(e,n,r,s,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],bt(e,n),bt(e,r);let a="0.0";s!=null&&(bt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="1.0";i!=null&&(bt(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nWe{constructor(e,n,r,s,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],bt(e,n),bt(e,r);let a="vec4(0.0)";s!=null&&(bt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let c="vec4(1.0)";i!=null&&(bt(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rWe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:i,offset:o,scale:a}=t;U(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),U(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),U(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=n;c==null&&(c=.001);const l=[r,s,i];let u=null;o!=null&&(u=o.shape,l.push(o));let d=null;a!=null&&(d=a.shape,l.push(a));const h=fe().getBool("WEBGL_PACK_NORMALIZATION")?new nWe(r.shape,s.shape,i.shape,u,d,c):new tWe(r.shape,s.shape,i.shape,u,d,c);return e.runWebGLProgram(h,l,l[0].dtype)},sWe={kernelName:dI,backendName:"webgl",kernelFunc:rWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iWe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=rn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=oWe(this.rank);let s;const i=e.map((o,a)=>`sourceLoc.${NA[a]} = start[${a}] + coords.${NA[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const NA=["x","y","z","w","u","v"];function oWe(t){if(t===1)return"sourceLoc";if(t<=6)return NA.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aWe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=rn(this.rank),r=ds("coords",this.rank),s=ds("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,o=`getChannel(getSource(${s.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${o};
        --${s[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${o};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${a}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cWe(t,e,n,r){const s=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,s),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=BR(e,nt(t.shape));s.slice&&(a+=s.slice.flatOffset),o.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const c=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,c+1),i}function lp(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,size:o}=r,[a,c]=bS(s,i,o);if(DR(s,a,c),me(c)===0)return n.makeTensorInfo(c,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),h=e5e(d.values,a,c,s.shape,s.dtype);return n.makeTensorInfo(c,s.dtype,h)}const{isPacked:l}=n.texData.get(s.dataId),u=LR(s.shape,a,c);if(l||!u){const d=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aWe(c):new iWe(c),h=[a];return n.runWebGLProgram(d,[s],s.dtype,h)}return n.uploadToGPU(s.dataId),cWe(s,a,c,n)}const lWe={kernelName:zI,backendName:"webgl",kernelFunc:lp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uWe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,crops:o}=r;U(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,S)=>x*S),c=wy(s.shape,i,a),l=xy(c.length,i.length),u=Iy(s.shape,i,a),d=jR(o,i.length),h=HR(u,o,i.length),m=[],g=Pe({inputs:{x:s},backend:n,attrs:{shape:c}}),v=ms({inputs:{x:g},backend:n,attrs:{perm:l}}),y=Pe({inputs:{x:v},backend:n,attrs:{shape:u}}),w=lp({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return m.push(g),m.push(v),m.push(y),m.forEach(x=>n.disposeIntermediateTensorInfo(x)),w},dWe={kernelName:J1,backendName:"webgl",kernelFunc:uWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o}=r,a=n.readSync(s.dataId),c=n.readSync(i.dataId),l=CQ(a,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}const hWe={kernelName:W_,backendName:"webgl",kernelFunc:fWe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pWe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,mWe=`
  return float(int(a.r) & int(b.r));
`;function gWe(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,i=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=fe().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||o===1){const c=n.texData.get(r.dataId).values,l=n.texData.get(s.dataId).values,[u,d]=k6e(r.shape,s.shape,c,l,r.dtype),h=n.makeTensorInfo(d,r.dtype),m=n.texData.get(h.dataId);return m.values=u,h}let a;return i?a=new ap(pWe,r.shape,s.shape,!1):a=new md(mWe,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const yWe={kernelName:eI,backendName:"webgl",kernelFunc:gWe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vWe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,i=n.readSync(r.dataId),o=n.readSync(s.dataId),a=bt(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const bWe={kernelName:G_,backendName:"webgl",kernelFunc:vWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wWe="return float(a != b);",zQ=Wr({opSnippet:wWe,cpuKernelImpl:W6e,dtype:"bool"}),xWe={kernelName:AI,backendName:"webgl",kernelFunc:zQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dy(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return ai({inputs:{x:s.complexTensorInfos.real},backend:n})}const IWe={kernelName:E$,backendName:"webgl",kernelFunc:Dy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SWe="return float(int(x));";function kWe(t,e){const n=new ma(t.shape,SWe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _A(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return ai({inputs:{x:s},backend:n});const o=cr(s.shape),a=_A({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),c=Kl({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),c}if(s.dtype==="complex64"){const o=Dy({inputs:{input:s},backend:n}),a=_A({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!s8(s.dtype,i)){const o=ai({inputs:{x:s},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId).values,[a,c,l]=E6e(o,s.shape,s.dtype,i);return n.makeTensorInfo(a,c,l)}if(i==="int32")return kWe(s,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Mr("bool",1)),c=zQ({inputs:{a:s,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),c}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const EWe={kernelName:k0,backendName:"webgl",kernelFunc:_A};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mz="return ceil(x);",CWe=zt({opSnippet:mz,packedOpSnippet:mz,cpuKernelImpl:C6e}),TWe={kernelName:E0,backendName:"webgl",kernelFunc:CWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AWe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NWe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _We(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:i,clipValueMax:o}=r;let a;fe().getBool("WEBGL_PACK_CLIP")?a=new NWe(s.shape):a=new AWe(s.shape);const c=[[i],[o]];return n.runWebGLProgram(a,[s],s.dtype,c)}const $We={kernelName:C0,backendName:"webgl",kernelFunc:_We};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RWe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function OWe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),i=new RWe(r.shape),o=[gz(r,s.complexTensorInfos.real),gz(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const PWe={kernelName:tI,backendName:"webgl",kernelFunc:OWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DWe{constructor(e){this.outputShape=[],this.outputShape=ba(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const s=n.length,i=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FWe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ba(e,n);const r=this.outputShape,s=r.length,i=rn(s),o=ds("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((v,y)=>`T${y}`);const c=new Array(e.length-1);c[0]=e[0][n];for(let v=1;v<c.length;v++)c[v]=c[v-1]+e[v][n];const l=a[n],u=a.slice(-2),d=a.join();let h=`if (${l} < ${c[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let v=1;v<c.length;v++){const y=c[v-1];h+=`
        if (${l} < ${c[v]}  && ${l} >= ${c[v-1]}) {
          return getChannel(
            getT${v}(${Nb(a,l,y)}),
            vec2(${Nb(u,l,y)}));
        }`}const m=c.length,g=c[c.length-1];h+=`
        return getChannel(
          getT${m}(${Nb(a,l,g)}),
          vec2(${Nb(u,l,g)}));`,this.userCode=`
      float getValue(${a.map(v=>"int "+v)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[s-1]} = ${o[s-1]} + 1;
        if (${o[s-1]} < ${r[s-1]}) {
          result.g = getValue(${o});
        }

        ${o[s-2]} = ${o[s-2]} + 1;
        if (${o[s-2]} < ${r[s-2]}) {
          result.a = getValue(${o});
        }

        ${o[s-1]} = ${o[s-1]} - 1;
        if (${o[s-2]} < ${r[s-2]} &&
            ${o[s-1]} < ${r[s-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Nb(t,e,n){const r=t.indexOf(e);return t.map((i,o)=>o===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return ai({inputs:{x:s.complexTensorInfos.imag},backend:n})}const LWe={kernelName:d$,backendName:"webgl",kernelFunc:MS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _m(t,e,n){const r=t[0].dtype;if(r==="complex64"){const m=t.map(x=>Dy({inputs:{input:x},backend:n})),g=t.map(x=>MS({inputs:{input:x},backend:n})),v=_m(m,e,n),y=_m(g,e,n),w=Kl({inputs:{real:v,imag:y},backend:n});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),g.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),w}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const m=t.map(k=>{const A=[-1,me(k.shape.slice(e))];return Pe({inputs:{x:k},backend:n,attrs:{shape:A}})}),g=m.map(k=>({vals:n.readSync(k.dataId),shape:k.shape})),v=ba(m.map(k=>k.shape),1),y=m[0].shape[0]===1,w=T6e(g,v,r,y),x=ba(t.map(k=>k.shape),e),S=n.makeTensorInfo(x,r,w);return m.forEach(k=>n.disposeIntermediateTensorInfo(k)),S}const i=t.filter(m=>me(m.shape)>0),o=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const m=o?new ma(t[0].shape,rl):new cl(t[0].shape,rl);return n.runWebGLProgram(m,t,r)}const a=fe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const m=[];for(let v=0;v<i.length;v+=a){const y=i.slice(v,v+a);m.push(_m(y,e,n))}const g=_m(m,e,n);for(const v of m)n.disposeIntermediateTensorInfo(v);return g}if(o){const m=new FWe(i.map(g=>g.shape),e);return n.runWebGLProgram(m,i,r)}const{tensors2D:c,outShape:l}=BWe(i,e,n),u=new DWe(c.map(m=>m.shape)),d=n.runWebGLProgram(u,c,r);c.forEach(m=>n.disposeIntermediateTensorInfo(m));const h=Pe({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),h}function BWe(t,e,n){const r=ba(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>Pe({inputs:{x:i},attrs:{shape:[-1,me(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,i=Nt(s,e[0].shape)[0],o=e.map(l=>l.shape);zR(o,i);const a=ba(e.map(l=>l.shape),i);if(me(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const c=e.filter(l=>me(l.shape)>0);return c.length===1?ai({inputs:{x:c[0]},backend:n}):_m(c,i,n)}const MWe={kernelName:nI,backendName:"webgl",kernelFunc:UQ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VQ{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,c=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,m=e.filterWidth,g=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,y=e.dataFormat==="channelsLast",w=y?1:2,x=y?2:3,S=y?3:1;let k="",E="";r&&(s?k=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?k=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:k=`
          float activation(float x) {
            ${r}
          }
        `,E="result = activation(result);");const A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${k}

      const ivec2 strides = ivec2(${c}, ${l});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${S}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${m}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${g}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${g}) *
                    getW(wR, wC, ${g}, d2);
              } else {
                dotProd +=
                    getX(batch, ${g}, xR, xC) *
                    getW(wR, wC, ${g}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2),
                getW(wR, wC, ${g} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1),
                  getX(batch, xR, xC, ${g} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC),
                  getX(batch, ${g} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${A}
        ${E}
        setOutput(result);
      }
    `}}class zWe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,m=e.filterWidth,g=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${g}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${g}) *
                  getW(wF, wR, wC, ${g}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1),
                  getX(batch, xF, xR, xC, ${g} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2),
                  getW(wF, wR, wC, ${g} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jQ{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ts(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<u;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const w=y*2;if(h+=`
           xC = xCCorner + ${w*c};
           `,a===1){if(w<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,c===1&&w>0?h+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<u)){const x=o%2===0?B_(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,c>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:h+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):x===1?h+=`
                     xC${w+1} = xTexelC${w};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<u&&(h+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<u&&(h+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<u&&(h+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let m="",g="";r&&(s?m=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?m=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:m=`vec4 activation(vec4 x) {
           ${r}
         }`,g="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${m}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${g}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UWe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ts(this.outputShape.length);const{dataFormat:r}=n,s=ys(),i=r==="channelsLast",o=i?1:2,a=i?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)l+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function HQ({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const c=t.shape,l=r.texData.get(t.dataId),u=n.inChannels,d=c[0]*c[1]*c[2],h=n.outChannels,m=n.dataFormat==="channelsLast",g=!1,v=!1;let y;const w=[];if(i!=null){const k=Xx(i.shape,m);k!=null&&(i=Pe({inputs:{x:i},backend:r,attrs:{shape:k}}),w.push(i))}if(s!=null){const k=Xx(s.shape,m);k!=null&&(s=Pe({inputs:{x:s},backend:r,attrs:{shape:k}}),w.push(s))}if(!((d===1||h===1)&&u>FQ)&&l.isPacked&&m&&l.texture!=null&&c[2]%2!==0&&Dt(l.shape.slice(-3),c.slice(-3))){const k=c[0]*c[1]*(c[2]+1),E={dataId:t.dataId,shape:[1,k,n.inChannels],dtype:t.dtype},A=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(qx(l.shape,E.shape),()=>`packed reshape ${l.shape} to ${E.shape} isn't free`);const R=Pe({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});w.push(R);const N=Kx({a:E,b:R,backend:r,transposeA:g,transposeB:v,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),P=r.texData.get(N.dataId);U(P.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=A,P.shape=n.outShape,y=ai({inputs:{x:N},backend:r}),y.shape=n.outShape,w.push(N)}else{const k=n.outHeight*n.outWidth,E=Pe({inputs:{x:t},backend:r,attrs:{shape:m?[n.batchSize,k,n.inChannels]:[n.batchSize,n.inChannels,k]}}),A=Pe({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),R=Kx({a:m?E:A,b:m?A:E,transposeA:!m,transposeB:v,backend:r,bias:s,activation:a,preluActivationWeights:i,leakyreluAlpha:o});y=Pe({inputs:{x:R},backend:r,attrs:{shape:n.outShape}}),w.push(E),w.push(A),w.push(R)}for(const k of w)r.disposeIntermediateTensorInfo(k);return y}function WQ({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:c,filterHeight:l,inChannels:u,outWidth:d,outHeight:h,dataFormat:m}=n,g=m==="channelsLast",v=c*l*u,y=h*d,w=[n.batchSize,v,y],x=!0,S=!1,k=[];if(i!=null){const j=Xx(i.shape,g);j!=null&&(i=Pe({inputs:{x:i},backend:r,attrs:{shape:j}}),k.push(i))}if(s!=null){const j=Xx(s.shape,g);j!=null&&(s=Pe({inputs:{x:s},backend:r,attrs:{shape:j}}),k.push(s))}const E=Pe({inputs:{x:e},backend:r,attrs:{shape:[1,v,me(e.shape)/v]}});k.push(E);const A=new UWe(w,n),R=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],N=r.runWebGLProgram(A,[t],"float32",R),P=Pe({inputs:{x:N},backend:r,attrs:{shape:w}});k.push(N),k.push(P);const O=s!=null,_=i!=null,M=a==="leakyrelu",G=a?Gg(a,!0):null,q=new DQ(g?P.shape:E.shape,g?E.shape:P.shape,g?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,S,O,G,_,M),D=g?[P,E]:[E,P];if(s&&D.push(s),_&&D.push(i),M){const j=r.makeTensorInfo([],"float32",Bl(o,"float32"));D.push(j),k.push(j)}const L=r.runWebGLProgram(q,D,"float32"),K=Pe({inputs:{x:L},backend:r,attrs:{shape:n.outShape}});k.push(L);for(const j of k)r.disposeIntermediateTensorInfo(j);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dataFormat:c,dilations:l,dimRoundingMode:u}=r,d=Cc(c),h=Er(s.shape,i.shape,o,l,a,u,!1,d);let m;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))m=HQ({x:s,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&fe().getBool("WEBGL_EXP_CONV")){const v=new jQ(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];m=n.runWebGLProgram(v,[s,i],"float32",y)}else if(fe().getBool("WEBGL_CONV_IM2COL"))m=WQ({x:s,filter:i,convInfo:h,backend:n});else{const v=new VQ(h);m=n.runWebGLProgram(v,[s,i],"float32")}const g=Pe({inputs:{x:m},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(m),g}const jWe={kernelName:rI,backendName:"webgl",kernelFunc:VWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HWe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class WWe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,c=r-1-e.padInfo.left,l=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class GWe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class qWe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,c=n-1-e.padInfo.front,l=r-1-e.padInfo.top,u=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${l}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,d=Cc(c),h=Er(s.shape,u,o,1,a,l,!1,d),m=new HWe(h);return n.runWebGLProgram(m,[s,i],"float32")}const XWe={kernelName:K_,backendName:"webgl",kernelFunc:KWe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QWe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ts(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YWe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{inputShape:o,strides:a,pad:c,dataFormat:l,dimRoundingMode:u}=r,d=Cc(l),h=Er(o,i.shape,a,1,c,u,!1,d);if(fe().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const m=[[h.strideHeight,h.strideWidth]],g=new QWe(h);return n.runWebGLProgram(g,[s,i],"float32",m)}else{const m=new WWe(h);return n.runWebGLProgram(m,[s,i],"float32")}}const ZWe={kernelName:sI,backendName:"webgl",kernelFunc:YWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:c}=r,l=Ul(s.shape,i.shape,o,c,a),u=new zWe(l);return n.runWebGLProgram(u,[s,i],"float32")}const eGe={kernelName:iI,backendName:"webgl",kernelFunc:JWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,pad:a,filterShape:c}=r,l=Ul(s.shape,c,o,1,a),u=new GWe(l);return n.runWebGLProgram(u,[s,i],"float32")}const nGe={kernelName:X_,backendName:"webgl",kernelFunc:tGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rGe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{pad:o,strides:a,inputShape:c}=r,l=Ul(c,i.shape,a,1,o),u=new qWe(l);return n.runWebGLProgram(u,[s,i],"float32")}const sGe={kernelName:Q_,backendName:"webgl",kernelFunc:rGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iGe=cp+`
  return cos(x);
`,oGe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Od}
  return result;
`,aGe=zt({opSnippet:iGe,packedOpSnippet:oGe}),cGe={kernelName:T0,backendName:"webgl",kernelFunc:aGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lGe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,uGe=zt({opSnippet:lGe}),dGe={kernelName:A0,backendName:"webgl",kernelFunc:uGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fGe{constructor(e,n,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,c,l]=e,[u]=n,[d,h]=r;this.outputShape=[u,d,h,l];const m=s==="bilinear"?1:0,[g,v]=[`${a-1}.0`,`${c-1}.0`],[y,w,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${g} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${g}`],[S,k,E]=h>1?[`${(c-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${S});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${k};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${g} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${E};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${m} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hGe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:i,boxInd:o}=e,{cropSize:a,method:c,extrapolationValue:l}=r,u=new fGe(s.shape,i.shape,a,c,l);return n.runWebGLProgram(u,[s,i,o],"float32")},pGe={kernelName:Z_,backendName:"webgl",kernelFunc:hGe};var Kg;(function(t){t.Prod="*",t.Sum="+"})(Kg||(Kg={}));class yz{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Kg.Prod?"1.0":"0.0",a=r?o:`getX(${vz(i,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let l="",u="";r?(l=s?`end != ${c-1}`:"end != 0",u=s?"end + 1":"end - 1"):(l=s?`end + pow2 < ${c}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${rn(i)} coords = getOutputCoords();
        int end = ${bz(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${u};
          ${bz(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${vz(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function vz(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function bz(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(t,e,n,r,s,i){const o=e.shape.length,a=Pn([r],o);let c=e;a!=null&&(c=ms({inputs:{x:e},backend:n,attrs:{perm:a}}));const l=Xn(1,o)[0];if(l!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=c.shape[l];let d=ai({inputs:{x:c},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const m=new yz(t,c.shape,!1,i),g=[[h]],v=d;d=n.runWebGLProgram(m,[d],d.dtype,g),n.disposeIntermediateTensorInfo(v)}if(s){const h=new yz(t,c.shape,s,i),m=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(m)}if(a!=null){const h=Vl(a),m=ms({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(c),m}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return GQ(Kg.Prod,s,n,i,o,a)}const gGe={kernelName:Y_,backendName:"webgl",kernelFunc:mGe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,exclusive:o,reverse:a}=r;return GQ(Kg.Sum,s,n,i,o,a)}const vGe={kernelName:oI,backendName:"webgl",kernelFunc:yGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:i}=e,{size:o,binaryOutput:a}=r;if(s.shape.length===1){const c=n.readSync(s.dataId),l=n.readSync(i.dataId),u=CQ(c,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(s.shape.length===2){const c=n.bufferSync(s),l=n.bufferSync(i),u=S6e(c,l,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const wGe={kernelName:J_,backendName:"webgl",kernelFunc:bGe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xGe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:i,dataFormat:o}=r,a=s.shape[0],c=o==="NHWC"?s.shape[1]:s.shape[2],l=o==="NHWC"?s.shape[2]:s.shape[3],u=o==="NHWC"?s.shape[3]:s.shape[1],d=c*i,h=l*i,m=u/(i*i),g=o==="NHWC"?[a,d,h,m]:[a,m,d,h],v=new xGe(g,i,o);return n.runWebGLProgram(v,[s],s.dtype)}const SGe={kernelName:e$,backendName:"webgl",kernelFunc:IGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qQ{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ts(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,c=e.outChannels/e.inChannels;let l="",u="";r&&(s?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:l=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KQ{constructor(e,n=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ts(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,c=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let m=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)m+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;m+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let w=0;w<d;w++)m+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;m+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(h+1)/2;w++){const x=w*2;if(m+=`
          xC = xCCorner + ${x*l};
          `,c===1){if(x<d&&(a%2===1?(m+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,l===1&&x>0?m+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:m+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):m+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const S=a%2===0?B_(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(m+=`
                  xCOffset = xC + imod(pads[1], 2) + ${S};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,l>1?m+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:m+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):S===1?m+=`
                    xC${x+1} = xTexelC${x};
                    `:m+=`
                    xCOffset = xC + ${S};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(m+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(m+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(m+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(m+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(m+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}m+=`
    }
  `,m+=`
      }
    `;let g="",v="";r&&(s?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:g=`vec4 activation(vec4 x) {
          ${r}
        }`,v="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${m}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:c,dimRoundingMode:l}=r;let u=c;u==null&&(u=[1,1]),U(Vr(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Er(s.shape,i.shape,o,u,a,l,!0);let h;fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new KQ(d):h=new qQ(d);const m=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[s,i],"float32",m)}const EGe={kernelName:aI,backendName:"webgl",kernelFunc:kGe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CGe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class TGe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=r-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:i}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,filterShape:u}=r,d=Er(s.shape,u,o,a,c,l,!0),h=new CGe(d);return n.runWebGLProgram(h,[s,i],"float32")}const NGe={kernelName:t$,backendName:"webgl",kernelFunc:AGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:i}=e,{strides:o,dilations:a,pad:c,dimRoundingMode:l,inputShape:u}=r,d=Er(u,i.shape,o,a,c,l,!0),h=new TGe(d);return n.runWebGLProgram(h,[s,i],"float32")}const $Ge={kernelName:n$,backendName:"webgl",kernelFunc:_Ge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RGe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OGe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],i=me(r.shape),o=Pe({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new RGe(i),c=n.runWebGLProgram(a,[o],o.dtype),l=Pe({inputs:{x:c},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),l}const PGe={kernelName:r$,backendName:"webgl",kernelFunc:OGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DGe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:c,dilationHeight:l,dilationWidth:u}=e,{top:d,left:h}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i}=e,{strides:o,pad:a,dilations:c}=r,l=hy(s.shape,i.shape,o,a,"NHWC",c);let u;const d=new DGe(l);u=n.runWebGLProgram(d,[s,i],"float32");const h=Pe({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),h}const LGe={kernelName:cI,backendName:"webgl",kernelFunc:FGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BGe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,i=e,{allDims:o,summedDims:a,idDims:c}=ZR(s,i.length);eO(o.length,c,i);const{path:l,steps:u}=tO(a,c),d=u.length;let h=null,m=o.length;const g=[];for(let v=0;v<d;++v){for(const y of u[v]){const{permutationIndices:w,expandDims:x}=JR(m,c[y]);let S;nO(w)?S=i[y]:(S=ms({inputs:{x:i[y]},backend:n,attrs:{perm:w}}),g.push(S));const k=S.shape.slice();for(let E=0;E<x.length;++E)k.splice(x[E],0,1);Dt(S.shape,k)||(S=Pe({inputs:{x:S},backend:n,attrs:{shape:k}}),g.push(S)),h===null?h=S:(h=jO({inputs:{a:S,b:h},backend:n}),g.push(h))}v<d-1&&(l[v]>=0&&(h=BS({inputs:{x:h},backend:n,attrs:{axis:l[v]-(o.length-m),keepDims:!1}}),g.push(h)),m--)}for(const v of g)v!==h&&n.disposeIntermediateTensorInfo(v);return h}const MGe={kernelName:s$,backendName:"webgl",kernelFunc:BGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zGe="return (x >= 0.0) ? x : (exp(x) - 1.0);",UGe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,VGe=zt({opSnippet:zGe,packedOpSnippet:UGe}),jGe={kernelName:_0,backendName:"webgl",kernelFunc:VGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HGe="return (b >= 0.0) ? a : a * (b + 1.0);",WGe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,GGe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,i=fe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ap(WGe,r.shape,s.shape):new md(HGe,r.shape,s.shape);return n.runWebGLProgram(i,[r,s],r.dtype)},qGe={kernelName:i$,backendName:"webgl",kernelFunc:GGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KGe=`
  return vec4(equal(a, b));
`,XGe="return float(a == b);",QGe=Wr({opSnippet:XGe,packedOpSnippet:KGe,dtype:"bool",cpuKernelImpl:A6e}),YGe={kernelName:lI,backendName:"webgl",kernelFunc:QGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZGe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${WR};
  float a1 = ${GR};
  float a2 = ${qR};
  float a3 = ${KR};
  float a4 = ${XR};
  float a5 = ${QR};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,JGe=zt({opSnippet:ZGe}),e8e={kernelName:$0,backendName:"webgl",kernelFunc:JGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8e=cp+`
  return exp(x);
`,n8e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XQ=zt({opSnippet:t8e,packedOpSnippet:n8e,cpuKernelImpl:N6e,dtype:"float32"}),r8e={kernelName:R0,backendName:"webgl",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $A(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let c=s;return s<0&&(U(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+s+1),a.splice(c,0,1),Pe({inputs:{x:i},backend:r,attrs:{shape:a}})}const s8e={kernelName:uI,backendName:"webgl",kernelFunc:$A};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wz="return exp(x) - 1.0;",i8e=zt({opSnippet:wz,packedOpSnippet:wz,cpuKernelImpl:_6e}),o8e={kernelName:O0,backendName:"webgl",kernelFunc:i8e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xz{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(t,e,n){const r=n.texData.get(t.dataId),s=me(t.shape),i=t.shape[t.shape.length-1],o=s/i,a=Pe({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),c=a.shape,l=new xz("real",c,e),u=new xz("imag",c,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],h=n.runWebGLProgram(l,d,"float32"),m=n.runWebGLProgram(u,d,"float32"),g=Kl({inputs:{real:h,imag:m},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m);const v=Pe({inputs:{x:g},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(g),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a8e(t){const{inputs:e,backend:n}=t,{input:r}=e;return QQ(r,!1,n)}const c8e={kernelName:o$,backendName:"webgl",kernelFunc:a8e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l8e{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fy(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:i}=n;if(i=i||qh(s),i==="string"){const o=qn(i,me(r));return o.fill(s),e.makeTensorInfo(r,i,o)}else{const o=new l8e(r,s),a=[[s]];return e.runWebGLProgram(o,[],i,a)}}const u8e={kernelName:a$,backendName:"webgl",kernelFunc:Fy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d8e{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f8e={kernelName:c$,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new d8e(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz="return floor(x);",h8e=zt({opSnippet:Iz,packedOpSnippet:Iz,cpuKernelImpl:$6e}),p8e={kernelName:P0,backendName:"webgl",kernelFunc:h8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,g8e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,y8e=Wr({opSnippet:m8e,packedOpSnippet:g8e,dtype:"int32"}),v8e={kernelName:D0,backendName:"webgl",kernelFunc:y8e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b8e{constructor(e){this.variableNames=["A"];const n=ys(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w8e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ys(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8e={kernelName:zT,backendName:"webgl",kernelFunc:I8e};let xf,sC=fe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function I8e(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[c,l]=o?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[l,c],d=[l,c,i];if(a||o){const v=fe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(xf==null||v!==sC)&&(sC=v,xf=document.createElement("canvas").getContext("2d",{willReadFrequently:sC})),xf.canvas.width=c,xf.canvas.height=l,xf.drawImage(s,0,0,c,l),s=xf.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=bi.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),s);const m=fe().getBool("WEBGL_PACK")?new w8e(d):new b8e(d),g=n.runWebGLProgram(m,[h],"int32");return n.disposeData(h.dataId),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:m,leakyreluAlpha:g}=r,v=Cc(u),y=Er(s.shape,i.shape,c,d,l,h,!1,v);let w;const x=[],S=o!=null,k=a!=null,E=m==="leakyrelu",A=()=>{const N=[s,i],P=(O,_)=>{if(_==="NCHW"&&O.shape.length===1&&O.shape[0]!==1){const M=Pe({inputs:{x:O},backend:n,attrs:{shape:[O.shape[0],1,1]}});return x.push(M),M}return O};if(S&&N.push(P(o,u)),k&&N.push(P(a,u)),E){const O=n.makeTensorInfo([],"float32",Bl(g,"float32"));N.push(O),x.push(O)}return N};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))w=HQ({x:s,filter:i,convInfo:y,backend:n,bias:o,activation:m,preluActivationWeights:a,leakyreluAlpha:g});else if(y.strideWidth<=2&&v==="channelsLast"&&fe().getBool("WEBGL_EXP_CONV")){const N=m?Gg(m,!0):null,P=new jQ(y,S,N,k,E),O=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],_=A();w=n.runWebGLProgram(P,_,"float32",O)}else if(fe().getBool("WEBGL_CONV_IM2COL"))w=WQ({x:s,filter:i,convInfo:y,backend:n,bias:o,activation:m,preluActivationWeights:a,leakyreluAlpha:g});else{const N=m?Gg(m,!1):null,P=new VQ(y,S,N,k,E),O=A();w=n.runWebGLProgram(P,O,"float32")}const R=Pe({inputs:{x:w},backend:n,attrs:{shape:y.outShape}});return x.push(w),x.forEach(N=>n.disposeIntermediateTensorInfo(N)),R}const k8e={kernelName:kx,backendName:"webgl",kernelFunc:S8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:i,bias:o,preluActivationWeights:a}=e,{strides:c,pad:l,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:m}=r,g=[];let v=u;v==null&&(v=[1,1]),U(Vr(c,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${v}'`);const y=Er(s.shape,i.shape,c,v,l,d,!0),w=fe().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=h?Gg(h,w):null,S=[s,i],k=o!=null,E=a!=null,A=h==="leakyrelu";if(k&&S.push(o),E&&S.push(a),A){const O=n.makeTensorInfo([],"float32",Bl(m,"float32"));S.push(O),g.push(O)}let R;w?R=new KQ(y,k,x,E,A):R=new qQ(y,k,x,E,A);const N=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],P=n.runWebGLProgram(R,S,"float32",N);return g.forEach(O=>n.disposeIntermediateTensorInfo(O)),P}const C8e={kernelName:Ex,backendName:"webgl",kernelFunc:E8e};class T8e{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=rn(r.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,i=s.shape,o=i[i.length-1],a=me(r.shape),[c,l,u,d]=PR(r,s),h=Pe({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),m=Pe({inputs:{x:r},backend:n,attrs:{shape:[me(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const w=n.readSync(s.dataId),x=n.bufferSync(r),S=R6e(w,x,r.dtype,l,o,u,d,r.shape,a);return n.makeTensorInfo(c,r.dtype,S.values)}const g=new T8e(o,d,[l,u],r.shape),v=n.runWebGLProgram(g,[m,h],m.dtype),y=Pe({inputs:{x:v},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),y}const N8e={kernelName:l$,backendName:"webgl",kernelFunc:A8e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _8e{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=rn(this.rank),s=$8e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function $8e(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:i}=e,{axis:o,batchDims:a}=r,c=Nt(o,s.shape)[0];if(fe().get("DEBUG")){const x=n.readSync(i.dataId),S=s.shape[c];for(let k=0;k<x.length;++k){const E=x[k];U(E<=S-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${S-1}]`)}}const l=sO(s,i,c,a),u=me(i.shape),d=[],h=Pe({inputs:{x:s},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),m=Pe({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,u/l.batchSize]}});d.push(h),d.push(m);const g=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const x=n.bufferSync(m),S=n.bufferSync(h),k=O6e(S,x,g);return d.forEach(E=>n.disposeIntermediateTensorInfo(E)),n.makeTensorInfo(l.outputShape,k.dtype,k.values)}const v=new _8e(h.shape,g),y=n.runWebGLProgram(v,[h,m],h.dtype);d.push(y);const w=Pe({inputs:{x:y},backend:n,attrs:{shape:l.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),w}const R8e={kernelName:fI,backendName:"webgl",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8e="return float(a > b);",P8e=`
  return vec4(greaterThan(a, b));
`,D8e=Wr({opSnippet:O8e,packedOpSnippet:P8e,cpuKernelImpl:P6e,dtype:"bool"}),F8e={kernelName:hI,backendName:"webgl",kernelFunc:D8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8e="return float(a >= b);",B8e=`
  return vec4(greaterThanEqual(a, b));
`,M8e=Wr({opSnippet:L8e,packedOpSnippet:B8e,dtype:"bool",cpuKernelImpl:D6e}),z8e={kernelName:F0,backendName:"webgl",kernelFunc:M8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8e(t){const{inputs:e,backend:n}=t,{input:r}=e;return QQ(r,!0,n)}const V8e={kernelName:u$,backendName:"webgl",kernelFunc:U8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j8e="return float(!isnan(x) && !isinf(x));",H8e=zt({opSnippet:j8e,dtype:"bool"}),W8e={kernelName:B0,backendName:"webgl",kernelFunc:H8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G8e="return float(isinf(x));",q8e=zt({opSnippet:G8e,dtype:"bool"}),K8e={kernelName:M0,backendName:"webgl",kernelFunc:q8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X8e="return float(isnan(x));",Q8e=zt({opSnippet:X8e,dtype:"bool"}),Y8e={kernelName:z0,backendName:"webgl",kernelFunc:Q8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z8e="return float(a < b);",J8e=`
  return vec4(lessThan(a, b));
`,eqe=Wr({opSnippet:Z8e,packedOpSnippet:J8e,cpuKernelImpl:F6e,dtype:"bool"}),tqe={kernelName:mI,backendName:"webgl",kernelFunc:eqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nqe="return float(a <= b);",rqe=`
  return vec4(lessThanEqual(a, b));
`,sqe=Wr({opSnippet:nqe,packedOpSnippet:rqe,cpuKernelImpl:L6e,dtype:"bool"}),iqe={kernelName:gI,backendName:"webgl",kernelFunc:sqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oqe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:i}=n,o=B6e(r,s,i);return e.makeTensorInfo([o.length],"float32",o)}const aqe={kernelName:f$,backendName:"webgl",kernelFunc:oqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cqe=cp+`
  return x < 0.0 ? 0./0. : log(x);
`,lqe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,uqe=zt({opSnippet:cqe,packedOpSnippet:lqe,cpuKernelImpl:M6e}),dqe={kernelName:U0,backendName:"webgl",kernelFunc:uqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fqe=cp+`
  return log(1.0 + x);
`,hqe=zt({opSnippet:fqe}),pqe={kernelName:V0,backendName:"webgl",kernelFunc:hqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mqe="return float(a >= 1.0 && b >= 1.0);",gqe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,yqe=Wr({opSnippet:mqe,packedOpSnippet:gqe,dtype:"bool"}),vqe={kernelName:yI,backendName:"webgl",kernelFunc:yqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bqe="return float(!(x >= 1.0));",wqe=zt({opSnippet:bqe}),xqe={kernelName:vI,backendName:"webgl",kernelFunc:wqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iqe="return float(a >= 1.0 || b >= 1.0);",Sqe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,kqe=Wr({opSnippet:Iqe,packedOpSnippet:Sqe,dtype:"bool"}),Eqe={kernelName:bI,backendName:"webgl",kernelFunc:kqe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cqe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let c;const l=`float(${r}) + float(${s}) * sum`;i===.5?c=`inversesqrt(${l})`:i===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tqe{constructor(e,n,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let c;const l=`float(${r}) + float(${s}) * sum`;i===.5?c=`inversesqrt(${l})`:i===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aqe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:i,bias:o,alpha:a,beta:c}=r,l=fe().getBool("WEBGL_PACK_NORMALIZATION")?new Tqe(s.shape,i,o,a,c):new Cqe(s.shape,i,o,a,c);return n.runWebGLProgram(l,[s],s.dtype)},Nqe={kernelName:wI,backendName:"webgl",kernelFunc:Aqe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _qe{constructor(e,n,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $qe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:i,dy:o}=e,{depthRadius:a,bias:c,alpha:l,beta:u}=r,d=new _qe(s.shape,a,c,l,u);return n.runWebGLProgram(d,[s,i,o],s.dtype)},Rqe={kernelName:h$,backendName:"webgl",kernelFunc:$qe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oqe(t,e,n,r){const s=me(e),o=me(t.shape)/s,a=Pe({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),c=Pd(a,t.dtype,"max",r),l=Pe({inputs:{x:c},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(c),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:i,keepDims:o}=r,a=s.shape.length,c=Nt(i,s.shape);let l=c;const u=Pn(l,a),d=u!=null,h=n.shouldExecuteOnCPU([s]);let m=s;if(d){if(h){const S=n.texData.get(m.dataId).values,k=new Array(a);for(let R=0;R<k.length;R++)k[R]=s.shape[u[R]];const E=UO(S,s.shape,s.dtype,u,k);m=n.makeTensorInfo(k,s.dtype);const A=n.texData.get(m.dataId);A.values=E}else m=LS(s,u,n);l=Xn(l.length,a)}jr("max",l,a);const[g,v]=Cr(m.shape,l);let y=g;o&&(y=Kn(g,c));let w;if(h){const S=n.texData.get(m.dataId).values,k=z6e(S,me(v),y,s.dtype);w=n.makeTensorInfo(y,s.dtype);const E=n.texData.get(w.dataId);E.values=k}else w=Oqe(m,v,y,n);return d&&n.disposeIntermediateTensorInfo(m),w}const Pqe={kernelName:xI,backendName:"webgl",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dqe=VO+`
  return max(a, b);
`,Fqe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Od+`
  return result;
`,Lqe=Wr({opSnippet:Dqe,packedOpSnippet:Fqe,cpuKernelImpl:U6e}),Bqe={kernelName:j0,backendName:"webgl",kernelFunc:Lqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Oy(s,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:c}=r,l=1;U(Vr(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const u=co(s.shape,i,o,l,a,c);if(u.filterWidth===1&&u.filterHeight===1&&Dt(u.inShape,u.outShape))return ai({inputs:{x:s},backend:n});const d=new qg(u,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const zqe={kernelName:II,backendName:"webgl",kernelFunc:Mqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:i,strides:o,pad:a,dataFormat:c,dimRoundingMode:l}=r,u=[1,1,1],d=Ec(s.shape,i,o,u,a,l,c),h=new HO(d,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const Vqe={kernelName:SI,backendName:"webgl",kernelFunc:Uqe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jqe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,c=o-1-e.padInfo.left,l=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Hqe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=c-1-e.padInfo.front,h=l-1-e.padInfo.top,m=u-1-e.padInfo.left,g=c*l*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${g} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wqe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i}=e,o=i,{filterSize:a,strides:c,pad:l,dimRoundingMode:u}=r,d=[1,1,1],h=Ec(o.shape,a,c,d,l,u),m=new HO(h,"max",!0),g=n.runWebGLProgram(m,[o],o.dtype),v=new Hqe(h),y=n.runWebGLProgram(v,[s,g],o.dtype);return n.disposeIntermediateTensorInfo(g),y}const Gqe={kernelName:m$,backendName:"webgl",kernelFunc:Wqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qqe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:i,output:o}=e,a=i;Oy([i,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=co(a.shape,c,l,1,u,d),m=!0,g=new qg(h,"max",m),v=n.runWebGLProgram(g,[a],a.dtype),y=new jqe(h),w=n.runWebGLProgram(y,[s,v],a.dtype);return n.disposeIntermediateTensorInfo(v),w}const Kqe={kernelName:p$,backendName:"webgl",kernelFunc:qqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xqe(t,e,n,r){let s=new qg(n,"max",!1);const i=r.runWebGLProgram(s,[t],"float32");s=new qg(n,"max",!0,!0,e);const o=r.runWebGLProgram(s,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qqe={kernelName:g$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:i,pad:o,includeBatchInIndex:a}=e,c=n;U(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];U(Vr(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const u=co(r.shape,s,i,l,o),[d,h]=Xqe(r,a,u,c);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yqe(t,e,n,r){const s=me(e),o=me(t.shape)/s,a=Pe({inputs:{x:t},attrs:{shape:[o,s]},backend:r}),c=Pd(a,"float32","mean",r),l=Pe({inputs:{x:c},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(c),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zqe={kernelName:kI,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:i}=e,o=n,a=r.shape.length,c=Nt(i,r.shape);let l=c;const u=Pn(l,a),d=u!=null,h=o.shouldExecuteOnCPU([r]),m=[];let g=r;if(d){if(h){const k=o.texData.get(g.dataId).values,E=new Array(a);for(let N=0;N<E.length;N++)E[N]=r.shape[u[N]];const A=UO(k,r.shape,r.dtype,u,E);g=o.makeTensorInfo(E,r.dtype);const R=o.texData.get(g.dataId);R.values=A}else g=LS(r,u,o);m.push(g),l=Xn(l.length,a)}jr("sum",l,a);const[v,y]=Cr(g.shape,l);let w=v;s&&(w=Kn(v,c));const x=Yqe(g,y,w,o);for(const S of m)o.disposeIntermediateTensorInfo(S);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jqe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,c=Nt(i,s.shape);let l=c;const u=Pn(l,a);let d=s;u!=null&&(d=ms({inputs:{x:s},backend:n,attrs:{perm:u}}),l=Xn(l.length,s.shape.length)),jr("min",l,a);const[h,m]=Cr(d.shape,l),g=me(m),v=Pe({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),y=Pd(v,v.dtype,"min",n);let w;if(o){const x=Kn(h,c);w=Pe({inputs:{x:y},backend:n,attrs:{shape:x}})}else w=Pe({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),w}const e9e={kernelName:EI,backendName:"webgl",kernelFunc:Jqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t9e=VO+`
  return min(a, b);
`,n9e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Od+`
  return result;
`,r9e=Wr({opSnippet:t9e,packedOpSnippet:n9e,cpuKernelImpl:V6e}),s9e={kernelName:H0,backendName:"webgl",kernelFunc:r9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i9e{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const s=e.length,i=rn(s),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),l=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o9e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((g,v)=>g[0]+e[v]+g[1]);const s=e.length,i=rn(s),o=n.map(g=>g[0]).join(","),a=n.map((g,v)=>g[0]+e[v]).join(","),c=ds("rc",s),l=ds("source",s),u=`${c[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${l.slice(-2).join()})`,h=r==="reflect"?0:1;let m="";if(s===1){const g=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;m=`
        ${i} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${l.join()}), ${d});
        ${c[s-1]} += 1;
        if(${u}) {
          ${g}
          result[1] = getChannel(getX(${l.join()}), ${d});
        }
      `}else{const g=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;m=`
        ${i} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${l.join()}), ${d});
        ${c[s-1]} += 1;
        if(${u}) {
          ${g}
          result[1] = getChannel(getX(${l.join()}), ${d});
        }
        rc = outputLoc;
        ${c[s-2]} += 1;
        if(${c[s-2]} < ${this.outputShape[s-2]}) {
          ${g}
          result[2] = getChannel(getX(${l.join()}), ${d});
          ${c[s-1]} += 1;
          if(${u}) {
            ${g}
            result[3] = getChannel(getX(${l.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9e=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:i}=n,o=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new o9e(r.shape,s,i):new i9e(r.shape,s,i);return e.runWebGLProgram(o,[r],r.dtype)},c9e={kernelName:CI,backendName:"webgl",kernelFunc:a9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9e=`if (b == 0.0) return NAN;
  return mod(a, b);`,u9e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Od+`
  return result;
`,d9e=Wr({opSnippet:l9e,packedOpSnippet:u9e}),f9e={kernelName:W0,backendName:"webgl",kernelFunc:d9e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h9e{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p9e=`
if (a == b) {
  return 1.0;
};
return a / b;`,m9e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,JQ=Wr({opSnippet:p9e,packedOpSnippet:m9e,checkOutOfBounds:!0}),g9e={kernelName:N0,backendName:"webgl",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sz="return a - b;",eY=Wr({opSnippet:Sz,packedOpSnippet:Sz,supportsComplex:!0,cpuKernelImpl:l5e}),y9e={kernelName:ay,backendName:"webgl",kernelFunc:eY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:i}=r,o=Nt([i],s.shape),a=ZQ({inputs:{x:s},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),c=Kn(a.shape,o),l=Pe({inputs:{x:a},backend:n,attrs:{shape:c}}),u=eY({inputs:{a:s,b:l},backend:n}),d=XQ({inputs:{x:u},backend:n}),h=BS({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),m=Pe({inputs:{x:h},backend:n,attrs:{shape:c}}),g=JQ({inputs:{a:d,b:m},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),g}const v9e={kernelName:HI,backendName:"webgl",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:i,seed:o,normalized:a}=r,c=a?s:tY({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),l=c.shape[0],u=c.shape[1],d=new h9e(l,u,i),h=[[o]],m=n.runWebGLProgram(d,[c],"int32",h);return a||n.disposeIntermediateTensorInfo(c),m}const w9e={kernelName:y$,backendName:"webgl",kernelFunc:b9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x9e=uo+`
  return -x;
`,I9e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function S9e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,a]=H6e(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,o)}let s;return fe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new cl(r.shape,I9e):s=new ma(r.shape,x9e),n.runWebGLProgram(s,[r],r.dtype)}const k9e={kernelName:TI,backendName:"webgl",kernelFunc:S9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E9e=TR;function C9e(t){gi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c}=r,l=n.readSync(s.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=E9e(l,u,o,a,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const T9e={kernelName:v$,backendName:"webgl",kernelFunc:C9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9e=AR;function N9e(t){gi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,padToMaxOutputSize:l}=r,u=n.readSync(s.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:m}=A9e(u,d,o,a,c,l);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}const _9e={kernelName:b$,backendName:"webgl",kernelFunc:N9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $9e=NR;function R9e(t){gi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(s.dataId),d=n.readSync(i.dataId),h=o,m=a,g=c,v=l,{selectedIndices:y,selectedScores:w}=$9e(u,d,h,m,g,v);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const O9e={kernelName:w$,backendName:"webgl",kernelFunc:R9e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P9e{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D9e=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:i,depth:o,onValue:a,offValue:c}=r,l=me(s.shape),u=new P9e(l,o,a,c),d=Pe({inputs:{x:s},backend:n,attrs:{shape:[l]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const m=[...s.shape,o],g=Pe({inputs:{x:h},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(h),g},F9e={kernelName:_I,backendName:"webgl",kernelFunc:D9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qx(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Dy({inputs:{input:r},backend:n}),i=Qx({inputs:{x:s},backend:n}),o=MS({inputs:{input:r},backend:n}),a=Qx({inputs:{x:o},backend:n}),c=Kl({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}else return Fy({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const L9e={kernelName:KI,backendName:"webgl",kernelFunc:Qx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Dy({inputs:{input:r},backend:n}),i=nY({inputs:{x:s},backend:n}),o=MS({inputs:{input:r},backend:n}),a=Qx({inputs:{x:o},backend:n}),c=Kl({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),c}else return Fy({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const B9e={kernelName:NI,backendName:"webgl",kernelFunc:nY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return $A({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{ci(i,u.shape,"All tensors passed to stack must have matching shapes"),U(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],c=e.map(u=>{const d=$A({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(d),d}),l=UQ({inputs:c,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),l}const z9e={kernelName:$I,backendName:"webgl",kernelFunc:M9e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U9e{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((l,u)=>l[0]+e[u]+l[1]);const s=e.length,i=rn(s),o=n.map(l=>l[0]).join(","),a=n.map((l,u)=>l[0]+e[u]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V9e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((v,y)=>v[0]+e[y]+v[1]);const s=e.length,i=rn(s),o=n.map(v=>v[0]).join(","),a=n.map((v,y)=>v[0]+e[y]).join(","),c=ds("rc",s),l=ds("source",s),u=`${c[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${l.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${c[s-1]} += 1;
       if(${u}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${c[s-2]} += 1;
       if(${c[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${c[s-1]} += 1;
         if(${u}) {`],m=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let g="";for(let v=0,y=s===1?2:4;v<y;v++)g+=`
        ${h[v]}
        if (${m}) {
          result[${v}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${v}] = getChannel(getX(${l.join()}), ${d});
        }
      `;g+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rY=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:i,constantValue:o}=r;if(me(s.shape)===0){const l=i.map((u,d)=>u[0]+s.shape[d]+u[1]);return Fy({backend:n,attrs:{shape:l,value:o,dtype:s.dtype}})}const a=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new V9e(s.shape,i,o):new U9e(s.shape,i,o),c=[[o]];return n.runWebGLProgram(a,[s],s.dtype,c)},j9e={kernelName:RI,backendName:"webgl",kernelFunc:rY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,W9e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Od+`
  return result;
`,G9e=Wr({opSnippet:H9e,packedOpSnippet:W9e}),q9e={kernelName:q0,backendName:"webgl",kernelFunc:G9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:i,keepDims:o}=r,a=s.shape.length,c=[],l=Nt(i,s.shape);let u=l;const d=Pn(u,a);let h=s;d!=null&&(h=ms({inputs:{x:s},backend:n,attrs:{perm:d}}),u=Xn(u.length,a),c.push(h)),jr("prod",u,a);let m;if(n.shouldExecuteOnCPU([h])){const g=n.texData.get(h.dataId).values,{outVals:v,outShape:y,outDtype:w}=G6e(h.shape,h.dtype,g,u);m=n.makeTensorInfo(y,w,v)}else{const[g,v]=Cr(h.shape,u),y=me(v),w=Pe({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),x=W$(s.dtype),S=Pd(w,x,"prod",n);m=Pe({inputs:{x:S},backend:n,attrs:{shape:g}}),c.push(w),c.push(S)}if(o){c.push(m);const g=Kn(m.shape,l);m=Pe({inputs:{x:m},backend:n,attrs:{shape:g}})}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const X9e={kernelName:PI,backendName:"webgl",kernelFunc:K9e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=r,c=s.map(w=>n.readSync(w.dataId)),l=s.map(w=>w.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,m,g]=q6e(c,l,u,i.shape,i.dtype,d,o.shape,a),v=h.map(w=>n.makeTensorInfo([w.length],"int32",w)),y=n.makeTensorInfo(g,i.dtype,m);return v.concat([y])}const Y9e={kernelName:x$,backendName:"webgl",kernelFunc:Q9e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9e(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:i}=e,o=n.readSync(r.dataId),a=n.readSync(s.dataId),c=n.readSync(i.dataId),[l,u]=K6e(o,r.shape,r.dtype,a,s.shape,c,i.shape),d=n.makeTensorInfo([l.length],"int32",l),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const J9e={kernelName:I$,backendName:"webgl",kernelFunc:Z9e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e7e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:c}=r,l=n.readSync(s.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(y=>n.readSync(y.dataId)),m=a.map(y=>y.shape),[g,v]=X6e(l,s.shape,u,i.shape,i.dtype,d,o.shape,h,m,c);return n.makeTensorInfo(g,i.dtype,v)}const t7e={kernelName:S$,backendName:"webgl",kernelFunc:e7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:i,dtype:o}=n,a=Q6e(r,s,i,o);return e.makeTensorInfo([a.length],o,a)},n7e={kernelName:k$,backendName:"webgl",kernelFunc:sY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7e="return 1.0 / x;",s7e=zt({opSnippet:r7e}),i7e={kernelName:K0,backendName:"webgl",kernelFunc:s7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7e=uo+`
  return (x < 0.0) ? 0.0 : x;
`,a7e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,c7e=zt({opSnippet:o7e,packedOpSnippet:a7e}),l7e={kernelName:X0,backendName:"webgl",kernelFunc:c7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7e=uo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,d7e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,f7e=zt({opSnippet:u7e,packedOpSnippet:d7e}),h7e={kernelName:Q0,backendName:"webgl",kernelFunc:f7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p7e{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,c,l]=e;this.outputShape=[o,n,r,l];const u=[s&&n>1?a-1:a,s&&r>1?c-1:c],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m7e{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,c,l]=e;this.outputShape=[o,n,r,l];const u=[s&&n>1?a-1:a,s&&r>1?c-1:c],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[c,l]=a,u=fe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new m7e(s.shape,c,l,i,o):new p7e(s.shape,c,l,i,o);return n.runWebGLProgram(u,[s],"float32")}const y7e={kernelName:LI,backendName:"webgl",kernelFunc:g7e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v7e{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,c=[r&&o>1?s-1:s,r&&a>1?i-1:i],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],u=c[0]/l[0],d=c[1]/l[1],h=1/u,m=1/d,g=Math.ceil(h)*2+2,v=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${m});

        const int winHeight = int(${g});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new v7e(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const w7e={kernelName:T$,backendName:"webgl",kernelFunc:b7e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x7e{constructor(e,n,r,s,i){this.variableNames=["A"],this.outputShape=[];const[o,a,c,l]=e;this.outputShape=[o,n,r,l];const u=[s&&n>1?a-1:a,s&&r>1?c-1:c],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let m;i?m="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I7e{constructor(e,n,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,c,l]=e;this.outputShape=[o,n,r,l];const u=[s&&n>1?a-1:a,s&&r>1?c-1:c],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],h=s?"0.5":"0.0";let m;i?m="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:i,halfPixelCenters:o,size:a}=r,[c,l]=a,u=fe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new I7e(s.shape,c,l,i,o):new x7e(s.shape,c,l,i,o);return n.runWebGLProgram(u,[s],s.dtype)}const k7e={kernelName:FI,backendName:"webgl",kernelFunc:S7e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E7e{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,i]=n,[,o,a]=e,c=[r&&o>1?s-1:s,r&&a>1?i-1:i],l=[r&&o>1?o-1:o,r&&a>1?a-1:a],u=c[0]/l[0],d=c[1]/l[1],h=1/u,m=1/d,g=Math.ceil(h)*2+2,v=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${m});

        const int winHeight = int(${g});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7e(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:i}=e,{alignCorners:o}=r,a=new E7e(i.shape,s.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const T7e={kernelName:C$,backendName:"webgl",kernelFunc:C7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A7e{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,c)=>s(c)).join(","),o=rn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N7e{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=ds("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=rn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(s.slice())};
          if(${i}){
            result.g = ${l(s.slice())};
          }
          if(${o}) {
            result.b = ${u(s.slice())};
            if(${i}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(g){return h(g)}function l(g){return g[r-1]="("+g[r-1]+" + 1)",h(g)}function u(g){return g[r-2]="("+g[r-2]+" + 1)",h(g)}function d(g){return g[r-1]="("+g[r-1]+" + 1)",g[r-2]="("+g[r-2]+" + 1)",h(g)}function h(g){const v=e.map((x,S)=>m(S,g)),y=v.join(","),w=v.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${w}))`}function m(g,v){return n.indexOf(g)!==-1&&e[g]!==1?`${e[g]} - ${v[g]} - 1`:`${v[g]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:i}=r,o=s.shape.length,a=Nt(i,s.shape);if(o===0)return ai({inputs:{x:s},backend:n});const c=fe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new N7e(s.shape,a):new A7e(s.shape,a);return n.runWebGLProgram(c,[s],s.dtype)}const $7e={kernelName:BI,backendName:"webgl",kernelFunc:_7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R7e{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7e={kernelName:H$,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:i,center:o}=e,a=n,c=new R7e(r.shape,i),[l,u]=VR(o,r.shape[1],r.shape[2]),d=[[l,u,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(c,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7e=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,D7e=zt({opSnippet:P7e}),F7e={kernelName:Y0,backendName:"webgl",kernelFunc:D7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7e="return inversesqrt(x);",B7e=zt({opSnippet:L7e,cpuKernelImpl:Y6e}),M7e={kernelName:Z0,backendName:"webgl",kernelFunc:B7e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WO{constructor(e,n,r,s,i,o,a=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=rn(i.length),u=rn(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let m="";s===1?m="i":s===2&&(m="i, coords[1]");const g=`getUpdates(${m})`;let v="";c&&(v="coords[0], coords[1]");const y=`getDefaultValue(${v})`,w=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${g};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z7e{constructor(e,n,r,s,i,o,a=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const l=rn(i.length),u=rn(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let m="";s===1?m="i":s===2&&(m="i, coords[1]");const g=`getUpdates(${m})`;let v="";c&&(v="coords[0], coords[1]");const y=`getDefaultValue(${v})`,w=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${g};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:i}=e,{shape:o}=r,{sliceRank:a,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Ad(i,s,o),h=[d/l,l];if(d===0)return n.makeTensorInfo(o,s.dtype);const m=Pe({inputs:{x:s},backend:n,attrs:{shape:[c,a]}}),g=Pe({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;fe().getBool("WEBGL_PACK")?y=new z7e(c,a,m.shape.length,g.shape.length,u,h):y=new WO(c,a,m.shape.length,g.shape.length,u,h);const w=n.runWebGLProgram(y,[g,m,v],g.dtype),x=Pe({inputs:{x:w},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(v),x}const V7e={kernelName:A$,backendName:"webgl",kernelFunc:U7e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j7e{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=fe().getNumber("WEBGL_VERSION")===2?i:o,c=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:i}=e,{side:o}=r,a=new j7e(s.shape[0],s.shape[1],i.shape[1],o),c=[[s.shape[1]]];return n.runWebGLProgram(a,[s,i],"int32",c)}const W7e={kernelName:_$,backendName:"webgl",kernelFunc:H7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G7e{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],l=[];for(let u=0;u<n.length;u++)l.push(`${a[u]}`),u<e&&c.push(`${a[u]}`);s=c.join(),i=l.join()}const o=rn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7e(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:i}=e,o=new G7e(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(o,[r,s,i],ni(s.dtype,i.dtype))}const K7e={kernelName:MI,backendName:"webgl",kernelFunc:q7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X7e=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${xS};
  float scale = ${IS};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Q7e=zt({opSnippet:X7e}),Y7e={kernelName:J0,backendName:"webgl",kernelFunc:Q7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7e=cp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,J7e=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,eKe=zt({opSnippet:Z7e,packedOpSnippet:J7e,cpuKernelImpl:J6e}),tKe={kernelName:ry,backendName:"webgl",kernelFunc:eKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nKe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,rKe=zt({opSnippet:nKe}),sKe={kernelName:ny,backendName:"webgl",kernelFunc:rKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iKe=cp+`
  return sin(x);
`,oKe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Od}
  return result;
`,aKe=zt({opSnippet:iKe,packedOpSnippet:oKe}),cKe={kernelName:ey,backendName:"webgl",kernelFunc:aKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lKe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,uKe=zt({opSnippet:lKe}),dKe={kernelName:ty,backendName:"webgl",kernelFunc:uKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fKe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,hKe=zt({opSnippet:fKe}),pKe={kernelName:sy,backendName:"webgl",kernelFunc:hKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mKe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:i,paddings:o}=r;U(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((w,x)=>w*x),c=[[0,0]];c.push(...o);for(let w=1+i.length;w<s.shape.length;++w)c.push([0,0]);const l=[],u=rY({inputs:{x:s},backend:n,attrs:{paddings:c,constantValue:0}}),d=wy(u.shape,i,a,!1),h=xy(d.length,i.length,!1),m=Iy(u.shape,i,a,!1),g=Pe({inputs:{x:u},backend:n,attrs:{shape:d}}),v=ms({inputs:{x:g},backend:n,attrs:{perm:h}}),y=Pe({inputs:{x:v},backend:n,attrs:{shape:m}});return l.push(u),l.push(g),l.push(v),l.forEach(w=>n.disposeIntermediateTensorInfo(w)),y},gKe={kernelName:VI,backendName:"webgl",kernelFunc:mKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yKe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(r.dataId),c=n.readSync(s.dataId),l=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,m,g,v]=t5e(a,r.shape,r.dtype,c,s.dtype,l,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],s.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(y=>Number(y)))),n.makeTensorInfo([v.length],r.dtype,new Int32Array(v))]}const vKe={kernelName:$$,backendName:"webgl",kernelFunc:yKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bKe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),c=Array.from(n.readSync(i.dataId)),[l,u,d]=n5e(a,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const wKe={kernelName:R$,backendName:"webgl",kernelFunc:bKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xKe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),c=n.readSync(i.dataId),[l,u]=AQ(o,r.shape,r.dtype,a,c,!0);return n.makeTensorInfo(u,r.dtype,l)}const IKe={kernelName:O$,backendName:"webgl",kernelFunc:xKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SKe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),a=n.readSync(s.dataId),c=n.readSync(i.dataId),[l,u]=AQ(o,r.shape,r.dtype,a,c);return n.makeTensorInfo(u,r.dtype,l)}const kKe={kernelName:P$,backendName:"webgl",kernelFunc:SKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EKe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:i,defaultValue:o}=e,{outputShape:a}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=Ad(i,s,a),m=!1;if(i.dtype==="string"){const w=n.bufferSync(s),x=n.bufferSync(i),S=Sl(n.readSync(o.dataId)[0]),k=Z6e(w,x,a,h,u,l,c,d,S,m);return n.makeTensorInfo(a,k.dtype,k.values)}const g=new WO(l,c,s.shape.length,i.shape.length,d,[h,1],m),v=n.runWebGLProgram(g,[i,s,o],i.dtype),y=Pe({inputs:{x:v},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(v),y}const CKe={kernelName:D$,backendName:"webgl",kernelFunc:EKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:i,axis:o}=r,a=Nt(o,s.shape)[0],c=rO(s,i,a),l=s.shape.length,u=new Array(l).fill(0),d=s.shape.slice();return c.map(h=>{const m=[...d];m[a]=h;const g=lp({inputs:{x:s},backend:n,attrs:{begin:u,size:m}});return u[a]+=h,g})}const AKe={kernelName:jI,backendName:"webgl",kernelFunc:TKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz="return sqrt(x);",NKe=zt({opSnippet:kz,packedOpSnippet:kz,cpuKernelImpl:r5e}),_Ke={kernelName:iy,backendName:"webgl",kernelFunc:NKe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ke="return x * x;",RKe=zt({opSnippet:$Ke}),OKe={kernelName:F$,backendName:"webgl",kernelFunc:RKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ez="return (a - b) * (a - b);",PKe=Wr({opSnippet:Ez,packedOpSnippet:Ez}),DKe={kernelName:oy,backendName:"webgl",kernelFunc:PKe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(s.dataId),o=bc(i),a=s5e(o,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const LKe={kernelName:WI,backendName:"webgl",kernelFunc:FKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BKe({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=uo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new ma(r.shape,s);return n.runWebGLProgram(i,[r],r.dtype)}const MKe={kernelName:dy,backendName:"webgl",kernelFunc:BKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zKe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=rn(r.length),o=rn(r.length);let a="";if(s===1)a="coords * strides + begin";else{let c=0;a=r.map((l,u)=>(c++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${c-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UKe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:i,end:o,strides:a,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:m,finalShape:g,isIdentity:v,sliceDim0:y,isSimpleSlice:w,begin:x,end:S,strides:k}=MR(s.shape,i,o,a,c,l,u,d,h);let E;if(v)E=Pe({inputs:{x:s},backend:n,attrs:{shape:g}});else if(y||w){U(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const R=FR(x,S,k),N=lp({inputs:{x:s},backend:n,attrs:{begin:x,size:R}});E=Pe({inputs:{x:N},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(N)}else if(n.shouldExecuteOnCPU([s])){const N=n.readSync(s.dataId),P=kt(s.shape,s.dtype,N),O=i5e(m,P,k,x);E=n.makeTensorInfo(g,s.dtype,O.values)}else{const N=new zKe(x,k,m);E=n.runWebGLProgram(N,[s],s.dtype)}const A=Pe({inputs:{x:E},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(E),A}const VKe={kernelName:L$,backendName:"webgl",kernelFunc:UKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jKe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:i,leftPad:o,rightPad:a,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),m=n.readSync(d.dataId),[g,v]=o5e(h,m,s,i,o,a,c,l);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",v)]}const HKe={kernelName:B$,backendName:"webgl",kernelFunc:jKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WKe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[l,u,d]=a5e(a,c,s),h=u.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const GKe={kernelName:M$,backendName:"webgl",kernelFunc:WKe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qKe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=c5e(o,s);return n.makeTensorInfo(i.shape,"int32",a)}const KKe={kernelName:z$,backendName:"webgl",kernelFunc:qKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XKe="return tan(x);",QKe=zt({opSnippet:XKe}),YKe={kernelName:cy,backendName:"webgl",kernelFunc:QKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZKe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,JKe=zt({opSnippet:ZKe}),eXe={kernelName:ly,backendName:"webgl",kernelFunc:JKe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tXe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:i,updates:o}=e,{sliceRank:a,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=Ad(o,i,s.shape),h=[d/l,l];if(d===0)return n.makeTensorInfo(s.shape,i.dtype);const m=Pe({inputs:{x:i},backend:n,attrs:{shape:[c,a]}}),g=Pe({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),v=Pe({inputs:{x:s},backend:n,attrs:{shape:h}}),y=new WO(c,a,m.shape.length,g.shape.length,u,h,!1,!0),w=n.runWebGLProgram(y,[g,m,v],v.dtype),x=Pe({inputs:{x:w},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w),x}const nXe={kernelName:N$,backendName:"webgl",kernelFunc:tXe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rXe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const s=rn(this.rank),i=sXe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function sXe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const c=n.readSync(s.dataId),l=s.dtype==="string"?c.map(h=>Sl(h)):c,u=kt(s.shape,s.dtype,l),d=u5e(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new rXe(s.shape,i);return n.runWebGLProgram(o,[s],s.dtype)}const iXe={kernelName:uy,backendName:"webgl",kernelFunc:iY};class oXe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class aXe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function Cz(t){let e=1;for(;e<t;)e*=2;return e}function cXe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:i,sorted:o}=r,a=fe().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=fe().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=s.shape,u=l[l.length-1];if(n.shouldExecuteOnCPU([s])||u<a||i>c){const O=n.readSync(s.dataId),[_,M]=d5e(O,l,s.dtype,i,o);return[n.makeTensorInfo(_.shape,_.dtype,_.values),n.makeTensorInfo(M.shape,M.dtype,M.values)]}if(i===0)return l[l.length-1]=0,[n.makeTensorInfo(l,s.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(u===1)return[s,Fy({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),h=d!==null&&d.isPacked,m=h?n.unpackTensor(s):s,v=me(l)/u,y=Pe({inputs:{x:m},attrs:{shape:[v,u]},backend:n});h&&hu(n,m);const w=Cz(i),x=Cz(u);let S=null;const k=()=>S===null?[y,y]:[y,S],E=(O,_,M)=>{const G=k(),q=new oXe(M),L=[[u],[S===null?1:0],[Number.NEGATIVE_INFINITY],[O],[_]],K=S;S=n.runWebGLProgram(q,G,"int32",L),hu(n,K)};for(let O=1;O<w;O*=2){const _=O*2;for(let M=O;M>=1;M/=2)E(_,M,[v,x])}for(let O=x;O>w;O/=2){const _=k(),M=new aXe([v,O/2]),q=[[u],[S===null?1:0],[w]],D=S;S=n.runWebGLProgram(M,_,"int32",q),hu(n,D);const L=w/2,K=L*2;for(let j=L;j>=1;j/=2)E(K,j,S.shape)}let A=S;S=lp({inputs:{x:S},backend:n,attrs:{begin:0,size:[v,i]}}),hu(n,A);let R=YQ({inputs:{x:y,indices:S},backend:n,attrs:{axis:1,batchDims:1}});hu(n,y);const N=l.slice(0,-1);N.push(i),A=S,S=Pe({inputs:{x:S},attrs:{shape:N},backend:n}),hu(n,A);const P=R;return R=Pe({inputs:{x:R},attrs:{shape:N},backend:n}),hu(n,P),[R,S]}const lXe={kernelName:U$,backendName:"webgl",kernelFunc:cXe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uXe{constructor(e,n,r,s,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=r==="nearest"?1:2;let c;switch(s){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dXe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:c,outputShape:l}=r,[u,d,h,m]=s.shape,[g,v]=l??[d,h],y=[u,g,v,m],w=new uXe(d,h,o,a,c,y);return n.runWebGLProgram(w,[s,i],"float32")}const fXe={kernelName:V$,backendName:"webgl",kernelFunc:dXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hXe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:i}=e;Oy(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:a,outputShape:c,indices:l}=f5e(o,s,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,a),r.makeTensorInfo([l.length],"int32",l)]}const pXe={kernelName:j$,backendName:"webgl",kernelFunc:hXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mXe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const o=s,a=o.shape.length,c=s.shape[i],l=new Array(a-1);let u=0;for(let v=0;v<a;v++)v!==i&&(l[u++]=o.shape[v]);const d=[],h=new Array(a).fill(0),m=o.shape.slice();m[i]=1;const g=new Array(c);for(let v=0;v<g.length;v++){h[i]=v;const y=lp({inputs:{x:o},backend:n,attrs:{begin:h,size:m}}),w=Pe({inputs:{x:y},backend:n,attrs:{shape:l}});g[v]=w,d.push(y)}return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const gXe={kernelName:GI,backendName:"webgl",kernelFunc:mXe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yXe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/r);this.outputShape=[s,a];const c="0.0",l="sumValue",u=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let g="";i%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${g}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vXe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:i}=e,{numSegments:o}=r,a=s.shape.length,c=[];let l=0;const u=Pn([l],a);let d=s;u!=null&&(d=ms({inputs:{x:s},backend:n,attrs:{perm:u}}),c.push(d),l=Xn(1,a)[0]);const h=L9(d.shape,l,o),m=me([d.shape[l]]),g=Pe({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}});c.push(g);const v=W$(s.dtype),y=(k,E,A,R,N)=>{const P=k.shape[0],O=k.shape[1],_=F9(O,N),M={windowSize:_,inSize:O,batchSize:P,numSegments:N},G=new yXe(M,E),q=n.compileAndRun(G,[k,A],R);if(c.push(q),q.shape[1]===N)return q;const D=sY({backend:n,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),L=iY({inputs:{x:D},backend:n,attrs:{reps:[O/_]}});return c.push(D),c.push(L),y(q,E,L,R,N)},w=y(g,"unsortedSegmentSum",i,v,o),x=Pe({inputs:{x:w},backend:n,attrs:{shape:h}});let S=x;if(u!=null){c.push(x);const k=Vl(u);S=ms({inputs:{x:S},backend:n,attrs:{perm:k}})}return c.forEach(k=>n.disposeIntermediateTensorInfo(k)),S}const bXe={kernelName:qI,backendName:"webgl",kernelFunc:vXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wXe=[rHe,iHe,cHe,dHe,hHe,gHe,vHe,wHe,kHe,CHe,NHe,RHe,DHe,MHe,VHe,HHe,GHe,QHe,ZHe,eWe,sWe,dWe,hWe,yWe,bWe,EWe,TWe,$We,z5e,PWe,MWe,jWe,XWe,ZWe,eGe,nGe,sGe,cGe,dGe,pGe,gGe,vGe,wGe,SGe,EGe,NGe,$Ge,PGe,LGe,MGe,jGe,qGe,YGe,e8e,r8e,s8e,o8e,c8e,u8e,f8e,p8e,v8e,x8e,k8e,C8e,N8e,R8e,F8e,z8e,M5e,V8e,LWe,W8e,K8e,Y8e,V5e,tqe,iqe,aqe,dqe,pqe,vqe,xqe,Eqe,Nqe,Rqe,Pqe,Bqe,zqe,Vqe,Gqe,Kqe,Qqe,Zqe,e9e,s9e,c9e,f9e,w9e,W5e,k9e,T9e,_9e,O9e,xWe,F9e,B9e,z9e,j9e,q9e,H5e,X9e,Y9e,J9e,t7e,n7e,IWe,g9e,i7e,l7e,h7e,q5e,y7e,w7e,k7e,T7e,$7e,O7e,F7e,M7e,V7e,W7e,K7e,Y7e,tKe,sKe,cKe,dKe,lWe,v9e,pKe,gKe,vKe,wKe,IKe,kKe,CKe,AKe,_Ke,OKe,DKe,LKe,MKe,VKe,HKe,GKe,KKe,y9e,eHe,YKe,eXe,nXe,iXe,lXe,fXe,tHe,pXe,gXe,bXe,L9e];for(const t of wXe)l8(t);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Of(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,[])).next())})}function Pf(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xXe=function(t){t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()},RA=function(t){return{startEndTensor:t,startPoint:at(t,[0,0],[-1,2]),endPoint:at(t,[0,2],[-1,2])}},IXe=function(t,e){var n=ee(t.startPoint,e),r=ee(t.endPoint,e),s=ZI([n,r],1);return RA(s)};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var SXe={strides:[8,16],anchors:[2,6]},Tz=6;function kXe(t,e,n){for(var r=[],s=0;s<n.strides.length;s++)for(var i=n.strides[s],o=Math.floor((e+i-1)/i),a=Math.floor((t+i-1)/i),c=n.anchors[s],l=0;l<o;l++)for(var u=i*(l+.5),d=0;d<a;d++)for(var h=i*(d+.5),m=0;m<c;m++)r.push([h,u]);return r}function EXe(t,e,n){var r=at(t,[0,1],[-1,2]),s=xe(r,e),i=at(t,[0,3],[-1,2]),o=We(i,n),a=We(s,n),c=We(o,2),l=Be(a,c),u=xe(a,c),d=ee(l,n),h=ee(u,n),m=1;return ZI([d,h],m)}function CXe(t){return t instanceof Yt?[t.shape[0],t.shape[1]]:[t.height,t.width]}function Az(t,e){var n,r,s;if(t.topLeft instanceof Yt&&t.bottomRight instanceof Yt){var i=ae(function(){return[zn([at(Be(e-1,t.topLeft),0,1),at(t.topLeft,1,1)]),zn([Be(e-1,at(t.bottomRight,0,1)),at(t.bottomRight,1,1)])]}),o=i[0],a=i[1];n=o,r=a,t.landmarks!=null&&(s=ae(function(){var v=Be(Ir([e-1,0]),t.landmarks),y=Ir([1,-1]),w=ee(v,y);return w}))}else{var c=t.topLeft,l=c[0],u=c[1],d=t.bottomRight,h=d[0],m=d[1];n=[e-1-l,u],r=[e-1-h,m],t.landmarks!=null&&(s=t.landmarks.map(function(v){return[e-1-v[0],v[1]]}))}var g={topLeft:n,bottomRight:r};return s!=null&&(g.landmarks=s),t.probability!=null&&(g.probability=t.probability instanceof Yt?t.probability.clone():t.probability),g}function Nz(t,e){return ae(function(){var n;return t.hasOwnProperty("box")?n=t.box:n=t,Do(IXe(n,e).startEndTensor)})}var TXe=(function(){function t(e,n,r,s,i,o){this.blazeFaceModel=e,this.width=n,this.height=r,this.maxFaces=s,this.anchorsData=kXe(n,r,SXe),this.anchors=Bu(this.anchorsData),this.inputSizeData=[n,r],this.inputSize=Ir([n,r]),this.iouThreshold=i,this.scoreThreshold=o}return t.prototype.getBoundingBoxes=function(e,n,r){return r===void 0&&(r=!0),Of(this,void 0,void 0,function(){var s,i,o,a,c,l,u,d,h,m,g,v,y,w,x=this;return Pf(this,function(S){switch(S.label){case 0:return s=ae(function(){var k=Yi.resizeBilinear(e,[x.width,x.height]),E=ee(Be(We(k,255),.5),2),A=x.blazeFaceModel.predict(E),R=Do(A),N=EXe(R,x.anchors,x.inputSize),P=at(R,[0,0],[-1,1]),O=Do(Po(P));return[R,N,O]}),i=s[0],o=s[1],a=s[2],c=console.warn,console.warn=function(){},l=Yi.nonMaxSuppression(o,a,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=c,[4,l.array()];case 1:return u=S.sent(),l.dispose(),d=u.map(function(k){return at(o,[k,0],[1,-1])}),n?[3,3]:[4,Promise.all(d.map(function(k){return Of(x,void 0,void 0,function(){var E;return Pf(this,function(A){switch(A.label){case 0:return[4,k.array()];case 1:return E=A.sent(),k.dispose(),[2,E]}})})}))];case 2:d=S.sent(),S.label=3;case 3:for(h=e.shape[1],m=e.shape[2],n?g=We([m,h],this.inputSize):g=[m/this.inputSizeData[0],h/this.inputSizeData[1]],v=[],y=function(k){var E=d[k],A=ae(function(){var R=E instanceof Yt?RA(E):RA(Bu(E));if(!r)return R;var N=u[k],P;n?P=at(x.anchors,[N,0],[1,2]):P=x.anchorsData[N];var O=re(Do(at(i,[N,Tz-1],[1,-1])),[Tz,-1]),_=at(a,[N],[1]);return{box:R,landmarks:O,probability:_,anchor:P}});v.push(A)},w=0;w<d.length;w++)y(w);return o.dispose(),a.dispose(),i.dispose(),[2,{boxes:v,scaleFactor:g}]}})})},t.prototype.estimateFaces=function(e,n,r,s){return n===void 0&&(n=!1),r===void 0&&(r=!1),s===void 0&&(s=!0),Of(this,void 0,void 0,function(){var i,o,a,c,l,u,d=this;return Pf(this,function(h){switch(h.label){case 0:return i=CXe(e),o=i[1],a=ae(function(){return e instanceof Yt||(e=bRe(e)),Qr(Fe(e,"float32"),0)}),[4,this.getBoundingBoxes(a,n,s)];case 1:return c=h.sent(),l=c.boxes,u=c.scaleFactor,a.dispose(),n?[2,l.map(function(m){var g=Nz(m,u),v={topLeft:at(g,[0],[2]),bottomRight:at(g,[2],[2])};if(s){var y=m,w=y.landmarks,x=y.probability,S=y.anchor,k=ee(xe(w,S),u);v.landmarks=k,v.probability=x}return r&&(v=Az(v,o)),v})]:[2,Promise.all(l.map(function(m){return Of(d,void 0,void 0,function(){var g,v,x,y,w,x,S,k,E,A,R,N,P=this;return Pf(this,function(O){switch(O.label){case 0:return g=Nz(m,u),s?[3,2]:[4,g.array()];case 1:return x=O.sent(),v={topLeft:x.slice(0,2),bottomRight:x.slice(2)},[3,4];case 2:return[4,Promise.all([m.landmarks,g,m.probability].map(function(_){return Of(P,void 0,void 0,function(){return Pf(this,function(M){return[2,_.array()]})})}))];case 3:y=O.sent(),w=y[0],x=y[1],S=y[2],k=m.anchor,E=u,A=E[0],R=E[1],N=w.map(function(_){return[(_[0]+k[0])*A,(_[1]+k[1])*R]}),v={topLeft:x.slice(0,2),bottomRight:x.slice(2),landmarks:N,probability:S},xXe(m.box),m.landmarks.dispose(),m.probability.dispose(),O.label=4;case 4:return g.dispose(),r&&(v=Az(v,o)),[2,v]}})})}))]}})})},t.prototype.dispose=function(){this.blazeFaceModel.dispose(),this.anchors.dispose(),this.inputSize.dispose()},t})();/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AXe="https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1";function NXe(t){var e={},n=e.maxFaces,r=n===void 0?10:n,s=e.inputWidth,i=s===void 0?128:s,o=e.inputHeight,a=o===void 0?128:o,c=e.iouThreshold,l=c===void 0?.3:c,u=e.scoreThreshold,d=u===void 0?.75:u,h=e.modelUrl;return Of(this,void 0,void 0,function(){var m,g;return Pf(this,function(v){switch(v.label){case 0:return h==null?[3,2]:[4,G4(h)];case 1:return m=v.sent(),[3,4];case 2:return[4,G4(AXe,{fromTFHub:!0})];case 3:m=v.sent(),v.label=4;case 4:return g=new TXe(m,i,a,r,l,d),[2,g]}})})}let Bf=null;async function oY(){return Bf||(console.log("Loading BlazeFace model..."),await HEe(),Bf=await NXe(),console.log("BlazeFace model loaded successfully"),Bf)}async function _Xe(t){Bf||await oY();const e=new Image;await new Promise((w,x)=>{e.onload=w,e.onerror=x,e.src=t});const n=await Bf.estimateFaces(e,!1);if(n.length===0)throw new Error("No face detected. Please ensure your face is visible and well-lit.");const r=n[0],s=r.probability[0],i=r.topLeft,o=r.bottomRight,a=o[0]-i[0],c=o[1]-i[1],l=Math.sqrt(a*c),u=Math.min(l/300,1),d=r.landmarks;let h=.5;if(d&&d.length>=5){const w=d[3],x=d[4],S=Math.abs(x[0]-w[0]);h=Math.min(S/a,1)}const m=s*.4+u*.3+h*.3,g=Math.random()*.3-.15,y=Math.max(0,Math.min(100,(m+g)*100))+s*10;return Math.round(Math.min(100,y))}async function $Xe(){try{await oY(),console.log("Model preloaded successfully")}catch(t){console.error("Failed to preload model:",t)}}function RXe(){const{wallet:t}=z1(),{toast:e}=Zx(),[n,r]=z.useState(null),[s,i]=z.useState(!1),{data:o=[],refetch:a}=RE({queryKey:["/leaderboard"],queryFn:Xke,enabled:t.connected,refetchInterval:1e4}),{data:c="0",refetch:l}=RE({queryKey:["/pool"],queryFn:Qke,enabled:t.connected,refetchInterval:1e4}),{data:u}=RE({queryKey:["/user",t.address],queryFn:()=>Yke(t.address),enabled:t.connected&&!!t.address,refetchInterval:1e4}),d={totalSmiles:0,averageScore:0,tokensEarned:u?.totalRewards||"0",bestScore:u?.bestScore||0};z.useEffect(()=>{$Xe()},[]);const h=async g=>{if(!t.connected||!t.address){e({variant:"destructive",title:"Wallet Not Connected",description:"Please connect your wallet first"});return}i(!0),r(null);try{const v=await _Xe(g);r(v);try{const y=await qke(t.address,v);v>=vu?e({title:"Congratulations! 🎉",description:`Your smile scored ${v}! Reward claimed automatically.`}):e({title:"Smile Recorded!",description:`Your smile scored ${v}. Score ${vu}+ to earn rewards!`}),a(),l()}catch(y){e({variant:"destructive",title:"Blockchain Error",description:y.message||"Failed to submit score to contract"})}}catch(v){e({variant:"destructive",title:"Analysis Failed",description:v.message||"Failed to analyze your smile. Please try again."}),r(null)}finally{i(!1)}},m=async g=>{if(!t.connected||!t.address)throw new Error("Wallet not connected");const v=await Kke(t.address,g);return l(),a(),v};return F.jsxs("div",{className:"min-h-screen bg-background",children:[F.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:F.jsx("div",{className:"container mx-auto px-4 py-4",children:F.jsxs("div",{className:"flex items-center justify-between",children:[F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsxs("div",{className:"flex items-center gap-2 text-2xl font-display font-bold",children:[F.jsx(Rte,{className:"h-7 w-7 text-primary"}),F.jsx("span",{className:"bg-gradient-to-r from-primary to-accent-foreground bg-clip-text text-transparent",children:"SmileChain"})]}),F.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1 bg-primary/10 rounded-full border border-primary/20",children:[F.jsx(s1,{className:"h-4 w-4 text-primary"}),F.jsx("span",{className:"text-xs font-medium text-primary",children:"Celo Alfajores"})]})]}),F.jsx(jke,{})]})})}),F.jsxs("main",{className:"container mx-auto px-4 py-8",children:[F.jsxs("div",{className:"text-center mb-12 space-y-4",children:[F.jsx("h1",{className:"text-4xl md:text-6xl font-display font-bold bg-gradient-to-r from-primary via-accent-foreground to-primary bg-clip-text text-transparent",children:"Earn Tokens with Your Smile"}),F.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto",children:"Capture your best smile, get scored by AI, and earn Celo tokens. The happier you look, the more you earn!"})]}),F.jsx(Wke,{}),t.connected&&F.jsx("div",{className:"mb-8",children:F.jsx(wIe,{...d})}),F.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 items-start",children:[F.jsxs("div",{className:"space-y-6",children:[F.jsx(R1e,{onCapture:h,isProcessing:s}),F.jsx(V1e,{score:n,isAnalyzing:s})]}),F.jsxs("div",{className:"space-y-6",children:[F.jsx(vIe,{poolSize:c,onDonate:m}),F.jsx(bIe,{entries:o})]})]}),F.jsxs("div",{className:"mt-16 max-w-4xl mx-auto",children:[F.jsx("h2",{className:"text-3xl font-display font-bold text-center mb-8",children:"How It Works"}),F.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{step:"1",title:"Capture Your Smile",description:"Use your camera to take a selfie showing your best smile"},{step:"2",title:"AI Scores Your Smile",description:"Our on-device AI model analyzes and rates your smile from 0-100"},{step:"3",title:"Earn Rewards",description:"Score 80+ to automatically receive Celo tokens as a reward"}].map(g=>F.jsxs("div",{className:"text-center space-y-3",children:[F.jsx("div",{className:"w-16 h-16 mx-auto rounded-full bg-primary text-primary-foreground flex items-center justify-center text-2xl font-display font-bold",children:g.step}),F.jsx("h3",{className:"text-xl font-semibold",children:g.title}),F.jsx("p",{className:"text-sm text-muted-foreground",children:g.description})]},g.step))})]})]}),F.jsx("footer",{className:"border-t mt-16",children:F.jsxs("div",{className:"container mx-auto px-4 py-8 text-center text-sm text-muted-foreground",children:[F.jsx("p",{children:"SmileChain is a decentralized application built on Celo Alfajores testnet"}),F.jsx("p",{className:"mt-2",children:"All smile detection happens on your device. Your photos are never uploaded."})]})})]})}function OXe(){return F.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-background",children:F.jsxs("div",{className:"text-center space-y-6 p-8",children:[F.jsx(SU,{className:"h-24 w-24 mx-auto text-muted-foreground"}),F.jsxs("div",{className:"space-y-2",children:[F.jsx("h1",{className:"text-6xl font-display font-bold text-foreground",children:"404"}),F.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Page Not Found"}),F.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:"Looks like this page doesn't exist. Let's get you back to spreading smiles!"})]}),F.jsx(OJ,{href:"/",children:F.jsxs(Ro,{size:"lg",className:"gap-2",children:[F.jsx(Tte,{className:"h-4 w-4"}),"Back to Home"]})})]})})}function PXe(){return F.jsxs(PJ,{children:[F.jsx(WF,{path:"/",component:RXe}),F.jsx(WF,{component:OXe})]})}function DXe(){return F.jsx(oee,{client:wee,children:F.jsx(E1e,{children:F.jsxs(nse,{children:[F.jsx(gne,{}),F.jsx(PXe,{})]})})})}uJ.createRoot(document.getElementById("root")).render(F.jsx(DXe,{}))});export default FXe();
